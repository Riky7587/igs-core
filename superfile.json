{"autorun/l_ingameshop.lua":  "--[[-------------------------------------------------------------------------\n\tР’РµР± Р·Р°РіСЂСѓР·С‡РёРє IGS 13.03.2021\n\thttps://blog.amd-nick.me/github-workshop-garrysmod/\n\tРР·РЅР°С‡Р°Р»СЊРЅРѕ СЌС‚Р° Р·Р°РґР°С‡Р° РїСЂРµРґСЃС‚Р°РІР»СЏР»Р°СЃСЊ РІ 3 СЃС‚СЂРѕРєРё\n---------------------------------------------------------------------------]]\nIGS = IGS or {}\n\nlocal function log(patt, ...)\n\tif cookie.GetNumber(\"igsverbose\", 0) == 1 then\n\t\tprint(string.format(\"[IGS] \" .. patt, ...))\n\tend\nend\n\nconcommand.Add(\"igsverbose\", function(pl)\n\tif SERVER and IsValid(pl) then return end\n\n\tlocal enable = cookie.GetNumber(\"igsverbose\", 0) == 0\n\tcookie.Set(\"igsverbose\", enable and 1 or 0)\n\tprint(\"IGS Logging \" .. (enable and \"enabled\" or \"disabled\"))\nend)\n\nlocal i = {} -- lua files only\ni.sv = SERVER and include or function() end\ni.cl = SERVER and AddCSLuaFile or include\ni.sh = function(f) return i.cl(f) or i.sv(f) end\n\n\nlocal function include_mount(sRealm, sAbsolutePath)\n\tif (sRealm == \"sh\")\n\tor (sRealm == \"sv\" and SERVER)\n\tor (sRealm == \"cl\" and CLIENT) then\n\t\t-- Р§РёСЃС‚С‹Р№ RunString РЅРµ РІРѕСЃРїСЂРёРЅРёРјР°РµС‚ return РІРЅСѓС‚СЂРё С„Р°Р№Р»РѕРІ\n\t\t-- РќРѕ CompileString 9 Р°РїСЂРµР»СЏ 2021 С‚РµРѕСЂРµС‚РёС‡РµСЃРєРё Р±С‹Р» РїСЂРёС‡РёРЅРѕР№ РѕС€РёР±РѕРє\n\t\t-- РџРѕРєР° РїСѓСЃС‚СЊ Р±СѓРґРµС‚ RunString Р±РµР· СЂРµС‚СѓСЂРЅР°\n\t\t-- Р—Р°РјРµС‚РєРё: https://t.me/c/1353676159/55852\n\n\t\t-- local executer = CompileString(content, sAbsolutePath)\n\t\t-- return executer()\n\n\t\tlocal content  = IGS_MOUNT[sAbsolutePath]\n\t\tRunString(content, sAbsolutePath)\n\tend\nend\n\n-- \"РљРѕСЃС‚С‹Р»СЊ\" РґР»СЏ СЂР°Р±РѕС‚С‹ IGS.sh/sv/cl РёР·РЅСѓС‚СЂРё РјРѕРґСѓР»СЊРЅС‹С… _main.lua С„Р°Р№Р»РѕРІ Рё СЌРЅС‚РёС‚Рё\n-- СЃ СѓРєР°Р·Р°РЅРёРµРј РѕС‚РЅРѕСЃРёС‚РµР»СЊРЅРѕРіРѕ РїСѓС‚Рё\n-- РЅРµ СЂР°Р±РѕС‚Р°РµС‚ СЃ ../file (РЅР°РІРµСЂРЅ. РќРµ С‡РµРєР°Р»)\nlocal iam_inside\n\nlocal function incl(sRealm, sPath)\n\t-- РќРµ СЃСЂР°Р±РѕС‚Р°РµС‚, РµСЃР»Рё РЅР°РїСЂРёРјРµСЂ РІ Р»Р°СѓРЅС‡РµСЂРµ РІ sh() РґР»СЏ С„Р°Р№Р»РѕРІ СѓР±СЂР°С‚СЊ РїСЂРёСЃС‚Р°РІРєСѓ \"igs/\"\n\tlocal isRelativePath = iam_inside and not sPath:StartWith(iam_inside)\n\tlocal sAbsolutePath  = isRelativePath and iam_inside .. \"/\" .. sPath or sPath\n\t-- /\\ РњР± РІРЅСѓС‚СЂРё РјРѕРґСѓР»СЏ СѓР¶Рµ СѓРєР°Р·Р°РЅ full РїСѓС‚СЊ, Р° РЅРµ РѕС‚РЅРѕСЃРёС‚РµР»СЊРЅС‹Р№\n\t-- (РѕР±С‹С‡РЅРѕ РїСѓС‚СЊ Рє _main.lua)\n\n\t-- print(sAbsolutePath)\n\n\tif IGS_MOUNT and IGS_MOUNT[sAbsolutePath] then -- 1st check for lua load (not web)\n\t\tlog(\"%s РРєР»СЋРґ СЃ MOUNT. РџСѓС‚СЊ: %s\", sRealm, sAbsolutePath)\n\t\treturn include_mount(sRealm, sAbsolutePath)\n\telse\n\t\tlog(\"%s РРєР»СЋРґ СЃ LUA. РџСѓС‚СЊ: %s\", sRealm, sAbsolutePath)\n\t\tlocal fIncluder = i[sRealm]\n\t\treturn fIncluder(sAbsolutePath)\n\tend\nend\n\nfunction IGS.sh(sPath) return incl(\"sh\", sPath) end\nfunction IGS.sv(sPath) return incl(\"sv\", sPath) end\nfunction IGS.cl(sPath) return incl(\"cl\", sPath) end\n\nlocal function findKeys(arr, patt)\n\tlocal found = {}\n\tfor key,val in pairs(arr) do\n\t\tlocal match = key:match(patt)\n\t\tif match then\n\t\t\ttable.insert(found, match)\n\t\tend\n\tend\n\treturn found\nend\n\n-- РўСЏР¶РµР»Р°СЏ, РЅРѕ РїРѕРєР° РІ РѕРїС‚РёРјРёР·Р°С†РёРё РЅРµ РЅСѓР¶РґР°РµС‚СЃСЏ\n-- РџСЂРё РІС‹Р±РѕСЂРєРµ РјРѕРґСѓР»РµР№ Рё СЌРЅС‚РёС‚Рё СЌР»РµРјРµРЅС‚С‹ РїРѕРІС‚РѕСЂСЏСЋС‚СЃСЏ\nlocal function unique(arr)\n\tlocal ret = {}\n\tfor _,v in ipairs(arr) do\n\t\tif not table.HasValue(ret, v) then\n\t\t\ttable.insert(ret, v)\n\t\tend\n\tend\n\treturn ret\nend\n\nlocal function findInMount(patt)\n\treturn IGS_MOUNT and findKeys(IGS_MOUNT, patt) or {}\nend\n\nfunction IGS.include_files(sPath, fIncluder) -- igs/extensions\n\tlocal data_files = findInMount(\"^\" .. sPath:PatternSafe() .. \"/(.*%.lua)$\")\n\tlocal lua_files  = file.Find(sPath .. \"/*.lua\",\"LUA\")\n\ttable.Add(data_files, lua_files)\n\n\tfor _,fileName in ipairs(data_files) do\n\t\tfIncluder(sPath .. \"/\" .. fileName)\n\tend\nend\n\nfunction IGS.load_modules(sBasePath) -- igs/modules\n\tlocal data_modules  = findInMount(\"^\" .. sBasePath .. \"/([^/]*)/_main%.lua$\")\n\tdata_modules = unique(data_modules)\n\tlocal _,lua_modules = file.Find(sBasePath .. \"/*\",\"LUA\")\n\ttable.Add(data_modules, lua_modules)\n\n\tfor _,mod in ipairs(data_modules) do\n\t\tlocal sModPath = sBasePath .. \"/\" .. mod\n\t\tiam_inside = sModPath\n\t\tIGS.sh(sModPath .. \"/_main.lua\") -- igs/modules/inv_log/_main.lua\n\tend\n\tiam_inside = nil\nend\n\nfunction IGS.load_entities()\n\tlog(\"Р—Р°РіСЂСѓР·РєР° СЌРЅС‚РёС‚Рё\")\n\tlocal entities = findInMount(\"^entities/([^/]*)/(.*%.lua)$\")\n\tentities = unique(entities) -- {ent_igs, npc_igs}\n\n\tfor _,ent_class in ipairs(entities) do\n\t\tiam_inside = \"entities/\" .. ent_class\n\t\tENT = {}\n\t\tENT.Folder = iam_inside\n\n\t\tif SERVER then IGS.sv(\"init.lua\")\n\t\telse IGS.cl(\"cl_init.lua\") end\n\t\tscripted_ents.Register(ENT, ent_class)\n\n\t\tiam_inside = nil\n\t\tENT = nil\n\tend\nend\n\n\nconcommand.Add(\"igs_flushversion\", function(pl)\n\tif IsValid(pl) then print(\"console only\") return end\n\tcookie.Set(\"igs_version\", nil)\n\tprint(\"OK. РџРѕСЃР»Рµ РїРµСЂРµР·Р°РіСЂСѓР·РєРё СЃРµСЂРІРµСЂ СЃРєР°С‡Р°РµС‚ РЅРѕРІСѓСЋ РІРµСЂСЃРёСЋ\")\nend)\n\n-- РјР± РµРјСѓ РјРµСЃС‚Рѕ РІ launcher?\nlocal igs_version = CreateConVar(\"igs_version\", \"\", {FCVAR_NOTIFY, FCVAR_REPLICATED, FCVAR_SERVER_CAN_EXECUTE})\n\nif SERVER and igs_version:GetString() == \"\" then\n\tlocal version = cookie.GetString(\"igs_version\")\n\tigs_version:SetString(version or \"777\") -- \"or\" for case when igsmod isn\u0027t ran (core hosted locally)\nend\n\nIGS.sh(\"igs/launcher.lua\")\nIGS.load_entities()\n","entities/ent_igs/cl_init.lua":  "IGS.sh(\"shared.lua\")\n\nlocal UPPER_TEXT = Color(255,255,255)\nlocal LOWER_TEXT = Color(20, 150, 200)\nlocal OUTLINE    = Color(0,0,0)\n\nlocal font = \"Fated.40\"\nlocal function drawSide(pos,ang,t1,t2)\n\tcam.Start3D2D(pos, ang, .1)\n\t\tdraw.SimpleTextOutlined(t1, font, 0, -385, UPPER_TEXT, TEXT_ALIGN_CENTER, nil, 1, OUTLINE)\n\t\tdraw.SimpleTextOutlined(t2, font, 0, -350, LOWER_TEXT, TEXT_ALIGN_CENTER, nil, 1, OUTLINE)\n\tcam.End3D2D()\nend\n\n\n\n-- РІ Draw РёР·РјРµРЅСЏС‚СЊ РѕСЃС‚РѕСЂРѕР¶РЅРѕ\n-- (РјРѕР¶РµС‚ Р±С‹С‚СЊ РєСѓС‡Р° РёС‚РµРјРѕРІ, РєРѕС‚РѕСЂС‹Рµ СѓСЃРєРѕСЂСЏСЋС‚ Р°РЅРёРјР°С†РёСЋ РїСЂРё РЅРµРїСЂР°РІРёР»СЊРЅРѕРј РєРѕРґРµ)\nlocal ang = Angle(0,0,90)\nfunction ENT:Draw()\n\tang.y = -180 * math.Remap(CurTime() % 3, 0,3, 0,1) -- РјРёРЅСѓСЃ РєСЂСѓС‚РёС‚СЊ РІ РґСЂСѓРіСѓСЋ СЃС‚РѕСЂРѕРЅСѓ\n\n\tself:DrawModel()\n\n\tlocal pos = self:GetPos()\n\n\tlocal ITEM = IGS.GetItemByUID(self:GetUID())\n\tlocal t1 = ITEM:Name()\n\tlocal t2 = \"Р”РµР№СЃС‚РІСѓРµС‚ \" .. IGS.TermToStr(ITEM:Term())\n\n\tdrawSide(pos,ang,t1,t2)\n\tang:RotateAroundAxis(ang:Right(), 180)\n\tdrawSide(pos,ang,t1,t2)\nend\n","entities/ent_igs/init.lua":  "IGS.sh(\"shared.lua\")\nIGS.cl(\"cl_init.lua\")\n\nfunction ENT:Initialize()\n\t-- self:SetModel(\"models/props_junk/Shoe001a.mdl\") -- Р±РѕС‚РёРЅРѕРє\n\t-- self:SetModel(\"models/christmas_gift2/christmas_gift2.mdl\") -- РїРѕРґР°СЂРѕРє\n\n\tself:SetModel(\"models/dav0r/hoverball.mdl\")\n\tself:SetModelScale(1.5)\n\tself:SetAngles(Angle(90, 0, 0))\n\n\tself:PhysicsInit(SOLID_VPHYSICS)\n\tself:SetMoveType(MOVETYPE_VPHYSICS)\n\tself:SetSolid(SOLID_VPHYSICS)\n\tself:SetUseType(SIMPLE_USE)\n\tself:PhysWake()\nend\n\n-- Р§С‚РѕР±С‹ РЅРµР»СЊР·СЏ Р±С‹Р»Рѕ СѓР±РёС‚СЊ NPC\nfunction ENT:OnTakeDamage()\n\treturn 0\nend\n\nfunction ENT:Use(_, caller)\n\tif caller:IsPlayer() then\n\t\tself:PlayerUse(caller)\n\tend\nend\n\nfunction ENT:PlayerUse(pl)\n\tif IGS.IsInventoryOverloaded(pl) then\n\t\tIGS.Notify(pl, \"РЈ РІР°СЃ СЃР»РёС€РєРѕРј РјРЅРѕРіРѕ РїСЂРµРґРјРµС‚РѕРІ РІ РёРЅРІРµРЅС‚Р°СЂРµ\")\n\t\treturn\n\tend\n\n\tif self.Busy or self.Removed then -- С…Р· РЅСѓР¶РЅРѕ Р»Рё РёРјРµРЅРЅРѕ Р·РґРµСЃСЊ, РЅРѕ СЏ РґРѕР±Р°РІРёР»\n\t\t-- https://vk.com/gim143836547?sel=383010676\u0026msgid=90338\n\t\tif CurTime() - self.Busy \u003e 5 then\n\t\t\tIGS.Notify(pl, \"РџСЂРµРґРјРµС‚ РІ РїСЂРѕС†РµСЃСЃРµ РїРµСЂРµРјРµС‰РµРЅРёСЏ РІ РёРЅРІРµРЅС‚Р°СЂСЊ\")\n\t\t\tIGS.Notify(pl, \"Р•СЃР»Рё РїСЂРѕС†РµСЃСЃ Р±РµСЃРєРѕРЅРµС‡РЅС‹Р№, С‚Рѕ РїРѕСЃРєРѕСЂРµРµ СЃРґРµР»Р°Р№С‚Рµ РґРѕРєР°Р·Р°С‚РµР»СЊСЃС‚РІР° Рё СЃРѕРѕР±С‰РёС‚Рµ Р°РґРјРёРЅРёСЃС‚СЂР°С‚РѕСЂСѓ\")\n\t\tend\n\t\treturn\n\tend\n\tself.Busy = CurTime()\n\n\tlocal UID = self:GetUID()\n\tIGS.AddToInventory(pl, UID, function(invDbID)\n\t\tself.Removed = true\n\t\tself:Remove()\n\n\t\tIGS.Notify(pl, \"РџСЂРµРґРјРµС‚ РїРѕРјРµС‰РµРЅ РІ /donate РёРЅРІРµРЅС‚Р°СЂСЊ\")\n\n\t\t-- РІСЃС‚Р°РІР»СЏС‚СЊ РЅРѕРІС‹Р№ ID РЅРµ СЃРѕРІСЃРµРј РєРѕСЂСЂРµРєС‚РЅРѕ\n\t\t-- Р”СѓРјР°СЋ, РЅР°РґРѕ РєРµС€РёСЂРѕРІР°С‚СЊ С‚РѕС‚ РР”, С‡С‚Рѕ Р±С‹Р» РїСЂРё РїРѕРєСѓРїРєРµ\n\t\thook.Run(\"IGS.PlayerPickedGift\", self:Getowning_ent(), UID, invDbID, pl)\n\tend)\nend\n\nfunction IGS.CreateGift(sUid, plOwner, vPos)\n\tassert(sUid, \"Item UID expected\")\n\n\tlocal ent = ents.Create(\"ent_igs\")\n\n\tif vPos then\n\t\tent:SetPos(vPos)\n\tend\n\n\tent:SetUID(sUid)\n\tent:Setowning_ent(plOwner)\n\n\tif vPos then\n\t\tent:Spawn()\n\tend\n\n\treturn ent\nend\n","entities/ent_igs/shared.lua":  "ENT.Type      = \"anim\"\nENT.Base      = \"base_anim\"\nENT.PrintName = \"Р”РѕРЅР°С‚ РёС‚РµРј\"\nENT.Author    = \"gm-donate.ru\"\nENT.Category  = \"IGS\"\n\nENT.RenderGroup = RENDERGROUP_TRANSLUCENT\n\nfunction ENT:SetupDataTables()\n\tself:NetworkVar(\"Entity\", 0, \"owning_ent\")\n\tself:NetworkVar(\"String\", 0, \"UID\")\nend\n","entities/npc_igs/cl_init.lua":  "IGS.sh(\"shared.lua\")\n\n-- #todo СЃРґРµР»Р°С‚СЊ С‚Р°РєРѕРµ Р¶Рµ РґР»СЏ РїРѕРґР°СЂРєР°?\n\nlocal COL_TEXT = Color(255,255,255)\nlocal COL_BG   = Color(0,0,0,150)\nlocal FONT     = \"Fated.40\"\n\nlocal function textPlate(text,y)\n\tsurface.SetFont(FONT)\n\tlocal tw,th = surface.GetTextSize(text)\n\tlocal bx,by = -tw / 2 - 10, y - 5\n\tlocal bw,bh = tw + 10 + 10, th + 10 + 10\n\n\t-- Background\n\tsurface.SetDrawColor(COL_BG)\n\tsurface.DrawRect(bx,by, bw,bh)\n\tsurface.SetDrawColor(COL_TEXT)\n\tsurface.DrawRect(bx, by + bh - 4, bw, 4)\n\n\t-- text\n\tsurface.SetTextColor(COL_TEXT)\n\tsurface.SetTextPos(-tw / 2,y)\n\tsurface.DrawText(text)\nend\n\nlocal function drawInfo(ent, text, dist)\n\tdist = dist or EyePos():DistToSqr(ent:GetPos())\n\n\tif dist \u003c 60000 then\n\t\tsurface.SetAlphaMultiplier( math.Clamp(3 - (dist / 20000), 0, 1) )\n\n\t\tlocal _,max = ent:GetRotatedAABB(ent:OBBMins(), ent:OBBMaxs() )\n\t\tlocal rot = (ent:GetPos() - EyePos()):Angle().yaw - 90\n\t\tlocal sin = math.sin(CurTime() + ent:EntIndex()) / 3 + .5 -- EntIndex РґР°РµС‚ СЂР°Р·РЅРёС†Сѓ РІ РґРІРёР¶РµРЅРёРё\n\t\tlocal center = ent:LocalToWorld(ent:OBBCenter())\n\n\t\tcam.Start3D2D(center + Vector(0, 0, math.abs(max.z / 2) + 12 + sin), Angle(0, rot, 90), 0.13)\n\t\t\ttextPlate(text,15)\n\t\tcam.End3D2D()\n\n\t\tsurface.SetAlphaMultiplier(1)\n\tend\nend\n\n-- https://vk.com/gim143836547?msgid=46147\u0026q=СЂРµРЅРґРµСЂ\u0026sel=88943099\nIGS_NPC_HIDE_ON_DISTANCE = nil -- 100000\nfunction ENT:Draw()\n\tlocal dist = EyePos():DistToSqr(self:GetPos())\n\tif IGS_NPC_HIDE_ON_DISTANCE and dist \u003e IGS_NPC_HIDE_ON_DISTANCE then return end -- РЅРµ РѕС‚СЂРёСЃРѕРІС‹РІР°С‚СЊ\n\n\tself:DrawModel()\n\tdrawInfo(self, \"Р”РѕРЅР°С‚ СѓСЃР»СѓРіРё\", dist)\nend\n","entities/npc_igs/init.lua":  "IGS.sh(\"shared.lua\")\nIGS.cl(\"cl_init.lua\")\n\nfunction ENT:Initialize()\n\tself:SetModel(IGS_NPC_MODEL or \"models/gman_high.mdl\")\n\tself:SetHullType( HULL_HUMAN )\n\tself:SetHullSizeNormal()\n\tself:SetSolid( SOLID_BBOX )\n\tself:CapabilitiesAdd( CAP_ANIMATEDFACE )\n\tself:CapabilitiesAdd( CAP_TURN_HEAD )\n\tself:DropToFloor()\n\tself:SetMoveType( MOVETYPE_NONE )\n\tself:SetCollisionGroup( COLLISION_GROUP_PLAYER )\n\tself:SetUseType( SIMPLE_USE )\n\n\tlocal phys = self:GetPhysicsObject()\n\tif IsValid(phys) then\n\t\tphys:EnableMotion(false)\n\tend\nend\n\nfunction ENT:PlayerUse(pl)\n\tIGS.UI(pl)\nend\n\nfunction ENT:AcceptInput(name, activator, pl, data)\n\tif name == \"Use\" then\n\t\tself:PlayerUse(pl)\n\tend\nend\n","entities/npc_igs/shared.lua":  "ENT.Base      = \"base_ai\"\nENT.Type      = \"ai\"\nENT.PrintName = \"Р”РѕРЅР°С‚ NPC\"\nENT.Author    = \"gm-donate.ru\"\nENT.Category  = \"IGS\"\nENT.Spawnable = true\n\nENT.RenderGroup = RENDERGROUP_TRANSLUCENT\n","igs/apinator.lua":  "if CLIENT then return end\n\nIGS.DB = IGS.DB or {}\nlocal DB = IGS.DB\n\nlocal function cfg()\n\tlocal c = IGS.C.DB or {}\n\tlocal ykd = rawget(_G, \"YKD\") or {}\n\treturn {\n\t\tHOST    = c.HOST or ykd.MYSQL_HOST or \"127.0.0.1\",\n\t\tPORT    = tonumber(c.PORT or ykd.MYSQL_PORT) or 3306,\n\t\tUSER    = c.USER or ykd.MYSQL_USER or \"root\",\n\t\tPASS    = c.PASS or ykd.MYSQL_PASS or \"\",\n\t\tNAME    = c.NAME or ykd.MYSQL_DB   or \"gmod_donate\",\n\t\tCHARSET = c.CHARSET or \"utf8mb4\",\n\t}\nend\n\nlocal function esc(v)\n\tif v == nil then return \"NULL\" end\n\tlocal s = tostring(v)\n\tif DB.conn then\n\t\ts = DB.conn:escape(s)\n\telse\n\t\ts = s:gsub(\"\\\\\", \"\\\\\\\\\"):gsub(\"\u0027\", \"\\\\\u0027\")\n\tend\n\treturn \"\u0027\" .. s .. \"\u0027\"\nend\n\nlocal function num(v, fallback)\n\tif type(v) == \"boolean\" then\n\t\treturn v and \"1\" or \"0\"\n\tend\n\tlocal n = tonumber(v)\n\tif n == nil then n = tonumber(fallback) or 0 end\n\treturn tostring(n)\nend\n\nfunction DB:Query(sql, onSuccess, onError)\n\tif not self.connected or not self.conn then\n\t\tif onError then onError(\"db_not_connected\") end\n\t\treturn\n\tend\n\n\tlocal q = self.conn:query(sql)\n\tfunction q:onSuccess(data)\n\t\tif onSuccess then onSuccess(data, self:lastInsert()) end\n\tend\n\tfunction q:onError(err)\n\t\tif onError then onError(err) end\n\tend\n\tq:start()\nend\n\nfunction DB:EnsureSchema()\n\tlocal queries = {\n\t\t[[\n\t\t\tCREATE TABLE IF NOT EXISTS gmod_users (\n\t\t\t\tsteamid64 VARCHAR(32) PRIMARY KEY,\n\t\t\t\tname VARCHAR(128) NULL,\n\t\t\t\tbalance DECIMAL(12,2) NOT NULL DEFAULT 0,\n\t\t\t\tupdated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP\n\t\t\t) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;\n\t\t]],\n\t\t[[\n\t\t\tCREATE TABLE IF NOT EXISTS gmod_payments (\n\t\t\t\tid BIGINT NOT NULL AUTO_INCREMENT PRIMARY KEY,\n\t\t\t\tpayment_id VARCHAR(64) NOT NULL,\n\t\t\t\tsteamid64 VARCHAR(32) NOT NULL,\n\t\t\t\trub_amount DECIMAL(10,2) NOT NULL,\n\t\t\t\tcoin_amount BIGINT NOT NULL,\n\t\t\t\tstatus VARCHAR(32) NOT NULL,\n\t\t\t\tcreated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n\t\t\t\tupdated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n\t\t\t\tUNIQUE KEY uq_payment_id (payment_id),\n\t\t\t\tKEY idx_steamid64 (steamid64),\n\t\t\t\tKEY idx_status (status)\n\t\t\t) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;\n\t\t]],\n\t\t[[\n\t\t\tCREATE TABLE IF NOT EXISTS igs_transactions (\n\t\t\t\tid BIGINT NOT NULL AUTO_INCREMENT PRIMARY KEY,\n\t\t\t\tsteamid64 VARCHAR(32) NOT NULL,\n\t\t\t\tsum DECIMAL(12,2) NOT NULL,\n\t\t\t\tnote VARCHAR(80) NULL,\n\t\t\t\tserver_id INT NULL,\n\t\t\t\ttime INT UNSIGNED NOT NULL,\n\t\t\t\tKEY idx_steamid64 (steamid64),\n\t\t\t\tKEY idx_time (time)\n\t\t\t) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;\n\t\t]],\n\t\t[[\n\t\t\tCREATE TABLE IF NOT EXISTS igs_purchases (\n\t\t\t\tid BIGINT NOT NULL AUTO_INCREMENT PRIMARY KEY,\n\t\t\t\tsteamid64 VARCHAR(32) NOT NULL,\n\t\t\t\titem_uid VARCHAR(128) NOT NULL,\n\t\t\t\tserver_id INT NULL,\n\t\t\t\tpurchase_ts INT UNSIGNED NOT NULL,\n\t\t\t\texpire_ts INT UNSIGNED NULL,\n\t\t\t\tactive TINYINT(1) NOT NULL DEFAULT 1,\n\t\t\t\tKEY idx_steamid64 (steamid64),\n\t\t\t\tKEY idx_item_uid (item_uid),\n\t\t\t\tKEY idx_active (active)\n\t\t\t) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;\n\t\t]],\n\t\t[[\n\t\t\tCREATE TABLE IF NOT EXISTS igs_inventory (\n\t\t\t\tid BIGINT NOT NULL AUTO_INCREMENT PRIMARY KEY,\n\t\t\t\tsteamid64 VARCHAR(32) NOT NULL,\n\t\t\t\titem_uid VARCHAR(128) NOT NULL,\n\t\t\t\tcreated_ts INT UNSIGNED NOT NULL,\n\t\t\t\tKEY idx_steamid64 (steamid64)\n\t\t\t) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;\n\t\t]],\n\t\t[[\n\t\t\tCREATE TABLE IF NOT EXISTS igs_coupons (\n\t\t\t\tcode VARCHAR(64) PRIMARY KEY,\n\t\t\t\tvalue DECIMAL(12,2) NOT NULL,\n\t\t\t\tnote VARCHAR(50) NULL,\n\t\t\t\texpire_ts INT UNSIGNED NULL,\n\t\t\t\tused_by VARCHAR(32) NULL,\n\t\t\t\tused_ts INT UNSIGNED NULL,\n\t\t\t\tcreated_ts INT UNSIGNED NOT NULL\n\t\t\t) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;\n\t\t]],\n\t\t[[\n\t\t\tCREATE TABLE IF NOT EXISTS igs_servers (\n\t\t\t\tid INT NOT NULL AUTO_INCREMENT PRIMARY KEY,\n\t\t\t\tname VARCHAR(64) NOT NULL,\n\t\t\t\tip VARCHAR(45) NOT NULL,\n\t\t\t\tport INT NOT NULL,\n\t\t\t\tsocket_port INT NULL,\n\t\t\t\tdisabled TINYINT(1) NOT NULL DEFAULT 0,\n\t\t\t\tversion INT NULL,\n\t\t\t\tcreated_ts INT UNSIGNED NOT NULL,\n\t\t\t\tupdated_ts INT UNSIGNED NOT NULL,\n\t\t\t\tKEY idx_ip_port (ip, port)\n\t\t\t) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;\n\t\t]],\n\t}\n\n\tfor _,sql in ipairs(queries) do\n\t\tself:Query(sql, nil, function(err)\n\t\t\tIGS.print(Color(255,0,0), \"IGS DB schema error: \" .. tostring(err))\n\t\tend)\n\tend\n\n\t-- MySQL \u003c 8 does not support IF NOT EXISTS for columns, ignore errors\n\tself:Query(\"ALTER TABLE gmod_users ADD COLUMN name VARCHAR(128) NULL\", nil, function() end)\nend\n\nfunction DB:Connect()\n\tif not mysqloo then\n\t\tIGS.print(Color(255,0,0), \"[IGS] mysqloo module not found. Install MySQLOO.\")\n\t\treturn\n\tend\n\n\tlocal c = cfg()\n\tself.conn = mysqloo.connect(c.HOST, c.USER, c.PASS, c.NAME, c.PORT)\n\n\t-- РќР°СЃС‚СЂРѕР№РєР° SSL РµСЃР»Рё С‚СЂРµР±СѓРµС‚СЃСЏ\n\tif c.USE_SSL then\n\t\t-- РџСЂРѕРІРµСЂСЏРµРј РґРѕСЃС‚СѓРїРЅС‹Рµ РјРµС‚РѕРґС‹ РґР»СЏ SSL\n\t\tif type(self.conn.setSSL) == \"function\" then\n\t\t\t-- mysqloo СЃ РїРѕРґРґРµСЂР¶РєРѕР№ SSL (РЅРѕРІС‹Рµ РІРµСЂСЃРёРё)\n\t\t\tself.conn:setSSL(true)\n\t\telseif type(self.conn.setOption) == \"function\" then\n\t\t\t-- РђР»СЊС‚РµСЂРЅР°С‚РёРІРЅС‹Р№ СЃРїРѕСЃРѕР± С‡РµСЂРµР· РѕРїС†РёРё\n\t\t\tpcall(function() self.conn:setOption(\"SSL_ENABLED\", true) end)\n\t\telseif type(self.conn.enableSSL) == \"function\" then\n\t\t\t-- Р•С‰Рµ РѕРґРёРЅ РІР°СЂРёР°РЅС‚\n\t\t\tself.conn:enableSSL()\n\t\telse\n\t\t\t-- Р•СЃР»Рё SSL РјРµС‚РѕРґС‹ РЅРµРґРѕСЃС‚СѓРїРЅС‹, РїСЂРµРґСѓРїСЂРµР¶РґР°РµРј\n\t\t\tIGS.print(Color(255,165,0), \"[IGS] Р’РќРРњРђРќРР•: USE_SSL РІРєР»СЋС‡РµРЅ, РЅРѕ РІР°С€Р° РІРµСЂСЃРёСЏ mysqloo РЅРµ РїРѕРґРґРµСЂР¶РёРІР°РµС‚ SSL. РћР±РЅРѕРІРёС‚Рµ mysqloo РёР»Рё РѕС‚РєР»СЋС‡РёС‚Рµ require_secure_transport РЅР° MySQL.\")\n\t\tend\n\tend\n\n\tfunction self.conn:onConnected()\n\t\tDB.connected = true\n\t\tIGS.print(\"MySQL connected\" .. (c.USE_SSL and \" (SSL)\" or \"\"))\n\t\tDB:EnsureSchema()\n\t\thook.Run(\"IGS.DBConnected\")\n\tend\n\n\tfunction self.conn:onConnectionFailed(err)\n\t\tDB.connected = false\n\t\tlocal errMsg = tostring(err)\n\t\tif errMsg:find(\"require_secure_transport\") then\n\t\t\tIGS.print(Color(255,0,0), \"MySQL С‚СЂРµР±СѓРµС‚ SSL. РЈСЃС‚Р°РЅРѕРІРёС‚Рµ USE_SSL = true РІ config_sv.lua РёР»Рё РѕС‚РєР»СЋС‡РёС‚Рµ require_secure_transport РЅР° MySQL СЃРµСЂРІРµСЂРµ.\")\n\t\telse\n\t\t\tIGS.print(Color(255,0,0), \"MySQL connection failed: \" .. errMsg)\n\t\tend\n\tend\n\n\tself.conn:connect()\nend\n\nhook.Add(\"Initialize\", \"IGS_DB_Init\", function()\n\tDB:Connect()\nend)\n\nconcommand.Add(\"igs_reload_db\", function(ply)\n\tif IsValid(ply) then return end\n\tDB:Connect()\nend)\n\nlocal function ensureUserRow(s64, name_, cb)\n\tlocal sid = esc(s64)\n\tlocal name = name_ and esc(name_) or \"NULL\"\n\tlocal sql =\n\t\t\"INSERT INTO gmod_users (steamid64, name, balance) VALUES (\" ..\n\t\tsid .. \",\" .. name .. \",0) \" ..\n\t\t\"ON DUPLICATE KEY UPDATE \" ..\n\t\t(name_ and (\"name = \" .. name .. \", \") or \"\") ..\n\t\t\"steamid64 = steamid64;\"\n\n\tDB:Query(sql, cb, function(err)\n\t\thook.Run(\"IGS.OnApiError\", \"db.ensureUserRow\", err, {sid = s64})\n\tend)\nend\n\n--[[\n\u003e----------------------------\u003c\n\tР”Р•Р™РЎРўР’РРЇ РЎ РР“Р РћРљРћРњ\n\u003e----------------------------\u003c\n]]\nfunction IGS.UpdatePlayerName(s64, sName, fCallback)\n\tensureUserRow(s64, sName, function()\n\t\tif fCallback then fCallback(true) end\n\tend)\nend\n\nfunction IGS.GetPlayer(s64, fCallback)\n\tif not DB.connected then\n\t\tif fCallback then fCallback() end\n\t\treturn\n\tend\n\tlocal sql = \"SELECT steamid64, name, balance FROM gmod_users WHERE steamid64 = \" .. esc(s64) .. \" LIMIT 1;\"\n\tDB:Query(sql, function(data)\n\t\tlocal row = data and data[1]\n\t\tif not row then\n\t\t\tensureUserRow(s64, nil, function()\n\t\t\t\tif fCallback then fCallback({Name = nil, Balance = 0}) end\n\t\t\tend)\n\t\t\treturn\n\t\tend\n\t\tlocal bal = tonumber(row.balance) or 0\n\t\tif fCallback then\n\t\t\tfCallback({Name = row.name, Balance = bal})\n\t\tend\n\tend, function(err)\n\t\thook.Run(\"IGS.OnApiError\", \"db.getPlayer\", err, {sid = s64})\n\t\tif fCallback then fCallback() end\n\tend)\nend\n\nfunction IGS.GetBalance(s64, fCallback)\n\tIGS.GetPlayer(s64, function(player)\n\t\tif not player then\n\t\t\tfCallback(nil)\n\t\t\treturn\n\t\tend\n\t\tfCallback(player[\"Balance\"] or 0)\n\tend)\nend\n\nfunction IGS.GetName(s64, fCallback)\n\tIGS.GetPlayer(s64, function(player)\n\t\tfCallback(player and player[\"Name\"] or nil)\n\tend)\nend\n\n--[[\n\u003e----------------------------\u003c\n\tРўР РђРќР—РђРљР¦РР\n\u003e----------------------------\u003c\n]]\nfunction IGS.Transaction(s64, iSum, sNote_, fCallback)\n\tlocal sum = tonumber(iSum) or 0\n\tlocal note = sNote_ and esc(sNote_) or \"NULL\"\n\tlocal server_id = IGS.SERVERS and IGS.SERVERS:ID() or nil\n\tlocal time = os.time()\n\n\tlocal sid = esc(s64)\n\tlocal upd =\n\t\t\"INSERT INTO gmod_users (steamid64, balance) VALUES (\" .. sid .. \",\" .. num(sum) .. \") \" ..\n\t\t\"ON DUPLICATE KEY UPDATE balance = balance + \" .. num(sum) .. \";\"\n\n\tDB:Query(upd, function()\n\t\tlocal sql =\n\t\t\t\"INSERT INTO igs_transactions (steamid64, sum, note, server_id, time) VALUES (\" ..\n\t\t\tsid .. \",\" .. num(sum) .. \",\" .. note .. \",\" .. (server_id and num(server_id) or \"NULL\") .. \",\" .. num(time) .. \");\"\n\n\t\tDB:Query(sql, function(_, last_id)\n\t\t\tif fCallback then fCallback(last_id) end\n\t\t\thook.Run(\"IGS.OnApiSuccess\", \"transactions.create\", {sid = s64})\n\t\tend, function(err)\n\t\t\thook.Run(\"IGS.OnApiError\", \"transactions.create\", err, {sid = s64, sum = sum})\n\t\tend)\n\tend, function(err)\n\t\thook.Run(\"IGS.OnApiError\", \"db.updateBalance\", err, {sid = s64, sum = sum})\n\tend)\nend\n\nfunction IGS.GetTransactions(fCallback, s64_, bGlobal_, iLimit_, iOffset_)\n\tlocal limit  = math.min(tonumber(iLimit_) or 255, 255)\n\tlocal offset = tonumber(iOffset_) or 0\n\tlocal where = {}\n\n\tif s64_ then\n\t\twhere[#where + 1] = \"steamid64 = \" .. esc(s64_)\n\tend\n\tif not bGlobal_ and IGS.SERVERS and IGS.SERVERS:ID() then\n\t\twhere[#where + 1] = \"server_id = \" .. num(IGS.SERVERS:ID())\n\tend\n\n\tlocal where_sql = (#where \u003e 0) and (\" WHERE \" .. table.concat(where, \" AND \")) or \"\"\n\tlocal sql =\n\t\t\"SELECT id, steamid64, sum, note, server_id, time FROM igs_transactions\" ..\n\t\twhere_sql .. \" ORDER BY id DESC LIMIT \" .. num(limit) .. \" OFFSET \" .. num(offset) .. \";\"\n\n\tDB:Query(sql, function(data)\n\t\tlocal res = {}\n\t\tfor i = 1, #(data or {}) do\n\t\t\tlocal v = data[i]\n\t\t\tres[#res + 1] = {\n\t\t\t\tID      = tonumber(v.id),\n\t\t\t\tSum     = tonumber(v.sum),\n\t\t\t\tTime    = tonumber(v.time),\n\t\t\t\tNote    = v.note,\n\t\t\t\tServer  = v.server_id and tonumber(v.server_id) or nil,\n\t\t\t\tSteamID = v.steamid64,\n\t\t\t}\n\t\tend\n\t\tfCallback(res)\n\tend, function(err)\n\t\thook.Run(\"IGS.OnApiError\", \"transactions.get\", err, {sid = s64_})\n\t\tfCallback({})\n\tend)\nend\n\nfunction IGS.GetPlayerTransactions(fCallback, s64)\n\tIGS.GetTransactions(fCallback, s64, true, 255)\nend\n\nfunction IGS.GetLatestTransactions(fCallback, iLimit_)\n\tIGS.GetTransactions(fCallback, nil, true, iLimit_)\nend\n\n--[[\n\u003e----------------------------\u003c\n\tРџРћРљРЈРџРљР\n\u003e----------------------------\u003c\n]]\nfunction IGS.StorePurchase(s64, sItemUID, iDaysTerm_, iServerID, fCallback)\n\tlocal term = tonumber(iDaysTerm_)\n\tlocal expire = term and (os.time() + term * 86400) or nil\n\tlocal sql =\n\t\t\"INSERT INTO igs_purchases (steamid64, item_uid, server_id, purchase_ts, expire_ts, active) VALUES (\" ..\n\t\tesc(s64) .. \",\" .. esc(sItemUID) .. \",\" .. (iServerID and num(iServerID) or \"NULL\") .. \",\" ..\n\t\tnum(os.time()) .. \",\" .. (expire and num(expire) or \"NULL\") .. \",1);\"\n\n\tDB:Query(sql, function(_, last_id)\n\t\tif fCallback then fCallback(last_id) end\n\tend, function(err)\n\t\thook.Run(\"IGS.OnApiError\", \"purchases.create\", err, {sid = s64})\n\tend)\nend\n\nfunction IGS.StoreLocalPurchase(s64, sItemUID, iDaysTerm_, fCallback)\n\tIGS.StorePurchase(s64, sItemUID, iDaysTerm_, IGS.SERVERS:ID(), fCallback)\nend\n\nfunction IGS.MovePurchase(db_id, iNewServer_, fCallback)\n\tlocal set_server = (iNewServer_ == nil) and \"server_id = NULL\" or (\"server_id = \" .. num(iNewServer_))\n\tlocal set_active = (iNewServer_ == 0) and \", active = 0\" or \"\"\n\tlocal sql = \"UPDATE igs_purchases SET \" .. set_server .. set_active .. \" WHERE id = \" .. num(db_id) .. \" LIMIT 1;\"\n\n\tDB:Query(sql, function()\n\t\tif fCallback then fCallback(true) end\n\tend, function(err)\n\t\thook.Run(\"IGS.OnApiError\", \"purchases.move\", err, {id = db_id})\n\t\tif fCallback then fCallback(false) end\n\tend)\nend\n\nfunction IGS.DisablePurchase(db_id, fCallback)\n\tIGS.MovePurchase(db_id, 0, fCallback)\nend\n\nfunction IGS.GetPurchases(fCallback, tParams)\n\ttParams = tParams or {}\n\tlocal where = {}\n\tlocal limit = math.min(tonumber(tParams.limit) or 127, 127)\n\tlocal offset = tonumber(tParams.offset) or 0\n\n\tif tParams.sid then\n\t\twhere[#where + 1] = \"p.steamid64 = \" .. esc(tParams.sid)\n\tend\n\n\tif tParams.s then\n\t\tlocal s = num(tParams.s)\n\t\twhere[#where + 1] = \"(p.server_id = \" .. s .. \" OR p.server_id IS NULL)\"\n\tend\n\n\tif tParams.only_active then\n\t\twhere[#where + 1] = \"p.active = 1\"\n\t\twhere[#where + 1] = \"(p.expire_ts IS NULL OR p.expire_ts \u003e \" .. num(os.time()) .. \")\"\n\tend\n\n\tlocal where_sql = (#where \u003e 0) and (\" WHERE \" .. table.concat(where, \" AND \")) or \"\"\n\tlocal sql =\n\t\t\"SELECT p.id, p.server_id, p.item_uid, p.purchase_ts, p.expire_ts, p.steamid64, u.name \" ..\n\t\t\"FROM igs_purchases p \" ..\n\t\t\"LEFT JOIN gmod_users u ON u.steamid64 = p.steamid64 \" ..\n\t\twhere_sql ..\n\t\t\" ORDER BY p.id DESC LIMIT \" .. num(limit) .. \" OFFSET \" .. num(offset) .. \";\"\n\n\tDB:Query(sql, function(data)\n\t\tlocal res = {}\n\t\tfor i = 1, #(data or {}) do\n\t\t\tlocal v = data[i]\n\t\t\tres[#res + 1] = {\n\t\t\t\tID      = tonumber(v.id),\n\t\t\t\tServer  = v.server_id and tonumber(v.server_id) or nil,\n\t\t\t\tItem    = v.item_uid,\n\t\t\t\tPurchase= tonumber(v.purchase_ts),\n\t\t\t\tExpire  = v.expire_ts and tonumber(v.expire_ts) or nil,\n\t\t\t\tSteamID = v.steamid64,\n\t\t\t\tNick    = v.name,\n\t\t\t}\n\t\tend\n\t\tfCallback(res)\n\tend, function(err)\n\t\thook.Run(\"IGS.OnApiError\", \"purchases.get\", err, tParams)\n\t\tfCallback({})\n\tend)\nend\n\nfunction IGS.GetPlayerPurchases(s64, fCallback)\n\tIGS.GetPurchases(fCallback, {sid = s64, only_active = 1, s = IGS.SERVERS:ID()})\nend\n\nfunction IGS.GetLatestPurchases(fCallback, iLimit_)\n\tIGS.GetPurchases(fCallback, {limit = iLimit_ or 10})\nend\n\n--[[\n\u003e----------------------------\u003c\n\tРЎРЎР«Р›РљР\n\u003e----------------------------\u003c\n]]\nfunction IGS.GetPaymentURL(fCallback, s64, iSum, sDescription_)\n\tlocal ykd = rawget(_G, \"YKD\") or {}\n\tlocal base = IGS.C.PAY_URL or ykd.PAY_URL\n\tif not base or base == \"\" then\n\t\thook.Run(\"IGS.OnApiError\", \"url.getPayment\", \"pay_url_missing\", {})\n\t\treturn\n\tend\n\n\tlocal url = string.format(\"%s?steamid64=%s\u0026amount=%s\", base, s64, tostring(iSum))\n\tfCallback(url)\nend\n\n--[[\n\u003e----------------------------\u003c\n\tРџР РћР•РљРў (Р›РѕРєР°Р»СЊРЅС‹Рµ РЅР°СЃС‚СЂРѕР№РєРё)\n\u003e----------------------------\u003c\n]]\nfunction IGS.GetProjectData(fCallback)\n\tlocal settings = {\n\t\tMinCharge     = tonumber(IGS.C.MIN_CHARGE) or 0,\n\t\tCurrencyPrice = tonumber(IGS.C.CURRENCY_PRICE) or 1,\n\t}\n\tfCallback({\n\t\tsettings = settings,\n\t\tname = IGS.C.PROJECT_NAME or \"Local Project\",\n\t\tcoowners = {},\n\t})\nend\n\nfunction IGS.GetSettings(fCallback)\n\tIGS.GetProjectData(function(proj)\n\t\tfCallback(proj[\"settings\"])\n\tend)\nend\n\n--[[\n\u003e----------------------------\u003c\n\tРЎР•Р Р’Р•Р Р«\n\u003e----------------------------\u003c\n]]\nfunction IGS.AddServer(ip, port, fCallback)\n\tlocal now = os.time()\n\tlocal sql =\n\t\t\"INSERT INTO igs_servers (name, ip, port, socket_port, disabled, version, created_ts, updated_ts) VALUES (\" ..\n\t\tesc(GetConVarString(\"hostname\")) .. \",\" .. esc(ip) .. \",\" .. num(port) .. \",NULL,0,NULL,\" ..\n\t\tnum(now) .. \",\" .. num(now) .. \");\"\n\n\tDB:Query(sql, function(_, last_id)\n\t\tif fCallback then fCallback(last_id) end\n\tend, function(err)\n\t\thook.Run(\"IGS.OnApiError\", \"servers.create\", err, {ip = ip, port = port})\n\tend)\nend\n\nfunction IGS.GetServers(fCallback, bIncludeDisabled_, iID_)\n\tlocal where = {}\n\tif iID_ then\n\t\twhere[#where + 1] = \"id = \" .. num(iID_)\n\tend\n\tif not bIncludeDisabled_ then\n\t\twhere[#where + 1] = \"disabled = 0\"\n\tend\n\tlocal where_sql = (#where \u003e 0) and (\" WHERE \" .. table.concat(where, \" AND \")) or \"\"\n\tlocal sql = \"SELECT id, name, ip, port, socket_port, disabled FROM igs_servers\" .. where_sql .. \";\"\n\n\tDB:Query(sql, function(data)\n\t\tlocal res = {}\n\t\tfor i = 1, #(data or {}) do\n\t\t\tlocal v = data[i]\n\t\t\tres[#res + 1] = {\n\t\t\t\tID = tonumber(v.id),\n\t\t\t\tName = v.name,\n\t\t\t\tIP = v.ip,\n\t\t\t\tPort = tonumber(v.port),\n\t\t\t\tSocketPort = v.socket_port and tonumber(v.socket_port) or nil,\n\t\t\t\tDisabled = tonumber(v.disabled) == 1,\n\t\t\t}\n\t\tend\n\t\tfCallback(res)\n\tend, function(err)\n\t\thook.Run(\"IGS.OnApiError\", \"servers.get\", err, {})\n\t\tfCallback({})\n\tend)\nend\n\nfunction IGS.GetExternalIP(fCallback)\n\thttp.Fetch(\"https://api.ipify.org\", function(body)\n\t\tfCallback(tostring(body))\n\tend, function()\n\t\tfCallback(nil)\n\tend)\nend\n\nfunction IGS.UpdateServer(iServerID, tParams, fCallback)\n\tif not tParams then\n\t\tif fCallback then fCallback(false) end\n\t\treturn\n\tend\n\n\tlocal sets = {}\n\tif tParams.name then sets[#sets + 1] = \"name = \" .. esc(tParams.name) end\n\tif tParams.version then sets[#sets + 1] = \"version = \" .. num(tParams.version) end\n\tif tParams.state then sets[#sets + 1] = \"disabled = \" .. num(tParams.state ~= 0) end\n\tif tParams.ip then sets[#sets + 1] = \"ip = \" .. esc(tParams.ip) end\n\tif tParams.hostport then sets[#sets + 1] = \"port = \" .. num(tParams.hostport) end\n\tif tParams.s then iServerID = tParams.s end\n\tif tParams.port then sets[#sets + 1] = \"socket_port = \" .. num(tParams.port) end\n\n\tsets[#sets + 1] = \"updated_ts = \" .. num(os.time())\n\n\tlocal sql = \"UPDATE igs_servers SET \" .. table.concat(sets, \", \") .. \" WHERE id = \" .. num(iServerID) .. \" LIMIT 1;\"\n\tDB:Query(sql, function()\n\t\tif fCallback then fCallback(true) end\n\tend, function(err)\n\t\thook.Run(\"IGS.OnApiError\", \"servers.update\", err, {s = iServerID})\n\t\tif fCallback then fCallback(false) end\n\tend)\nend\n\nfunction IGS.UpdateCurrentServer(tParams, fCallback)\n\tIGS.UpdateServer(IGS.SERVERS:ID(), tParams, fCallback)\nend\n\nfunction IGS.SetServerName(sName, fCallback)\n\tIGS.UpdateCurrentServer({name = sName}, fCallback)\nend\n\nfunction IGS.SetServerSocketPort(iPort, fCallback)\n\tIGS.UpdateCurrentServer({port = iPort}, fCallback)\nend\n\nfunction IGS.SetServerVersion(iVersion, fCallback)\n\tIGS.UpdateCurrentServer({version = iVersion}, fCallback)\nend\n\nfunction IGS.UpdateServerAddress(iServerID, ip, port, fCallback)\n\tIGS.UpdateServer(iServerID, {ip = ip, hostport = port}, fCallback)\nend\n\n--[[\n\u003e----------------------------\u003c\n\tРРќР’Р•РќРўРђР Р¬\n\u003e----------------------------\u003c\n]]\nfunction IGS.StoreInventoryItem(fCallback, s64, sUid)\n\tlocal sql =\n\t\t\"INSERT INTO igs_inventory (steamid64, item_uid, created_ts) VALUES (\" ..\n\t\tesc(s64) .. \",\" .. esc(sUid) .. \",\" .. num(os.time()) .. \");\"\n\n\tDB:Query(sql, function(_, last_id)\n\t\tif fCallback then fCallback(last_id) end\n\tend, function(err)\n\t\thook.Run(\"IGS.OnApiError\", \"inventory.addItem\", err, {sid = s64})\n\tend)\nend\n\nfunction IGS.FetchInventory(fCallback, s64)\n\tlocal sql = \"SELECT id, item_uid FROM igs_inventory WHERE steamid64 = \" .. esc(s64) .. \" ORDER BY id ASC;\"\n\tDB:Query(sql, function(data)\n\t\tlocal res = {}\n\t\tfor i = 1, #(data or {}) do\n\t\t\tlocal v = data[i]\n\t\t\tres[#res + 1] = {ID = tonumber(v.id), Item = v.item_uid}\n\t\tend\n\t\tfCallback(res)\n\tend, function(err)\n\t\thook.Run(\"IGS.OnApiError\", \"inventory.get\", err, {sid = s64})\n\t\tfCallback({})\n\tend)\nend\n\nfunction IGS.DeleteInventoryItem(fCallback, iID)\n\tlocal sql = \"DELETE FROM igs_inventory WHERE id = \" .. num(iID) .. \" LIMIT 1;\"\n\tDB:Query(sql, function(_, _)\n\t\tif fCallback then fCallback(true) end\n\tend, function(err)\n\t\thook.Run(\"IGS.OnApiError\", \"inventory.deleteItem\", err, {id = iID})\n\t\tif fCallback then fCallback(false) end\n\tend)\nend\n\n--[[\n\u003e----------------------------\u003c\n\tРљРЈРџРћРќР«\n\u003e----------------------------\u003c\n]]\nlocal function generateCouponCode()\n\treturn hash.SHA256(tostring(os.time()) .. \":\" .. tostring(math.random()) .. \":\" .. tostring(SysTime()))\nend\n\nfunction IGS.CreateCoupon(iGiveMoney, iDaysTerm_, sNote_, fCallback)\n\tlocal code = generateCouponCode()\n\tlocal expire = iDaysTerm_ and (os.time() + tonumber(iDaysTerm_) * 86400) or nil\n\tlocal sql =\n\t\t\"INSERT INTO igs_coupons (code, value, note, expire_ts, used_by, used_ts, created_ts) VALUES (\" ..\n\t\tesc(code) .. \",\" .. num(iGiveMoney) .. \",\" .. (sNote_ and esc(sNote_) or \"NULL\") .. \",\" ..\n\t\t(expire and num(expire) or \"NULL\") .. \",NULL,NULL,\" .. num(os.time()) .. \");\"\n\n\tDB:Query(sql, function()\n\t\tif fCallback then fCallback(code) end\n\tend, function(err)\n\t\thook.Run(\"IGS.OnApiError\", \"coupons.create\", err, {})\n\tend)\nend\n\nfunction IGS.GetCoupon(sCouponCode, fCallback)\n\tlocal sql = \"SELECT code, value, expire_ts, used_by FROM igs_coupons WHERE code = \" .. esc(sCouponCode) .. \" LIMIT 1;\"\n\tDB:Query(sql, function(data)\n\t\tlocal row = data and data[1]\n\t\tif not row then fCallback() return end\n\t\tfCallback({\n\t\t\tValue = tonumber(row.value),\n\t\t\tDateExpire = row.expire_ts and tonumber(row.expire_ts) or nil,\n\t\t\tUsedBy = row.used_by,\n\t\t})\n\tend, function(err)\n\t\thook.Run(\"IGS.OnApiError\", \"coupons.get\", err, {coupon = sCouponCode})\n\t\tfCallback()\n\tend)\nend\n\nfunction IGS.DeactivateCoupon(sActivatorSteamID, sCouponCode, fCallback)\n\tlocal now = os.time()\n\tlocal sql =\n\t\t\"UPDATE igs_coupons SET used_by = \" .. esc(sActivatorSteamID) .. \", used_ts = \" .. num(now) ..\n\t\t\" WHERE code = \" .. esc(sCouponCode) .. \" AND used_by IS NULL LIMIT 1;\"\n\n\tDB:Query(sql, function()\n\t\tif fCallback then fCallback(true) end\n\tend, function(err)\n\t\thook.Run(\"IGS.OnApiError\", \"coupons.deactivate\", err, {coupon = sCouponCode})\n\t\tif fCallback then fCallback(false) end\n\tend)\nend\n\n--[[\n\u003e----------------------------\u003c\n\tMETA\n\u003e----------------------------\u003c\n]]\nkvapi = kvapi or {}\n\nfunction kvapi.set(key, value, ttl, cb)\n\thttp.Post(\"https://kv.gmod.app/set\", {\n\t\tkey = key,\n\t\tvalue = tostring(value),\n\t\tttl = tostring(ttl),\n\t}, cb, error)\nend\n\nfunction kvapi.get(key, cb)\n\thttp.Post(\"https://kv.gmod.app/get\", {\n\t\tkey = key,\n\t}, function(value, _, headers)\n\t\tcb(value ~= \"\" and value or nil, tonumber(headers.Expires))\n\tend, error)\nend\n\nfunction IGS.SetSharedKV(key, value, ttl, cb)\n\tkvapi.set((IGS.C.PROJECT_NAME or \"local\") .. \":\" .. key:URLEncode(), value, ttl, cb)\nend\n\nfunction IGS.GetSharedKV(key, cb)\n\tkvapi.get((IGS.C.PROJECT_NAME or \"local\") .. \":\" .. key:URLEncode(), cb)\nend\n","igs/cl_preload_icons.lua":  "--[[\n    РљР»РёРµРЅС‚СЃРєР°СЏ РїСЂРµРґР·Р°РіСЂСѓР·РєР° РёРєРѕРЅРѕРє С‚РѕРІР°СЂРѕРІ\n    Р—Р°РіСЂСѓР¶Р°РµС‚ РІСЃРµ РёРєРѕРЅРєРё РІ С„РѕРЅРµ РїСЂРё РїРѕРґРєР»СЋС‡РµРЅРёРё Рє СЃРµСЂРІРµСЂСѓ\n]]\n\nif SERVER then return end\n\nlocal preloadQueue = {}\nlocal isPreloading = false\nlocal preloadedCount = 0\nlocal totalToPreload = 0\nlocal preloadAttempts = {}\n\n-- Р¤СѓРЅРєС†РёСЏ РґР»СЏ РїСЂРµРґР·Р°РіСЂСѓР·РєРё РѕРґРЅРѕР№ РёРєРѕРЅРєРё\nlocal function PreloadIcon(url, callback, attempt)\n    if not url or not url:match(\"^https?://\") then \n        if callback then callback(false) end\n        return \n    end\n    \n    -- РџСЂРѕРІРµСЂСЏРµРј, РЅРµ Р·Р°РіСЂСѓР¶РµРЅР° Р»Рё СѓР¶Рµ\n    if texture.Get(url) then\n        if callback then callback(true) end\n        return\n    end\n    \n    -- РЎРѕР·РґР°РµРј Рё Р·Р°РіСЂСѓР¶Р°РµРј С‚РµРєСЃС‚СѓСЂСѓ\n    attempt = attempt or 1\n    texture.Create(url)\n        :SetSize(256, 256) -- РћРїС‚РёРјР°Р»СЊРЅС‹Р№ СЂР°Р·РјРµСЂ РґР»СЏ РєР°С‡РµСЃС‚РІР°/РїСЂРѕРёР·РІРѕРґРёС‚РµР»СЊРЅРѕСЃС‚Рё\n        :SetFormat(url:sub(-3) == \"jpg\" and \"jpg\" or \"png\")\n        :Download(url, function()\n            preloadedCount = preloadedCount + 1\n            if callback then callback(true) end\n        end, function()\n            if attempt \u003c 3 then\n                timer.Simple(1, function()\n                    PreloadIcon(url, callback, attempt + 1)\n                end)\n                return\n            end\n\n            preloadedCount = preloadedCount + 1\n            if callback then callback(false) end\n        end)\nend\n\n-- РћР±СЂР°Р±РѕС‚РєР° РѕС‡РµСЂРµРґРё Р·Р°РіСЂСѓР·РєРё (РїР°СЂР°Р»Р»РµР»СЊРЅР°СЏ Р·Р°РіСЂСѓР·РєР°)\nlocal function ProcessPreloadQueue()\n    if #preloadQueue == 0 then\n        isPreloading = false\n        print(\"[IGS] Р’СЃРµ РёРєРѕРЅРєРё РїСЂРµРґР·Р°РіСЂСѓР¶РµРЅС‹: \" .. preloadedCount .. \"/\" .. totalToPreload)\n        return\n    end\n    \n    isPreloading = true\n    \n    -- Р—Р°РіСЂСѓР¶Р°РµРј РјРµРЅСЊС€Рµ РїР°СЂР°Р»Р»РµР»СЊРЅРѕ, С‡С‚РѕР±С‹ РЅРµ Р»РѕРІРёС‚СЊ С‚Р°Р№РјР°СѓС‚С‹\n    local batchSize = math.min(3, #preloadQueue)\n    for i = 1, batchSize do\n        local url = table.remove(preloadQueue, 1)\n        if url then\n            PreloadIcon(url, function(success)\n                -- РџСЂРѕРґРѕР»Р¶Р°РµРј Р·Р°РіСЂСѓР·РєСѓ РєРѕРіРґР° batch Р·Р°РІРµСЂС€РµРЅ\n                if preloadedCount \u003e= totalToPreload or #preloadQueue == 0 then\n                    ProcessPreloadQueue()\n                end\n            end)\n        end\n    end\n    \n    -- РџСЂРѕРґРѕР»Р¶Р°РµРј Р·Р°РіСЂСѓР·РєСѓ СЃР»РµРґСѓСЋС‰РµРіРѕ batch СЃ РЅРµР±РѕР»СЊС€РѕР№ РїР°СѓР·РѕР№\n    if #preloadQueue \u003e 0 then\n        timer.Simple(0.2, ProcessPreloadQueue)\n    end\nend\n\n-- Р—Р°РїСѓСЃРє РїСЂРµРґР·Р°РіСЂСѓР·РєРё РІСЃРµС… РёРєРѕРЅРѕРє С‚РѕРІР°СЂРѕРІ\nlocal function StartPreloading()\n    if isPreloading then return end\n    \n    preloadQueue = {}\n    preloadedCount = 0\n    totalToPreload = 0\n    \n    -- РЎРѕР±РёСЂР°РµРј РІСЃРµ СѓРЅРёРєР°Р»СЊРЅС‹Рµ URL РёРєРѕРЅРѕРє\n    local urls = {}\n    for uid, ITEM in pairs(IGS.ITEMS.STORED or {}) do\n        local icon = ITEM:ICON()\n        if icon and icon:match(\"^https?://\") and not urls[icon] then\n            urls[icon] = true\n            table.insert(preloadQueue, icon)\n            totalToPreload = totalToPreload + 1\n        end\n    end\n    \n    if totalToPreload \u003e 0 then\n        print(\"[IGS] РќР°С‡РёРЅР°РµС‚СЃСЏ РїСЂРµРґР·Р°РіСЂСѓР·РєР° \" .. totalToPreload .. \" РёРєРѕРЅРѕРє...\")\n        ProcessPreloadQueue()\n    end\nend\n\n-- РђРІС‚РѕРјР°С‚РёС‡РµСЃРєР°СЏ РїСЂРµРґР·Р°РіСЂСѓР·РєР° РїСЂРё РёРЅРёС†РёР°Р»РёР·Р°С†РёРё IGS\nhook.Add(\"IGS.Loaded\", \"PreloadItemIcons\", function()\n    timer.Simple(0.5, StartPreloading) -- Р—Р°РґРµСЂР¶РєР° 0.5 СЃРµРєСѓРЅРґС‹ РїРѕСЃР»Рµ Р·Р°РіСЂСѓР·РєРё IGS\nend)\n\n-- Р­РєСЃРїРѕСЂС‚РёСЂСѓРµРј С„СѓРЅРєС†РёСЋ РґР»СЏ РІС‹Р·РѕРІР° РёР· РґСЂСѓРіРёС… РјРѕРґСѓР»РµР№\nIGS.PreloadIcons = StartPreloading\n\n-- РљРѕРјР°РЅРґР° РґР»СЏ СЂСѓС‡РЅРѕР№ РїРµСЂРµР·Р°РіСЂСѓР·РєРё РёРєРѕРЅРѕРє\nconcommand.Add(\"igs_reload_icons\", function()\n    print(\"[IGS] РџСЂРёРЅСѓРґРёС‚РµР»СЊРЅР°СЏ РїРµСЂРµР·Р°РіСЂСѓР·РєР° РёРєРѕРЅРѕРє...\")\n    StartPreloading()\nend)\n\n-- РћС‡РёСЃС‚РєР° РєСЌС€Р° РёРєРѕРЅРѕРє\nconcommand.Add(\"igs_clear_icon_cache\", function()\n    local files = file.Find(\"texture/*.png\", \"DATA\")\n    local count = 0\n    for _, f in ipairs(files) do\n        file.Delete(\"texture/\" .. f)\n        count = count + 1\n    end\n    print(\"[IGS] РћС‡РёС‰РµРЅРѕ \" .. count .. \" РєСЌС€РёСЂРѕРІР°РЅРЅС‹С… РёРєРѕРЅРѕРє\")\n    print(\"[IGS] РСЃРїРѕР»СЊР·СѓР№С‚Рµ \u0027igs_reload_icons\u0027 РґР»СЏ РїРѕРІС‚РѕСЂРЅРѕР№ Р·Р°РіСЂСѓР·РєРё\")\nend)\n","igs/core_sv.lua":  "-- РњРѕР¶РЅРѕ Рё Р·Р°Р±РёСЂР°С‚СЊ, СѓРєР°Р·Р°РІ РјРёРЅСѓСЃРѕРІРѕРµ С‡РёСЃР»Рѕ\nlocal PLAYER = FindMetaTable(\"Player\")\nfunction PLAYER:AddIGSFunds(amount, note, callback)\n\tIGS.Transaction(self:SteamID64(),amount,note,function()\n\t\tlocal newbal = self:IGSFunds() + amount\n\t\tself:SetIGSVar(\"igs_balance\", newbal)\n\n\t\tif amount \u003e 0 then\n\t\t\tlocal tt = IGS.TotalTransaction(self) + amount\n\t\t\tself:SetIGSVar(\"igs_total_transactions\", tt)\n\n\t\t\tself:SetIGSVar(\"igs_lvl\", IGS.LVL.GetByCost( IGS.RealPrice(tt) ):LVL())\n\t\tend\n\n\t\tif callback then\n\t\t\tcallback(newbal)\n\t\tend\n\tend)\nend\n\n\n--[[-------------------------------------------------------------------------\n\tРџРѕРєСѓРїРєРё\n---------------------------------------------------------------------------]]\nfunction IGS.LoadPlayerPurchases(pl,cb)\n\t-- РЎРїРёСЃРѕРє РїРѕРєСѓРїРѕРє\n\tIGS.GetPlayerPurchases(pl:SteamID64(),function(dat)\n\t\tif #dat == 0 then\n\t\t\thook.Run(\"IGS.PlayerPurchasesLoaded\",pl)\n\t\t\tpl:SetIGSVar(\"igs_purchases\", {}) -- РґР»СЏ С…СѓРєР°. РќРёР¶Рµ РѕРїРёСЃР°РЅРѕ\n\t\t\treturn\n\t\tend\n\n\t\tlocal purchases = {} -- uid = amount\n\t\tlocal networked = {} -- iter = uid\n\n\t\tfor i = 1,#dat do\n\t\t\tlocal uid  = dat[i][\"Item\"]\n\t\t\tlocal ITEM = IGS.GetItemByUID(uid) -- TO DO РїСЂРѕРІРµСЂРєР° РЅР° СЃСѓС‰РµСЃС‚РІРѕРІР°РЅРёРµ РёС‚РµРјР°. РР»Рё РЅРµ РЅСѓР¶РЅРѕ? Р’СЂРµРјСЏ РїРѕРєР°Р¶РµС‚\n\n\t\t\tpurchases[uid] = purchases[uid] and (purchases[uid] + 1) or 1\n\n\t\t\tif ITEM:IsNetworked() then\n\t\t\t\tnetworked[#networked + 1] = ITEM:ID()\n\t\t\tend\n\t\tend\n\n\t\t-- UID - Amount Of Purchases\n\t\tpl:SetVar(\"igs_purchases\",purchases)\n\n\t\t-- print(\"IGS.GetPlayerPurchases processed\",pl)\n\t\tIGS.nw.WaitForPlayer(pl, function()\n\t\t\t-- print(\"IGS.nw.WaitForPlayer INSIDE\",pl)\n\t\t\t-- if (#networked \u003e 0) then -- Р·Р°РєРѕРјРјРµРЅС‡РµРЅРѕ, С‡С‚РѕР±С‹ СЃСЂР°Р±Р°С‚С‹РІР°Р» РєР»РёРµРЅС‚СЃРєРёР№ С…СѓРє РІ Р»СЋР±РѕРј СЃР»СѓС‡Р°Рµ\n\t\t\t\tpl:SetIGSVar(\"igs_purchases\", networked) -- РјРёРЅСѓСЃ РІ С‚РѕРј, С‡С‚Рѕ С‚РµРїРµСЂСЊ РґР»СЏ Р’РЎР•РҐ РёРіСЂРѕРєРѕРІ Р±СѓРґРµС‚ СЃРµС‚РёС‚СЃСЏ\n\t\t\t-- end -- Р° СЃРґРµР»Р°РЅРѕ СЌС‚Рѕ РґР»СЏ С‚СѓР» С…Р°Р№РґРµСЂР°\n\t\tend)\n\n\t\thook.Run(\"IGS.PlayerPurchasesLoaded\",pl,purchases)\n\t\tif cb then cb(purchases) end\n\tend)\nend\n\n-- Р’С‹РґР°РµС‚ РїРѕРєСѓРїРєСѓ. Р‘РµР· СЃРѕС…СЂР°РЅРµРЅРёСЏ\nfunction IGS.GivePurchase(pl, sItemUID)\n\tlocal ITEM = IGS.GetItemByUID(sItemUID)\n\n\tlocal purchases = pl:GetVar(\"igs_purchases\",{})\n\tpurchases[sItemUID] = (purchases[sItemUID] or 0) + 1\n\n\tpl:SetVar(\"igs_purchases\",purchases)\n\n\tif ITEM:IsNetworked() then\n\t\tlocal tab = pl:GetIGSVar(\"igs_purchases\") or {}\n\t\ttab[#tab + 1] = ITEM:ID()\n\t\tpl:SetIGSVar(\"igs_purchases\", tab)\n\tend\n\n\tITEM:OnActivate(pl)\n\treturn ITEM\nend\n\n-- РџСЂРё РїРµСЂРІРѕР№ Р°РєС‚РёРІР°С†РёРё РїСЂРµРґРјРµС‚Р°\n-- Р’С‹РґР°РµС‚ Рё СЃРѕС…СЂР°РЅСЏРµС‚ РїРѕРєСѓРїРєСѓ.\n-- Р’ РєР°Р»Р»Р±СЌРєРµ ID РїСЂРµРґРјРµС‚Р° СЃ Р‘Р”\nfunction IGS.PlayerActivateItem(pl, sItemUID, fCallback)\n\tlocal ITEM = IGS.GetItemByUID(sItemUID)\n\n\tIGS.StoreLocalPurchase(pl:SteamID64(),ITEM:UID(),ITEM:Term(),function(iPurchID)\n\t\tIGS.GivePurchase(pl,sItemUID)\n\t\thook.Run(\"IGS.PlayerActivatedItem\", pl, ITEM, iPurchID)\n\t\tif fCallback then fCallback(iPurchID) end\n\tend)\nend\nIGS.PlayerActivatedItem = IGS.PlayerActivateItem -- #todo РѕР±СЂР°С‚РєР° 2020.07.16\n\n-- РџРѕСЃР»Рµ :CanBuy() РїСЂРѕРІРµСЂРѕРє Рё СЃРїРёСЃР°РЅРёСЏ СЃСЂРµРґСЃС‚РІ\nfunction IGS.PlayerPurchasedItem(pl, ITEM, cb)\n\tlocal afterBuy = function(invDbID_or_iPurchID)\n\t\tlocal id = invDbID_or_iPurchID\n\t\tITEM:Buy(pl) -- РІРЅСѓС‚СЂРё С…СѓРє\n\t\thook.Run(\"IGS.PlayerPurchasedItem\", pl, ITEM, id)\n\t\tcb(id)\n\tend\n\n\tif IGS.C.Inv_Enabled then\n\t\tIGS.AddToInventory(pl, ITEM:UID(), afterBuy)\n\telse\n\t\tIGS.PlayerActivateItem(pl, ITEM:UID(), afterBuy)\n\tend\nend\n\n\n--[[-------------------------------------------------------------------------\n\tРљРЈРџРћРќР«\n---------------------------------------------------------------------------]]\nlocal trans = {\n\t[\"COUP_DOESNT_EXIST\"] = \"РљСѓРїРѕРЅ РЅРµ СЃСѓС‰РµСЃС‚РІСѓРµС‚!\",\n\t[\"COUP_EXPIRED\"]      = \"РЎСЂРѕРє РґРµР№СЃС‚РІРёСЏ РєСѓРїРѕРЅР° РёСЃС‚РµРє!\",\n\t[\"COUP_ACTIVATED\"]    = \"РљСѓРїРѕРЅ СѓР¶Рµ Р°РєС‚РёРІРёСЂРѕРІР°РЅ!\",\n}\n\n-- https://trello.com/c/6Oc1DykD/312\n-- РќР° Р±РѕР»СЊС€РёС… СЃРµСЂРІРµСЂР°С… РїСЂРё СЂР°Р·РґР°С‡Рµ РєСѓРїРѕРЅРѕРІ Р±СѓРґРµС‚ СЃР»РёС€РєРѕРј РјРЅРѕРіРѕ Р·Р°РїСЂРѕСЃРѕРІ Рє GMD,\n-- С‡С‚Рѕ РїСЂРёРІРµРґРµС‚ Рє Р±Р»РѕРєСѓ API\nlocal coupons_errors = setmetatable({proxy = {}},{\n\t__newindex = function(self, sCoupon, sErrorCode)\n\t\tself.proxy[sCoupon] = sErrorCode\n\n\t\ttimer.Create(\"IGS.CouponsCacheCleanup\",60,1,function()\n\t\t\ttable.Empty(self.proxy)\n\t\tend)\n\tend,\n\t__index = function(self, sCoupon)\n\t\tlocal err_code = self.proxy[sCoupon]\n\t\tif err_code then\n\t\t\treturn trans[err_code]\n\t\tend\n\tend\n})\n\nfunction IGS.PlayerActivateCoupon(pl, sCoupon, cb)\n\tcb = cb or function() end\n\n\tif coupons_errors[sCoupon] then\n\t\tcb(false, coupons_errors[sCoupon])\n\t\treturn\n\tend\n\n\tIGS.GetCoupon(sCoupon,function(c,expired,used)\n\t\tlocal err_code =\n\t\t\tnot c   and \"COUP_DOESNT_EXIST\" or\n\t\t\texpired and \"COUP_EXPIRED\" or\n\t\t\tused    and \"COUP_ACTIVATED\"\n\n\t\tif err_code then\n\t\t\tcoupons_errors[sCoupon] = err_code\n\t\t\tcb(false, coupons_errors[sCoupon])\n\t\t\treturn\n\t\tend\n\n\t\tIGS.DeactivateCoupon(pl:SteamID64(),sCoupon,function(affected)\n\t\t\tcoupons_errors[sCoupon] = \"COUP_ACTIVATED\"\n\n\t\t\tif not affected then\n\t\t\t\tcb(false, \"РљСѓРїРѕРЅ СѓР¶Рµ Р°РєС‚РёРІРёСЂРѕРІР°РЅ. РљСЃС‚Р°С‚Рё, СЌС‚Рѕ РѕС‡РµРЅСЊ(!) СЂРµРґРєР°СЏ РѕС€РёР±РєР°. РЎРѕРѕР±С‰РёС‚Рµ Р°РґРјРёРЅРёСЃС‚СЂР°С†РёРё, С‚СѓС‚ РґРѕР»Р¶РЅР° Р±С‹Р»Р° РІС‹Р»РµР·С‚Рё РґСЂСѓРіР°СЏ\")\n\t\t\t\treturn -- /\\ РѕРґРЅР°Р¶РґС‹ СЌС‚Р° РѕС€РёР±РєР° РІС‹Р»РµР·Р»Р°, РєРѕРіРґР° СЏ РІ С†РёРєР»Рµ СЃ РєР»РёРµРЅС‚Р° РїС‹С‚Р°Р»СЃСЏ Р°РєС‚РёРІРёСЂРѕРІР°С‚СЊ РєСѓРїРѕРЅ (https://img.qweqwe.ovh/1487848973964.png)\n\t\t\tend -- РІ Р±Рґ РЅРµ РёР·РјРµРЅРµРЅ РЅРё РѕРґРёРЅ РєСѓРїРѕРЅ\n\n\t\t\tIGS.UpdatePlayerName(pl:SteamID64(),pl:Nick())\n\t\t\tpl:AddIGSFunds(c.Value,\"C: \" .. sCoupon,function()\n\t\t\t\tcb(true)\n\t\t\tend)\n\t\tend)\n\tend)\nend\n\n\n--[[-------------------------------------------------------------------------\n\tРРќР’Р•РќРўРђР Р¬\n---------------------------------------------------------------------------]]\nlocal function CreateInvStructure(pl)\n\tpl.igs_inv = {\n\t\tMAP  = {}, -- db_id, data\n\t\tLIST = {}  -- iter,  data\n\t}\nend\n\nlocal function insertInvData(pl,iId,sItem)\n\tlocal d = {\n\t\tID     = iId,\n\t\tItem   = sItem,\n\t}\n\n\tpl.igs_inv.MAP[iId] = d\n\td.listid = table.insert(pl.igs_inv.LIST,d)\nend\n\nfunction IGS.Inventory(pl,bMap)\n\treturn pl.igs_inv and pl.igs_inv[bMap and \"MAP\" or \"LIST\"]\nend\n\nlocal f = function() end\n\nfunction IGS.AddToInventory(pl,sUid,fOnFinish_)\n\tIGS.StoreInventoryItem(function(inserted_id)\n\t\tif not IGS.Inventory(pl) then\n\t\t\tCreateInvStructure(pl)\n\t\tend\n\n\t\tinsertInvData(pl,inserted_id,sUid)\n\n\t\tif fOnFinish_ then\n\t\t\tfOnFinish_(inserted_id)\n\t\tend\n\tend, pl:SteamID64(),sUid)\nend\n-- IGS.AddToInventory(AMD(),\"money_5mi\",PRINT)\n\n-- https://img.qweqwe.ovh/1527524052957.png\nfunction IGS.LoadInventory(pl,cb)\n\tIGS.FetchInventory(function(d)\n\t\tcb = cb or f\n\t\tif #d == 0 then cb() return end\n\n\t\tCreateInvStructure(pl)\n\n\t\tfor _,v in ipairs(d) do\n\t\t\tlocal ITEM = IGS.GetItemByUID(v.Item)\n\t\t\t\n\t\t\t-- РђРІС‚РѕРјР°С‚РёС‡РµСЃРєРё СѓРґР°Р»СЏРµРј null РїСЂРµРґРјРµС‚С‹ (СѓРґР°Р»РµРЅРЅС‹Рµ РёР· РєРѕРЅС„РёРіР°)\n\t\t\tif ITEM.isnull then\n\t\t\t\tprint(\"[IGS] РЈРґР°Р»РµРЅРёРµ null РїСЂРµРґРјРµС‚Р° РёР· РёРЅРІРµРЅС‚Р°СЂСЏ РёРіСЂРѕРєР° \" .. pl:Nick() .. \": \" .. v.Item .. \" (ID: \" .. v.ID .. \")\")\n\t\t\t\tIGS.DeleteInventoryItem(function(ok)\n\t\t\t\t\tif ok then\n\t\t\t\t\t\tprint(\"[IGS] Null РїСЂРµРґРјРµС‚ СѓСЃРїРµС€РЅРѕ СѓРґР°Р»РµРЅ РёР· Р‘Р”\")\n\t\t\t\t\tend\n\t\t\t\tend, v.ID)\n\t\t\telse\n\t\t\t\t-- Р”РѕР±Р°РІР»СЏРµРј С‚РѕР»СЊРєРѕ РІР°Р»РёРґРЅС‹Рµ РїСЂРµРґРјРµС‚С‹\n\t\t\t\tinsertInvData(pl,v.ID,v.Item)\n\t\t\tend\n\t\tend\n\n\t\tcb(pl.igs_inv)\n\tend, pl:SteamID64())\nend\n-- IGS.LoadInventory(AMD(),prt)\n\nlocal function GetPlayerInventoryItemLocally(pl, invDbID)\n\tlocal inv_map  = IGS.Inventory(pl,\"map\")\n\tlocal inv_list = IGS.Inventory(pl)\n\n\tif (not inv_map) then return false end -- Сѓ С‡РµР»Р° РЅРµС‚ РґРѕРЅР°С‚ СѓСЃР»СѓРі. РќР°РІРµСЂРЅ Р±Р°Р№РїР°СЃ, РµСЃР»Рё Р·Р°РїСЂРѕСЃ СЃ РєР»РёРµРЅС‚Р°\n\n\tlocal t = inv_map[invDbID]\n\tif (not t) then return false end -- РїРѕРґСЃСѓРЅСѓС‚ Р»РµРІС‹Р№ РР”, РєРѕС‚РѕСЂС‹Р№ СѓР¶Рµ СѓРґР°Р»РµРЅ РёР»Рё РЅРµ СЃСѓС‰РµСЃС‚РІРѕРІР°Р»\n\n\tfunction t:Delete()\n\t\tassert(inv_map[invDbID],\"РС‚РµРј #\" .. invDbID .. \" РЅРµ СЃСѓС‰РµСЃС‚РІСѓРµС‚ (СѓР¶Рµ СѓРґР°Р»РµРЅ?)\")\n\n\t\tinv_map[invDbID] = nil\n\t\ttable.remove(inv_list, t.listid)\n\n\t\tfor i = t.listid,#inv_list do\n\t\t\tinv_list[i].listid = i\n\t\tend\n\tend\n\n\treturn t\nend\n\nfunction IGS.DeletePlayerInventoryItemLocally(pl, invDbID)\n\tlocal t = GetPlayerInventoryItemLocally(pl, invDbID)\n\tif (not t) then return false end\n\n\tt:Delete()\n\n\treturn t\nend\n\nfunction IGS.PlayerEjectItem(cb, pl, invDbID)\n\tcb = cb or f\n\n\tlocal tRemoved = IGS.DeletePlayerInventoryItemLocally(pl, invDbID)\n\tif (not tRemoved) then -- Р±Р°Р№РїР°СЃС‹\n\t\tcb(false)\n\t\treturn\n\tend\n\n\tIGS.DeleteInventoryItem(function(ok)\n\t\tif (not ok) then -- РјР± РІ РїР°РЅРµР»Рё СѓРґР°Р»РёР»Рё\n\t\t\treturn cb(false)\n\t\tend\n\n\t\tlocal pos = LocalToWorld( Vector(50,0,35),Angle(0,0,0), pl:GetPos(),pl:GetAngles() )\n\t\tlocal ent = IGS.CreateGift(tRemoved.Item, pl, pos)\n\n\t\tcb(ent)\n\tend, invDbID)\nend\n\nfunction IGS.IsInventoryOverloaded(pl)\n\treturn #(IGS.Inventory(pl) or {}) \u003e= 100\nend\n--[[-------------------------------------------------------------------------\n\t//РРќР’Р•РќРўРђР Р¬\n---------------------------------------------------------------------------]]\n","igs/dependencies/bib.lua":  "bib = bib or {} -- РќРµ Р·РЅР°СЋ, РїРѕС‡РµРјСѓ СЏ СЂРµС€РёР» РґР°С‚СЊ РµРјСѓ РёРјРµРЅРЅРѕ С‚Р°РєРѕРµ РЅР°Р·РІР°РЅРёРµ\n\nfunction bib.set(key,value)\n\tsql.Query([[\n\t\tREPLACE INTO `bib`(`key`,`value`)\n\t\tVALUES (]] .. sql.SQLStr(key) .. \",\" .. sql.SQLStr(value) .. [[)\n\t]])\nend\n\nfunction bib.get(key,fallback)\n\treturn sql.QueryValue([[\n\t\tSELECT `value`\n\t\tFROM `bib`\n\t\tWHERE `key` = ]] .. sql.SQLStr(key)\n\t) or fallback\nend\n\nfunction bib.delete(key)\n\tsql.Query([[\n\t\tDELETE FROM `bib`\n\t\tWHERE `key` = ]] .. sql.SQLStr(key)\n\t)\nend\n\nfunction bib.getAll()\n\tlocal t = sql.Query([[\n\t\tSELECT `key`,`value`\n\t\tFROM `bib`\n\t]]) or {}\n\n\tlocal kv = {}\n\tfor _,v in ipairs(t) do\n\t\tkv[v.key] = v.value\n\tend\n\n\treturn kv\nend\n\nfunction bib.reset()\n\tsql.Query([[\n\t\tDELETE FROM `bib`\n\t]])\nend\n\nsql.Query([[\n\tCREATE TABLE IF NOT EXISTS `bib` (\n\t\t`key`   TEXT NOT NULL UNIQUE,\n\t\t`value` TEXT,\n\t\tPRIMARY KEY(key)\n\t);\n]])\n\n\n\n\n\n--[[-------------------------------------------------------------------------\n\tBools\n---------------------------------------------------------------------------]]\nfunction bib.getBool(k, bFallback)\n\tlocal v = bib.get(k)\n\tif v == nil then\n\t\treturn bFallback\n\tend\n\n\treturn v == \"t\"\nend\n\nfunction bib.setBool(k,b)\n\tbib.set(k,b and \"t\" or \"f\")\nend\n\n-- local function g() return bib.getBool(\"foo\") end\n-- local function s(b) bib.setBool(\"foo\",b) end\n-- s(nil)   print(\"false\",g())\n-- s(true)  print(\"true\",g())\n-- s(false) print(\"false\",g())\n-- s(1)     print(\"true\",g())\n\n\n--[[-------------------------------------------------------------------------\n\tNumbers\n---------------------------------------------------------------------------]]\nfunction bib.getNum(k,iFallback)\n\treturn tonumber(bib.get(k,iFallback))\nend\n\nfunction bib.setNum(k,i)\n\tbib.set(k,i)\nend\n\nfunction bib.increment(k, i_)\n\tlocal i = bib.getNum(k, 0) + (i_ or 1)\n\tbib.setNum(k, i)\n\treturn i\nend\n\n","igs/dependencies/chatprint.lua":  "if TRIGON then return end\n\n\nif SERVER then\n\tutil.AddNetworkString(\"ChatPrintColor\")\n\n\n\tlocal function sayColor(targ, ...)\n\t\tlocal args = {...}\n\t\t-- PrintTable(args)\n\t\tnet.Start(\"ChatPrintColor\")\n\t\t\tnet.WriteTable(IsColor(args[1]) and args or args[1])\n\t\tnet[targ and \"Send\" or \"Broadcast\"](targ)\n\tend\n\n\tlocal PLAYER = FindMetaTable(\"Player\")\n\tfunction PLAYER:ChatPrintColor(...)\n\t\tsayColor(self, ...)\n\tend\n\n\tchat = chat or {}\n\tfunction chat.AddTextSV(...)\n\t\tsayColor(nil, ...)\n\tend\n\nelse\n\tnet.Receive(\"ChatPrintColor\",function()\n\t\tchat.AddText(unpack(net.ReadTable()))\n\tend)\nend\n","igs/dependencies/dash/hash.lua":  "if hash then return end\n\nif (SERVER) and file.Exists(\u0027lua/bin/gmsv_hash_\u0027 .. (system.IsWindows() and \u0027win32\u0027 or \u0027linux\u0027) .. \u0027.dll\u0027, \u0027MOD\u0027) then -- Use gm_hash if we have it since it\u0027s a faster https://github.com/SuperiorServers/gm_hash\n\t_require \u0027hash\u0027\n\treturn\nend\n\nhash = {}\n\n-- MD5 modified from https://github.com/kikito/md5.lua\ndo\n\tlocal char, byte, format, rep, sub = string.char, string.byte, string.format, string.rep, string.sub\n\tlocal bit_or, bit_and, bit_not, bit_xor, bit_rshift, bit_lshift = bit.bor, bit.band, bit.bnot, bit.bxor, bit.rshift, bit.lshift\n\n\t-- convert little-endian 32-bit int to a 4-char string\n\tlocal function lei2str(i)\n\t  local f=function (s) return char( bit_and( bit_rshift(i, s), 255)) end\n\t  return f(0)..f(8)..f(16)..f(24)\n\tend\n\n\t-- convert raw string to big-endian int\n\tlocal function str2bei(s)\n\t  local v=0\n\t  for i=1, #s do\n\t    v = v * 256 + byte(s, i)\n\t  end\n\t  return v\n\tend\n\n\t-- convert raw string to little-endian int\n\tlocal function str2lei(s)\n\t  local v=0\n\t  for i = #s,1,-1 do\n\t    v = v*256 + byte(s, i)\n\t  end\n\t  return v\n\tend\n\n\t-- cut up a string in little-endian ints of given size\n\tlocal function cut_le_str(s,...)\n\t  local o, r = 1, {}\n\t  local args = {...}\n\t  for i=1, #args do\n\t    table.insert(r, str2lei(sub(s, o, o + args[i] - 1)))\n\t    o = o + args[i]\n\t  end\n\t  return r\n\tend\n\n\tlocal swap = function (w) return str2bei(lei2str(w)) end\n\n\t-- An MD5 mplementation in Lua, requires bitlib (hacked to use LuaBit from above, ugh)\n\t-- 10/02/2001 jcw@equi4.com\n\n\tlocal CONSTS = {\n\t  0xd76aa478, 0xe8c7b756, 0x242070db, 0xc1bdceee,\n\t  0xf57c0faf, 0x4787c62a, 0xa8304613, 0xfd469501,\n\t  0x698098d8, 0x8b44f7af, 0xffff5bb1, 0x895cd7be,\n\t  0x6b901122, 0xfd987193, 0xa679438e, 0x49b40821,\n\t  0xf61e2562, 0xc040b340, 0x265e5a51, 0xe9b6c7aa,\n\t  0xd62f105d, 0x02441453, 0xd8a1e681, 0xe7d3fbc8,\n\t  0x21e1cde6, 0xc33707d6, 0xf4d50d87, 0x455a14ed,\n\t  0xa9e3e905, 0xfcefa3f8, 0x676f02d9, 0x8d2a4c8a,\n\t  0xfffa3942, 0x8771f681, 0x6d9d6122, 0xfde5380c,\n\t  0xa4beea44, 0x4bdecfa9, 0xf6bb4b60, 0xbebfbc70,\n\t  0x289b7ec6, 0xeaa127fa, 0xd4ef3085, 0x04881d05,\n\t  0xd9d4d039, 0xe6db99e5, 0x1fa27cf8, 0xc4ac5665,\n\t  0xf4292244, 0x432aff97, 0xab9423a7, 0xfc93a039,\n\t  0x655b59c3, 0x8f0ccc92, 0xffeff47d, 0x85845dd1,\n\t  0x6fa87e4f, 0xfe2ce6e0, 0xa3014314, 0x4e0811a1,\n\t  0xf7537e82, 0xbd3af235, 0x2ad7d2bb, 0xeb86d391,\n\t  0x67452301, 0xefcdab89, 0x98badcfe, 0x10325476\n\t}\n\n\tlocal f=function (x,y,z) return bit_or(bit_and(x,y),bit_and(-x-1,z)) end\n\tlocal g=function (x,y,z) return bit_or(bit_and(x,z),bit_and(y,-z-1)) end\n\tlocal h=function (x,y,z) return bit_xor(x,bit_xor(y,z)) end\n\tlocal i=function (x,y,z) return bit_xor(y,bit_or(x,-z-1)) end\n\tlocal z=function (f,a,b,c,d,x,s,ac)\n\t  a=bit_and(a+f(b,c,d)+x+ac,0xFFFFFFFF)\n\t  -- be *very* careful that left shift does not cause rounding!\n\t  return bit_or(bit_lshift(bit_and(a,bit_rshift(0xFFFFFFFF,s)),s),bit_rshift(a,32-s))+b\n\tend\n\n\tlocal function transform(A,B,C,D,X)\n\t  local a,b,c,d=A,B,C,D\n\t  local t=CONSTS\n\n\t  a=z(f,a,b,c,d,X[ 0], 7,t[ 1])\n\t  d=z(f,d,a,b,c,X[ 1],12,t[ 2])\n\t  c=z(f,c,d,a,b,X[ 2],17,t[ 3])\n\t  b=z(f,b,c,d,a,X[ 3],22,t[ 4])\n\t  a=z(f,a,b,c,d,X[ 4], 7,t[ 5])\n\t  d=z(f,d,a,b,c,X[ 5],12,t[ 6])\n\t  c=z(f,c,d,a,b,X[ 6],17,t[ 7])\n\t  b=z(f,b,c,d,a,X[ 7],22,t[ 8])\n\t  a=z(f,a,b,c,d,X[ 8], 7,t[ 9])\n\t  d=z(f,d,a,b,c,X[ 9],12,t[10])\n\t  c=z(f,c,d,a,b,X[10],17,t[11])\n\t  b=z(f,b,c,d,a,X[11],22,t[12])\n\t  a=z(f,a,b,c,d,X[12], 7,t[13])\n\t  d=z(f,d,a,b,c,X[13],12,t[14])\n\t  c=z(f,c,d,a,b,X[14],17,t[15])\n\t  b=z(f,b,c,d,a,X[15],22,t[16])\n\n\t  a=z(g,a,b,c,d,X[ 1], 5,t[17])\n\t  d=z(g,d,a,b,c,X[ 6], 9,t[18])\n\t  c=z(g,c,d,a,b,X[11],14,t[19])\n\t  b=z(g,b,c,d,a,X[ 0],20,t[20])\n\t  a=z(g,a,b,c,d,X[ 5], 5,t[21])\n\t  d=z(g,d,a,b,c,X[10], 9,t[22])\n\t  c=z(g,c,d,a,b,X[15],14,t[23])\n\t  b=z(g,b,c,d,a,X[ 4],20,t[24])\n\t  a=z(g,a,b,c,d,X[ 9], 5,t[25])\n\t  d=z(g,d,a,b,c,X[14], 9,t[26])\n\t  c=z(g,c,d,a,b,X[ 3],14,t[27])\n\t  b=z(g,b,c,d,a,X[ 8],20,t[28])\n\t  a=z(g,a,b,c,d,X[13], 5,t[29])\n\t  d=z(g,d,a,b,c,X[ 2], 9,t[30])\n\t  c=z(g,c,d,a,b,X[ 7],14,t[31])\n\t  b=z(g,b,c,d,a,X[12],20,t[32])\n\n\t  a=z(h,a,b,c,d,X[ 5], 4,t[33])\n\t  d=z(h,d,a,b,c,X[ 8],11,t[34])\n\t  c=z(h,c,d,a,b,X[11],16,t[35])\n\t  b=z(h,b,c,d,a,X[14],23,t[36])\n\t  a=z(h,a,b,c,d,X[ 1], 4,t[37])\n\t  d=z(h,d,a,b,c,X[ 4],11,t[38])\n\t  c=z(h,c,d,a,b,X[ 7],16,t[39])\n\t  b=z(h,b,c,d,a,X[10],23,t[40])\n\t  a=z(h,a,b,c,d,X[13], 4,t[41])\n\t  d=z(h,d,a,b,c,X[ 0],11,t[42])\n\t  c=z(h,c,d,a,b,X[ 3],16,t[43])\n\t  b=z(h,b,c,d,a,X[ 6],23,t[44])\n\t  a=z(h,a,b,c,d,X[ 9], 4,t[45])\n\t  d=z(h,d,a,b,c,X[12],11,t[46])\n\t  c=z(h,c,d,a,b,X[15],16,t[47])\n\t  b=z(h,b,c,d,a,X[ 2],23,t[48])\n\n\t  a=z(i,a,b,c,d,X[ 0], 6,t[49])\n\t  d=z(i,d,a,b,c,X[ 7],10,t[50])\n\t  c=z(i,c,d,a,b,X[14],15,t[51])\n\t  b=z(i,b,c,d,a,X[ 5],21,t[52])\n\t  a=z(i,a,b,c,d,X[12], 6,t[53])\n\t  d=z(i,d,a,b,c,X[ 3],10,t[54])\n\t  c=z(i,c,d,a,b,X[10],15,t[55])\n\t  b=z(i,b,c,d,a,X[ 1],21,t[56])\n\t  a=z(i,a,b,c,d,X[ 8], 6,t[57])\n\t  d=z(i,d,a,b,c,X[15],10,t[58])\n\t  c=z(i,c,d,a,b,X[ 6],15,t[59])\n\t  b=z(i,b,c,d,a,X[13],21,t[60])\n\t  a=z(i,a,b,c,d,X[ 4], 6,t[61])\n\t  d=z(i,d,a,b,c,X[11],10,t[62])\n\t  c=z(i,c,d,a,b,X[ 2],15,t[63])\n\t  b=z(i,b,c,d,a,X[ 9],21,t[64])\n\n\t  return A+a,B+b,C+c,D+d\n\tend\n\n\tfunction hash.MD5(s)\n\t  local msgLen = #s\n\t  local padLen = 56 - msgLen % 64\n\n\t  if msgLen % 64 \u003e 56 then padLen = padLen + 64 end\n\n\t  if padLen == 0 then padLen = 64 end\n\n\t  s = s .. char(128) .. rep(char(0),padLen-1) .. lei2str(8*msgLen) .. lei2str(0)\n\t  local t = CONSTS\n\t  local a,b,c,d = t[65],t[66],t[67],t[68]\n\n\t  for i=1,#s,64 do\n\t    local X = cut_le_str(sub(s,i,i+63),4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4)\n\t    X[0] = table.remove(X,1) -- zero based!\n\t    a,b,c,d = transform(a,b,c,d,X)\n\t  end\n\n\t  return format(\"%08x%08x%08x%08x\",swap(a),swap(b),swap(c),swap(d))\n\tend\nend\n\n\n-- SHA2 modified from http://lua-users.org/wiki/SecureHashAlgorithm\ndo\n\tlocal bit_band \t\t= bit.band\n\tlocal bit_ror     = bit.ror\n\tlocal bit_bxor \t\t= bit.bxor\n\tlocal bit_rshift \t= bit.rshift\n\tlocal bit_bnot\t\t= bit.bnot\n\n\tlocal string_gsub \t= string.gsub\n\tlocal string_format = string.format\n\tlocal string_byte \t= string.byte\n\tlocal string_char   = string.char\n\tlocal string_rep\t= string.rep\n\n\n\tlocal k = {\n\t\t0x428a2f98, 0x71374491, 0xb5c0fbcf, 0xe9b5dba5,\n\t\t0x3956c25b, 0x59f111f1, 0x923f82a4, 0xab1c5ed5,\n\t\t0xd807aa98, 0x12835b01, 0x243185be, 0x550c7dc3,\n\t\t0x72be5d74, 0x80deb1fe, 0x9bdc06a7, 0xc19bf174,\n\t\t0xe49b69c1, 0xefbe4786, 0x0fc19dc6, 0x240ca1cc,\n\t\t0x2de92c6f, 0x4a7484aa, 0x5cb0a9dc, 0x76f988da,\n\t\t0x983e5152, 0xa831c66d, 0xb00327c8, 0xbf597fc7,\n\t\t0xc6e00bf3, 0xd5a79147, 0x06ca6351, 0x14292967,\n\t\t0x27b70a85, 0x2e1b2138, 0x4d2c6dfc, 0x53380d13,\n\t\t0x650a7354, 0x766a0abb, 0x81c2c92e, 0x92722c85,\n\t\t0xa2bfe8a1, 0xa81a664b, 0xc24b8b70, 0xc76c51a3,\n\t\t0xd192e819, 0xd6990624, 0xf40e3585, 0x106aa070,\n\t\t0x19a4c116, 0x1e376c08, 0x2748774c, 0x34b0bcb5,\n\t\t0x391c0cb3, 0x4ed8aa4a, 0x5b9cca4f, 0x682e6ff3,\n\t\t0x748f82ee, 0x78a5636f, 0x84c87814, 0x8cc70208,\n\t\t0x90befffa, 0xa4506ceb, 0xbef9a3f7, 0xc67178f2,\n\t}\n\n\tlocal function str2hexa (s)\n\t\treturn string_gsub(s, \".\", function(c)\n\t\t\treturn string_format(\"%02x\", string_byte(c))\n\t\tend)\n\tend\n\n\tlocal function num2s (l, n)\n\t\tlocal s = \"\"\n\t\tfor i = 1, n do\n\t\t\tlocal rem = l % 256\n\t\t\ts = string_char(rem) .. s\n\t\t\tl = (l - rem) / 256\n\t\tend\n\t\treturn s\n\tend\n\n\tlocal function s232num (s, i)\n\t\tlocal n = 0\n\t\tfor i = i, i + 3 do\n\t\t\tn = n*256 + string_byte(s, i)\n\t\tend\n\t\treturn n\n\tend\n\n\tlocal function preproc (msg, len)\n\t\tlocal extra = -(len + 1 + 8) % 64\n\t\tlen = num2s(8 * len, 8)\n\t\tmsg = msg .. \"\\128\" .. string_rep(\"\\0\", extra) .. len\n\t\treturn msg\n\tend\n\n\tlocal function initH256 (H)\n\t\tH[1] = 0x6a09e667\n\t\tH[2] = 0xbb67ae85\n\t\tH[3] = 0x3c6ef372\n\t\tH[4] = 0xa54ff53a\n\t\tH[5] = 0x510e527f\n\t\tH[6] = 0x9b05688c\n\t\tH[7] = 0x1f83d9ab\n\t\tH[8] = 0x5be0cd19\n\t\treturn H\n\tend\n\n\tlocal function digestblock (msg, i, H)\n\t\tlocal w = {}\n\t\tfor j = 1, 16 do\n\t\t\tw[j] = s232num(msg, i + (j - 1)*4)\n\t\tend\n\n\t\tfor j = 17, 64 do\n\t\t\tlocal v = w[j - 15]\n\t\t\tlocal s0 = bit_bxor(bit_ror(v, 7), bit_ror(v, 18), bit_rshift(v, 3))\n\t\t\tv = w[j - 2]\n\t\t\tlocal s1 = bit_bxor(bit_ror(v, 17), bit_ror(v, 19), bit_rshift(v, 10))\n\t\t\tw[j] = w[j - 16] + s0 + w[j - 7] + s1\n\t\tend\n\n\t\tlocal a, b, c, d, e, f, g, h = H[1], H[2], H[3], H[4], H[5], H[6], H[7], H[8]\n\n\t\tfor i = 1, 64 do\n\t\t\tlocal s0 = bit_bxor(bit_ror(a, 2), bit_ror(a, 13), bit_ror(a, 22))\n\t\t\tlocal maj = bit_bxor(bit_band(a, b), bit_band(a, c), bit_band(b, c))\n\t\t\tlocal t2 = s0 + maj\n\t\t\tlocal s1 = bit_bxor(bit_ror(e, 6), bit_ror(e, 11), bit_ror(e, 25))\n\t\t\tlocal ch = bit_bxor (bit_band(e, f), bit_band(bit_bnot(e), g))\n\t\t\tlocal t1 = h + s1 + ch + k[i] + w[i]\n\n\t\t\th = g\n\t\t\tg = f\n\t\t\tf = e\n\t\t\te = d + t1\n\t\t\td = c\n\t\t\tc = b\n\t\t\tb = a\n\t\t\ta = t1 + t2\n\t\tend\n\n\t\tH[1] = bit_band(H[1] + a)\n\t\tH[2] = bit_band(H[2] + b)\n\t\tH[3] = bit_band(H[3] + c)\n\t\tH[4] = bit_band(H[4] + d)\n\t\tH[5] = bit_band(H[5] + e)\n\t\tH[6] = bit_band(H[6] + f)\n\t\tH[7] = bit_band(H[7] + g)\n\t\tH[8] = bit_band(H[8] + h)\n\tend\n\n\tlocal HH = {}\n\tfunction hash.SHA256(msg)\n\t\tmsg = preproc(msg, #msg)\n\t\tlocal H = initH256(HH)\n\t\tfor i = 1, #msg, 64 do\n\t\t\tdigestblock(msg, i, H)\n\t\tend\n\n\t\treturn str2hexa(num2s(H[1], 4)..num2s(H[2], 4)..num2s(H[3], 4)..num2s(H[4], 4)..num2s(H[5], 4)..num2s(H[6], 4)..num2s(H[7], 4)..num2s(H[8], 4))\n\tend\nend\n\ndo\n\tlocal band = bit.band\n\tlocal bnot = bit.bnot\n\tlocal bor = bit.bor\n\tlocal bxor = bit.bxor\n\tlocal floor = math.floor\n\n\t// The four core functions - F1 is optimized somewhat\n\t// local function f1(x, y, z) bit.bor( bit.band( x, y ), bit.band( bit.bnot( x ), z )) end\n\tlocal function f1( x, y, z ) return bxor( z, band( x, bxor( y, z ))) end\n\tlocal function f2( x, y, z ) return bxor( y, band( z, bxor( x, y ))) end\n\tlocal function f3( x, y, z ) return bxor( bxor( x, y ), z ) end\n\tlocal function f4( x, y, z ) return bxor( y, bor( x, bnot( z ))) end\n\n\t// This is the central step in the MD5 algorithm.\n\tlocal function Step( func, w, x, y, z, flData, iStep )\n\t\tw = w + func(x, y, z) + flData\n\n\t\treturn bor( (w * 2^iStep) % 0x100000000, floor(w % 0x100000000 / 2^(0x20 - iStep)) ) + x\n\tend\n\n\t-- This is called every tick so it has to be super optimised\n\tfunction hash.PseudoRandom( nSeed )\n\t\tnSeed = nSeed % 0x100000000\n\n\t\tlocal a = Step(f1, 0x67452301, 0xefcdab89, 0x98badcfe, 0x10325476, nSeed + 0xd76aa478, 7)\n\t\tlocal d = Step(f1, 0x10325476, a, 0xefcdab89, 0x98badcfe, 0xe8c7b7d6, 12)\n\t\tlocal c = Step(f1, 0x98badcfe, d, a, 0xefcdab89, 0x242070db, 17)\n\t\tlocal b = Step(f1, 0xefcdab89, c, d, a, 0xc1bdceee, 22)\n\t\ta = Step(f1, a, b, c, d, 0xf57c0faf, 7)\n\t\td = Step(f1, d, a, b, c, 0x4787c62a, 12)\n\t\tc = Step(f1, c, d, a, b, 0xa8304613, 17)\n\t\tb = Step(f1, b, c, d, a, 0xfd469501, 22)\n\t\ta = Step(f1, a, b, c, d, 0x698098d8, 7)\n\t\td = Step(f1, d, a, b, c, 0x8b44f7af, 12)\n\t\tc = Step(f1, c, d, a, b, 0xffff5bb1, 17)\n\t\tb = Step(f1, b, c, d, a, 0x895cd7be, 22)\n\t\ta = Step(f1, a, b, c, d, 0x6b901122, 7)\n\t\td = Step(f1, d, a, b, c, 0xfd987193, 12)\n\t\tc = Step(f1, c, d, a, b, 0xa67943ae, 17)\n\t\tb = Step(f1, b, c, d, a, 0x49b40821, 22)\n\n\t\ta = Step(f2, a, b, c, d, 0xf61e25e2, 5)\n\t\td = Step(f2, d, a, b, c, 0xc040b340, 9)\n\t\tc = Step(f2, c, d, a, b, 0x265e5a51, 14)\n\t\tb = Step(f2, b, c, d, a, nSeed + 0xe9b6c7aa, 20)\n\t\ta = Step(f2, a, b, c, d, 0xd62f105d, 5)\n\t\td = Step(f2, d, a, b, c, 0x02441453, 9)\n\t\tc = Step(f2, c, d, a, b, 0xd8a1e681, 14)\n\t\tb = Step(f2, b, c, d, a, 0xe7d3fbc8, 20)\n\t\ta = Step(f2, a, b, c, d, 0x21e1cde6, 5)\n\t\td = Step(f2, d, a, b, c, 0xc33707f6, 9)\n\t\tc = Step(f2, c, d, a, b, 0xf4d50d87, 14)\n\t\tb = Step(f2, b, c, d, a, 0x455a14ed, 20)\n\t\ta = Step(f2, a, b, c, d, 0xa9e3e905, 5)\n\t\td = Step(f2, d, a, b, c, 0xfcefa3f8, 9)\n\t\tc = Step(f2, c, d, a, b, 0x676f02d9, 14)\n\t\tb = Step(f2, b, c, d, a, 0x8d2a4c8a, 20)\n\n\t\ta = Step(f3, a, b, c, d, 0xfffa3942, 4)\n\t\td = Step(f3, d, a, b, c, 0x8771f681, 11)\n\t\tc = Step(f3, c, d, a, b, 0x6d9d6122, 16)\n\t\tb = Step(f3, b, c, d, a, 0xfde5382c, 23)\n\t\ta = Step(f3, a, b, c, d, 0xa4beeac4, 4)\n\t\td = Step(f3, d, a, b, c, 0x4bdecfa9, 11)\n\t\tc = Step(f3, c, d, a, b, 0xf6bb4b60, 16)\n\t\tb = Step(f3, b, c, d, a, 0xbebfbc70, 23)\n\t\ta = Step(f3, a, b, c, d, 0x289b7ec6, 4)\n\t\td = Step(f3, d, a, b, c, nSeed + 0xeaa127fa, 11)\n\t\tc = Step(f3, c, d, a, b, 0xd4ef3085, 16)\n\t\tb = Step(f3, b, c, d, a, 0x04881d05, 23)\n\t\ta = Step(f3, a, b, c, d, 0xd9d4d039, 4)\n\t\td = Step(f3, d, a, b, c, 0xe6db99e5, 11)\n\t\tc = Step(f3, c, d, a, b, 0x1fa27cf8, 16)\n\t\tb = Step(f3, b, c, d, a, 0xc4ac5665, 23)\n\n\t\ta = Step(f4, a, b, c, d, nSeed + 0xf4292244, 6)\n\t\td = Step(f4, d, a, b, c, 0x432aff97, 10)\n\t\tc = Step(f4, c, d, a, b, 0xab9423c7, 15)\n\t\tb = Step(f4, b, c, d, a, 0xfc93a039, 21)\n\t\ta = Step(f4, a, b, c, d, 0x655b59c3, 6)\n\t\td = Step(f4, d, a, b, c, 0x8f0ccc92, 10)\n\t\tc = Step(f4, c, d, a, b, 0xffeff47d, 15)\n\t\tb = Step(f4, b, c, d, a, 0x85845e51, 21)\n\t\ta = Step(f4, a, b, c, d, 0x6fa87e4f, 6)\n\t\td = Step(f4, d, a, b, c, 0xfe2ce6e0, 10)\n\t\tc = Step(f4, c, d, a, b, 0xa3014314, 15)\n\t\tb = Step(f4, b, c, d, a, 0x4e0811a1, 21)\n\t\ta = Step(f4, a, b, c, d, 0xf7537e82, 6)\n\t\td = Step(f4, d, a, b, c, 0xbd3af235, 10)\n\t\tc = (0x98badcfe + Step(f4, c, d, a, b, 0x2ad7d2bb, 15)) % 0x100000000\n\t\tb = (0xefcdab89 + Step(f4, b, c, d, a, 0xeb86d391, 21)) % 0x100000000\n\n\t\treturn floor( b / 0x10000 ) % 0x100 + floor( b / 0x1000000 ) % 0x100 * 0x100 + c % 0x100 * 0x10000 + floor( c / 0x100 ) % 0x100 * 0x1000000\n\tend\nend\n","igs/dependencies/dash/misc.lua":  "if dash then return end\n-- Thanks to SuperiorServers.co\n\nlocal Start = net.Start\nlocal Send  = SERVER and net.Send or net.SendToServer\nfunction net.Ping(msg, recipients)\n\tStart(msg)\n\tSend(recipients)\nend\n\n\nif CLIENT then\n\tlocal surface_SetFont \t\t= surface.SetFont\n\tlocal surface_GetTextSize \t= surface.GetTextSize\n\tlocal string_Explode \t\t= string.Explode\n\tlocal ipairs \t\t\t\t= ipairs\n\n\tfunction string.Wrap(font, text, width)\n\t\tsurface_SetFont(font)\n\n\t\tlocal sw = surface_GetTextSize(\u0027 \u0027)\n\t\tlocal ret = {}\n\n\t\tlocal w = 0\n\t\tlocal s = \u0027\u0027\n\n\t\tlocal t = string_Explode(\u0027\\n\u0027, text)\n\t\tfor i = 1, #t do\n\t\t\tlocal t2 = string_Explode(\u0027 \u0027, t[i], false)\n\t\t\tfor i2 = 1, #t2 do\n\t\t\t\tlocal neww = surface_GetTextSize(t2[i2])\n\n\t\t\t\tif (w + neww \u003e= width) then\n\t\t\t\t\tret[#ret + 1] = s\n\t\t\t\t\tw = neww + sw\n\t\t\t\t\ts = t2[i2] .. \u0027 \u0027\n\t\t\t\telse\n\t\t\t\t\ts = s .. t2[i2] .. \u0027 \u0027\n\t\t\t\t\tw = w + neww + sw\n\t\t\t\tend\n\t\t\tend\n\t\t\tret[#ret + 1] = s\n\t\t\tw = 0\n\t\t\ts = \u0027\u0027\n\t\tend\n\n\t\tif (s ~= \u0027\u0027) then\n\t\t\tret[#ret + 1] = s\n\t\tend\n\n\t\treturn ret\n\tend\n\n\tlocal formathex = \u0027%%%02X\u0027\n\tfunction string:URLEncode()\n\t\treturn string.gsub(string.gsub(string.gsub(self, \u0027\\n\u0027, \u0027\\r\\n\u0027), \u0027([^%w ])\u0027, function(c)\n\t\t\treturn string.format(formathex, string.byte(c))\n\t\tend), \u0027 \u0027, \u0027+\u0027)\n\tend\n\n\tlocal surface_DrawRect     = surface.DrawRect\n\tlocal surface_SetDrawColor = surface.SetDrawColor\n\tfunction draw.Box(x, y, w, h, col)\n\t\tsurface_SetDrawColor(col)\n\t\tsurface_DrawRect(x, y, w, h)\n\tend\nend\n","igs/dependencies/dash/nw.lua":  "-- Thanks to SuperiorServers.co\n\nIGS.nw = {}\n\nlocal vars     = {}\nlocal mappings = {}\nlocal data     = {\n\t[0] = {}\n}\nlocal globals   = data[0]\nlocal callbacks = {}\n\nlocal NETVAR   = {}\nNETVAR.__index = NETVAR\n\ndebug.getregistry().IGSVar = NETVAR\n\nlocal bitmap = {\n\t[3]\t  = 3,\n\t[7]   = 4,\n\t[15]  = 5,\n\t[31]  = 6,\n\t[63]  = 7,\n\t[127] = 8\n}\n\nlocal bitcount = 2\n\nlocal ENTITY = FindMetaTable \u0027Entity\u0027\n\nlocal pairs  = pairs\nlocal Entity = Entity\n\nlocal net_WriteUInt = net.WriteUInt\nlocal net_ReadUInt  = net.ReadUInt\nlocal net_Start     = net.Start\nlocal net_Send      = SERVER and net.Send or net.SendToServer\nlocal net_Broadcast = net.Broadcast\nlocal sorted_pairs  = SortedPairsByMemberValue\n\nfunction IGS.nw.Register(var) -- You must always call this on both the client and server. It will serioulsy break shit if you don\u0027t.\n\tlocal t = {\n\t\tName = var,\n\t\tNetworkString = \u0027IGS.nw_\u0027 .. var,\n\t\tWriteFunc = net.WriteType,\n\t\tReadFunc = net.ReadType,\n\t\tSendFunc = function(self, ent, value, recipients)\n\t\t\tif (recipients ~= nil) then\n\t\t\t\tnet_Send(recipients)\n\t\t\telse\n\t\t\t\tnet_Broadcast()\n\t\t\tend\n\t\tend,\n\t}\n\tsetmetatable(t, NETVAR)\n\tvars[var] = t\n\n\tif (SERVER) then\n\t\tutil.AddNetworkString(t.NetworkString)\n\telse\n\t\tnet.Receive(t.NetworkString, function()\n\t\t\tlocal index, value = t:_Read()\n\n\t\t\tif (not data[index]) then\n\t\t\t\tdata[index] = {}\n\t\t\tend\n\n\t\t\tdata[index][var] = value\n\n\t\t\tt:_CallHook(index, value)\n\t\tend)\n\tend\n\n\treturn t:_Construct()\nend\n\nfunction NETVAR:Write(func, opt)\n\tself.WriteFunc = function(value)\n\t\tfunc(value, opt)\n\tend\n\treturn self:_Construct()\nend\n\nfunction NETVAR:Read(func, opt)\n\tself.ReadFunc = function()\n\t\treturn func(opt)\n\tend\n\treturn self:_Construct()\nend\n\nfunction NETVAR:Filter(func)\n\tself.SendFunc = function(_, ent, value, recipients)\n\t\tnet_Send(recipients or func(ent, value))\n\tend\n\treturn self:_Construct()\nend\n\nfunction NETVAR:SetPlayer()\n\tself.PlayerVar = true\n\treturn self:_Construct()\nend\n\nfunction NETVAR:SetLocalPlayer()\n\tself.LocalPlayerVar = true\n\treturn self:_Construct()\nend\n\nfunction NETVAR:SetGlobal()\n\tself.GlobalVar = true\n\treturn self:_Construct()\nend\n\nfunction NETVAR:SetNoSync()\n\tself.NoSync = true\n\treturn self:_Construct()\nend\n\nfunction NETVAR:SetHook(name)\n\tself.Hook = name\n\treturn self\nend\n\nfunction NETVAR:_Send(ent, value, recipients)\n\tnet_Start(self.NetworkString)\n\t\tself:_Write(ent, value)\n\tself:SendFunc(ent, value, recipients)\nend\n\nfunction NETVAR:_CallHook(index, value)\n\tif self.Hook then\n\t\tif (index ~= 0) then -- not global\n\t\t\thook.Call(self.Hook, GAMEMODE, Entity(index), value)\n\t\telse\n\t\t\thook.Call(self.Hook, GAMEMODE, value)\n\t\tend\n\tend\nend\n\nfunction NETVAR:_Construct()\n\tlocal WriteFunc = self.WriteFunc\n\tlocal ReadFunc \t= self.ReadFunc\n\n\tif self.PlayerVar then\n\t\tself._Write = function(_, ent, value)\n\t\t\tnet_WriteUInt(ent:EntIndex(), 7)\n\t\t\tWriteFunc(value)\n\t\tend\n\t\tself._Read = function(_)\n\t\t\treturn net_ReadUInt(7), ReadFunc()\n\t\tend\n\telseif self.LocalPlayerVar then\n\t\tself._Write = function(_, ent, value)\n\t\t\tWriteFunc(value)\n\t\tend\n\t\tself._Read = function(_)\n\t\t\treturn LocalPlayer():EntIndex(), ReadFunc()\n\t\tend\n\t\tself.SendFunc = function(_, ent, value, recipients)\n\t\t\tnet_Send(ent)\n\t\tend\n\telseif self.GlobalVar then\n\t\tself._Write = function(_, ent, value)\n\t\t\tWriteFunc(value)\n\t\tend\n\t\tself._Read = function(_)\n\t\t\treturn 0, ReadFunc()\n\t\tend\n\telse\n\t\tself._Write = function(_, ent, value)\n\t\t\tnet_WriteUInt(ent:EntIndex(), 12)\n\t\t\tWriteFunc(value)\n\t\tend\n\t\tself._Read = function(_)\n\t\t\treturn net_ReadUInt(12), ReadFunc()\n\t\tend\n\tend\n\n\tmappings = {}\n\tfor k, v in sorted_pairs(vars, \u0027Name\u0027, false) do\n\t\tlocal c = #mappings + 1\n\t\tvars[k].ID = c\n\t\tmappings[c] = v\n\t\tif bitmap[c] then\n\t\t\tbitcount = bitmap[c]\n\t\tend\n\tend\n\n\treturn self\nend\n\nfunction IGS.nw.GetGlobal(var)\n\treturn globals[var]\nend\n\nfunction ENTITY:GetIGSVar(var)\n\tlocal index = self:EntIndex()\n\treturn data[index] and data[index][var]\nend\n\nif (SERVER) then\n\tutil.AddNetworkString \u0027IGS.nw.PlayerSync\u0027\n\tutil.AddNetworkString \u0027IGS.nw.NilEntityVar\u0027\n\tutil.AddNetworkString \u0027IGS.nw.NilPlayerVar\u0027\n\tutil.AddNetworkString \u0027IGS.nw.EntityRemoved\u0027\n\tutil.AddNetworkString \u0027IGS.nw.PlayerRemoved\u0027\n\n\tnet.Receive(\u0027IGS.nw.PlayerSync\u0027, function(len, pl)\n\t\tif (pl.IGSEntityCreated ~= true) then\n\t\t\thook.Call(\u0027PlayerEntityCreated\u0027, GAMEMODE, pl)\n\n\t\t\tpl.IGSEntityCreated = true\n\n\t\t\tfor index, _vars in pairs(data) do\n\t\t\t\tfor var, value in pairs(_vars) do\n\t\t\t\t\tlocal ent = Entity(index)\n\t\t\t\t\tif (not vars[var].LocalPlayerVar and not vars[var].NoSync) or (ent == pl) then\n\t\t\t\t\t\tvars[var]:_Send(ent, value, pl)\n\t\t\t\t\tend\n\t\t\t\tend\n\t\t\tend\n\n\t\t\tif (callbacks[pl] ~= nil) then\n\t\t\t\tfor i = 1, #callbacks[pl] do\n\t\t\t\t\tcallbacks[pl][i](pl)\n\t\t\t\tend\n\t\t\tend\n\t\t\tcallbacks[pl] = nil\n\t\tend\n\tend)\n\n\thook.Add(\u0027EntityRemoved\u0027, \u0027IGS.nw.EntityRemoved\u0027, function(ent)\n\t\tlocal index = ent:EntIndex()\n\t\tif (index ~= 0) and (data[index] ~= nil) then -- For some reason this kept getting called on Entity(0), not sure why...\n\t\t\tif ent:IsPlayer() then\n\t\t\t\tnet_Start(\u0027IGS.nw.PlayerRemoved\u0027)\n\t\t\t\t\tnet_WriteUInt(index, 7)\n\t\t\t\tnet_Broadcast()\n\t\t\telse\n\t\t\t\tnet_Start(\u0027IGS.nw.EntityRemoved\u0027)\n\t\t\t\t\tnet_WriteUInt(index, 12)\n\t\t\t\tnet_Broadcast()\n\t\t\tend\n\n\t\t\tdata[index] = nil\n\t\tend\n\tend)\n\n\tfunction IGS.nw.WaitForPlayer(pl, cback)\n\t\tif (pl.IGSEntityCreated == true) then\n\t\t\tcback(pl)\n\t\telse\n\t\t\tif (callbacks[pl] == nil) then\n\t\t\t\tcallbacks[pl] = {}\n\t\t\tend\n\t\t\tcallbacks[pl][#callbacks[pl] + 1] = cback\n\t\tend\n\tend\n\n\tfunction IGS.nw.SetGlobal(var, value)\n\t\tglobals[var] = value\n\t\tif (value ~= nil) then\n\t\t\tvars[var]:_Send(0, value)\n\t\telse\n\t\t\tnet_Start(\u0027IGS.nw.NilEntityVar\u0027)\n\t\t\t\tnet_WriteUInt(0, 12)\n\t\t\t\tnet_WriteUInt(vars[var].ID, bitcount)\n\t\t\tvars[var]:SendFunc(0, value)\n\t\tend\n\tend\n\n\tfunction ENTITY:SetIGSVar(var, value)\n\t\tlocal index = self:EntIndex()\n\n\t\tif (not data[index]) then\n\t\t\tdata[index] = {}\n\t\tend\n\n\t\tdata[index][var] = value\n\n\t\tif (value ~= nil) then\n\t\t\tvars[var]:_Send(self, value)\n\t\telse\n\t\t\tif self:IsPlayer() then\n\t\t\t\tnet_Start(\u0027IGS.nw.NilPlayerVar\u0027)\n\t\t\t\tnet_WriteUInt(index, 7)\n\t\t\telse\n\t\t\t\tnet_Start(\u0027IGS.nw.NilEntityVar\u0027)\n\t\t\t\tnet_WriteUInt(index, 12)\n\t\t\tend\n\t\t\t\tnet_WriteUInt(vars[var].ID, bitcount)\n\t\t\tvars[var]:SendFunc(self, value)\n\t\tend\n\tend\nelse\n\thook.Add(\u0027InitPostEntity\u0027, \u0027IGS.nw.InitPostEntity\u0027, function()\n\t\tnet_Start(\u0027IGS.nw.PlayerSync\u0027)\n\t\tnet_Send()\n\tend)\n\n\tnet.Receive(\u0027IGS.nw.NilEntityVar\u0027, function()\n\t\tlocal index, id = net_ReadUInt(12), net_ReadUInt(bitcount)\n\t\tif data[index] and mappings[id] then\n\t\t\tdata[index][mappings[id].Name] = nil\n\t\tend\n\tend)\n\n\tnet.Receive(\u0027IGS.nw.NilPlayerVar\u0027, function()\n\t\tlocal index, id = net_ReadUInt(7), net_ReadUInt(bitcount)\n\t\tif data[index] and mappings[id] then\n\t\t\tdata[index][mappings[id].Name] = nil\n\t\tend\n\tend)\n\n\tnet.Receive(\u0027IGS.nw.EntityRemoved\u0027, function()\n\t\tdata[net_ReadUInt(12)] = nil\n\tend)\n\n\tnet.Receive(\u0027IGS.nw.PlayerRemoved\u0027, function()\n\t\tdata[net_ReadUInt(7)] = nil\n\tend)\nend","igs/dependencies/dash/wmat.lua":  "if dash and texture then return end -- https://t.me/c/1353676159/41153\n-- Thanks to SuperiorServers.co\n-- require \u0027hash\u0027\n\ntexture = {}\n\nlocal TEXTURE = {\n\t__tostring = function(self)\n\t\treturn self.Name\n\tend\n}\nTEXTURE.__index = TEXTURE\nTEXTURE.__concat = TEXTURE.__tostring\n\ndebug.getregistry().Texture = TEXTURE\n\ntexture.textures = {}\n-- РЎС‚Р°СЂС‹Р№ РїСЂРѕРєСЃРё РјРѕР¶РµС‚ РЅРµ СЂР°Р±РѕС‚Р°С‚СЊ\n-- texture.proxyurl = \u0027https://imgkit.gmod.app/?image=%s\u0026size=%i\u0027\n-- РСЃРїРѕР»СЊР·СѓРµРј Р°Р»СЊС‚РµСЂРЅР°С‚РёРІРЅС‹Р№ РїСЂРѕРєСЃРё РёР»Рё РїСЂСЏРјС‹Рµ СЃСЃС‹Р»РєРё\ntexture.proxyurl = \u0027https://images.weserv.nl/?url=%s\u0026w=%i\u0026h=%i\u0026output=%s\u0027\n\n-- Р”РѕРјРµРЅС‹, РґР»СЏ РєРѕС‚РѕСЂС‹С… РЅРµ РЅСѓР¶РµРЅ РїСЂРѕРєСЃРё\ntexture.trusted_domains = {\n\t\"i.imgur.com\",\n\t\"imgur.com\",\n\t\"steamusercontent.com\",\n\t\"steamcommunity.com\",\n\t\"githubusercontent.com\",\n\t\"viperrp.ru\",\n}\n\nif (not file.IsDir(\u0027texture\u0027, \u0027DATA\u0027)) then\n\tfile.CreateDir \u0027texture\u0027\nend\n\nfunction texture.Create(name)\n\ttexture.Delete(name)\n\n\tlocal ret = setmetatable({\n\t\tName \t= name,\n\t\tURL \t= \u0027\u0027,\n\t\tWidth \t= 1024,\n\t\tHeight \t= 1024,\n\t\tBusy \t= false,\n\t\tCache \t= true,\n\t\tProxy \t= true,\n\t\tFormat \t= \u0027jpg\u0027,\n\t}, TEXTURE)\n\ttexture.textures[name] = ret\n\treturn ret\nend\n\nfunction texture.Get(name)\n\tif texture.textures[name] then\n\t\treturn texture.textures[name]:GetMaterial()\n\tend\nend\n\nfunction texture.Delete(name)\n\ttexture.textures[name] = nil\nend\n\nfunction TEXTURE:SetSize(w, h)\n\tself.Width, self.Height = w, h\n\treturn self\nend\n\nfunction TEXTURE:SetFormat(format) -- valid formats are whatever your webserver proxy can handle.\n\tself.Format = format\n\treturn self\nend\n\nfunction TEXTURE:EnableCache(enable)\n\tself.Cache = enable\n\treturn self\nend\n\nfunction TEXTURE:EnableProxy(enable)\n\tself.Proxy = enable\n\treturn self\nend\n\n\nfunction TEXTURE:GetName()\n\treturn self.Name\nend\n\nfunction TEXTURE:GetUID(reaccount)\n\tif (not self.UID) or reaccount then\n\t\tself.UID = hash.MD5(self.Name .. self.URL .. self.Width .. self.Height .. self.Format)\n\tend\n\treturn self.UID\nend\n\nfunction TEXTURE:GetSize()\n\treturn self.Width, self.Height\nend\n\nfunction TEXTURE:GetFormat()\n\treturn self.Format\nend\n\nfunction TEXTURE:GetURL()\n\treturn self.URL\nend\n\nfunction TEXTURE:GetFile()\n\treturn self.File\nend\n\nfunction TEXTURE:GetMaterial()\n\treturn self.IMaterial\nend\n\nfunction TEXTURE:GetError()\n\treturn self.Error\nend\n\nfunction TEXTURE:IsBusy()\n\treturn self.Busy == true\nend\n\nfunction TEXTURE:Download(url, onsuccess, onfailure)\n\tif (self.Name == nil) then\n\t\tself.Name = \u0027Web Material: \u0027 .. url\n\tend\n\tself.URL = url\n\tself.File = \u0027texture/\u0027 .. self:GetUID() .. \u0027.png\u0027\n\n\tif self.Cache and file.Exists(self.File, \u0027DATA\u0027) then\n\t\tself.IMaterial = Material(\u0027data/\u0027 .. self.File, \u0027smooth\u0027)\n\t\tif onsuccess then\n\t\t\tonsuccess(self, self.IMaterial)\n\t\tend\n\telse\n\t\tself.Busy = true\n\n\t\tlocal function isTrustedDomain(link)\n\t\t\tfor _, domain in ipairs(texture.trusted_domains) do\n\t\t\t\tif link:find(domain, 1, true) then\n\t\t\t\t\treturn true\n\t\t\t\tend\n\t\t\tend\n\t\t\treturn false\n\t\tend\n\n\t\tlocal function buildFetchUrl(link, useProxy)\n\t\t\tif not useProxy then return link end\n\t\t\tlocal cleanUrl = link:gsub(\"^https?://\", \"\")\n\t\t\treturn string.format(texture.proxyurl, cleanUrl, self.Width, self.Height, self.Format)\n\t\tend\n\n\t\tlocal function fetchWithProxy(useProxy, triedAlternate)\n\t\t\tlocal fetchUrl = buildFetchUrl(url, useProxy)\n\n\t\t\thttp.Fetch(fetchUrl, function(body, len, headers, code)\n\t\t\t\tif code ~= 200 then\n\t\t\t\t\tif not triedAlternate then\n\t\t\t\t\t\treturn fetchWithProxy(not useProxy, true)\n\t\t\t\t\tend\n\n\t\t\t\t\tprint(\"[IGS Texture] Failed to load image: \" .. url .. \" (HTTP \" .. code .. \")\")\n\t\t\t\t\tif onfailure then\n\t\t\t\t\t\tonfailure(self, \"HTTP \" .. code)\n\t\t\t\t\tend\n\t\t\t\t\tself.Busy = false\n\t\t\t\t\treturn\n\t\t\t\tend\n\n\t\t\t\tif (self.Cache) then\n\t\t\t\t\tfile.Write(self.File, body)\n\t\t\t\tend\n\n\t\t\t\tlocal tempfile = \u0027texture/tmp_\u0027 .. os.time() .. \u0027_\u0027 .. self:GetUID() .. \u0027.png\u0027\n\t\t\t\tfile.Write(tempfile, body)\n\t\t\t\tself.IMaterial = Material(\u0027data/\u0027 .. tempfile, \u0027smooth\u0027)\n\t\t\t\tfile.Delete(tempfile)\n\n\t\t\t\tprint(\"[IGS Texture] Successfully loaded: \" .. url)\n\n\t\t\t\tif onsuccess then\n\t\t\t\t\tonsuccess(self, self.IMaterial)\n\t\t\t\tend\n\n\t\t\t\tself.Busy = false\n\t\t\tend, function(error)\n\t\t\t\tif not triedAlternate then\n\t\t\t\t\treturn fetchWithProxy(not useProxy, true)\n\t\t\t\tend\n\n\t\t\t\tprint(\"[IGS Texture] Error loading image: \" .. url)\n\t\t\t\tprint(\"[IGS Texture] Error details: \" .. tostring(error))\n\n\t\t\t\tself.Error = error\n\n\t\t\t\tif onfailure then\n\t\t\t\t\tonfailure(self, self.Error)\n\t\t\t\tend\n\n\t\t\t\tself.Busy = false\n\t\t\tend)\n\t\tend\n\n\t\tlocal useProxy = self.Proxy and not isTrustedDomain(url)\n\t\tfetchWithProxy(useProxy, false)\n\tend\n\treturn self\nend\n\nfunction TEXTURE:RenderManual(func, callback)\n\tlocal cachefile = \u0027texture/\u0027 .. self:GetUID() .. \u0027-render.png\u0027\n\n\tif file.Exists(cachefile, \u0027DATA\u0027) then\n\t\tself.File = cachefile\n\t\tself.IMaterial = Material(\u0027data/\u0027 .. self.File, \u0027smooth\u0027)\n\n\t\tif callback then\n\t\t\tcallback(self, self.IMaterial)\n\t\tend\n\telse\n\t\thook.Add(\u0027HUDPaint\u0027, \u0027texture.render\u0027 .. self:GetName(), function()\n\t\t\tif self:IsBusy() then return end\n\n\t\t\tlocal w, h = self.Width, self.Height\n\n\t\t\tlocal drawRT = GetRenderTarget(\u0027texture_rt\u0027, w, h, true)\n\t\t\tlocal oldRT = render.GetRenderTarget()\n\n\t\t\trender.SetRenderTarget(drawRT)\n\t\t\t\trender.Clear(0, 0, 0, 0)\n\t\t\t\trender.ClearDepth()\n\n\t\t\t\trender.SetViewPort(0, 0, w, h) -- may need to tweak this all a bit later when I find use cases this doesn\u0027t work well for.\n\t\t\t\t\tfunc(self, w, h)\n\n\t\t\t\t\tif self.Cache then\n\t\t\t\t\t\tself.File = \u0027texture/\u0027 .. self:GetUID() .. \u0027-render.png\u0027\n\t\t\t\t\t\tfile.Write(self.File, render.Capture({\n\t\t\t\t\t\t\tformat = \u0027png\u0027,\n\t\t\t\t\t\t\tquality = 100,\n\t\t\t\t\t\t\tx = 0,\n\t\t\t\t\t\t\ty = 0,\n\t\t\t\t\t\t\th = h,\n\t\t\t\t\t\t\tw = w\n\t\t\t\t\t\t}))\n\t\t\t\t\tend\n\t\t\t\trender.SetViewPort(0, 0, ScrW(), ScrH())\n\t\t\trender.SetRenderTarget(oldRT)\n\n\t\t\tself.IMaterial = Material(\u0027data/\u0027 .. self.File)\n\n\t\t\tif callback then\n\t\t\t\tcallback(self, self.IMaterial)\n\t\t\tend\n\n\t\t\thook.Remove(\u0027HUDPaint\u0027, \u0027texture.render\u0027 .. self:GetName())\n\t\tend)\n\tend\n\treturn self\nend\n\nfunction TEXTURE:Render(func, callback)\n\treturn self:RenderManual(function(self, w, h)\n\t\tcam.Start2D()\n\t\t\tfunc(self, w, h)\n\t\tcam.End2D()\n\tend, callback)\nend\n","igs/dependencies/lolib.lua":  "-- 2021.01.18 Logging library\n-- Author https://amd-nick.me/about\n\n-- Inspired by Python\n-- https://docs.python.org/3/howto/logging-cookbook.html\n-- https://docs.python.org/3/library/logging.html?highlight=relativecreated#logrecord-attributes\n\nlolib = {}\n\n-- https://colorswall.com/palette/3/\nlocal COLOR_DEBUG   = Color(2, 117, 216)\nlocal COLOR_FADED   = Color(247, 247, 247)\nlocal COLOR_INFO    = Color(91, 192, 222)\nlocal COLOR_WARNING = Color(255, 255, 0)\nlocal COLOR_ERROR   = Color(240, 50, 50)\n\nlolib.LEVELS = {\n\tDISABLE = 0,\n\tDEBUG   = 1,\n\tINFO    = 2,\n\tWARNING = 3,\n\tERROR   = 4,\n\n\t{\"D\", COLOR_DEBUG,   COLOR_DEBUG},\n\t{\"I\", COLOR_INFO,    COLOR_FADED},\n\t{\"W\", COLOR_WARNING, COLOR_FADED},\n\t{\"E\", COLOR_ERROR,   COLOR_FADED},\n}\n\nlocal function echo(pref_col, pref, text_col, text)\n\tMsgC(pref_col, pref, text_col, \" \" .. text .. \"\\n\")\nend\n\nlocal function format(patt, ...)\n\tlocal args = {...}\n\tlocal count = 0\n\tpatt = patt:gsub(\"{}\", function()\n\t\tcount = count + 1\n\t\tlocal replacement_val = (args[count] ~= nil) and args[count]\n\t\tif isnumber(replacement_val) or isstring(replacement_val) then\n\t\t\treturn replacement_val\n\t\tend\n\n\t\tif replacement_val == nil then\n\t\t\treturn \"nil_value\"\n\t\tend\n\n\t\t-- #todo hardcoded\n\t\tPrintTable({replacement_val = replacement_val})\n\t\tdebug.Trace()\n\t\treturn \"INVALID_REPLACEMENT_VALUE\"\n\tend)\n\n\treturn patt\nend\n\nlocal function fp(a)\n\tlocal func = a[1]\n\treturn function(...)\n\t\treturn func(unpack(a, 2), ...)\n\tend\nend\n\nfunction lolib.new()\n\tlocal logger = {\n\t\tlevel   = lolib.default_level or 3,\n\t\tpattern = \"{message}\"\n\t}\n\n\tlogger.log = function(iLevel, patt, ...)\n\t\tif iLevel \u003c logger.level or logger.level == 0 then return end\n\n\t\tlocal message = format(patt, ...)\n\n\t\tlocal text = logger.pattern\n\t\t\t:gsub(\"{time}\", os.date(\"%H:%M:%S\"))\n\t\t\t:gsub(\"{message}\", message)\n\n\t\tlocal level_data = lolib.LEVELS[iLevel]\n\t\techo(level_data[2], \"[\" .. level_data[1] .. \"]\", level_data[3], text)\n\tend\n\n\tlogger.debug   = fp{logger.log, lolib.LEVELS.DEBUG}\n\tlogger.info    = fp{logger.log, lolib.LEVELS.INFO}\n\tlogger.warning = fp{logger.log, lolib.LEVELS.WARNING}\n\tlogger.error   = fp{logger.log, lolib.LEVELS.ERROR}\n\n\tlogger.setLevel = function(iLevel)\n\t\tlogger.level = iLevel\n\tend\n\n\tlogger.setCvar = function(sVarName, iDefaultValue)\n\t\tlocal cvar = CreateConVar(sVarName, iDefaultValue or 0, FCVAR_ARCHIVE)\n\n\t\tcvars.AddChangeCallback(sVarName, function(_, _, new)\n\t\t\tlocal level = tonumber(new) or 0\n\t\t\tassert(level \u003e= 0 and level \u003c= 5)\n\t\t\tlogger.setLevel(level)\n\t\t\tMsgN(\"logging level has been changed. New level is: \" .. level)\n\t\tend, \"lolib\")\n\n\t\tlogger.setLevel(cvar:GetInt())\n\n\t\treturn cvar\n\tend\n\n\t-- {time}, message\n\t-- #todo filename, funcname, linen, filepath, levelname(?)\n\tlogger.setFormat = function(sPattern)\n\t\tlogger.pattern = sPattern\n\tend\n\n\treturn logger\nend\n\n/*\nlocal log = lolib.new()\nlog.setLevel(lolib.LEVELS.INFO)\nlog.setFormat(\"{time} name {message}\")\n\nlog.debug(\"debug value: {}\", 123)\nlog.info(\"info value: {}\", 123)\nlog.warning(\"warning value: {}\", 123)\nlog.error(\"error value: {}\", 123)\n*/\n\n-- return lolib","igs/dependencies/permasents.lua":  "--[[-------------------------------------------------------------------------\n\tР”Р»СЏ РІРµР± Р·Р°РіСЂСѓР·РєРё РЅРµ РїРѕРґС…РѕРґРёС‚ PermaProps Р°РґРґРѕРЅ СЃ РІРѕСЂРєС€РѕРїР°,\n\tРїРѕСЃРєРѕР»СЊРєСѓ РѕРЅ СЂР°Р±РѕС‚Р°РµС‚ РЅР° InitPostEntity, РєРѕС‚РѕСЂС‹Р№ РЅРµР»СЊР·СЏ РІС‹Р·РІР°С‚СЊ РїРѕСЃР»Рµ РІРµР± Р·Р°РіСЂСѓР·РєРё\n\n\tРР»Рё РјРѕР¶РЅРѕ..\n---------------------------------------------------------------------------]]\n\nlocal function getIndex()\n\treturn util.JSONToTable(cookie.GetString(\"perma_index\", \"\")) or {}\nend\n\nlocal function updateIndex(uid, class)\n\tlocal map = getIndex()\n\tmap[uid] = class\n\tcookie.Set(\"perma_index\", util.TableToJSON(map))\nend\n\nlocal function SpawnSent(class, pos, ang)\n\tlocal ent = ents.Create(class)\n\tent:SetPos(pos)\n\tent:SetAngles(ang)\n\tent:Spawn()\n\tent:Activate()\n\n\tlocal phys = ent:GetPhysicsObject()\n\tif phys:IsValid() then\n\t\tphys:EnableMotion(false)\n\tend\n\n\treturn ent\nend\n\n\nfunction IGS.PermaSaveFeature(class)\n\tproperties.Add(class .. \"_perma_add\", {\n\t\tMenuLabel = \"РЎРѕС…СЂР°РЅРёС‚СЊ РЅР° РєР°СЂС‚Рµ\",\n\t\tOrder = 855,\n\t\tMenuIcon = \"icon16/bullet_disk.png\",\n\n\t\tFilter = function(self, ent, pl)\n\t\t\treturn IsValid(ent) and pl:IsSuperAdmin() and ent:GetClass() == class\n\t\tend,\n\t\tAction = function(self, ent)\n\t\t\tself:MsgStart()\n\t\t\t\tnet.WriteEntity( ent )\n\t\t\tself:MsgEnd()\n\t\tend,\n\t\tReceive = function(self, length, pl)\n\t\t\tlocal ent = net.ReadEntity()\n\t\t\tif not self:Filter(ent, pl) then return end\n\n\t\t\tif ent.permaSentUID then\n\t\t\t\tpl:ChatPrint(\"Р­С‚Р° СЌРЅС‚РёС‚Рё СѓР¶Рµ СЃРѕС…СЂР°РЅРµРЅР°. РЈРґР°Р»РёС‚Рµ Рё СЃРѕС…СЂР°РЅРёС‚Рµ Р·Р°РЅРѕРІРѕ, РµСЃР»Рё С…РѕС‚РёС‚Рµ РїРµСЂРµРјРµСЃС‚РёС‚СЊ\")\n\t\t\t\treturn\n\t\t\tend\n\n\t\t\tlocal uid = math.random(0xFFFF)\n\t\t\tcookie.Set(\"perma_\" .. class .. \"_\" .. uid, util.TableToJSON({ent:GetPos(), ent:GetAngles()}))\n\t\t\tpl:ChatPrint(\"РџРѕР·РёС†РёСЏ СЃРѕС…СЂР°РЅРµРЅР° РїРѕРґ UID \" .. uid)\n\t\t\tent.permaSentUID = uid\n\n\t\t\tupdateIndex(uid, class)\n\t\tend\n\t})\n\n\tproperties.Add(class .. \"_perma_delete\", {\n\t\tMenuLabel = \"РЈРґР°Р»РёС‚СЊ СЃ РєР°СЂС‚С‹\",\n\t\tOrder = 856,\n\t\tMenuIcon = \"icon16/bin_closed.png\",\n\n\t\tFilter = function(self, ent, pl)\n\t\t\treturn IsValid(ent) and pl:IsSuperAdmin() and ent:GetClass() == class\n\t\tend,\n\t\tAction = function(self, ent)\n\t\t\tself:MsgStart()\n\t\t\t\tnet.WriteEntity( ent )\n\t\t\tself:MsgEnd()\n\t\tend,\n\t\tReceive = function(self, length, pl)\n\t\t\tlocal ent = net.ReadEntity()\n\t\t\tif not self:Filter(ent, pl) then return end\n\n\t\t\tif not ent.permaSentUID then\n\t\t\t\tpl:ChatPrint(\"Р­С‚Р° СЌРЅС‚РёС‚Рё РЅРµ РїРµСЂРјР°РЅРµРЅС‚РЅР°СЏ\")\n\t\t\t\treturn\n\t\t\tend\n\n\t\t\tlocal uid  = ent.permaSentUID\n\t\t\tcookie.Set(\"perma_\" .. class .. \"_\" .. uid, nil)\n\t\t\tpl:ChatPrint(\"РћР±СЉРµРєС‚ СѓРґР°Р»РµРЅ. UID Р±С‹Р» \" .. uid)\n\t\t\tent:Remove()\n\n\t\t\tupdateIndex(uid, nil)\n\t\tend\n\t})\nend\n\nif SERVER then\n\thook.Add(\"IGS.Loaded\", \"IGS.PermaSents\", function()\n\ttimer.Simple(30, function()\n\t\tfor _, ent in ipairs(ents.GetAll()) do\n\t\t\tif ent.permaSentUID then\n\t\t\t\tent:Remove()\n\t\t\tend\n\t\tend\n\n\t\tlocal map = getIndex()\n\t\tfor uid,class in pairs(map) do\n\t\t\tif not scripted_ents.GetStored(class) then\n\t\t\t\tprint(\"IGS.PermaSents: \" .. class .. \" РЅРµ СЃСѓС‰РµСЃС‚РІСѓРµС‚ РЅР° СЃРµСЂРІРµСЂРµ\")\n\t\t\t\tcontinue\n\t\t\tend\n\n\t\t\tlocal dat = util.JSONToTable(cookie.GetString(\"perma_\" .. class .. \"_\" .. uid))\n\t\t\tlocal ent = SpawnSent(class, util.StringToType(dat[1], \"Vector\"), util.StringToType(dat[2], \"Angle\"))\n\t\t\tent.permaSentUID = uid\n\n\t\t\tprint(\"IGS.PermaSents: Р—Р°СЃРїР°РІРЅРёР»Рё \" .. class)\n\t\tend\n\tend)\n\tend)\nend\n","igs/dependencies/plurals.lua":  "if TRIGON then return end\n\nlocal function plural_type(i)\n\treturn i % 10 == 1 and i % 100 ~= 11 and 1\n\t\tor (i % 10 \u003e= 2 and i % 10 \u003c= 4 and (i % 100 \u003c 10 or i % 100 \u003e= 20) and 2\n\t\t\tor 3\n\t\t)\nend\n\n\nPL = PL or setmetatable({\n\tlist = {}\n},{__call = function(self,name,i)\n\treturn self.Get(name,i)\nend})\n\nlocal mt = {__call = function(self,i)\n\tlocal pl = self[ plural_type(i) ]\n\treturn i .. \" \" .. pl, pl\nend}\n\n\n\n\nfunction PL.Add(name,plurals)\n\tPL.list[name] = setmetatable(plurals,mt)\n\treturn PL.list[name]\nend\n\nfunction PL.Get(name,i)\n\treturn PL.list[name](i)\nend","igs/dependencies/resources.lua":  "-- FontAwesome 32\n-- https://steamcommunity.com/sharedfiles/filedetails/?id=1562487365\n-- /materials/icons/fa32/{icon_name}.png\nresource.AddWorkshop(\"1562487365\")\n\n-- resource.AddWorkshop(\"577994158\") -- РјРѕРґРµР»Рё РїРѕРґР°СЂРєРѕРІ\n-- \"models/christmas_gift2/christmas_gift.mdl\"\n-- \"models/christmas_gift2/christmas_gift2.mdl\"","igs/dependencies/scc.lua":  "-- Simple Chat Commands\n-- Special for IGS by _AMD_\n-- 2019.11.08 01:47\n\nscc = {\n\tcommands = {},\n}\n\nif SERVER then\n\tutil.AddNetworkString(\"scc.run\")\nend\n\nfunction scc.add(command, callback)\n\tscc.commands[command:lower()] = callback\nend\n\nfunction scc.run(pl, command, args)\n\tlocal callback = scc.commands[command:lower()]\n\tcallback(pl, unpack(args or {}))\nend\n\n\nif SERVER then\n\thook.Add(\"PlayerSay\", \"scc\", function(pl, text)\n\t\ttext = text:Trim()\n\t\tif text[1] == \"/\" then\n\t\t\tlocal pieces  = text:Split(\" \")\n\t\t\tlocal command = pieces[1]:sub(2):lower()\n\n\t\t\tif scc.commands[command] then\n\t\t\t\tlocal args = {}\n\t\t\t\tfor i = 2,#pieces do\n\t\t\t\t\targs[#args + 1] = pieces[i]\n\t\t\t\tend\n\n\t\t\t\tscc.run(pl, command, args)\n\t\t\t\treturn \"\"\n\t\t\tend\n\t\tend\n\tend)\nend\n\n\n--[[-------------------------------------------------------------------------\n---------------------------------------------------------------------------]]\n\nlocal PLAYER = FindMetaTable(\"Player\")\nfunction PLAYER:RunSCC(command, ...)\n\tscc.run(self, command, {...})\nend\n\n-- function scc.addWithCooldown(cooldown, command, callback)\n-- \tlocal runIfNotCooldown = function(pl, ...)\n-- \t\tif !pl.sccLastRun then pl.sccLastRun = {} end\n-- \t\tif CurTime() - (pl.sccLastRun[command] or 0) \u003e= cooldown then\n-- \t\t\tpl.sccLastRun[command] = CurTime()\n-- \t\t\tcallback(pl, ...)\n-- \t\tend\n-- \tend\n\n-- \tscc.add(command, runIfNotCooldown)\n-- end\n\nif SERVER then\n\tutil.AddNetworkString(\"scc.run\")\nelse\n\tnet.Receive(\"scc.run\", function()\n\t\tlocal command = net.ReadString()\n\t\tlocal args = {}\n\t\tfor i = 1, net.ReadUInt(4) do\n\t\t\targs[i] = net.ReadString()\n\t\tend\n\n\t\tscc.run(LocalPlayer(), command, args)\n\tend)\nend\n\nfunction scc.addClientside(command, callback)\n\tlocal runOnClient = SERVER and function(pl, ...)\n\t\tlocal args = {...}\n\t\tnet.Start(\"scc.run\")\n\t\t\tnet.WriteString(command)\n\t\t\tnet.WriteUInt(#args, 4)\n\t\t\tfor _,arg in ipairs(args) do\n\t\t\t\tnet.WriteString(arg)\n\t\t\tend\n\t\tnet.Send(pl)\n\tend or callback\n\n\tscc.add(command, runOnClient)\nend\n","igs/dependencies/stack.lua":  "local link = {}\nlocal mt = {\n\t__index = link,\n}\n\nfunction link:length()\n\treturn self.tail - self.head + 1\nend\n\nfunction link:isempty()\n\treturn self:length() == 0\nend\n\n\nfunction link:peek()\n\treturn self.data[self.head]\nend\n\nfunction link:lpush(v)\n\tself.tail = self.tail + 1\n\tself.data[self.tail] = v\nend\n\nfunction link:rpush(v)\n\tself.head = self.head - 1\n\tself.data[self.head] = v\nend\n\nfunction link:lpop()\n\tif self.head \u003e self.tail then return nil end\n\tlocal v = self.data[self.tail]\n\tself.data[self.tail] = nil\n\tself.tail = self.tail - 1\n\treturn v\nend\n\nfunction link:rpop()\n\tif self.head \u003e self.tail then return nil end\n\tlocal v = self.data[self.head]\n\tself.data[self.head] = nil\n\tself.head = self.head + 1\n\treturn v\nend\n\nfunction IGStack(...)\n\treturn setmetatable({\n\t\thead = 1,\n\t\ttail = select(\"#\",...),\n\t\tdata = {...},\n\t}, mt)\nend\n\n\n-- local S = IGStack()\n-- S:lpush(1) S:lpush(2) S:lpush(3) -- 3 \u003c 2 \u003c 1\n-- PRINT({len = S:length(), head = S:rpop(), tail = S:lpop()}) -- 1 3\n-- S:rpush(1) S:lpush(3) S:lpush(4) -- РІРµСЂРЅСѓР»Рё, С‡С‚Рѕ Р·Р°Р±СЂР°Р»Рё Рё РґРѕР±Р°РІРёР»Рё СЃР»РµРІР° 4\n-- PRINT({len = S:length(), head = S:rpop(), all = S:table()})\n","igs/extensions/badmin.lua":  "IGS.BADMIN_GROUPS = IGS.BADMIN_GROUPS or {}\n\nlocal STORE_ITEM = FindMetaTable(\"IGSItem\")\n\nfunction STORE_ITEM:SetBAdminGroup(rank, rank_priority)\n\tlocal rankId = ba.ranks.Get(rank):GetID()\n\tIGS.BADMIN_GROUPS[rankId] = rank_priority or 0\n\n\tself:SetInstaller(function(pl)\n\t\tpl:SetNetVar(\"UserGroup\", rankId)\n\tend)\n\tself:SetValidator(function(pl)\n\t\tlocal current_rank     = pl:GetNetVar(\"UserGroup\")\n\t\tlocal current_priority = IGS.BADMIN_GROUPS[current_rank]\n\t\tif not current_priority then return end -- СЂР°РЅРіР° РёРіСЂРѕРєР° РЅРµС‚ РІ РїСЂРѕРґР°Р¶Рµ. РќРµ СЃР±СЂР°СЃС‹РІР°РµРј\n\n\t\treturn current_priority \u003e= rank_priority -- РјРµРЅСЏРµРј, РµСЃР»Рё РІРµСЃ С‚РµРєСѓС‰РµР№ РјРµРЅСЊС€Рµ, С‡РµРј РЅРѕРІРѕР№\n\tend)\n\treturn self\nend\n","igs/extensions/bwhitelist.lua":  "IGS.ITEMS.Whitelist = IGS.ITEMS.Whitelist or {}\n\nlocal STORE_ITEM = FindMetaTable(\"IGSItem\")\n\nlocal function team_id(team_cmd)\n\treturn DarkRP.getJobByCommand(team_cmd).team\nend\n\nfunction STORE_ITEM:SetWhitelist(team_cmd)\n\tself:SetCategory(\"Р’Р°Р№С‚Р»РёСЃС‚С‹\")\n\tself:SetCanActivate(function(pl)\n\t\tif GAS.JobWhitelist:IsWhitelisted(pl, team_id(team_cmd)) then\n\t\t\treturn \"Р’С‹ РІ РІР°Р№С‚Р»РёСЃС‚Рµ\"\n\t\tend\n\tend)\n\tself:SetInstaller(function(pl)\n\t\tGAS.JobWhitelist:AddToWhitelist(team_id(team_cmd), GAS.JobWhitelist.LIST_TYPE_STEAMID, pl:SteamID())\n\tend)\n\tself:SetValidator(function(pl)\n\t\treturn GAS.JobWhitelist:IsWhitelisted(pl, team_id(team_cmd))\n\tend)\n\n\tself.whitelist = self:Insert(IGS.ITEMS.Whitelist, team_cmd) -- not team_id РёР·-Р·Р° DarkRP = nil РЅР° СЌС‚РѕРј СЌС‚Р°РїРµ\n\treturn self\nend\n\nif SERVER then\n\thook.Add(\"IGS.PlayerPurchasesLoaded\", \"IGS.bWhitelist\", function(pl)\n\t\tfor team_cmd,_ in pairs(IGS.ITEMS.Whitelist) do\n\t\t\tGAS.JobWhitelist:RemoveFromWhitelist(team_id(team_cmd), GAS.JobWhitelist.LIST_TYPE_STEAMID, pl:SteamID())\n\t\tend\n\tend)\nend\n","igs/extensions/darkrp.lua":  "IGS.ITEMS.DRP = IGS.ITEMS.DRP or {\n\tITEMS = {},\n\tJOBS  = {}\n}\n\n\nlocal STORE_ITEM = FindMetaTable(\"IGSItem\")\n\n-- Р”РµР»Р°РµС‚ РёС‚РµРј РІ РјР°РіР°Р·РёРЅРµ РїРѕРєСѓРїР°РµРјС‹Рј С‚РѕР»СЊРєРѕ Р·Р° РґРѕРЅР°С‚\n-- Р­С‚Рѕ РјРѕР¶РµС‚ Р±С‹С‚СЊ СЏС‰РёРє РѕСЂСѓР¶РёСЏ, РѕС‚РґРµР»СЊРЅР°СЏ РїСѓС€РєР° РёР»Рё РґР°Р¶Рµ РѕС‚РґРµР»СЊРЅР°СЏ СЌРЅС‚РёС‚Рё\nfunction STORE_ITEM:SetDarkRPItem(sEntClass)\n\tself.dpr_item = self:Insert(IGS.ITEMS.DRP.ITEMS, sEntClass)\n\treturn self\nend\n\n-- Р”РѕСЃС‚СѓРї Рє РїСЂРѕС„РµСЃСЃРёСЏРј С‚РѕР»СЊРєРѕ С‚РµРј, РєС‚Рѕ РµРµ РїРѕРєСѓРїР°Р»\nfunction STORE_ITEM:SetDarkRPTeams(...)\n\t-- https://trello.com/c/xxGiGpb2/319-СѓР»СѓС‡С€РёС‚СЊ-setdarkrpteam\n\tlocal tTeams = {...}\n\tfor i,team in ipairs(tTeams) do\n\t\tif isnumber(team) then -- РѕР±СЂР°С‚РЅР°СЏ СЃРѕРІРјРµСЃС‚РёРјРѕСЃС‚СЊ (20.03.2019)\n\t\t\tlocal TEAM = RPExtraTeams[team]\n\t\t\tself:Insert(IGS.ITEMS.DRP.JOBS, TEAM.command)\n\t\t\ttTeams[i] = TEAM.command -- Р·Р°РјРµРЅСЏРµРј ENUM РЅР° cmd РґР»СЏ ITEM.dpr_teams\n\t\telse -- СЃС‚СЂРѕРєР° (team.command) https://trello.com/c/BcbYbAb7/512\n\t\t\tself:Insert(IGS.ITEMS.DRP.JOBS, team)\n\t\tend\n\tend\n\tself.dpr_teams = tTeams\n\treturn self\nend\nSTORE_ITEM.SetDarkRPTeam = STORE_ITEM.SetDarkRPTeams -- РѕР±СЂР°С‚РЅР°СЏ СЃРѕРІРјРµСЃС‚РёРјРѕСЃС‚СЊ (20.03.2019)\n\nfunction STORE_ITEM:SetDarkRPMoney(iSum)\n\tself:SetDescription(\"РњРіРЅРѕРІРµРЅРЅРѕ Рё Р±РµР· РїСЂРѕР±Р»РµРј РїРѕРїРѕР»РЅСЏРµС‚ Р±Р°Р»Р°РЅСЃ РёРіСЂРѕРІРѕР№ РІР°Р»СЋС‚С‹ РЅР° \" .. string.Comma(iSum) .. \" РІР°Р»СЋС‚С‹\")\n\tself:SetInstaller(function(pl) pl:addMoney(iSum,\"IGS\") end)\n\tself:SetStackable()\n\n\tself.dpr_money = iSum\n\treturn self\nend\n\nhook.Add(\"canBuyShipment\", \"IGS\", function(pl, tItem)\n\tlocal ITEM = IGS.PlayerHasOneOf(pl, IGS.ITEMS.DRP.ITEMS[tItem.entity])\n\tif ITEM ~= nil then -- РґРѕРЅР°С‚РЅС‹Р№ РёС‚РµРј\n\t\tlocal allow, message = hook.Run(\"IGS.canBuyShipment\", pl, tItem)\n\t\treturn allow or tobool(ITEM), false, message or \"Р­С‚Рѕ РґР»СЏ РґРѕРЅР°С‚РµСЂРѕРІ (/donate)\"\n\tend\nend)\n\nhook.Add(\"canBuyPistol\", \"IGS\", function(pl, tItem)\n\tlocal ITEM = IGS.PlayerHasOneOf(pl, IGS.ITEMS.DRP.ITEMS[tItem.entity])\n\tif ITEM ~= nil then -- РґРѕРЅР°С‚РЅС‹Р№ РёС‚РµРј\n\t\tlocal allow, message = hook.Run(\"IGS.canBuyPistol\", pl, tItem)\n\t\treturn allow or tobool(ITEM), false, message or \"Р­С‚Рѕ РґР»СЏ РґРѕРЅР°С‚РµСЂРѕРІ (/donate)\"\n\tend\nend)\n\n-- РІ DarkRP.hooks РЅРµС‚ С‚Р°РєРѕРіРѕ\n-- https://img.qweqwe.ovh/1528097550183.png\nhook.Add(\"canBuyCustomEntity\", \"IGS\", function(pl, tItem)\n\tlocal ITEM = IGS.PlayerHasOneOf(pl, IGS.ITEMS.DRP.ITEMS[tItem.ent])\n\tif ITEM ~= nil then -- РґРѕРЅР°С‚РЅС‹Р№ РёС‚РµРј\n\t\tlocal allow, message = hook.Run(\"IGS.canBuyCustomEntity\", pl, tItem)\n\t\treturn allow or tobool(ITEM), false, message or \"Р­С‚Рѕ РґР»СЏ РґРѕРЅР°С‚РµСЂРѕРІ (/donate)\"\n\tend\nend)\n\n-- РЅРµС‚ suppress\n-- print(IGS.PlayerHasOneOf(AMD(), IGS.ITEMS.DRP.JOBS[TEAM_LOCK]))\nhook.Add(\"playerCanChangeTeam\", \"IGS\", function(pl, iTeam, bForce)\n\tlocal TEAM = RPExtraTeams[iTeam]\n\tlocal ITEM = IGS.PlayerHasOneOf(pl, IGS.ITEMS.DRP.JOBS[TEAM.command])\n\tif ITEM ~= nil then -- РґРѕРЅР°С‚РЅС‹Р№ РёС‚РµРј\n\t\tlocal allow, message = hook.Run(\"IGS.playerCanChangeTeam\", pl, iTeam, bForce)\n\t\treturn allow or tobool(ITEM), message or \"Р­С‚Рѕ РґР»СЏ РґРѕРЅР°С‚РµСЂРѕРІ (/donate)\"\n\tend\nend)\n\n\n-- Hunger\nfunction STORE_ITEM:DisablePlayerHunger()\n\treturn self:SetInstaller(function(pl)\n\t\tpl.igs_disable_hunger = true\n\tend):SetValidator(function(pl)\n\t\treturn false\n\tend)\nend\n\nhook.Add(\"hungerUpdate\", \"IGS\", function(pl)\n\tif pl.igs_disable_hunger then\n\t\tpl:setSelfDarkRPVar(\"Energy\", 100)\n\t\treturn true\n\tend\nend)\n","igs/extensions/evolve.lua":  "local ITEM = FindMetaTable(\"IGSItem\")\n\nfunction ITEM:SetEvolveRank(rank)\n\treturn self:SetInstaller(function(pl)\n\t\tevolve.PlayerInfo[pl:UniqueID()][\"Rank\"] = rank\n\tend):SetValidator(function(pl)\n\t\treturn evolve.PlayerInfo[pl:UniqueID()][\"Rank\"] == rank\n\tend):SetMeta(\"ev_rank\", rank)\nend\n","igs/extensions/extra.lua":  "local STORE_ITEM = FindMetaTable(\"IGSItem\")\n\nfunction STORE_ITEM:SetMaxGlobalPurchases(iMax)\n\tIGS.nw.Register(\"total_purchases_\" .. self:UID()) -- С‚РѕР»СЊРєРѕ РІРЅСѓС‚СЂРё С…СѓРєР° СЋР·\n\t\t:Write(net.WriteUInt, 8)\n\t\t:Read(net.ReadUInt, 8)\n\t:SetGlobal():SetHook(\"total_purchases_\" .. self:UID())\n\n\tif CLIENT then -- #todo nw РЅРµ РїРѕР·РІРѕР»СЏРµС‚, РЅРѕ РЅСѓР¶РЅРѕ СЃРґРµР»Р°С‚СЊ РћР”РРќ РєР»РёРµРЅС‚СЃРєРёР№ С…СѓРє\n\t\thook.Add(\"total_purchases_\" .. self:UID(), self:UID(), function(purchased)\n\t\t\tif self.user_icon == nil then -- С‡С‚РѕР±С‹ РїСЂРѕ Р»СѓР° СЂРµС„СЂРµС€Рµ РЅРµ СЃС‚Р°Р»Рѕ true\n\t\t\t\tself.user_icon = tobool(self.icon) -- bool РІРјРµСЃС‚Рѕ СЃСЃС‹Р»РєРё. РќСѓР¶РµРЅ, С‡С‚РѕР±С‹ РЅРµ РѕРІРµСЂСЂР°Р№РґРёС‚СЊ СЋР·РµСЂСЃРєРёРµ РёРєРѕРЅРєРё\n\t\t\tend\n\t\t\tif not self.user_icon then\n\t\t\t\tlocal left = iMax - purchased\n\t\t\t\tlocal icon = left \u003c= 0 and \" 0 \" or left -- РїРѕС‚РѕРјСѓ С‡С‚Рѕ 0 СЃР°Р№С‚ РЅРµ РїРµСЂРµР¶РµРІС‹РІР°РµС‚\n\t\t\t\tself:SetIcon(\"https://via.placeholder.com/90x90.png?text=\" .. icon)\n\t\t\tend\n\n\t\t\tif purchased \u003e= iMax then\n\t\t\t\tself:SetHidden()\n\t\t\tend\n\t\tend)\n\telse\n\t\tlocal purchased = bib.getNum(\"igs:total_purchases:\" .. self:UID())\n\t\tIGS.nw.SetGlobal(\"total_purchases_\" .. self:UID(), purchased or 0)\n\tend\n\n\treturn self:SetMeta(\"global_limit\", iMax)\nend\n\nhook.Add(\"IGS.CanPlayerBuyItem\", \"GlobalLimit\", function(_, ITEM)\n\tif SERVER and ITEM:GetMeta(\"global_limit\") then\n\t\tlocal limit     = ITEM:GetMeta(\"global_limit\")\n\t\tlocal purchased = bib.getNum(\"igs:total_purchases:\" .. ITEM:UID(), 0)\n\n\t\tif purchased \u003e= limit then\n\t\t\treturn false, \"Р­С‚РѕС‚ РїСЂРµРґРјРµС‚ Р·Р°РєРѕРЅС‡РёР»СЃСЏ\"\n\t\tend\n\tend\nend)\n\nhook.Add(\"IGS.PlayerPurchasedItem\", \"GlobalLimit\", function(_, ITEM)\n\tif SERVER and ITEM:GetMeta(\"global_limit\") then\n\t\tlocal limit     = ITEM:GetMeta(\"global_limit\")\n\t\tlocal purchased = bib.getNum(\"igs:total_purchases:\" .. ITEM:UID(), 0)\n\n\t\tbib.setNum(\"igs:total_purchases:\"   .. ITEM:UID(), purchased + 1)\n\t\tIGS.nw.SetGlobal(\"total_purchases_\" .. ITEM:UID(), purchased + 1)\n\n\t\tif purchased \u003e= limit then\n\t\t\tITEM:SetHidden()\n\t\tend\n\tend\nend)\n\n\n\n\n-- Р’РѕР·РІРѕР»СЏРµС‚ РЅР°СЃС‚СЂРѕРёС‚СЊ РјР°РєСЃРёРјР°Р»СЊРЅРѕРµ РєРѕР»РёС‡РµСЃС‚РІРѕ РџРћРљРЈРџРћРљ РѕРґРЅРѕРіРѕ РїСЂРµРґРјРµС‚Р°\n-- РџРѕР»РµР·РЅРѕ РґР»СЏ С‚РµСЃС‚РѕРІС‹С… РІРёРїРѕРє Р·Р° СЂСѓР±Р»СЊ Рё С‚Рґ\nfunction STORE_ITEM:SetMaxPlayerPurchases(iLimit)\n\tlocal function bibKey(pid, iid) return string.format(\"igs:purchases:%s:%s\", pid, iid) end\n\n\treturn self:SetCanBuy(function(pl)\n\t\tlocal limit = self:GetMeta(\"purchasesLimit\")\n\t\tlocal key = bibKey(pl:UniqueID(), self:UID())\n\t\tif bib.getNum(key, 0) \u003e= limit then\n\t\t\treturn \"Р­С‚РѕС‚ РїСЂРµРґРјРµС‚ РјРѕР¶РЅРѕ РєСѓРїРёС‚СЊ С‚РѕР»СЊРєРѕ \" .. limit .. \" СЂР°Р·(Р°)\"\n\t\tend\n\tend):SetOnBuy(function(pl)\n\t\tlocal limit = self:GetMeta(\"purchasesLimit\")\n\t\tif limit then\n\t\t\tlocal key = bibKey(pl:UniqueID(), self:UID())\n\t\t\tlocal now_purchased = bib.getNum(key, 0) + 1\n\t\t\tbib.setNum(key, now_purchased)\n\t\t\tIGS.Notify(pl, \"Р’С‹ РєСѓРїРёР»Рё \" .. self:Name() .. \" \" .. now_purchased .. \" СЂР°Р· РёР· \" .. limit)\n\t\tend\n\tend):SetMeta(\"purchasesLimit\", iLimit)\nend\n\n\n\n\n-- Р“Р»РѕР±Р°Р»СЊРЅС‹Рµ РёС‚РµРјС‹ Р±СѓРґСѓС‚ Р°РєС‚РёРІРёСЂРѕРІР°РЅС‹ РЅР° РєР°Р¶РґРѕРј СЃРµСЂРІРµСЂРµ РїСЂРѕРµРєС‚Р°\n-- https://img.qweqwe.ovh/1574888071533.png\nfunction STORE_ITEM:SetGlobal(b)\n\treturn self:SetMeta(\"global\", b ~= false)\nend\n\nhook.Add(\"IGS.PlayerActivatedItem\", \"IGS.GlobalPurchase\", function(pl, ITEM)\n\tif SERVER and ITEM:GetMeta(\"global\") then\n\t\tfor sv_id in pairs(IGS.SERVERS.MAP) do\n\t\t\tif sv_id == IGS.SERVERS.CURRENT then continue end -- СѓР¶Рµ РІС‹РґР°РЅРѕ\n\t\t\tIGS.StorePurchase(pl:SteamID64(), ITEM:UID(), ITEM:Term(), sv_id)\n\t\tend\n\t\tIGS.Notify(pl, \"РџСЂРµРґРјРµС‚ РІС‹РґР°РЅ РЅР° \" .. IGS.SERVERS.TOTAL .. \" СЃРµСЂРІРµСЂР°С…\")\n\tend\nend)\n\n-- Р’С‹РґР°РµС‚ СЂР°РЅРґРѕРјРЅС‹Р№ РїСЂРµРґРјРµС‚ РёР· СѓРєР°Р·Р°РЅРЅС‹С… (Р°РЅР°Р»РѕРі РєРµР№СЃРѕРІ)\n-- https://trello.com/c/hWRihJ1k/564\n-- Р—Р°РјРµС‚РєР°, РїРѕС‡РµРјСѓ РЅРµ РЅСѓР¶РЅРѕ РґРµР»Р°С‚СЊ tItemsUIDs\n-- https://img.qweqwe.ovh/1568507799904.png\n-- РСЃРїРѕР»СЊР·РѕРІР°С‚СЊ С‚РѕР»СЊРєРѕ СЃ :SetStackable РїСЂРµРґРјРµС‚Р°РјРё\nlocal function giveRandomItem(pl, tItems)\n\tlocal WINNED_ITEM = table.Random(tItems)\n\n\tIGS.PlayerActivateItem(pl, WINNED_ITEM:UID(), function()\n\t\tIGS.Notify(pl, \"Р’С‹ РїРѕР»СѓС‡РёР»Рё \" .. WINNED_ITEM:Name())\n\tend)\nend\n\n-- РЎРѕС‡РµС‚Р°РµС‚СЃСЏ СЃ :SetTerm(0), :SetMaxPurchases() Рё :SetStackable()\nfunction STORE_ITEM:SetRandom(tItems)\n\treturn self:SetInstaller(function(pl)\n\t\tgiveRandomItem(pl, self:GetMeta(\"random_items\"))\n\tend):SetMeta(\"random_items\", tItems)\nend\n\n\nlocal function giveItemsSet(pl, tItems)\n\tlocal added = 0\n\tfor _,ITEM in ipairs(tItems) do\n\t\tIGS.AddToInventory(pl, ITEM:UID(), function()\n\t\t\tadded = added + 1\n\t\t\tif added == #tItems then\n\t\t\t\tIGS.Notify(pl, \"Р’ РІР°С€ РёРЅРІРµРЅС‚Р°СЂСЊ РґРѕР±Р°РІР»РµРЅРѕ \" .. added .. \" РїСЂРµРґРјРµС‚РѕРІ\")\n\t\t\tend\n\t\tend)\n\tend\nend\n\n-- Р›РѕР¶РёС‚ Р’ РРќР’Р•РќРўРђР Р¬ РЅР°Р±РѕСЂ СѓРєР°Р·Р°РЅРЅС‹С… РїСЂРµРґРјРµС‚РѕРІ (С…РѕС‚СЏ РјРѕР¶РЅРѕ Рё UID РґРѕР±Р°РІРёС‚СЊ)\n-- РќР°РїСЂРёРјРµСЂ 10 Hidden Р°РїС‚РµС‡РµРє (РєР°Рє Р·Р°РјРµРЅР° Р»РёРјРёС‚Сѓ Р°РєС‚РёРІР°С†РёР№ РІ РёРЅРІРµРЅС‚Р°СЂРµ)\nfunction STORE_ITEM:SetItems(tItems) -- IGS.C.Inv_Enabled\n\treturn self:SetInstaller(function(pl)\n\t\tgiveItemsSet(pl, self:GetMeta(\"items_set\"))\n\tend):SetMeta(\"items_set\", tItems)\nend\n-- local ITEM = IGS(\"РўР°Р№РЅС‹Р№ РїСЂРµРґРјРµС‚\", \"secret\", -10):SetStackable():SetHidden():SetOnActivate(fp{PRINT, \"YEAH!!\"})\n-- IGS(\"2 С‚Р°Р№РЅС‹С… РїСЂРµРґРјРµС‚Р°\", \"secret_2\", 5):SetStackable():SetItems({ITEM, ITEM})\n\n\n\n\n--[[-------------------------------------------------------------------------\n\tРЎРµРєС†РёСЏ СЃ РІРѕР·РјРѕР¶РЅС‹Рј РїРµСЂРµРјРµС‰РµРЅРёРµРј РІ СЏРґСЂРѕ\n\tРџРµСЂРµРјРµСЃС‚РёС‚СЊ, РµСЃР»Рё AddHook Р±СѓРґРµС‚ РІРѕСЃС‚СЂРµР±РѕРІР°РЅ РґР»СЏ Р·Р°РјРµРЅС‹ РєР°РєРёС…-С‚Рѕ РјРµС‚РѕРґРѕРІ СЏРґСЂР°\n---------------------------------------------------------------------------]]\n\n-- Р”РѕР»Р¶РЅРѕ РёСЃРїРѕР»СЊР·РѕРІР°С‚СЊ С‚РѕР»СЊРєРѕ С‚Рµ С…СѓРєРё,\n-- РіРґРµ РїРµСЂРІС‹Рј Р°СЂРіСѓРјРµРЅС‚РѕРј РІ РєРѕР»Р±РµРєРµ РёРґРµС‚ РёРіСЂРѕРє\n-- ITEM:AddHook(\"PlayerLoadout\", funciton(pl) pl:GiveAmmos() end)\nfunction STORE_ITEM:AddHook(sHook, fCallback)\n\tlocal uid = self:UID()\n\thook.Add(sHook, \"item.\" .. uid, function(pl, ...)\n\t\tif pl:HasPurchase(uid) then\n\t\t\tfCallback(pl, ...)\n\t\tend\n\tend)\n\treturn self\nend\n","igs/extensions/fadmin.lua":  "-- РљС‚Рѕ-С‚Рѕ РёСЃРїРѕР»СЊР·СѓРµС‚ FAdmin, РєР°Рє РѕС‚РґРµР»СЊРЅС‹Р№ Р°РґРґРѕРЅ Рє РґСЂСѓРіРёРј РіРµР№РјРјРѕРґР°Рј? Рћ_Рѕ\n\nlocal STORE_ITEM = FindMetaTable(\"IGSItem\")\n\nlocal function getGroupImmunity(group)\n\tif not FAdmin or not FAdmin.Access or not FAdmin.Access.Groups then return nil end\n\tlocal g = FAdmin.Access.Groups[group]\n\treturn g and g.immunity\nend\n\nlocal function setGroupWithCAMI(pl, newGroup)\n\tif not IsValid(pl) then return end\n\tif not FAdmin or not FAdmin.Access or not FAdmin.Access.Groups then return end\n\tif not FAdmin.Access.Groups[newGroup] then return end\n\n\tlocal oldGroup = pl:GetUserGroup()\n\tif oldGroup == newGroup then return end\n\n\tFAdmin.Access.PlayerSetGroup(pl, newGroup)\n\n\t-- РЎРѕС…СЂР°РЅСЏРµРј РІ FAdmin_PlayerGroup (С‡РµСЂРµР· CAMI С…СѓРє), С‡С‚РѕР±С‹ РїРµСЂРµР¶РёРІР°Р»Рѕ РїРµСЂРµР·Р°С…РѕРґ\n\tif CAMI and CAMI.SignalUserGroupChanged then\n\t\tCAMI.SignalUserGroupChanged(pl, oldGroup, newGroup, \"IGS\")\n\tend\nend\n\nfunction STORE_ITEM:SetFAdminGroup(sGroup, iWeight)\n\t-- Р—Р°РїРѕРјРёРЅР°РµРј РіСЂСѓРїРїСѓ РґР»СЏ РїРѕСЃР»РµРґСѓСЋС‰РµРіРѕ РІРѕСЃСЃС‚Р°РЅРѕРІР»РµРЅРёСЏ\n\tif SERVER then\n\t\tself:SetMeta(\"fadmin_group\", sGroup)\n\tend\n\n\treturn self:SetInstaller(function(pl)\n\t\t-- РќРµ РїРѕРЅРёР¶Р°РµРј РїСЂРёРІРёР»РµРіРёРё: РµСЃР»Рё С‚РµРєСѓС‰Р°СЏ РІС‹С€Рµ РёР»Рё СЂР°РІРЅР°, РїСЂРѕРїСѓСЃРєР°РµРј\n\t\tlocal curGroup = pl:GetUserGroup()\n\t\tlocal curImm   = getGroupImmunity(curGroup)\n\t\tlocal newImm   = getGroupImmunity(sGroup)\n\n\t\tif curImm and newImm and curImm \u003e= newImm then\n\t\t\treturn\n\t\tend\n\n\t\tsetGroupWithCAMI(pl, sGroup)\n\t\tpl.IGSFAdminWeight = iWeight\n\tend):SetValidator(function(pl)\n\t\t-- Р•СЃР»Рё СѓР¶Рµ РІ РЅСѓР¶РЅРѕР№ РіСЂСѓРїРїРµ вЂ” РѕРє\n\t\tif pl:IsUserGroup(sGroup) then\n\t\t\treturn true\n\t\tend\n\n\t\t-- РџСЂРѕРІРµСЂСЏРµРј РёРјРјСѓРЅРёС‚РµС‚С‹ РёР· DarkRP/FAdmin\n\t\tlocal curImm = getGroupImmunity(pl:GetUserGroup())\n\t\tlocal newImm = getGroupImmunity(sGroup)\n\t\tif curImm and newImm and curImm \u003e= newImm then\n\t\t\treturn true\n\t\tend\n\n\t\t-- Р¤РѕР»Р±СЌРє РЅР° СЃС‚Р°СЂС‹Рµ РІРµСЃР°, РµСЃР»Рё РёРјРјСѓРЅРёС‚РµС‚РѕРІ РЅРµС‚\n\t\tif pl.IGSFAdminWeight then\n\t\t\treturn iWeight \u003c pl.IGSFAdminWeight\n\t\tend\n\n\t\treturn false\n\tend)\nend\n\n-- Р’РѕСЃСЃС‚Р°РЅРѕРІР»РµРЅРёРµ РјР°РєСЃРёРјР°Р»СЊРЅРѕР№ РєСѓРїР»РµРЅРЅРѕР№ РїСЂРёРІРёР»РµРіРёРё\nif SERVER then\n\tfunction IGS.ApplyBestFAdminGroup(pl, purchases)\n\t\tif not IsValid(pl) then return end\n\t\tif not FAdmin or not FAdmin.Access or not FAdmin.Access.Groups then return end\n\t\tif not purchases then return end\n\n\t\tlocal bestGroup, bestImm\n\n\t\tfor uid in pairs(purchases) do\n\t\t\tlocal ITEM = IGS.GetItemByUID(uid)\n\t\t\tif ITEM and ITEM.GetMeta then\n\t\t\t\tlocal grp = ITEM:GetMeta(\"fadmin_group\")\n\t\t\t\tif grp then\n\t\t\t\t\tlocal imm = getGroupImmunity(grp)\n\t\t\t\t\tif imm and (not bestImm or imm \u003e bestImm) then\n\t\t\t\t\t\tbestImm = imm\n\t\t\t\t\t\tbestGroup = grp\n\t\t\t\t\tend\n\t\t\t\tend\n\t\t\tend\n\t\tend\n\n\t\tif not bestGroup then return end\n\n\t\tlocal curGroup = pl:GetUserGroup()\n\t\tlocal curImm = getGroupImmunity(curGroup)\n\n\t\t-- Р•СЃР»Рё С‚РµРєСѓС‰Р°СЏ РіСЂСѓРїРїР° РЅРёР¶Рµ РєСѓРїР»РµРЅРЅРѕР№ вЂ” РІРѕР·РІСЂР°С‰Р°РµРј РєСѓРїР»РµРЅРЅСѓСЋ\n\t\tif not curImm or (bestImm and bestImm \u003e curImm) then\n\t\t\tsetGroupWithCAMI(pl, bestGroup)\n\t\tend\n\tend\nend\n","igs/extensions/levels.lua":  "--[[-------------------------------------------------------------------------\n\tРџРѕРґРґРµСЂР¶РєР° РІРѕС‚ СЌС‚РѕРіРѕ РіРѕРІРЅРѕРєРѕРґР°:\n\thttps://github.com/vrondakis/Leveling-System\n---------------------------------------------------------------------------]]\nlocal STORE_ITEM = FindMetaTable(\"IGSItem\")\n\nfunction STORE_ITEM:SetLevels(iAmount)\n\treturn self:SetInstaller(function(pl)\n\t\tpl:addLevels(iAmount)\n\tend)\nend\n\nfunction STORE_ITEM:SetEXP(iAmount)\n\treturn self:SetInstaller(function(pl)\n\t\tpl:addXP(iAmount)\n\tend)\nend\n","igs/extensions/pointshop2.lua":  "local STORE_ITEM = FindMetaTable(\"IGSItem\")\n\nfunction STORE_ITEM:SetPremiumPoints(iAmount)\n\treturn self:SetInstaller(function(pl)\n\t\tpl:PS2_AddPremiumPoints(iAmount)\n\tend):SetMeta(\"ps2_prempoints\", iAmount)\nend\n\nfunction STORE_ITEM:SetPoints(iAmount)\n\treturn self:SetInstaller(function(pl)\n\t\tpl:PS2_AddStandardPoints(iAmount, \"/donate\")\n\tend):SetMeta(\"ps2_points\", iAmount)\nend\n","igs/extensions/sam.lua":  "IGS.ITEMS.SAM = IGS.ITEMS.SAM or {\n\tGROUPS = {}\n}\n\nlocal STORE_ITEM = FindMetaTable(\"IGSItem\")\n\nfunction STORE_ITEM:SetSAMGroup(sUserGroup, iGroupWeight)\n\tself:SetCategory(\"SAM (РђРґРјРёРЅРєР°)\")\n\n\tself:SetCanActivate(function(pl) -- global, invDbID\n\t\tif pl:IsUserGroup(sUserGroup) then\n\t\t\treturn \"РЈ РІР°СЃ СѓР¶Рµ РґРµР№СЃС‚РІСѓРµС‚ СЌС‚Р° СѓСЃР»СѓРіР°\"\n\t\tend\n\tend)\n\tself:SetInstaller(function(pl)\n\t\tpl:sam_set_rank(sUserGroup)\n\tend)\n\tself:SetValidator(function(pl)\n\t\tif pl.IGSSAMWeight then\n\t\t\treturn iGroupWeight \u003c pl.IGSSAMWeight\n\t\telse\n\t\t\treturn  pl:GetUserGroup() == sUserGroup\n\t\tend\n\tend)\n\n\n\tself.sg_group = self:Insert(IGS.ITEMS.SAM.GROUPS, sUserGroup)\n\treturn self\nend\n\nif CLIENT then return end\n\nlocal function checkGroups(pl)\n\tlocal hasAccess = IGS.PlayerHasOneOf(pl, IGS.ITEMS.SAM.GROUPS[ pl:GetUserGroup() ])\n\tif hasAccess == nil then return end  -- РЅРµ РѕС‚СЃР»РµР¶РёРІР°РµС‚СЃСЏ\n\n\tif hasAccess then\n\t\treturn -- РµСЃР»Рё РёРјРµРµС‚СЃСЏ С…РѕС‚СЊ РѕРґРЅР° РїРѕРєСѓРїРєР°, С‚Рѕ РЅРµ СЃРЅРёРјР°РµРј РїСЂР°РІР°\n\tend\n\n\tpl:sam_set_rank(\"user\")\nend\n\nhook.Add(\"IGS.PlayerPurchasesLoaded\", \"SAMGroups\", function(pl)\n\tif next(IGS.ITEMS.SAM.GROUPS) then -- РіСЂСѓРїРїС‹ РїСЂРѕРґР°СЋС‚СЃСЏ\n\t\tcheckGroups(pl)\n\tend\nend)\n","igs/extensions/sandbox.lua":  "IGS.ITEMS.SB = IGS.ITEMS.SB or {\n\tTOOLS = {},\n\tSENTS = {},\n\tSWEPS = {},\n\tVEHS  = {}\n}\n\n\nlocal STORE_ITEM = FindMetaTable(\"IGSItem\")\n\n-- РўСѓР»С‹\nfunction STORE_ITEM:SetTool(sToolName)\n\tself:SetCategory(\"РРЅСЃС‚СЂСѓРјРµРЅС‚С‹\")\n\tself:SetDescription(\"Р Р°Р·СЂРµС€Р°РµС‚ РёСЃРїРѕР»СЊР·РѕРІР°С‚СЊ РёРЅСЃС‚СЂСѓРјРµРЅС‚ \" .. sToolName)\n\n\tself.tool = self:Insert(IGS.ITEMS.SB.TOOLS, sToolName)\n\treturn self\nend\n\n-- Р­РЅС‚РёС‚Рё\nfunction STORE_ITEM:SetEntity(sEntClass)\n\tself:SetCategory(\"Р­РЅС‚РёС‚Рё (РџСЂРµРґРјРµС‚С‹)\")\n\n\tself.entity = self:Insert(IGS.ITEMS.SB.SENTS, sEntClass)\n\treturn self\nend\n\n-- РџСѓС€РєРё\nfunction STORE_ITEM:SetWeapon(sWepClass,tAmmo)\n\tself:SetCategory(\"РћСЂСѓР¶РёРµ\")\n\tself:SetDescription(\"Р Р°Р·СЂРµС€Р°РµС‚ СЃРїР°РІРЅРёС‚СЊ \" .. sWepClass .. \" С‡РµСЂРµР· СЃРїР°РІРЅ РјРµРЅСЋ РІ Р»СЋР±РѕРµ РІСЂРµРјСЏ\")\n\n\tself:SetNetworked() -- РґР»СЏ HasPurchase Рё РѕС‚РѕР±СЂР°Р¶РµРЅРёСЏ РіР°Р»РѕС‡РєРё\n\n\tself.ammo = tAmmo\n\tself.swep = self:Insert(IGS.ITEMS.SB.SWEPS, sWepClass)\n\treturn self\nend\n\nif CLIENT then -- :SetWeapon only\nhook.Add(\"IGS.OnItemInfoOpen\",\"CheckGiveWeaponOnSpawn\",function(ITEM, fr)\n\tif !(ITEM.swep and LocalPlayer():HasPurchase(ITEM:UID())) then return end\n\n\tuigs.Create(\"DCheckBoxLabel\", function(self)\n\t\tself:Dock(TOP)\n\t\tself:DockMargin(0,5,0,0)\n\t\tself:SetTall(20)\n\n\t\tlocal should_give = LocalPlayer():GetNWBool(\"igs.gos.\" .. ITEM:ID())\n\t\tself:SetValue(should_give)\n\n\t\tself:SetText(\"Р’С‹РґР°РІР°С‚СЊ РїСЂРё СЃРїР°РІРЅРµ\")\n\t\tself.Label:SetTextColor(IGS.col.TEXT_SOFT)\n\t\tself.Label:SetFont(\"Fated.15\")\n\n\t\tfunction self:OnChange(give)\n\t\t\tnet.Start(\"IGS.GiveOnSpawnWep\")\n\t\t\t\tnet.WriteIGSItem(ITEM)\n\t\t\t\tnet.WriteBool(give)\n\t\t\tnet.SendToServer()\n\t\tend\n\tend, fr.act)\nend)\n\n-- IGS.CloseUI()\n-- IGS.UI()\n-- IGS.WIN.Item(\"wep_weapon_ar2\")\n\nelse -- SV\n\tutil.AddNetworkString(\"IGS.GiveOnSpawnWep\")\n\n\tlocal function bibuid(pl, ITEM)\n\t\treturn \"igs:gos:\" .. pl:UniqueID() .. \":\" .. ITEM:UID()\n\tend\n\n\tlocal function SetShouldPlayerReceiveWep(pl, ITEM, bGive)\n\t\tpl:SetNWBool(\"igs.gos.\" .. ITEM:ID(), bGive) -- gos GiveOnSpawn\n\t\tbib.setBool(bibuid(pl, ITEM), bGive)\n\tend\n\n\tlocal function PlayerSetWantReceiveOnSpawn(pl, ITEM, bWant)\n\t\tSetShouldPlayerReceiveWep(pl, ITEM, bWant)\n\t\tIGS.Notify(pl, ITEM:Name() .. (bWant and \" \" or \" РЅРµ \") .. \"Р±СѓРґРµС‚ РІС‹РґР°РІР°С‚СЊСЃСЏ РїСЂРё СЃРїР°РІРЅРµ\")\n\tend\n\n\tlocal function GetShouldPlayerReceiveWep(pl, ITEM)\n\t\treturn bib.getBool(bibuid(pl, ITEM))\n\tend\n\n\tlocal function setActiveWeapon(pl, class)\n\t\tpl:SetActiveWeapon(pl:GetWeapon(class))\n\tend\n\n\tlocal function giveItemAmmo(pl, ITEM)\n\t\tfor type,count in pairs(ITEM.ammo or {}) do\n\t\t\tpl:SetAmmo(count,type)\n\t\tend\n\tend\n\n\t-- Р’С‹РґР°РµС‚ РєСѓРїР»РµРЅРЅРѕРµ РѕСЂСѓР¶РёРµ, РµСЃР»Рё СѓСЃС‚Р°РЅРѕРІР»РµРЅР° РіР°Р»РѕС‡РєР°\n\t-- https://trello.com/c/2KJQisfJ/488-РѕСЂСѓР¶РёРµ-РІС‹РґР°РµС‚СЃСЏ-Рё-РІ-С‚СЋСЂСЊРјРµ\n\tfunction IGS:IGS_PlayerLoadout(pl)\n\t\tfor uid in pairs(IGS.PlayerPurchases(pl) or {}) do\n\t\t\tlocal ITEM = IGS.GetItemByUID(uid)\n\t\t\tif !ITEM.swep then continue end\n\n\t\t\tlocal give = GetShouldPlayerReceiveWep(pl, ITEM)\n\t\t\tif give then\n\t\t\t\tpl:Give(ITEM.swep)\n\t\t\t\tgiveItemAmmo(pl, ITEM)\n\t\t\tend\n\t\tend\n\tend\n\n\tnet.Receive(\"IGS.GiveOnSpawnWep\",function(_, pl)\n\t\tlocal ITEM,bWant = net.ReadIGSItem(),net.ReadBool()\n\t\tif !pl:HasPurchase(ITEM:UID()) or !ITEM.swep then return end -- Р±Р°Р№РїР°СЃ\n\n\t\tPlayerSetWantReceiveOnSpawn(pl, ITEM, bWant)\n\tend)\n\n\thook.Add(\"PlayerLoadout\", \"IGS.PlayerLoadout\", function(pl)\n\t\thook.Call(\"IGS_PlayerLoadout\", IGS, pl)\n\tend)\n\n\thook.Add(\"IGS.PlayerPurchasesLoaded\", \"IGS.PlayerLoadout\", function(pl)\n\t\thook.Call(\"IGS_PlayerLoadout\", IGS, pl)\n\tend)\n\n\thook.Add(\"IGS.PlayerActivatedItem\",\"IGS.PlayerLoadout\",function(pl, ITEM)\n\t\tif ITEM.swep then\n\t\t\tPlayerSetWantReceiveOnSpawn(pl, ITEM, true) -- default give on spawn\n\t\t\thook.Call(\"IGS_PlayerLoadout\", IGS, pl)\n\n\t\t\tlocal text = \"%s С‚РµРїРµСЂСЊ Р±СѓРґРµС‚ РІС‹РґР°РІР°С‚СЊСЃСЏ РїСЂРё РєР°Р¶РґРѕРј СЂРµСЃРїР°РІРЅРµ. \" ..\n\t\t\t\"Р•СЃР»Рё РІС‹ С…РѕС‚РёС‚Рµ РІСЂРµРјРµРЅРЅРѕ РѕС‚РєР»СЋС‡РёС‚СЊ РІС‹РґР°С‡Сѓ, \" ..\n\t\t\t\"С‚Рѕ СЃРЅРёРјРёС‚Рµ РіР°Р»РѕС‡РєСѓ РІ РєР°СЂС‚РѕС‡РєРµ РїСЂРµРґРјРµС‚Р° РІ /donate РјРµРЅСЋ\"\n\n\t\t\tpl:ChatPrint(\"в–ј\")\n\t\t\tIGS.Notify(pl, text:format(ITEM:Name()))\n\t\t\tpl:ChatPrint(\"в–І\")\n\n\t\t\tsetActiveWeapon(pl, ITEM.swep)\n\t\t\tgiveItemAmmo(pl, ITEM)\n\t\tend\n\tend)\nend\n\n\n-- РњР°С€РёРЅС‹\nfunction STORE_ITEM:SetVehicle(sVehClass)\n\tself:SetCategory(\"РўСЂР°РЅСЃРїРѕСЂС‚\")\n\n\tself.vehicle = self:Insert(IGS.ITEMS.SB.VEHS, sVehClass)\n\treturn self\nend\n\n-- /\\ SHARED\nif CLIENT then return end\n-- \\/ SERVER\n\n-- print( hook.Run(\"CanTool\", player.Find(\"hell\"), AMD():GetEyeTrace(), \"rope\") )\nhook.Add(\"CanTool\",\"IGS\",function(pl,_,tool)\n\tlocal ITEM = IGS.PlayerHasOneOf(pl, IGS.ITEMS.SB.TOOLS[tool])\n\tif ITEM ~= nil then -- donate\n\t\tlocal allow = hook.Run(\"IGS.CanTool\", pl, tool)\n\t\tif allow ~= nil then return allow end\n\t\treturn tobool(ITEM)\n\tend\nend)\n\n-- РќРёР¶Рµ СЂРµС€РµРЅРёРµ РґР»СЏ РјР°С€РёРЅ, РєР°Рє СЃРґРµР»Р°С‚СЊ, С‡С‚РѕР±С‹ РЅРµ СЃРїР°РІРЅРёР»Рё С‚СѓС‡Сѓ. РЎРµР№С‡Р°СЃ СЂРµР°Р»РёР·РѕРІС‹РІР°С‚СЊ Р»РµРЅСЊ\nhook.Add(\"PlayerSpawnSENT\",\"IGS\",function(pl, class)\n\tlocal ITEM = IGS.PlayerHasOneOf(pl, IGS.ITEMS.SB.SENTS[class])\n\tif ITEM ~= nil then -- donate\n\t\tlocal allow = hook.Run(\"IGS.PlayerSpawnSENT\", pl, class)\n\t\tif allow ~= nil then return allow end\n\t\treturn tobool(ITEM)\n\tend\nend)\n\n\n-- РґР»СЏ HOOK_HIGH\n-- РІС‹С€Рµ 2018.11.15 РІС‹РЅРµСЃ Рё РЅРµРјРЅРѕРіРѕ РїРµСЂРµРїРёСЃР°Р» РґРІРµ С„СѓРЅРєС†РёРё\n-- Р•СЃР»Рё Р±СѓРґРµС‚ СЂР°Р±РѕС‚Р°С‚СЊ РЅРѕСЂРј, С‚Рѕ Рё СЃ РѕСЃС‚Р°Р»СЊРЅС‹С… СЃРЅСЏС‚СЊ\ntimer.Simple(0,function()\n\nhook.Add(\"PlayerGiveSWEP\",\"IGS\",function(pl,class)\n\tlocal ITEM = IGS.PlayerHasOneOf(pl, IGS.ITEMS.SB.SWEPS[class]) -- hasAccess if ITEM returned\n\tif ITEM then\n\t\ttimer.Simple(.1,function()\n\t\t\tfor type,count in pairs(ITEM.ammo or {}) do\n\t\t\t\tpl:SetAmmo(count,type)\n\t\t\tend\n\t\tend)\n\n\t\treturn true -- #todo РЅРµ СЂРµС‚СѓСЂРЅРёС‚СЊ true!!. false or nil only\n\tend\nend, HOOK_HIGH)\n\n\n--[[-------------------------------------------------------------------------\n\tРњР°С€РёРЅС‹\n---------------------------------------------------------------------------]]\nlocal function getcount(pl, class)\n\treturn pl:GetVar(\"vehicles_\" .. class,0)\nend\n\nlocal function counter(pl, class, incr)\n\tpl:SetVar(\"vehicles_\" .. class, getcount(pl,class) + incr)\nend\n\n-- СЂР°Р·СЂРµС€Р°РµРј СЃРїР°РІРЅРёС‚СЊ РѕРґРЅСѓ, РЅРѕ РєРѕРЅСЃС‚СЂСѓРєС†РёСЏ РїРѕР·РІРѕР»СЏРµС‚ РІ Р±СѓРґСѓС‰РµРј СЃРґРµР»Р°С‚СЊ РїРѕРґРґРµСЂР¶РєСѓ СЃРїР°РІРЅР° РЅРµСЃРєРѕР»СЊРєРёС… РјР°С€РёРЅ\nlocal function canSpawn(pl, class)\n\treturn getcount(pl,class) \u003c 1\nend\n\nlocal function getVehClass(veh)\n\t-- https://trello.com/c/l1tw7YpR/623\n\t-- ClassOverride for scars (https://t.me/c/1353676159/48545)\n\treturn (veh.IsSimfphyscar and veh:GetSpawn_List()) or veh.ClassOverride or veh:GetVehicleClass()\nend\n\n-- РЎС‡РёС‚Р°РµРј Р·Р°СЃРїР°РІРЅРµРЅРЅС‹Рµ Рё СѓРґР°Р»РµРЅРЅС‹Рµ РјР°С€РёРЅС‹\nhook.Add(\"PlayerSpawnedVehicle\",\"IGS\",function(pl,veh)\n\tif IGS.PlayerHasOneOf(pl, IGS.ITEMS.SB.VEHS[getVehClass(veh)]) then -- С‡РµР» РїРѕРєСѓРїР°Р» СЌС‚Сѓ С‚Р°С‡РєСѓ, Р° С‚РµРїРµСЂСЊ СЃРїР°РІРЅРёС‚\n\t\tcounter(pl, getVehClass(veh), 1)\n\n\t\tveh:CallOnRemove(\"ChangeCounter\",function(ent)\n\t\t\tif !IsValid(pl) then return end\n\t\t\tcounter(pl, getVehClass(ent), -1)\n\t\tend)\n\tend\nend)\n\nhook.Add(\"PlayerSpawnVehicle\",\"IGS\",function(pl, _, class) -- model, class, table\n\tif IGS.PlayerHasOneOf(pl,IGS.ITEMS.SB.VEHS[class]) then -- РїРѕРєСѓРїР°Р» РјР°С€РёРЅСѓ\n\t\tlocal can = canSpawn(pl,class)\n\t\tif !can then\n\t\t\tIGS.Notify(pl,\"РЈ РІР°СЃ РµСЃС‚СЊ Р·Р°СЃРїР°РІРЅРµРЅР° СЌС‚Р° РјР°С€РёРЅР°\")\n\t\tend\n\n\t\treturn can\n\tend\nend, HOOK_HIGH)\n--[[-------------------------------------------------------------------------\n\t/РњР°С€РёРЅС‹\n---------------------------------------------------------------------------]]\nlocal prop_limiters_exists = nil -- optimization\n\nfunction STORE_ITEM:IncreasePlayerPropLimit(iAmount)\n\tprop_limiters_exists = true\n\treturn self:SetInstaller(function(pl)\n\t\tlocal current_extra = pl:GetVar(\"igs_extra_props_limit\", 0)\n\t\tpl:SetVar(\"igs_extra_props_limit\", current_extra + iAmount)\n\tend):SetMeta(\"prop_limit\", iAmount)\nend\n\nhook.Add(\"PlayerCheckLimit\", \"IGS\", function(pl, type, current_spawned, general_limit)\n\tif not prop_limiters_exists or type ~= \"props\" then return end\n\n\tlocal extra_props_purchased = pl:GetVar(\"igs_extra_props_limit\", 0)\n\tlocal general_limit_reached = current_spawned \u003e= general_limit\n\tlocal extra_limit_reached   = current_spawned \u003c= extra_props_purchased + general_limit\n\n\t-- РїРµСЂРІРѕРµ, С‡С‚РѕР±С‹ РЅРµ РІС‹Р±СЂР°СЃС‹РІР°С‚СЊ true Р»РёС€РЅРёР№ СЂР°Р·\n\tif general_limit_reached and (not extra_limit_reached) then\n\t\treturn true\n\tend\nend)\n\nhook.Add(\"IGS.PlayerPurchasesLoaded\", \"IGS.LoadExtraPropsLimit\", function(pl, purchases_)\n\tif not purchases_ or not prop_limiters_exists then return end\n\n\tlocal extra = 0\n\tfor uid in pairs(purchases_) do\n\t\tlocal ITEM = IGS.GetItemByUID(uid)\n\t\tif ITEM:GetMeta(\"prop_limit\") then\n\t\t\textra = extra + ITEM:GetMeta(\"prop_limit\")\n\t\tend\n\tend\n\n\tif extra ~= 0 then\n\t\tpl:SetVar(\"igs_extra_props_limit\", extra)\n\tend\nend)\n\n\n-- hook.Add(\"PlayerCheckLimit\", \"asd\", PRINT)\n\n\n-- DARKRP ONLY\nhook.Add(\"canDropWeapon\",\"IGS\",function(pl,wep)\n\t-- РџСѓС€РєР° РЅРµ РїСЂРѕРґР°РµС‚СЃСЏ\n\tif !IsValid(wep) or !IGS.ITEMS.SB.SWEPS[wep:GetClass()] then return end\n\n\t-- РџСѓС€РєР° РїСЂРѕРґР°РµС‚СЃСЏ Рё С‡РµР» РєСѓРїРёР» РµРµ\n\tlocal ITEM = IGS.PlayerHasOneOf(pl, IGS.ITEMS.SB.SWEPS[wep:GetClass()])\n\tif ITEM then\n\t\treturn false\n\tend\n\n\t-- РџСѓС€РєР° РїСЂРѕРґР°РµС‚СЃСЏ, РЅРѕ С‡РµР» РµРµ РЅРµ РїРѕРєСѓРїР°Р»\n\t-- Рў.Рµ. РїРѕ СЃСѓС‚Рё РІРѕР·РјРѕР¶РЅРѕСЃС‚СЊ РґСЂРѕРїР° РєРѕРЅС‚СЂРѕР»Р»РёСЂСѓРµС‚СЃСЏ РґСЂСѓРіРёРјРё С…СѓРєР°РјРё\nend, HOOK_HIGH)\nend)\n","igs/extensions/serverguard.lua":  "IGS.ITEMS.SG = IGS.ITEMS.SG or {\n\tGROUPS = {}\n}\n\nlocal STORE_ITEM = FindMetaTable(\"IGSItem\")\n\nfunction STORE_ITEM:SetSGGroup(sUserGroup, iGroupWeight)\n\tself:SetCanActivate(function(pl)\n\t\tif pl:IsUserGroup(sUserGroup) then\n\t\t\treturn \"РЈ РІР°СЃ СѓР¶Рµ РґРµР№СЃС‚РІСѓРµС‚ СЌС‚Р° СѓСЃР»СѓРіР°\"\n\t\tend\n\tend)\n\tself:SetInstaller(function(pl)\n\t\tlocal rankData = serverguard.ranks:GetRank(sUserGroup)\n\t\tif rankData then\n\t\t\tserverguard.player:SetRank(pl, sUserGroup, 0)\n\t\t\tserverguard.player:SetImmunity(pl, rankData.immunity)\n\t\t\tserverguard.player:SetTargetableRank(pl, rankData.targetable)\n\t\t\tserverguard.player:SetBanLimit(pl, rankData.banlimit)\n\t\t\tpl.IGSSGWeight = iGroupWeight\n\t\tend\n\tend)\n\tself:SetValidator(function(pl)\n\t\tif pl.IGSSGWeight then\n\t\t\treturn iGroupWeight \u003c pl.IGSSGWeight\n\t\telse\n\t\t\treturn serverguard.player:GetRank(pl) == sUserGroup\n\t\tend\n\tend)\n\n\tself.sg_group = self:Insert(IGS.ITEMS.SG.GROUPS, sUserGroup)\n\treturn self\nend\nif CLIENT then return end\nlocal function checkGroups(pl)\n\tlocal hasAccess = IGS.PlayerHasOneOf(pl, IGS.ITEMS.SG.GROUPS[ serverguard.player:GetRank(pl) ])\n\tif hasAccess == nil then return end  -- РЅРµ РѕС‚СЃР»РµР¶РёРІР°РµС‚СЃСЏ\n\n\tif hasAccess then\n\t\treturn -- РµСЃР»Рё РёРјРµРµС‚СЃСЏ С…РѕС‚СЊ РѕРґРЅР° РїРѕРєСѓРїРєР°, С‚Рѕ РЅРµ СЃРЅРёРјР°РµРј РїСЂР°РІР°\n\tend\n\n\tserverguard.player:SetRank(pl, \"user\", 0);\nend\n\nhook.Add(\"IGS.PlayerPurchasesLoaded\", \"SGGroups\", function(pl)\n\tif next(IGS.ITEMS.SG.GROUPS) then -- РіСЂСѓРїРїС‹ РїСЂРѕРґР°СЋС‚СЃСЏ\n\t\tcheckGroups(pl)\n\tend\nend)\n","igs/extensions/ulx.lua":  "IGS.ITEMS.ULX = IGS.ITEMS.ULX or {\n\tGROUPS = {},\n\tPEX    = {}\n}\n\n\nlocal STORE_ITEM = FindMetaTable(\"IGSItem\")\n\nfunction STORE_ITEM:SetULXGroup(sUserGroup, iGroupWeight)\n\tself:SetCanActivate(function(pl) -- invDbID\n\t\tif pl:IsUserGroup(sUserGroup) then\n\t\t\treturn \"РЈ РІР°СЃ СѓР¶Рµ РґРµР№СЃС‚РІСѓРµС‚ СЌС‚Р° СѓСЃР»СѓРіР°\"\n\t\tend\n\tend)\n\tself:SetInstaller(function(pl)\n\t\tRunConsoleCommand(\"ulx\", \"adduserid\", pl:SteamID(), sUserGroup)\n\t\tpl.IGSULXWeight = iGroupWeight\n\tend)\n\tself:SetValidator(function(pl)\n\t\tlocal valid = false\n\t\tif pl.IGSULXWeight then\n\t\t\tvalid = iGroupWeight \u003c= pl.IGSULXWeight\n\t\telse\n\t\t\tvalid = pl:IsUserGroup(sUserGroup)\n\t\tend\n\n\t\tif !valid then\n\t\t\tIGS.NotifyAll(\"РђРІС‚РѕРІРѕСЃСЃС‚Р°РЅРѕРІР»РµРЅРёРµ \" .. self:Name() .. \" РґР»СЏ \" .. pl:Name())\n\t\t\treturn false\n\t\tend\n\tend)\n\n\n\tself.ulx_group = self:Insert(IGS.ITEMS.ULX.GROUPS, sUserGroup)\n\tself.ulx_group_weight = iGroupWeight\n\treturn self\nend\n\n-- Р•СЃС‚СЊ РјРЅРѕРіРѕ РЅСЊСЋР°РЅСЃРѕРІ. РљРѕРјРјРёС‚ 1 РѕРєС‚СЏР±СЂСЏ 2019\nfunction STORE_ITEM:SetULXCommandAccess(cmd,tag) -- \"ulx model\",\"^\", РЅР°РїСЂРёРјРµСЂ\n\tself:SetInstaller(function(pl)\n\t\tif !tag then\n\t\t\ttable.insert(ULib.ucl.authed[ pl:UniqueID() ].allow, cmd)\n\t\telse\n\t\t\tULib.ucl.authed[ pl:UniqueID() ].allow[cmd] = tag\n\t\tend\n\tend)\n\tself:SetValidator(function()\n\t\treturn false\n\tend)\n\n\n\tself.ulx_command = self:Insert(IGS.ITEMS.ULX.PEX, cmd)\n\treturn self\nend\n\n\nif CLIENT then return end\n\nlocal function checkGroups(pl)\n\tlocal hasAccess = IGS.PlayerHasOneOf(pl, IGS.ITEMS.ULX.GROUPS[ pl:GetUserGroup() ])\n\tif hasAccess == nil then return end\n\n\tif hasAccess then\n\t\tpl.IGSULXWeight = hasAccess.ulx_group_weight\n\t\treturn -- РµСЃР»Рё РёРјРµРµС‚СЃСЏ С…РѕС‚СЊ РѕРґРЅР° РїРѕРєСѓРїРєР°, С‚Рѕ РЅРµ СЃРЅРёРјР°РµРј РїСЂР°РІР°\n\tend\n\n\tRunConsoleCommand(\"ulx\",\"removeuserid\",pl:SteamID())\nend\n\nlocal function hasPexAccess(pl, cmd)\n\tlocal hasAccess = IGS.PlayerHasOneOf(pl, IGS.ITEMS.ULX.PEX[cmd])\n\treturn hasAccess ~= false -- nil, РµСЃР»Рё РЅРµ РїСЂРѕРґР°РµС‚СЃСЏ\nend\n\nlocal function checkPermissions(pl)\n\tlocal user = ULib.ucl.authed[ pl:UniqueID() ]\n\tif !user then return end\n\n\tlocal changed\n\t-- Р’РёРґ ucl С‚Р°Р±Р»РёС†С‹ https://img.qweqwe.ovh/1523035793058.png\n\tfor k,v in pairs(user.allow or {}) do -- РЅРµ СѓРІРµСЂРµРЅ, С‡С‚Рѕ allow РѕР±СЏР·Р°С‚РµР»СЊРЅРѕ РµСЃС‚СЊ\n\t\tlocal cmd = isnumber(k) and v or k\n\n\t\tif !hasPexAccess(pl, cmd) then\n\t\t\tuser.allow[k] = nil\n\t\t\tchanged = true\n\t\tend\n\tend\n\n\tif changed then\n\t\tULib.ucl.saveUsers()\n\tend\nend\n\ntimer.Simple(.1, function() -- С‡С‚РѕР±С‹ СЌС‚РѕС‚ С…СѓРє РѕР±СЏР·Р°С‚РµР»СЊРЅРѕ Р±С‹Р» РїРѕСЃР»Рµ RestorePex. РСЃС‚РѕСЂРёСЏ Р’Рљ 20 РјР°СЏ СЃ РђРЅС‚РѕРЅ РџР°РЅС‡РµРЅРєРѕ\nhook.Add(\"IGS.PlayerPurchasesLoaded\", \"ULXGroupsAndPEX\", function(pl)\n\tif next(IGS.ITEMS.ULX.GROUPS) then\n\t\tcheckGroups(pl)\n\tend\n\n\tif next(IGS.ITEMS.ULX.PEX) then\n\t\tcheckPermissions(pl)\n\tend\nend, HOOK_HIGH)\nend)\n","igs/extensions/xadmin.lua":  "IGS.ITEMS.XADMIN_USERS = IGS.ITEMS.XADMIN_USERS or {} -- by kip https://t.me/c/1353676159/1673\n\nlocal STORE_ITEM = FindMetaTable(\"IGSItem\")\n\nfunction STORE_ITEM:SetXAdminGroup(sUserGroup)\n\treturn self:SetInstaller(function(pl)\n\t\txAdmin.UserGroups[pl:SteamID()] = sUserGroup\n\t\tpl:SetUserGroup(sUserGroup)\n\t\tIGS.ITEMS.XADMIN_USERS[pl:SteamID()] = true\n\tend):SetValidator(function()\n\t\treturn false\n\tend)\nend\n\nhook.Add(\"PlayerDisconnected\", \"IGS.XAdminRemovePerm\", function(pl)\n\tif IGS.ITEMS.XADMIN_USERS[pl:SteamID()] then\n\t\txAdmin.UserGroups[pl:SteamID()] = nil\n\t\tIGS.ITEMS.XADMIN_USERS[pl:SteamID()] = nil\n\tend\nend)\n\n\n-- Р•СЃС‚СЊ xAdmin.SetGroup(pl, sUserGroup)\n-- РЅРѕ С‚РѕРіРґР° Р±СѓРґРµС‚ СЃР»РѕР¶РЅРµРµ РєРѕРЅС‚СЂРѕР»Р»РёСЂРѕРІР°С‚СЊ СЃРЅСЏС‚РёРµ РїСЂР°РІ, С‚Рє РёРґРµС‚ Р·Р°РїРёСЃСЊ РІ Р‘Р”\nfunction STORE_ITEM:SetXAdmin2Group(sUserGroup)\n\treturn self:SetInstaller(function(pl)\n\t\tlocal sid64 = pl:SteamID64()\n\t\tlocal oldgroup = pl:GetUserGroup()\n\n\t\txAdmin.UserData[sid64] = xAdmin.UserData[sid64] or {SteamID = sid64}\n\t\txAdmin.UserData[sid64].UserGroup = sUserGroup\n\n\t\tpl:SetUserGroup(sUserGroup)\n\n\t\txAdmin.UpdateGroupMembers(player.GetAll(), sUserGroup)\n\n\t\thook.Run(\"xAdminUserGroupUpdated\", pl, sUserGroup, oldgroup)\n\tend):AddHook(\"IGS.PlayerPurchasesLoaded\", function(pl, purchases)\n\t\tif CLIENT or not purchases then return end\n\n\t\tlocal priority_item = self\n\n\t\tfor uid in pairs(purchases) do\n\t\t\tlocal ITEM = IGS.GetItemByUID(uid)\n\t\t\tif ITEM:GetMeta(\"badmin2group\") and ITEM.id \u003e self.id then\n\t\t\t\tpriority_item = ITEM\n\t\t\tend\n\t\tend\n\n\t\tif priority_item == self then\n\t\t\tself:Setup(pl)\n\t\tend\n\tend):SetMeta(\"badmin2group\", sUserGroup)\nend\n","igs/interface/activities/inventory.lua":  "local function loadTab(activity,sidebar,dat)\n\tlocal bg = uigs.Create(\"Panel\")\n\t\n\tbg.OnRemove = function()\n\t\thook.Remove(\"IGS.PlayerPurchasedItem\",\"UpdateInventoryView\")\n\t\thook.Remove(\"IGS.InventoryUpdated\",\"UpdateInventoryViewFull\")\n\tend\n\n\tbg.OnOpen = function()\n\t\tlocal frame = activity:GetParent()\n\t\tif frame and frame.SetSidebarVisible then\n\t\t\tframe:SetSidebarVisible(false)\n\t\tend\n\tend\n\n\tlocal content_w = activity:GetContentWide()\n\n\t-- РЎРѕР·РґР°РµРј СЃРєСЂРѕР»Р» РїР°РЅРµР»СЊ РґР»СЏ РєР°СЂС‚РѕС‡РµРє\n\tlocal scr = uigs.Create(\"igs_scroll\", bg)\n\tscr:SetSize(content_w, activity:GetTall())\n\tscr:SetPos(0, 0)\n\tscr:SetSpacing(10)\n\tscr:SetPadding(10)\n\n\t-- РЎРѕР·РґР°РµРј layout РґР»СЏ РєР°СЂС‚РѕС‡РµРє\n\tlocal icons = uigs.Create(\"DIconLayout\", function(p)\n\t\tp:SetWide(content_w - 20)\n\t\tp:SetSpaceX(10)\n\t\tp:SetSpaceY(10)\n\t\tp.Paint = function() end\n\tend, scr)\n\tscr:AddItem(icons)\n\n\tlocal emptyPanel\n\n\tlocal function removeFromCanvas(itemPan)\n\t\tif IsValid(itemPan) then\n\t\t\titemPan:Remove()\n\t\tend\n\tend\n\n\tlocal function setData(newDat)\n\t\t-- РџРѕР»РЅР°СЏ РїРµСЂРµСЂРёСЃРѕРІРєР° (РЅР°РїСЂРёРјРµСЂ, РµСЃР»Рё РёРЅРІРµРЅС‚Р°СЂСЊ РёР·РјРµРЅРёР»СЃСЏ С‡РµСЂРµР· СЃР°Р№С‚/РїР°РЅРµР»СЊ)\n\t\ticons:Clear()\n\n\t\tif #newDat == 0 then\n\t\t\tshowEmptyState()\n\t\t\treturn\n\t\tend\n\n\t\thideEmptyState()\n\t\tfor _, v in ipairs(newDat) do\n\t\t\ticons:AddItem(v.item, v.id)\n\t\tend\n\tend\n\n\tfunction icons:AddItem(ITEM, dbID)\n\t\tlocal item = icons:Add(\"igs_item\")\n\t\titem:SetSize(140, 170) -- РЎС‚Р°РЅРґР°СЂС‚РЅС‹Р№ СЂР°Р·РјРµСЂ РєР°СЂС‚РѕС‡РєРё РєР°Рє РІ СѓСЃР»СѓРіР°С…\n\t\titem:HidePrice(true) -- РЎРєСЂС‹РІР°РµРј С†РµРЅСѓ РІ РёРЅРІРµРЅС‚Р°СЂРµ\n\t\titem:SetIcon(ITEM:ICON())\n\t\titem:SetName(ITEM:Name())\n\t\t-- РЈР±СЂР°РЅР° РЅР°РґРїРёСЃСЊ \"РЎСЂРѕРє\" - РєР°СЂС‚РѕС‡РєР° РїРѕРєР°Р·С‹РІР°РµС‚ С‚РѕР»СЊРєРѕ РЅР°Р·РІР°РЅРёРµ\n\t\t\n\t\t-- РџСЂРё РєР»РёРєРµ РѕС‚РєСЂС‹РІР°РµРј РјРµРЅСЋ РґРµР№СЃС‚РІРёР№\n\t\titem.DoClick = function()\n\t\t\t-- РЎРѕР·РґР°РµРј РєСЂР°СЃРёРІРѕРµ РјРѕРґР°Р»СЊРЅРѕРµ РѕРєРЅРѕ РІРјРµСЃС‚Рѕ РѕР±С‹С‡РЅРѕРіРѕ РјРµРЅСЋ\n\t\t\tlocal frame = uigs.Create(\"igs_frame\", function(f)\n\t\t\t\tf:SetSize(300, 200)\n\t\t\t\tf:Center()\n\t\t\t\tf:MakePopup()\n\t\t\t\tf:SetTitle(ITEM:Name())\n\t\t\tend)\n\t\t\t\n\t\t\tlocal y = frame:GetTitleHeight() + 10\n\t\t\t\n\t\t\t-- РљРЅРѕРїРєР° Р°РєС‚РёРІР°С†РёРё\n\t\t\tlocal activateBtn = uigs.Create(\"igs_button\", function(btn)\n\t\t\t\tbtn:SetPos(10, y)\n\t\t\t\tbtn:SetSize(frame:GetWide() - 20, 35)\n\t\t\t\tbtn:SetText(\"вњ“ РђРєС‚РёРІРёСЂРѕРІР°С‚СЊ\")\n\t\t\t\tbtn:SetActive(true)\n\t\t\t\tbtn.DoClick = function()\n\t\t\t\t\tframe:Close()\n\t\t\t\t\tIGS.ProcessActivate(dbID, function(ok)\n\t\t\t\t\t\tif !ok then return end\n\t\t\t\t\t\tremoveFromCanvas(item)\n\t\t\t\t\tend)\n\t\t\t\tend\n\t\t\tend, frame)\n\t\t\t\n\t\t\ty = y + 40\n\t\t\t\n\t\t\t-- РљРЅРѕРїРєР° РёРЅС„РѕСЂРјР°С†РёРё\n\t\t\tlocal infoBtn = uigs.Create(\"igs_button\", function(btn)\n\t\t\t\tbtn:SetPos(10, y)\n\t\t\t\tbtn:SetSize(frame:GetWide() - 20, 35)\n\t\t\t\tbtn:SetText(\"в„№ РРЅС„РѕСЂРјР°С†РёСЏ\")\n\t\t\t\tbtn.DoClick = function()\n\t\t\t\t\tframe:Close()\n\t\t\t\t\tIGS.WIN.Item(ITEM:UID())\n\t\t\t\tend\n\t\t\tend, frame)\n\t\t\t\n\t\t\ty = y + 40\n\t\t\t\n\t\t\t-- РљРЅРѕРїРєР° РѕС‚РјРµРЅС‹\n\t\t\tlocal cancelBtn = uigs.Create(\"igs_button\", function(btn)\n\t\t\t\tbtn:SetPos(10, y)\n\t\t\t\tbtn:SetSize(frame:GetWide() - 20, 35)\n\t\t\t\tbtn:SetText(\"вњ– РћС‚РјРµРЅР°\")\n\t\t\t\tbtn.DoClick = function()\n\t\t\t\t\tframe:Close()\n\t\t\t\tend\n\t\t\tend, frame)\n\t\t\t\n\t\t\ty = y + 45\n\t\t\tframe:SetTall(y)\n\t\tend\n\tend\n\n\tlocal function showEmptyState()\n\t\tif IsValid(emptyPanel) then return end\n\t\temptyPanel = uigs.Create(\"Panel\", function(p)\n\t\t\tp:SetSize(content_w - 40, 200)\n\t\t\tp:SetPos(20, (activity:GetTall() - 200) / 2)\n\t\t\t\n\t\t\tp.Paint = function(s, w, h)\n\t\t\t\t-- Р Р°Р·РјС‹С‚РёРµ С„РѕРЅР° РµСЃР»Рё РІРєР»СЋС‡РµРЅРѕ\n\t\t\t\tif RNDX and Mantle and Mantle.ui.convar.blur then\n\t\t\t\t\tRNDX().Rect(0, 0, w, h)\n\t\t\t\t\t\t:Rad(8)\n\t\t\t\t\t\t:Blur(1.0)\n\t\t\t\t\t:Draw()\n\t\t\t\tend\n\t\t\t\t\n\t\t\t\tdraw.RoundedBox(8, 0, 0, w, h, ColorAlpha(IGS.col.PASSIVE_SELECTIONS, 100))\n\t\t\t\t\n\t\t\t\t-- РРєРѕРЅРєР°\n\t\t\t\tsurface.SetDrawColor(IGS.col.TEXT_SOFT)\n\t\t\t\tsurface.SetMaterial(Material(\"materials/icons/fa32/cart-arrow-down.png\"))\n\t\t\t\tsurface.DrawTexturedRect((w - 64) / 2, 30, 64, 64)\n\t\t\tend\n\t\t\t\n\t\t\tlocal title = uigs.Create(\"DLabel\", p)\n\t\t\ttitle:SetPos(0, 110)\n\t\t\ttitle:SetWide(p:GetWide())\n\t\t\ttitle:SetFont(\"Fated.24\")\n\t\t\ttitle:SetTextColor(IGS.col.TEXT_HARD)\n\t\t\ttitle:SetText(\"РРЅРІРµРЅС‚Р°СЂСЊ РїСѓСЃС‚\")\n\t\t\ttitle:SetContentAlignment(5)\n\t\t\t\n\t\t\tlocal desc = uigs.Create(\"DLabel\", p)\n\t\t\tdesc:SetPos(20, 145)\n\t\t\tdesc:SetWide(p:GetWide() - 40)\n\t\t\tdesc:SetFont(\"Fated.18\")\n\t\t\tdesc:SetTextColor(IGS.col.TEXT_SOFT)\n\t\t\tdesc:SetText(\"РљСѓРїР»РµРЅРЅС‹Рµ РїСЂРµРґРјРµС‚С‹ Р±СѓРґСѓС‚ РЅР°С…РѕРґРёС‚СЊСЃСЏ Р·РґРµСЃСЊ.\\nР’С‹ СЃРјРѕР¶РµС‚Рµ Р°РєС‚РёРІРёСЂРѕРІР°С‚СЊ РёС… РёР»Рё РїРµСЂРµРґР°С‚СЊ РґСЂСѓРіРёРј РёРіСЂРѕРєР°Рј.\")\n\t\t\tdesc:SetWrap(true)\n\t\t\tdesc:SetAutoStretchVertical(true)\n\t\t\tdesc:SetContentAlignment(5)\n\t\tend, bg)\n\tend\n\n\tlocal function hideEmptyState()\n\t\tif IsValid(emptyPanel) then\n\t\t\temptyPanel:Remove()\n\t\t\temptyPanel = nil\n\t\tend\n\tend\n\n\tsetData(dat)\n\n\thook.Add(\"IGS.PlayerPurchasedItem\", \"UpdateInventoryView\", function(_, ITEM, invDbID)\n\t\t-- РќРµ РґРѕР±Р°РІР»СЏРµРј null РїСЂРµРґРјРµС‚С‹ РІ UI\n\t\tif not ITEM.isnull then\n\t\t\thideEmptyState()\n\t\t\ticons:AddItem(ITEM, invDbID)\n\t\tend\n\tend)\n\n\thook.Add(\"IGS.InventoryUpdated\", \"UpdateInventoryViewFull\", function()\n\t\tIGS.GetInventory(function(items)\n\t\t\tif not IsValid(bg) then return end\n\t\t\tsetData(items)\n\t\tend)\n\tend)\n\n\tactivity:AddTab(\"РРЅРІРµРЅС‚Р°СЂСЊ\", bg, \"materials/icons/fa32/cart-arrow-down.png\")\nend\n\nhook.Add(\"IGS.CatchActivities\",\"inventory\",function(activity,sidebar)\n\tif !IGS.C.Inv_Enabled then return end\n\n\tIGS.GetInventory(function(items)\n\t\tif !IsValid(sidebar) then return end\n\t\tloadTab(activity,sidebar,items)\n\tend)\nend)\n\n-- IGS.UI()\n","igs/interface/activities/main.lua":  "local null = function() end\nlocal etoGlavnayaVkladkaBlya = true\n\nhook.Add(\"IGS.CatchActivities\",\"main\",function(activity,sidebar)\n\tlocal bg = uigs.Create(\"Panel\")\n\n\t-- РџР°РЅРµР»СЊ С‚РµРіРѕРІ Рё РіРѕС‚РѕРІР°СЏ РєРЅРѕРїРєР° СЃР±СЂРѕСЃР° С„РёР»СЊС‚СЂРѕРІ\n\tlocal tagspan = uigs.Create(\"Panel\", bg)\n\tlocal content_w = activity:GetContentWide()\n\ttagspan:SetWide(content_w)\n\ttagspan:SetPos(0, 0)\n\ttagspan.Paint = function(s,w,h)\n\t\tIGS.S.Panel(s,w,h,nil,nil,nil,true)\n\tend\n\n\t-- СЃРµС‚РєР° https://img.qweqwe.ovh/1487714173294.png\n\tbg.tags = uigs.Create(\"DIconLayout\", function(tags)\n\t\ttags:SetWide(content_w - 5 - 5)\n\t\ttags:SetPos(5,5)\n\t\ttags:SetSpaceX(10)\n\t\ttags:SetSpaceY(10)\n\t\ttags.Paint = null\n\n\t\tfunction tags:AddTag(sName, doClick, sIcon)\n\t\t\tlocal tag = uigs.Create(\"igs_button\")\n\t\t\ttag:SetTall(18)\n\t\t\t\n\t\t\t-- Р•СЃР»Рё РµСЃС‚СЊ РёРєРѕРЅРєР°, РґРѕР±Р°РІР»СЏРµРј РїСЂРѕР±РµР»С‹ РґР»СЏ СЃРјРµС‰РµРЅРёСЏ С‚РµРєСЃС‚Р°\n\t\t\tif sIcon then\n\t\t\t\ttag:SetText(\"      \" .. sName .. \" \") -- РґРѕРїРѕР»РЅРёС‚РµР»СЊРЅС‹Рµ РїСЂРѕР±РµР»С‹ РґР»СЏ РёРєРѕРЅРєРё\n\t\t\telse\n\t\t\t\ttag:SetText(\" \" .. sName .. \" \") -- РєРѕСЃС‚С‹Р»СЊ РґР»СЏ СЂР°СЃС€РёСЂРµРЅРёСЏ РєРЅРѕРїРєРё\n\t\t\tend\n\t\t\t\n\t\t\ttag:SizeToContents()\n\t\t\ttag.DoClick = doClick\n\t\t\t\n\t\t\t-- Р•СЃР»Рё РµСЃС‚СЊ РёРєРѕРЅРєР°, СЂРёСЃСѓРµРј РµС‘ РїРѕРІРµСЂС…\n\t\t\tif sIcon then\n\t\t\t\ttag.categoryIcon = Material(sIcon)\n\t\t\t\ttag.isCategory = true -- С„Р»Р°Рі РґР»СЏ РѕСЃРѕР±РѕРіРѕ СЃС‚РёР»СЏ РєР°С‚РµРіРѕСЂРёР№\n\t\t\t\t\n\t\t\t\t-- РЈСЃС‚Р°РЅР°РІР»РёРІР°РµРј СЏСЂРєРёР№ С†РІРµС‚ С‚РµРєСЃС‚Р° РґР»СЏ РєР°С‚РµРіРѕСЂРёРё\n\t\t\t\ttag:SetTextColor(IGS.col.TEXT_ON_HIGHLIGHT)\n\t\t\t\t\n\t\t\t\t-- Р РёСЃСѓРµРј РёРєРѕРЅРєСѓ РїРѕРІРµСЂС… РІСЃРµРіРѕ (РїРѕСЃР»Рµ С‚РµРєСЃС‚Р°)\n\t\t\t\ttag.PaintOver = function(s, w, h)\n\t\t\t\t\tif s.categoryIcon then\n\t\t\t\t\t\t-- РРєРѕРЅРєР° РІСЃРµРіРґР° СЏСЂРєР°СЏ\n\t\t\t\t\t\tsurface.SetDrawColor(IGS.col.TEXT_ON_HIGHLIGHT)\n\t\t\t\t\t\tsurface.SetMaterial(s.categoryIcon)\n\t\t\t\t\t\tsurface.DrawTexturedRect(4, 2, 14, 14)\n\t\t\t\t\tend\n\t\t\t\tend\n\t\t\tend\n\n\t\t\tself:Add(tag)\n\n\t\t\ttags:InvalidateLayout(true) -- tags:GetTall()\n\t\t\ttagspan:SetTall(tags:GetTall() + 5 + 5)\n\n\t\t\tlocal y = tagspan:GetTall()\n\n\t\t\t-- Р Р°СЃС…РѕР¶РґРµРЅРёРµ РІРѕС‚ С‚СѓС‚:\n\t\t\t-- https://img.qweqwe.ovh/1493840355855.png\n\t\t\t-- y = y - 10 -- UPD 2020 t.me/c/1353676159/7888\n\n\t\t\tbg.categs:SetTall(activity:GetTall() - y)\n\t\t\tbg.categs:SetPos(0,y)\n\t\t\treturn tag\n\t\tend\n\tend, tagspan)\n\n\tbg.categs = uigs.Create(\"igs_panels_layout_list\", bg) -- center panel\n\tbg.categs:DisableAlignment(true)\n\tbg.categs:SetWide(content_w)\n\n\t-- Р Р°СЃРєРѕРјРјРµРЅС‚РёС‚СЊ, РµСЃР»Рё Р·Р°С…РѕС‡Сѓ СѓР±СЂР°С‚СЊ С‚РµРіРё\n\t-- bg.categs:SetTall(activity:GetTall() - activity.tabBar:GetTall())\n\t-- bg.categs:SetPos(0,y)\n\n\n\t-- category = true\n\tlocal cats = {}\n\n\tlocal function addItems(fItemsFilter,fGroupFilter)\n\t\tlocal rows = {}\n\n\t\tfor _,GROUP in pairs( IGS.GetGroups() ) do -- name\n\t\t\tif fGroupFilter and fGroupFilter(GROUP) == false then continue end\n\n\t\t\tlocal pnl = uigs.Create(\"igs_group\"):SetGroup(GROUP)\n\t\t\tpnl.category = GROUP:Items()[1].item:Category() -- РїСЂРµРґРїРѕР»Р°РіР°РµРј, С‡С‚Рѕ РІ РѕРґРЅРѕР№ РіСЂСѓРїРїРµ Р±СѓРґСѓС‚ РёС‚РµРјС‹ РѕРґРЅРѕР№ РєР°С‚РµРіРѕСЂРёРё\n\n\t\t\ttable.insert(rows,pnl)\n\t\tend\n\n\t\t-- РЅРµ (i)pairs, РїРѕС‚РѕРјСѓ С‡С‚Рѕ РєР°РєРѕР№-С‚Рѕ ID РІ РєР°РєРѕРј-С‚Рѕ РѕС‡РµРЅСЊ СЂРµРґРєРѕРј СЃР»СѓС‡Р°Рµ РјРѕР¶РµС‚ РѕС‚СЃСѓС‚СЃС‚РІРѕРІР°С‚СЊ\n\t\t-- РµСЃР»Рё РµРіРѕ РєС‚Рѕ-С‚Рѕ РїСЂРёРЅСѓРґРёС‚РµР»СЊРЅРѕ Р·Р°РЅРёР»РёС‚, С‡С‚РѕР±С‹ СѓР±СЂР°С‚СЊ РёС‚РµРј РЅР°РїСЂРёРјРµСЂ.\n\t\t-- РҐРѕС‚СЏ РјР°Р»РѕРІРµСЂРѕСЏС‚РЅРѕ, РЅРѕ РІСЃРµ Р¶Рµ\n\t\tfor _,ITEM in pairs(IGS.GetItems()) do\n\t\t\tif fItemsFilter and fItemsFilter(ITEM) == false then continue end\n\t\t\tif ITEM:IsHidden() then continue end -- РµС‰Рµ РІ IGS.WIN.Group\n\t\t\tif ITEM:Group()    then continue end -- РіСЂСѓРїРїРёСЂРѕРІР°РЅРЅС‹Рµ РёС‚РµРјС‹ Р·Р°СЃСѓРЅСѓС‚С‹ РІ РіСЂСѓРїРїСѓ РІС‹С€Рµ\n\t\t\tif ITEM.isnull     then continue end -- РїСѓСЃС‚С‹С€РєР°\n\n\t\t\tlocal pnl = uigs.Create(\"igs_item\"):SetItem(ITEM)\n\t\t\tpnl.category = ITEM:Category()\n\n\t\t\ttable.insert(rows,pnl)\n\t\tend\n\n\t\tfor _,pnl in ipairs(rows) do\n\t\t\tbg.categs:Add(pnl,pnl.category or \"Р Р°Р·РЅРѕРµ\").title:SetTextColor(IGS.col.TEXT_HARD) -- http://joxi.ru/Y2LqqyBh5BODA6\n\t\t\tcats[pnl.category or \"Р Р°Р·РЅРѕРµ\"] = true\n\t\tend\n\tend\n\taddItems()\n\n\n\n\t--[[-------------------------------------------------------------------------\n\t\tРўРµРіРё (Р‘С‹СЃС‚СЂС‹Р№ РІС‹Р±РѕСЂ РєР°С‚РµРіРѕСЂРёРё)\n\t---------------------------------------------------------------------------]]\n\tlocal cat_list = {}\n\tfor categ in pairs(cats) do\n\t\ttable.insert(cat_list, categ)\n\tend\n\ttable.sort(cat_list, function(a, b) return tostring(a) \u003c tostring(b) end)\n\n\tfor i, categ in ipairs(cat_list) do\n\t\t-- РџРѕР»СѓС‡Р°РµРј РёРєРѕРЅРєСѓ РґР»СЏ РєР°С‚РµРіРѕСЂРёРё\n\t\tlocal categoryIcon = IGS.GetCategoryIcon(categ)\n\t\t\n\t\tlocal tag = bg.tags:AddTag(categ, function(self)\n\t\t\t-- РЎР±СЂР°СЃС‹РІР°РµРј Р°РєС‚РёРІРЅРѕРµ СЃРѕСЃС‚РѕСЏРЅРёРµ СЃРѕ РІСЃРµС… С‚РµРіРѕРІ\n\t\t\tfor _, child in ipairs(bg.tags:GetChildren()) do\n\t\t\t\tif child.SetActive then\n\t\t\t\t\tchild:SetActive(false)\n\t\t\t\tend\n\t\t\tend\n\t\t\t\n\t\t\t-- РЈСЃС‚Р°РЅР°РІР»РёРІР°РµРј Р°РєС‚РёРІРЅРѕРµ СЃРѕСЃС‚РѕСЏРЅРёРµ С‚РѕР»СЊРєРѕ РЅР° С‚РµРєСѓС‰РёР№ С‚РµРі\n\t\t\tself:SetActive(true)\n\t\t\t\n\t\t\t-- РџСЂРµРґР·Р°РіСЂСѓР¶Р°РµРј РёРєРѕРЅРєРё С‚РѕРІР°СЂРѕРІ СЌС‚РѕР№ РєР°С‚РµРіРѕСЂРёРё\n\t\t\tfor uid, ITEM in pairs(IGS.ITEMS.STORED or {}) do\n\t\t\t\tlocal itemCategory = ITEM:Category()\n\t\t\t\tlocal matchesCategory = (self.categ == \"Р Р°Р·РЅРѕРµ\" and !itemCategory) or (itemCategory == self.categ)\n\t\t\t\t\n\t\t\t\tif matchesCategory then\n\t\t\t\t\tlocal icon = ITEM:ICON()\n\t\t\t\t\tif icon and icon:match(\"^https?://\") and not texture.Get(icon) then\n\t\t\t\t\t\ttexture.Create(icon)\n\t\t\t\t\t\t\t:SetSize(256, 256)\n\t\t\t\t\t\t\t:SetFormat(icon:sub(-3) == \"jpg\" and \"jpg\" or \"png\")\n\t\t\t\t\t\t\t:Download(icon)\n\t\t\t\t\tend\n\t\t\t\tend\n\t\t\tend\n\t\t\t\n\t\t\tbg.categs:Clear()\n\n\t\t\t-- #todo РїРµСЂРµРїРёСЃР°С‚СЊ СЌС‚Рѕ РіРѕРІРЅРёС‰Рµ\n\t\t\taddItems(function(ITEM)\n\t\t\t\treturn self.categ == \"Р Р°Р·РЅРѕРµ\" and !ITEM:Category() or (ITEM:Category() == self.categ)\n\t\t\tend,function(GROUP)\n\t\t\t\treturn self.categ == \"Р Р°Р·РЅРѕРµ\" and !GROUP:Items()[1].item:Category() or (GROUP:Items()[1].item:Category() == self.categ)\n\t\t\tend)\n\t\tend, categoryIcon)\n\t\ttag.categ = categ\n\n\t\tif i == 1 then\n\t\t\tbg.firstTag = tag\n\t\t\ttag:SetActive(true)\n\t\t\ttag:DoClick()\n\t\tend\n\tend\n\tbg.OnOpen = function()\n\t\tlocal frame = activity:GetParent()\n\t\tif frame and frame.SetSidebarVisible then\n\t\t\tframe:SetSidebarVisible(false)\n\t\tend\n\n\t\tlocal new_w = activity:GetContentWide()\n\t\ttagspan:SetWide(new_w)\n\t\ttagspan:SetPos(0, 0)\n\t\tbg.tags:SetWide(new_w - 5 - 5)\n\t\tbg.categs:SetWide(new_w)\n\t\tbg.categs:SetTall(activity:GetTall() - tagspan:GetTall())\n\t\tbg.categs:SetPos(0, tagspan:GetTall())\n\n\t\t-- РќР° РїРµСЂРІРѕРј РѕС‚РєСЂС‹С‚РёРё РїРµСЂРµСЃРѕР±РёСЂР°РµРј СЃРїРёСЃРѕРє РїРѕСЃР»Рµ РєРѕСЂСЂРµРєС‚РЅРѕР№ С€РёСЂРёРЅС‹\n\t\tif not bg._firstOpen then\n\t\t\tbg._firstOpen = true\n\t\t\tif IsValid(bg.firstTag) then\n\t\t\t\tbg.firstTag:DoClick()\n\t\t\tend\n\t\tend\n\tend\n\n\tactivity:AddTab(\"РЈСЃР»СѓРіРё\",bg,\"materials/icons/fa32/rub.png\",etoGlavnayaVkladkaBlya)\nend)\n\n-- local p = IGS.UI()\n-- timer.Simple(3,function() if IsValid(p) then p:Remove() end end)\n","igs/interface/activities/profile.lua":  "-- РџСЂРѕС„РёР»СЊ, РіРґРµ С‚СЂР°РЅР·Р°РєС†РёРё Рё РїСЂРѕРіСЂРµСЃСЃ РґРѕ СЃР»РµРґ. Р±РѕРЅСѓСЃР°, Р° С‚Р°РєР¶Рµ РјРµСЃС‚Рѕ РІ С‚РѕРїРµ РґРѕРЅР°С‚РµСЂРѕРІ Р·Р° РјРµСЃСЏС†, Р±РёР·РЅРµСЃ Р»РµРІРµР»\n-- РџСЂРѕС‚РѕС‚РёРї https://pp.vk.me/c638927/v638927381/1ec19/nQnaytZDxls.jpg (Р’С‹С€Р»Рѕ СЃРѕРІСЃРµРј РЅРµ РєР°Рє Р·Р°РґСѓРјР°РЅРѕ)\n-- РЎС‚РѕРёРјРѕСЃС‚СЊ СѓСЃР»СѓРіРё РїРѕ С‚РµРєСѓС‰РµРјСѓ РєСѓСЂСЃСѓ\n\nlocal LP\nhook.Add(\"IGS.CatchActivities\",\"profile\",function(activity,sidebar)\n\tLP = LP or LocalPlayer()\n\n\tlocal bg = sidebar:AddPage(\"РРЅС„РѕСЂРјР°С†РёСЏ РїСЂРѕС„РёР»СЏ\")\n\tlocal ava_bg = uigs.Create(\"Panel\", function(self)\n\t\tlocal y = 5\n\n\t\t-- РђРІР°С‚Р°СЂ\n\t\tlocal sw     = bg.side:GetWide() -- 220\n\t\tlocal margin = (sw - 184) / 2\n\t\tuigs.Create(\"AvatarImage\", function(ava)\n\t\t\tava:SetSize(184,184)\n\t\t\tava:SetPos(margin,y)\n\t\t\tava:SetPlayer(LP,184)\n\n\t\t\ty = y + 184\n\t\tend, self)\n\n\t\t-- РќРёРє\n\t\tuigs.Create(\"DLabel\", function(nick)\n\t\t\tnick:SetSize(sw,24)\n\t\t\tnick:SetPos(0,y)\n\t\t\tnick:SetFont(\"Fated.24\")\n\t\t\tnick:SetTextColor(IGS.col.HIGHLIGHTING)\n\t\t\tnick:SetText(LP:Nick())\n\t\t\tnick:SetContentAlignment(5)\n\n\t\t\ty = y + nick:GetTall()\n\t\tend, self)\n\n\t\t-- РЎС‚РёРјР°Р№РґРё\n\t\tuigs.Create(\"DLabel\", function(sid)\n\t\t\tsid:SetSize(sw,18)\n\t\t\tsid:SetPos(0,y)\n\t\t\tsid:SetFont(\"Fated.18\")\n\t\t\tsid:SetTextColor(IGS.col.TEXT_SOFT)\n\t\t\tsid:SetText(\"(\" .. LP:SteamID() .. \")\")\n\t\t\tsid:SetContentAlignment(5)\n\n\t\t\ty = y + sid:GetTall() + 10\n\t\tend, self)\n\n\t\tfunction self:AddRow(sName,sVal)\n\t\t\tlocal row_bg = uigs.Create(\"Panel\", self)\n\t\t\trow_bg:SetSize(sw,20) -- 20, РєР°Рє Рё СЂР°Р·РјРµСЂ С€СЂРёС„С‚Р°\n\t\t\trow_bg:SetPos(0,y)\n\n\t\t\t-- Key\n\t\t\tlocal n = uigs.Create(\"DLabel\", function(name)\n\t\t\t\tname:SetSize(80,row_bg:GetTall())\n\t\t\t\tname:SetPos(0,0)\n\t\t\t\tname:SetFont(\"Fated.17\")\n\t\t\t\tname:SetTextColor(IGS.col.TEXT_SOFT)\n\t\t\t\tname:SetText(sName)\n\t\t\t\tname:SetContentAlignment(6)\n\t\t\tend, row_bg)\n\n\t\t\t-- Value\n\t\t\tfor i,line in ipairs(string.Wrap(\"Fated.18\",sVal,sw - n:GetWide() - 5)) do\n\t\t\t\tuigs.Create(\"DLabel\", function(val)\n\t\t\t\t\tval:SetSize(sw - n:GetWide() - 5,n:GetTall())\n\t\t\t\t\tval:SetPos(n:GetWide() + 5,(i - 1) * val:GetTall())\n\t\t\t\t\tval:SetFont(\"Fated.18\")\n\t\t\t\t\tval:SetTextColor(IGS.col.TEXT_HARD)\n\t\t\t\t\tval:SetText(line)\n\n\t\t\t\t\ty = y + val:GetTall()\n\t\t\t\t\trow_bg:SetTall(row_bg:GetTall() + val:GetTall())\n\t\t\t\tend, row_bg)\n\t\t\tend\n\n\t\t\tself:SetTall(y + 5)\n\t\tend\n\n\t\tself:SetTall(y + 5)\n\tend)\n\n\tlocal lvl = IGS.PlayerLVL(LP)\n\tlocal mybal  = LP:IGSFunds()\n\tlocal next_lvl = !lvl and IGS.LVL.MAP[1] or lvl:GetNext()\n\n\tava_bg:AddRow(\"РЎС‚Р°С‚СѓСЃ\",lvl and lvl:Name() or \"РќРёРєС‚Рѕ :(\")\n\tif next_lvl then\n\t\tlocal next_desc = next_lvl:Description()\n\n\t\tava_bg:AddRow(\"РЎР»РµРґ. СЃС‚Р°С‚СѓСЃ\", next_lvl:Name() .. (next_desc and (\"\\n\\n%s\"):format(next_desc) or \"\"))\n\t\tava_bg:AddRow(\"РќСѓР¶РЅРѕ\", next_lvl:Cost() - IGS.RealPrice( IGS.TotalTransaction(LP) ) .. \" СЂСѓР±\")\n\tend\n\n\tbg.side:AddItem(ava_bg)\n\n\t--[[-------------------------------------------------------------------------\n\t\tРћСЃРЅРѕРІРЅР°СЏ С‡Р°СЃС‚СЊ С„СЂРµР№РјР°\n\t---------------------------------------------------------------------------]]\n\tuigs.Create(\"igs_table\", function(pnl)\n\t\tpnl:Dock(FILL)\n\t\tpnl:DockMargin(5,5,5,5)\n\n\t\tpnl:SetTitle(\"РўСЂР°РЅР·Р°РєС†РёРё\")\n\n\t\tlocal multisv = IGS.SERVERS.TOTAL \u003e 1\n\t\tif multisv then\n\t\t\tpnl:AddColumn(\"РЎРµСЂРІРµСЂ\",100)\n\t\telse\n\t\t\tpnl:AddColumn(\"#\",40)\n\t\tend\n\n\t\tpnl:AddColumn(\"РЎСѓРјРјР°\",60)\n\t\tpnl:AddColumn(\"Р‘Р°Р»Р°РЅСЃ\",60)\n\t\tpnl:AddColumn(\"Р”РµР№СЃС‚РІРёРµ\")\n\t\tpnl:AddColumn(\"Р”Р°С‚Р°\",130)\n\n\t\t-- РћР±РЅРѕРІР»РµРЅРёРµ СЃРїРёСЃРєР° С‚СЂР°РЅР·Р°РєС†РёР№ Рё РёРЅС„РѕСЂРјР°С†РёРё РІ СЃР°Р№РґР±Р°СЂРµ\n\t\tIGS.GetMyTransactions(function(dat)\n\t\t\tif !IsValid(pnl) then return end -- Р”РѕР»РіРѕ РґР°РЅРЅС‹Рµ РїРѕР»СѓС‡Р°Р»РёСЃСЊ\n\n\t\t\tlocal bit_num_limit = 2 ^ IGS.BIT_TX - 1\n\t\t\tif #dat == bit_num_limit then\n\t\t\t\tpnl:SetTitle(\"РџРѕСЃР»РµРґРЅРёРµ \" .. bit_num_limit .. \" С‚СЂР°РЅР·Р°РєС†РёР№\")\n\t\t\tend\n\n\t\t\tfor i,v in ipairs(dat) do\n\t\t\t\tv.note = v.note or \"-\"\n\n\t\t\t\t-- Р•СЃР»Рё РїРѕРєСѓРїРєР°, С‚Рѕ РїРёС€РµРј РµРµ РЅР°Р·РІР°РЅРёРµ РёР»Рё РїРёС€РµРј СЃ С‡РµРј СЃРІСЏР·Р°РЅР° С‚СЂР°РЅР·Р°РєС†РёСЏ\n\t\t\t\tlocal note =\n\t\t\t\t\tv.note:StartWith(\"P: \") and IGS.GetItemByUID(v.note:sub(4)):Name() or\n\t\t\t\t\tv.note:StartWith(\"A: \") and (\"РџРѕРїРѕР»РЅРµРЅРёРµ СЃС‡РµС‚Р° (\" .. v.note:sub(4) .. \")\") or\n\t\t\t\t\tv.note:StartWith(\"C: \") and (\"РљСѓРїРѕРЅ \" .. v.note:sub(4,13) .. \"...\") or\n\t\t\t\t\tv.note\n\n\t\t\t\tpnl:AddLine(\n\t\t\t\t\t-- v.id,\n\t\t\t\t\tmultisv and IGS.ServerName(v.server) or #dat - i + 1,\n\t\t\t\t\tv.sum,\n\t\t\t\t\tmath.Truncate(mybal,2), -- РЅРµ РїСЂРµРґСЃС‚Р°РІР»СЏСЋ РєР°Рє, РЅРѕ РІСЂРµРјРµРЅР°РјРё РїРѕР»СѓС‡Р°Р»РёСЃСЊ РѕС‡РµРЅСЊ Р±РѕР»СЊС€РёРµ РєРѕРїРµР№РєРё\n\t\t\t\t\tnote,\n\t\t\t\t\tIGS.TimestampToDate(v.date,true)\n\t\t\t\t):SetTooltip((\"%s\\n\\nID С‚СЂР°РЅР·Р°РєС†РёРё РІ СЃРёСЃС‚РµРјРµ: %i%s\"):format(\n\t\t\t\t\tnote,\n\t\t\t\t\tv.id,\n\t\t\t\t\tnote ~= v.note and (\"\\nРћСЂРёРіРёРЅР°Р»СЊРЅР°СЏ РѕС‚РјРµС‚РєР°: \" .. v.note) or \"\"\n\t\t\t\t))\n\n\t\t\t\tmybal = mybal - v.sum\n\t\t\tend\n\n\t\t\tlocal spent = IGS.isUser(LP) and (IGS.TotalTransaction(LP) - mybal) or 0\n\n\t\t\tlocal first = dat[ #dat ]\n\t\t\tava_bg:AddRow(\"## РћРїРµСЂР°С†РёР№\",#dat .. \" С€С‚.\")\n\t\t\tava_bg:AddRow(\"в€‘ РћРїРµСЂР°С†РёР№\",IGS.SignPrice(spent))\n\t\t\tava_bg:AddRow(\"1 РћРїРµСЂР°С†РёСЏ\",first and IGS.TimestampToDate(first.date) or \"РќРµ Р±С‹Р»Рѕ\")\n\n\t\t\t-- РљРЅРѕРїРєР° \"РђРєС‚РёРІРёСЂРѕРІР°С‚СЊ РєСѓРїРѕРЅ\" РїРµСЂРµРЅРµСЃРµРЅР° РІ С€Р°РїРєСѓ РіР»Р°РІРЅРѕРіРѕ РјРµРЅСЋ\n\n\t\t\tbg.side:AddItem(uigs.Create(\"Panel\", function(s)\n\t\t\t\ts:SetTall(5)\n\t\t\tend))\n\n\t\tend)\n\tend, bg)\n\n\tactivity:AddTab(\"РџСЂРѕС„РёР»СЊ\",bg,\"materials/icons/fa32/user.png\")\nend)\n\n-- IGS.UI()\n","igs/interface/activities/purchases.lua":  "\nhook.Add(\"IGS.CatchActivities\",\"purchases\",function(activity,sidebar)\n\tlocal bg = uigs.Create(\"Panel\")\n\t\n\tbg.OnOpen = function()\n\t\tlocal frame = activity:GetParent()\n\t\tif frame and frame.SetSidebarVisible then\n\t\t\tframe:SetSidebarVisible(false)\n\t\tend\n\tend\n\n\t--[[-------------------------------------------------------------------------\n\t\tРћСЃРЅРѕРІРЅР°СЏ С‡Р°СЃС‚СЊ С„СЂРµР№РјР°\n\t---------------------------------------------------------------------------]]\n\tuigs.Create(\"igs_table\", function(pnl)\n\t\tpnl:Dock(FILL)\n\t\tpnl:DockMargin(5,5,5,5)\n\n\t\tpnl:SetTitle(\"РђРєС‚РёРІРЅС‹Рµ РїРѕРєСѓРїРєРё\")\n\n\t\tlocal multisv = IGS.SERVERS.TOTAL \u003e 1\n\t\tif multisv then\n\t\t\tpnl:AddColumn(\"РЎРµСЂРІРµСЂ\",100)\n\t\telse\n\t\t\tpnl:AddColumn(\"#\",40)\n\t\tend\n\n\t\tpnl:AddColumn(\"РџСЂРµРґРјРµС‚\")\n\t\tpnl:AddColumn(\"РљСѓРїР»РµРЅ\",90)\n\t\tpnl:AddColumn(\"РСЃС‚РµС‡РµС‚\",90)\n\n\n\t\tIGS.GetMyPurchases(function(d)\n\t\t\tif !IsValid(pnl) then return end -- Р”РѕР»РіРѕ РґР°РЅРЅС‹Рµ РїРѕР»СѓС‡Р°Р»РёСЃСЊ, С„СЂРµР№Рј СѓСЃРїРµР»Рё Р·Р°РєСЂС‹С‚СЊ\n\n\t\t\tfor i,v in ipairs(d) do\n\t\t\t\tlocal sv_name = IGS.ServerName(v.server)\n\t\t\t\tlocal ITEM    = IGS.GetItemByUID(v.item)\n\t\t\t\tlocal sName   = ITEM.isnull and v.item or ITEM:Name()\n\n\t\t\t\tpnl:AddLine(\n\t\t\t\t\t-- v.id,\n\t\t\t\t\tmultisv and sv_name or #d - i + 1,\n\t\t\t\t\tsName,\n\t\t\t\t\tIGS.TimestampToDate(v.purchase) or \"РќРёРєРѕРіРґР°\",\n\t\t\t\t\tIGS.TimestampToDate(v.expire)   or \"РќРёРєРѕРіРґР°\"\n\t\t\t\t):SetTooltip(\"РРјСЏ СЃРµСЂРІРµСЂР°: \" .. sv_name .. \"\\nID РІ СЃРёСЃС‚РµРјРµ: \" .. v.id .. \"\\nРћСЂРёРіРёРЅР°Р»СЊРЅРѕРµ РЅР°Р·РІР°РЅРёРµ: \" .. v.item)\n\t\t\tend\n\t\tend)\n\tend, bg)\n\n\tactivity:AddTab(\"РџРѕРєСѓРїРєРё\",bg,\"materials/icons/fa32/reorder.png\")\nend)\n\n-- IGS.UI()\n","igs/interface/core.lua":  "IGS.WIN = IGS.WIN or {}\n\nif CLIENT then\n\tif not Mantle then\n\t\tpcall(include, \"mantle/init.lua\")\n\tend\n\n\t-- Ensure Mantle fonts exist before any SetFont calls\n\tlocal function EnsureFatedFonts()\n\t\tlocal sizes = {15,16,17,18,19,20,22,24,40}\n\t\tfor _, size in ipairs(sizes) do\n\t\t\tsurface.CreateFont(\"Fated.\" .. size, {\n\t\t\t\tfont = \"Montserrat Medium\",\n\t\t\t\tsize = size,\n\t\t\t\textended = true\n\t\t\t})\n\t\t\tsurface.CreateFont(\"Fated.\" .. size .. \"b\", {\n\t\t\t\tfont = \"Montserrat Bold\",\n\t\t\t\tsize = size,\n\t\t\t\textended = true\n\t\t\t})\n\t\tend\n\tend\n\n\tEnsureFatedFonts()\nend\n\nuigs = uigs or {}\nfunction uigs.Create(t, f, p)\n\tlocal cb, parent = f, p\n\n\tif not isfunction(f) then -- nil or panel\n\t\tparent, cb = f, nil\n\tend\n\n\tlocal v = vgui.Create(t, parent)\n\tif cb then cb(v, parent) end\n\treturn v\nend\n-- uigs.Create(\"name\")\n-- uigs.Create(\"name\", parent)\n-- uigs.Create(\"name\", func, parent)\n-- uigs.Create(\"name\", func)\n\n\n-- Р§С‚РѕР±С‹ РЅРµ РѕС‚РєСЂС‹РІР°Р»Рѕ F1 РјРµРЅСЋС€РєСѓ РґР°СЂРєСЂРїС€РµРІСЃРєСѓСЋ РµР±СѓС‡СѓСЋ\nhook.Add(\"DarkRPFinishedLoading\",\"SupressDarkRPF1\",function()\n\tif IGS.C.MENUBUTTON ~= KEY_F1 then return end\n\n\tlocal GM = GM or GAMEMODE\n\tfunction GM:ShowHelp() end\nend)\n\n\n\n\n\n\n-- С‡С‚РѕР±С‹ Р°СЂРіСѓРјРµРЅС‚РѕРј РЅРµ РїРµСЂРµРґР°Р»Р°СЃСЊ РїР°РЅРµР»СЊ\nlocal function dep() IGS.WIN.Deposit() end\n\n\nlocal mf -- Р°РЅС‚РёРґСѓР±Р»РёРєР°С‚\nfunction IGS.UI()\n\tif not IGS.IsLoaded() then\n\t\tLocalPlayer():ChatPrint(\"[IGS] РђРІС‚РѕРґРѕРЅР°С‚ РЅРµ Р·Р°РіСЂСѓР¶РµРЅ\")\n\t\treturn\n\tend\n\n\tif not IGS.C then -- РџСЂРѕР±Р»РµРјР° AddCSLua. Р’ РєРѕРЅСЃРѕР»Рё РєР»РёРµРЅС‚Р° РґРѕР»Р¶РЅС‹ Р±С‹С‚СЊ РѕС€РёР±РєРё РёРЅРєР»СЋРґР° РЅРµСЃРєРѕР»СЊРєРёС… Р±Р°Р·РѕРІС‹С… С„Р°Р№Р»РѕРІ\n\t\tLocalPlayer():ChatPrint(\"[IGS] РђРІС‚РѕРґРѕРЅР°С‚ СѓСЃС‚Р°РЅРѕРІР»РµРЅ РЅРµРїСЂР°РІРёР»СЊРЅРѕ. РЎРѕРѕР±С‰РёС‚Рµ Р°РґРјРёРЅРёСЃС‚СЂР°С†РёРё\")\n\t\treturn\n\tend\n\n\tif IsValid(mf) then\n\t\tif not mf:IsVisible() then\n\t\t\tIGS.ShowUI()\n\t\tend\n\t\treturn\n\tend\n\n\tmf = uigs.Create(\"igs_frame\", function(self)\n\t\t-- 700 = (items_in_line * item_pan_wide) + (10(margin) * (items_in_line + 1))\n\t\tself:SetSize(math.min(ScrW(), 900), math.min(ScrH(), 650)) -- РїРѕР·РІРѕР»СЏРµС‚ Р·Р°РєСЂС‹С‚СЊ РѕРєРЅРѕ РЅР° СѓС‰РµСЂР±РЅС‹С… СЂР°Р·СЂРµС€РµРЅРёСЏС…\n\t\t-- РџРµСЂРµРѕРїСЂРµРґРµР»СЏРµРј RestoreLocation С‡С‚РѕР±С‹ РІСЃРµРіРґР° С†РµРЅС‚СЂРёСЂРѕРІР°С‚СЊ РѕРєРЅРѕ\n\t\tself.RestoreLocation = function() self:Center() end\n\t\tself:RememberLocation(\"igs\")\n\t\tself:MakePopup()\n\n\t\t-- РµСЃР»Рё РїРѕРІРµСЃРёС‚СЊ РЅР° С„СЂРµР№Рј, С‚Рѕ РґСЂР°Рі СЃР»РѕРјР°РµС‚СЃСЏ\n\t\tlocal init = CurTime() -- https://t.me/c/1353676159/7185\n\t\tfunction self.btnClose:Think()\n\t\t\tif CurTime() - init \u003e 1 and input.IsKeyDown(IGS.C.MENUBUTTON) then\n\t\t\t\tIGS.HideUI()\n\t\t\tend\n\t\tend\n\tend)\n\n--Р±Р°Р»Р°РЅСЃ\n-- РЎРѕР·РґР°РµРј РєРѕРЅС‚РµР№РЅРµСЂ РґР»СЏ Р±Р°Р»Р°РЅСЃР° Рё РєРЅРѕРїРѕРє\nlocal container = vgui.Create(\"Panel\", mf)\nlocal containerWidth = 150 + 100 + 110 -- Р±Р°Р»Р°РЅСЃ + РєСѓРїРѕРЅ + РїРѕРїРѕР»РЅРёС‚СЊ\ncontainer:SetPos(mf:GetWide() - 20 - containerWidth, 0)\ncontainer:SetSize(containerWidth, 23)\n\n-- РћР±С‰Р°СЏ РѕР±РІРѕРґРєР° РґР»СЏ РІСЃРµРіРѕ Р±Р»РѕРєР°\ncontainer.Paint = function(s, w, h)\n    -- Р Р°Р·РјС‹С‚РёРµ С„РѕРЅР°\n    if RNDX and Mantle and Mantle.ui.convar.blur then\n        RNDX().Rect(0, 0, w, h)\n            :Rad(4)\n            :Blur(0.8)\n        :Draw()\n    end\n    \n    -- Р¤РѕРЅ Рё РѕР±РІРѕРґРєР°\n    draw.RoundedBox(4, 0, 0, w, h, IGS.col.HIGHLIGHTING) -- outline\n    draw.RoundedBox(4, 1, 1, w - 2, h - 2, IGS.col.PASSIVE_SELECTIONS) -- bg\nend\n\n-- Р РёСЃСѓРµРј СЂР°Р·РґРµР»РёС‚РµР»Рё РїРѕРІРµСЂС… РІСЃРµРіРѕ, С‡С‚РѕР±С‹ РѕРЅРё РЅРµ РїРµСЂРµРєСЂС‹РІР°Р»РёСЃСЊ hover-СЌС„С„РµРєС‚Р°РјРё\ncontainer.PaintOver = function(s, w, h)\n    -- Р–РёСЂРЅС‹Рµ СЂР°Р·РґРµР»РёС‚РµР»Рё РјРµР¶РґСѓ РєРЅРѕРїРєР°РјРё (СЃС‚СЂРѕРіРѕ РѕРґРёРЅР°РєРѕРІР°СЏ С‚РѕР»С‰РёРЅР° 3 РїРёРєСЃРµР»СЏ)\n    draw.RoundedBox(0, 149, 2, 3, h - 4, IGS.col.HIGHLIGHTING) -- РїРѕСЃР»Рµ Р±Р°Р»Р°РЅСЃР°\n    draw.RoundedBox(0, 249, 2, 3, h - 4, IGS.col.HIGHLIGHTING) -- РїРѕСЃР»Рµ РєСѓРїРѕРЅР°\nend\n\n-- РџР°РЅРµР»СЊ Р±Р°Р»Р°РЅСЃР° (С‚РµРїРµСЂСЊ РїСЂРѕСЃС‚Рѕ РёРЅС„РѕСЂРјР°С†РёРѕРЅРЅР°СЏ, РЅРµ РєРЅРѕРїРєР°)\nlocal balancePanel = vgui.Create(\"Panel\", container)\nbalancePanel:SetPos(0, 0)\nbalancePanel:SetSize(150, 23)\n\nbalancePanel.Paint = function(s, w, h)\n    local font = \"Fated.16\"\n    local text = s.balanceText or \"\"\n    local col = IGS.col.TEXT_HARD or color_white\n    \n    draw.SimpleText(text, font, w / 2, h / 2, col, TEXT_ALIGN_CENTER, TEXT_ALIGN_CENTER)\nend\n\nfunction balancePanel:UPDBalance()\n    self.bal = LocalPlayer():IGSFunds()\n    self.balanceText = \"Р‘Р°Р»Р°РЅСЃ: \" .. IGS.SignPrice(self.bal)\nend\n\nbalancePanel:UPDBalance()\n\nbalancePanel.Think = function(s)\n    if s.bal ~= LocalPlayer():IGSFunds() then\n        s:UPDBalance()\n    end\nend\n\n-- РљРЅРѕРїРєР° \"РљСѓРїРѕРЅ\"\n    local coupon = vgui.Create(\"DButton\", container)\n    coupon:SetPos(150, 0)\n    coupon:SetSize(100, 23)\n    coupon:SetText(\"РљСѓРїРѕРЅ\")\n    coupon:SetFont(\"Fated.18\")\n    coupon:SetTextColor(IGS.col.TEXT_ON_HIGHLIGHT)\n    coupon:SetTooltip(\"РђРєС‚РёРІРёСЂРѕРІР°С‚СЊ РєСѓРїРѕРЅ\")\n    coupon.Paint = function(s, w, h)\n        if s:IsHovered() then\n            draw.RoundedBox(0, 0, 0, w, h, Color(255, 255, 255, 15))\n        elseif s:IsDown() then\n            draw.RoundedBox(0, 0, 0, w, h, Color(0, 0, 0, 30))\n        end\n    end\n    coupon.DoClick = function()\n        IGS.WIN.ActivateCoupon()\n    end\n    \n    -- РљРЅРѕРїРєР° \"РџРѕРїРѕР»РЅРёС‚СЊ\"\n    local add = vgui.Create(\"DButton\", container)\n    add:SetPos(250, 0)\n    add:SetSize(110, 23)\n    add:SetText(\"РџРѕРїРѕР»РЅРёС‚СЊ\")\n    add:SetFont(\"Fated.18\")\n    add:SetTextColor(IGS.col.TEXT_ON_HIGHLIGHT)\n    add:SetTooltip(\"РџРѕРїРѕР»РЅРµРЅРёРµ СЃС‡РµС‚Р°\")\n    add.Paint = function(s, w, h)\n        -- РђРєС‚РёРІРЅР°СЏ РєРЅРѕРїРєР°\n        draw.RoundedBoxEx(4, 0, 0, w, h, Color(70, 70, 85, 230), false, true, false, true)\n        \n        if s:IsHovered() then\n            draw.RoundedBoxEx(4, 0, 0, w, h, Color(255, 255, 255, 20), false, true, false, true)\n        elseif s:IsDown() then\n            draw.RoundedBoxEx(4, 0, 0, w, h, Color(0, 0, 0, 40), false, true, false, true)\n        end\n    end\nadd.DoClick = dep\n\n\tlocal framePad = 10\n\tmf.activity = uigs.Create(\"igs_tabbar\", function(self)\n\t\tself:SetPos(framePad, mf:GetTitleHeight() + framePad)\n\t\tself:SetSize(700 - framePad * 2, mf:GetTall() - mf:GetTitleHeight() - framePad * 2)\n\tend, mf)\n\n\t-- РҐРµСЂРЅСЏ СЃРїСЂР°РІР° РѕС‚ Р»СЌР№Р°СѓС‚Р° СЃ СѓСЃР»СѓРіР°РјРё http://joxi.ru/52aQQ8Efzov120\n\t-- Р’РёРґ Р±РµР· РЅРµРµ: http://joxi.ru/eAO44lGcXORlro\n\tmf._activityWidthDefault = mf.activity:GetWide()\n\n\tlocal x,y = mf.activity:GetPos()\n\tmf.sidebar = uigs.Create(\"igs_sidebar\", mf)\n\tmf.sidebar:SetSize(mf:GetWide() - framePad * 2 - mf.activity:GetWide(), mf.activity:GetTall() + 1 + 1)\n\tmf.sidebar:SetPos(x + mf.activity:GetWide(),y - 1) -- -1 С‡С‚РѕР±С‹ РїРµСЂРµРєСЂС‹С‚СЊ РїРѕРґС‡РµСЂРєРёРІР°РЅРёРµ С…СЌРґРµСЂР°\n\tmf.sidebar.PaintOver = function(_,_,h)\n\t\tsurface.SetDrawColor(IGS.col.HARD_LINE)\n\t\tsurface.DrawLine(0,0,0,h) -- Р»РёРЅРёСЏ СЃР»РµРІР°\n\tend\n\tmf.sidebar.header.Paint = function(_,w,h)\n\t\t-- Р Р°Р·РјС‹С‚РёРµ header\u0027Р° sidebar\u0027Р°\n\t\tif RNDX and Mantle and Mantle.ui.convar.blur then\n\t\t\tRNDX().Rect(0, 0, w, h)\n\t\t\t\t:Rad(0)\n\t\t\t\t:Blur(1.2)\n\t\t\t:Draw()\n\t\tend\n\t\t\n\t\tdraw.RoundedBox(0,0,0,w,h,IGS.col.FRAME_HEADER)\n\n\t\t-- РЈР±СЂР°РЅР° Р»РёРЅРёСЏ СЃРЅРёР·Сѓ header\u0027Р°\n\t\t-- surface.SetDrawColor(IGS.col.HARD_LINE)\n\t\t-- surface.DrawLine(0,h - 1,w,h - 1)\n\tend\n\n\tmf.sidebar.activity = uigs.Create(\"igs_multipanel\", mf.sidebar.sidebar)\n\tmf.sidebar.activity:Dock(FILL)\n\n\tfunction mf.sidebar:AddPanel(panel,active)\n\t\treturn self.activity:AddPanel(panel,active)\n\tend\n\n\tfunction mf.sidebar:Show(iPanelID)\n\t\treturn self.activity:SetActivePanel(iPanelID)\n\tend\n\n\tfunction mf:SetSidebarVisible(bVisible)\n\t\tlocal ax, ay = self.activity:GetPos()\n\t\tlocal activityWide = self._activityWidthDefault or self.activity:GetWide()\n\n\t\tif bVisible then\n\t\t\tself.sidebar:SetVisible(true)\n\t\t\tself.activity:SetSize(activityWide, self.activity:GetTall())\n\t\t\tself.sidebar:SetSize(self:GetWide() - framePad * 2 - activityWide, self.activity:GetTall() + 1 + 1)\n\t\t\tself.sidebar:SetPos(ax + activityWide, ay - 1)\n\t\telse\n\t\t\tself.sidebar:SetVisible(false)\n\t\t\tself.activity:SetSize(self:GetWide() - framePad * 2, self.activity:GetTall())\n\t\tend\n\n\t\tself.activity:InvalidateLayout(true)\n\t\tif self.activity.PerformLayout then\n\t\t\tself.activity:PerformLayout()\n\t\tend\n\tend\n\n\tfunction mf.sidebar:AddPage(sTitle)\n\t\treturn uigs.Create(\"Panel\", function(bg)\n\t\t\tbg.side = uigs.Create(\"igs_scroll\")\n\n\t\t\tbg.SidePanelID = self:AddPanel(bg.side)\n\t\t\tbg.side:SetSize(self:GetSize()) -- РµСЃР»Рё СѓРєР°Р·Р°С‚СЊ СЂР°РЅСЊС€Рµ, С‚Рѕ СЃР±СЂРѕСЃРёС‚СЃСЏ\n\t\t\tbg.OnOpen = function(s)\n\t\t\t\tlocal frame = self:GetParent()\n\t\t\t\tif frame and frame.SetSidebarVisible then\n\t\t\t\t\tframe:SetSidebarVisible(true)\n\t\t\t\tend\n\n\t\t\t\tself:SetTitle(sTitle)\n\t\t\t\tself:Show(s.SidePanelID)\n\n\t\t\t\t-- РќРµ Р·РЅР°СЋ РєР°Рє СЃРґРµР»Р°С‚СЊ Р»СѓС‡С€Рµ.\n\t\t\t\t-- Р§РўРѕР±С‹ РЅРµ РѕРІРµСЂСЂР°Р№РґРёС‚СЊ РїРѕР»РЅРѕСЃС‚СЊСЋ - СЃРґРµР»Р°Р» РґРѕРїРѕР»РЅРёС‚РµР»СЊРЅС‹Р№ РјРµС‚РѕРґ\n\t\t\t\tif bg.OnOpenOver then\n\t\t\t\t\tbg.OnOpenOver()\n\t\t\t\tend\n\t\t\tend\n\t\tend, self)\n\tend\n\n\t-- РќРµРјРЅРѕРіРѕ РЅРµ РїСЂР°РІРёР»СЊРЅРѕ, РЅРѕ СЌС‚Р° С€С‚СѓРєР° РѕС‚РєР»СЋС‡Р°РµС‚\n\tfor hook_name in pairs(IGS.C.DisabledFrames) do\n\t\thook.Remove(\"IGS.CatchActivities\",hook_name)\n\tend\n\n\t-- РЎРѕР±РёСЂР°РµРј РєРЅРѕРїРѕС‡РєРё РІ С„СѓС‚РµСЂРµ\n\thook.Run(\"IGS.CatchActivities\",mf.activity,mf.sidebar)\n\n\treturn mf\nend\n\nfunction IGS.GetUI()\n\treturn IsValid(mf) and mf or nil\nend\n\nfunction IGS.CloseUI()\n\tif IsValid(mf) then\n\t\tmf:Close()\n\tend\nend\n\nlocal lastX,lastY -- remember\nfunction IGS.HideUI()\n\tif not mf.moving then\n\t\tmf.moving = true\n\t\tlastX,lastY = mf:GetPos()\n\t\tmf:MoveTo(-mf:GetWide(), lastY, .2)\n\t\ttimer.Simple(.2, function()\n\t\t\tmf:SetVisible(false)\n\t\t\tmf.moving = false\n\t\tend)\n\tend\nend\n\nfunction IGS.ShowUI()\n\tif not mf.moving then\n\t\tmf.moving = true\n\t\tmf:SetVisible(true)\n\t\tmf:MoveTo(lastX, lastY, .2)\n\t\ttimer.Simple(.2, function() mf.moving = false end)\n\tend\nend\n\nfunction IGS.OpenUITab(sName)\n\tlocal iui = IGS.GetUI() or IGS.UI()\n\n\tfor _,btn in ipairs(iui.activity.Buttons) do\n\t\tif btn:Name() == sName then\n\t\t\tbtn:DoClick()\n\t\tend\n\tend\nend\n\n-- Р”РѕР±Р°РІР»СЏРµС‚ Р±Р»РѕРє С‚РµРєСЃС‚Р° Рє СЃРєСЂРѕР»Р» РїР°РЅРµР»Рё. Рљ РѕР±С‹С‡РЅРѕР№ РЅРµ РІРёР¶Сѓ СЃРјС‹СЃР»Р°\n-- scroll Р”РѕР»Р¶РµРЅ РёРјРµС‚СЊ СЃС‚Р°С‚РёС‡РµСЃРєРёР№ СЂР°Р·РјРµСЂ. РќРёРєР°РєРёС… РґРѕРєРѕРІ!\n-- РЎРµС‚РєР°: https://img.qweqwe.ovh/1487023074990.png\nfunction IGS.AddTextBlock(scroll,sTitle,sText) -- РёСЃРїРѕР»СЊР·СѓРµС‚СЃСЏ РІ С„СЂРµР№РјРµ С…РµР»РїР° Рё С‡Р°СЂС‚РѕРІ\n\t-- \\/ РІСЃС‚Р°РІР»РµРЅРЅР°СЏ РїР°РЅРµР»СЊ\n\treturn scroll:AddItem(uigs.Create(\"Panel\", function(pnl)\n\t\tlocal y = 3\n\n\t\t-- Title\n\t\tif sTitle then\n\t\t\tfor _,line in ipairs( string.Wrap(\"Fated.20\",sTitle,scroll:GetWide() - 5 - 5) ) do\n\t\t\t\tlocal t = uigs.Create(\"DLabel\", pnl)\n\t\t\t\tt:SetPos(5,y)\n\t\t\t\tt:SetFont(\"Fated.20\")\n\t\t\t\tt:SetText(line)\n\t\t\t\tt:SetTextColor(IGS.col.TEXT_HARD)\n\t\t\t\tt:SizeToContents()\n\n\t\t\t\ty = y + t:GetTall()\n\t\t\tend\n\n\t\t\ty = y + 2\n\t\tend\n\n\t\tfor _,line in ipairs( string.Wrap(\"Fated.18\",sText,scroll:GetWide() - 5 - 5) ) do\n\t\t\tlocal lbl = uigs.Create(\"DLabel\", pnl)\n\t\t\tlbl:SetPos(5,y)\n\t\t\tlbl:SetFont(\"Fated.18\")\n\t\t\tlbl:SetText(line)\n\t\t\tlbl:SetTextColor(IGS.col.TEXT_SOFT)\n\t\t\tlbl:SizeToContents()\n\n\t\t\ty = y + lbl:GetTall()\n\t\tend\n\n\t\tpnl:SetTall(y + 10)\n\tend))\nend\n\nfunction IGS.AddButton(pScroll,sName,fDoClick) -- РёСЃРїРѕР»СЊР·СѓРµС‚СЃСЏ РІ РёРЅРІРµРЅС‚Р°СЂРµ Рё РїСЂРѕС„РёР»Рµ РґР»СЏ СЋР·Р° РєСѓРїРѕРЅРѕРІ\n\t-- \\/ РІСЃС‚Р°РІР»РµРЅРЅР°СЏ РїР°РЅРµР»СЊ\n\treturn pScroll:AddItem(uigs.Create(\"Panel\", function(pan)\n\t\tpan.button = uigs.Create(\"igs_button\", function(s)\n\t\t\ts:SetSize(pScroll:GetWide() - 5 - 5,50)\n\t\t\ts:SetPos(5,5)\n\t\t\ts:SetText(sName)\n\t\t\ts.DoClick = fDoClick\n\t\tend, pan)\n\n\t\tpan:SetTall(pan.button:GetTall() + 5)\n\tend))\nend\n\n-- IGS.UI()\n\n-- timer.Create(\"IGSUI\",30,1,function()\n-- \tif IsValid(mf) then\n-- \t\tmf:Close()\n-- \tend\n-- end)\n","igs/interface/skin.lua":  "--[[-------------------------------------------------------------------------\n\tР§РµСЂРµР· СЌС‚РѕС‚ С„Р°Р№Р» РЅРµРІРѕР·РјРѕР¶РЅРѕ РїРѕРІСЃРµРјРµСЃС‚РЅРѕ РёР·РјРµРЅРёС‚СЊ СЃРєРёРЅ.\n\tР”Р° Рё РІРѕРѕР±С‰Рµ, РІСЃРµ РІ РіРѕРІРЅРѕ РЅР° СЃР°РјРѕРј РґРµР»Рµ, РЅРѕ РјРЅРµ Р»РµРЅСЊ СѓР¶Рµ РґРµР»Р°С‚СЊ РІСЃРµ РїСЂР°РІРёР»СЊРЅРѕ.\n\tР­С‚Рѕ РєСѓС‡Р° РіРµРјРјРѕСЂР°, РєРѕС‚РѕСЂС‹Р№, СЃРєРѕСЂРµРµ РІСЃРµРіРѕ, РЅРёРєРѕРјСѓ РЅРµ РЅСѓР¶РµРЅ\n---------------------------------------------------------------------------]]\n\nIGS.S = IGS.S or {}\n\nIGS.S.COLORS = {\n\tFRAME_HEADER        = Color(35,35,35,220), -- Р¤РѕРЅ РІРµСЂС…СѓС€РєРё С„СЂРµР№РјРѕРІ РІ С‚.С‡. РїРѕРїРѕР»РЅРµРЅРёСЏ СЃС‡РµС‚Р° Рё С‚.Рґ. https://img.qweqwe.ovh/1491950958825.png\n\tACTIVITY_BG         = Color(25,25,25,200), -- Р¤РѕРЅ РІ РєР°Р¶РґРѕР№ РІРєР»Р°РґРєРµ (РѕСЃРЅРѕРІРЅРѕР№) https://img.qweqwe.ovh/1509370647204.png\n\tTAB_BAR             = Color(30,30,30,210), -- Р¤РѕРЅ С‚Р°Р± Р±Р°СЂР° https://img.qweqwe.ovh/1509370669492.png\n\n\tPASSIVE_SELECTIONS  = Color(40,40,40,180), -- Р¤РѕРЅ РїР°РЅРµР»Рё С‚РµРіРѕРІ, С†РІРµС‚ РєРЅРѕРїРєРё СЃ Р±Р°Р»Р°РЅСЃРѕРј, РІРµСЂС…СѓС€РєРё С‚Р°Р±Р»РёС†, РЅРµ РІС‹РґРµР»РµРЅРЅС‹Рµ РєРЅРѕРїРєРё https://img.qweqwe.ovh/1509370720597.png\n\tINNER_SELECTIONS    = Color(45,45,45,200), -- Р¤РѕРЅ РёРєРѕРЅРѕРє РЅР° РїР»Р°С€РєР°С…, С„РѕРЅ РїР°РЅРµР»РµРє РїРѕСЃР»РµРґРЅРёС… РїРѕРєСѓРїРѕРє... https://img.qweqwe.ovh/1509370766148.png\n\n\tSOFT_LINE           = Color(60,60,60,180), -- Р›РёРЅРёСЏ РјРµР¶РґСѓ СЃРµРєС†РёСЏРјРё, С‚РёРїР° \"РРЅС„РѕСЂРјР°С†РёСЏ\" Рё \"РћРїРёСЃР°РЅРёРµ\" РІ РёРЅС„Рµ РѕР± РёС‚РµРјРµ\n\tHARD_LINE           = Color(80,80,80,200), -- РћР±РІРѕРґРєРё РїР°РЅРµР»РµР№\n\n\tHIGHLIGHTING        = Color(100,100,120), -- РћР±РІРѕРґРєР° РєРЅРѕРїРѕРє, С†РІРµС‚ С‚РµРєСЃС‚Р° РЅРµ Р°РєС‚РёРІРЅРѕР№ РєРЅРѕРїРєРё (РјСЏРіРєРёР№ СЃРµСЂРѕ-РіРѕР»СѓР±РѕР№)\n\tHIGHLIGHT_INACTIVE  = Color(140,140,140), -- Р¦РІРµС‚ РёРєРѕРЅРєРё РЅРµР°РєС‚РёРІРЅРѕР№ РєРЅРѕРїРєРё С‚Р°Р±Р±Р°СЂР°, РјРёРіР°СЋС‰Р°СЏ РёРєРѕРЅРєР° РЅР° С„СЂРµР№РјРµ РїРѕРјРѕС‰Рё https://img.qweqwe.ovh/1509371884592.png\n\n\tTEXT_HARD           = Color(255,255,255), -- Р—Р°РіРѕР»РѕРІРєРё, РІС‹РґРµР»СЏСЋС‰РёРµСЃСЏ С‚РµРєСЃС‚С‹ https://img.qweqwe.ovh/1509372019687.png\n\tTEXT_SOFT           = Color(200,200,200), -- РћРїРёСЃР°РЅРёСЏ, Р·РЅР°С‡РµРЅРёСЏ С‡РµРіРѕ-С‚Рѕ\n\tTEXT_ON_HIGHLIGHT   = Color(255,255,255), -- Р¦РІРµС‚ С‚РµРєСЃС‚Р° РЅР° РІС‹РґРµР»РµРЅРЅС‹С… РєРЅРѕРїРєР°С…\n\n\tLOG_SUCCESS         = Color(76,217,100),  -- Р’ Р»РѕРіР°С… РїРѕРїРѕР»РЅРµРЅРёСЏ С†РІРµС‚ СѓСЃРїРµС€РЅС‹С… РѕРїРµСЂР°С†РёР№\n\tLOG_ERROR           = Color(220,30,70),   -- Р’ Р»РѕРіР°С… РїРѕРїРѕР»РЅРµРЅРёСЏ С†РІРµС‚ РѕС€РёР±РѕРє\n\tLOG_NORMAL          = Color(255,255,255), -- Р’ Р»РѕРіР°С… РїРѕРїРѕР»РЅРµРЅРёСЏ РѕР±С‹С‡РЅС‹Рµ Р·Р°РїРёСЃРё\n\n\tICON                = Color(255,255,255), -- С†РІРµС‚ РёРєРѕРЅРѕРє РЅР° РїР»Р°С€РµС‡РєР°С…\n}\n\n-- Р’Р°СЂРёР°РЅС‚ СЂР°СЃРєСЂР°СЃРєРё РѕС‚ РџР°РІРµР» РўСѓРјР°С‡РµРІ (vk.com/id240371602)\n-- Р”РµРјРѕ: https://img.qweqwe.ovh/1626714494454.jpg\n-- IGS.S.COLORS = {\n-- \tFRAME_HEADER        = Color(0,0,0),\n-- \tACTIVITY_BG         = Color(10,10,10,180),\n-- \tTAB_BAR             = Color(0,0,0),\n\n-- \tPASSIVE_SELECTIONS  = Color(0,0,0),\n-- \tINNER_SELECTIONS    = Color(0,0,0),\n\n-- \tSOFT_LINE           = Color(51,128,255),\n-- \tHARD_LINE           = Color(51,128,255),\n\n-- \tHIGHLIGHTING        = Color(51,128,255),\n-- \tHIGHLIGHT_INACTIVE  = Color(255,255,255),\n\n-- \tTEXT_HARD           = Color(255,255,255),\n-- \tTEXT_SOFT           = Color(255,255,255),\n-- \tTEXT_ON_HIGHLIGHT   = Color(255,255,255),\n\n-- \tLOG_SUCCESS         = Color(76,217,100),\n-- \tLOG_ERROR           = Color(255,45,85),\n-- \tLOG_NORMAL          = Color(255,255,255),\n\n-- \tICON                = Color(255,255,255),\n-- }\n\n-- РџРѕРїС‹С‚РєРё СЃРґРµР»Р°С‚СЊ С‚РµРјРЅС‹Р№ СЃРєРёРЅ РёРЅС‚РµСЂС„РµР№СЃР°\n-- IGS.S.COLORS = {\n-- \tFRAME_HEADER        = Color(23,23,23),\n-- \tACTIVITY_BG         = Color(13,13,13),\n-- \tTAB_BAR             = Color(23,23,23),\n\n-- \tPASSIVE_SELECTIONS  = Color(23,23,23),\n-- \tINNER_SELECTIONS    = Color(23,23,23),\n\n-- \tSOFT_LINE           = Color(50,50,50),\n-- \tHARD_LINE           = Color(66,66,66),\n\n-- \tHIGHLIGHTING        = Color(230,130,35),\n-- \tHIGHLIGHT_INACTIVE  = Color(130,130,130),\n\n-- \tTEXT_HARD           = Color(255,255,255),\n-- \tTEXT_SOFT           = Color(140,140,150),\n-- \tTEXT_ON_HIGHLIGHT   = Color(255,255,255),\n\n-- \tLOG_SUCCESS         = Color(76,217,100),\n-- \tLOG_ERROR           = Color(255,45,85),\n-- \tLOG_NORMAL          = Color(140,140,150),\n\n-- \tICON                = Color(255,255,255),\n-- }\n\nIGS.col = IGS.S.COLORS\n\n-- https://img.qweqwe.ovh/1486557631077.png\nIGS.S.Panel = function(s,w,h,lL,tL,rL,bL)\n\t-- Р¤РѕРЅ СЃ СЂР°Р·РјС‹С‚РёРµРј\n\tif RNDX and Mantle and Mantle.ui.convar.blur then\n\t\tRNDX().Rect(0, 0, w, h)\n\t\t\t:Rad(0)\n\t\t\t:Blur(1.2)\n\t\t:Draw()\n\tend\n\t\n\tdraw.RoundedBox(0,0,0,w,h,IGS.col.PASSIVE_SELECTIONS) -- bg\n\n\tsurface.SetDrawColor(IGS.col.HARD_LINE) -- outline\n\n\tif lL then surface.DrawLine(0,0,0,h) end -- left line\n\tif tL then surface.DrawLine(0,0,w,0) end -- top line\n\tif rL then surface.DrawLine(w,0,w,h) end -- right line\n\tif bL then surface.DrawLine(0,h - 1,w,h - 1) end -- bottom line\nend\n\n-- https://img.qweqwe.ovh/1486557676799.png\nIGS.S.RoundedPanel = function(s,w,h)\n\t-- Р¤РѕРЅ СЃ СЂР°Р·РјС‹С‚РёРµРј\n\tif RNDX and Mantle and Mantle.ui.convar.blur then\n\t\tRNDX().Rect(0, 0, w, h)\n\t\t\t:Rad(3)\n\t\t\t:Blur(1.0)\n\t\t:Draw()\n\tend\n\t\n\tdraw.RoundedBox(3,0,0,w,h,        IGS.col.HARD_LINE) -- outline\n\tdraw.RoundedBox(3,1,1,w - 2,h - 2,IGS.col.INNER_SELECTIONS) -- bg\n\n\treturn true\nend\n\n-- igs\\vgui\\igs_frame.lua\nIGS.S.Frame = function(s,w,h)\n\t-- Р¤РѕРЅ СЃ СЂР°Р·РјС‹С‚РёРµРј РёСЃРїРѕР»СЊР·СѓСЏ Mantle RNDX\n\tif RNDX and Mantle and Mantle.ui.convar.blur then\n\t\tRNDX().Rect(0, 0, w, h)\n\t\t\t:Rad(0)\n\t\t\t:Blur(1.5)\n\t\t:Draw()\n\tend\n\t\n\t-- РџСЂРѕР·СЂР°С‡РЅС‹Р№ С„РѕРЅ\n\tdraw.RoundedBox(0,0,0,w,h,IGS.col.ACTIVITY_BG)\n\n\t-- /header\n\tlocal th = s:GetTitleHeight()\n\t\n\t-- Header СЃ СЂР°Р·РјС‹С‚РёРµРј\n\tif RNDX and Mantle and Mantle.ui.convar.blur then\n\t\tRNDX().Rect(0, 0, w, th)\n\t\t\t:Rad(0)\n\t\t\t:Blur(1.5)\n\t\t:Draw()\n\tend\n\t\n\tdraw.RoundedBox(0,0,0,w,th,IGS.col.FRAME_HEADER)\n\t-- РЈР±СЂР°РЅР° Р»РёРЅРёСЏ СЃРЅРёР·Сѓ header\u0027Р°\n\t-- surface.SetDrawColor(IGS.col.HARD_LINE)\n\t-- surface.DrawLine(0,th - 1,w,th - 1)\n\t-- \\header\nend\n\n-- igs\\vgui\\igs_table.lua\nIGS.S.TablePanel = function(s,w,h)\n\tif s.header_tall then\n\t\tIGS.S.Panel(s,w,s.header_tall) -- header\n\tend\nend\n\n-- igs_table, igs_frame\nIGS.S.Outline = function(s,w,h)\n\tsurface.SetDrawColor(IGS.col.HARD_LINE)\n\n\t-- https://img.qweqwe.ovh/1486830692390.png\n\tsurface.DrawLine(0,h,0,0)\n\tsurface.DrawLine(0,0,w,0)\n\tsurface.DrawLine(w - 1,0,w - 1,h)\n\tsurface.DrawLine(w,h - 1,0,h - 1)\nend\n","igs/interface/vgui/igs_button.lua":  "local PANEL = {}\n\nfunction PANEL:Init()\n\tself:SetTextColor(IGS.col.HIGHLIGHTING)\n\tself:SetFont(\"Fated.18\")\nend\n\n-- РљР°Рє Р±Р»СЏС‚СЊ РїРѕ С‡РµР»РѕРІРµС‡РµСЃРєРё РѕРІРµСЂСЂР°Р№РґРЅСѓС‚СЊ СЌС‚Сѓ С…СѓРµС‚РѕС‚Сѓ?\n-- function PANEL:SetText(text)\n-- \tself.BaseClass:SetText(\" \" .. text .. \" \") -- С‡С‚РѕР±С‹ РїСЂРё SizeToContent Р±С‹Р»Рѕ РЅРµ РІРїР»РѕС‚РЅСѓСЋ Рє СЃС‚РµРЅРєР°Рј\n-- end\n\nfunction PANEL:SetActive(bActive)\n\tself.active = bActive\n\n\t-- Р”Р»СЏ РєРЅРѕРїРѕРє РєР°С‚РµРіРѕСЂРёР№ С‚РµРєСЃС‚ РІСЃРµРіРґР° СЏСЂРєРёР№\n\tif self.isCategory then\n\t\tself:SetTextColor(IGS.col.TEXT_ON_HIGHLIGHT)\n\telse\n\t\tself:SetTextColor(self.active and IGS.col.TEXT_ON_HIGHLIGHT or IGS.col.HIGHLIGHTING)\n\tend\nend\n\nfunction PANEL:IsActive()\n\treturn self.active\nend\n\nfunction PANEL:Paint(w,h)\n\t-- Р Р°Р·РјС‹С‚РёРµ С„РѕРЅР° РєРЅРѕРїРєРё\n\tif RNDX and Mantle and Mantle.ui.convar.blur then\n\t\tRNDX().Rect(0, 0, w, h)\n\t\t\t:Rad(4)\n\t\t\t:Blur(0.8)\n\t\t:Draw()\n\tend\n\t\n\tif self.active then\n\t\t-- РћСЃРѕР±С‹Р№ СЃС‚РёР»СЊ РґР»СЏ РєРЅРѕРїРѕРє РєР°С‚РµРіРѕСЂРёР№\n\t\tif self.isCategory then\n\t\t\t-- РђРєС‚РёРІРЅР°СЏ РєР°С‚РµРіРѕСЂРёСЏ - РїСЂРѕР·СЂР°С‡РЅРѕ-Р±РѕСЂРґРѕРІС‹Р№ С„РѕРЅ\n\t\t\tdraw.RoundedBox(4, 0, 0, w, h, Color(120, 30, 40, 180))\n\t\t\t\n\t\t\tif self:IsHovered() then\n\t\t\t\tdraw.RoundedBox(4, 0, 0, w, h, Color(255, 255, 255, 20))\n\t\t\telseif self:IsDown() then\n\t\t\t\tdraw.RoundedBox(4, 0, 0, w, h, Color(0, 0, 0, 30))\n\t\t\tend\n\t\telse\n\t\t\t-- РћР±С‹С‡РЅР°СЏ Р°РєС‚РёРІРЅР°СЏ РєРЅРѕРїРєР° - Р·Р°Р»РёРІРєР° С†РІРµС‚РѕРј\n\t\t\tdraw.RoundedBox(4, 0, 0, w, h, Color(70, 70, 85, 230))\n\t\t\t\n\t\t\tif self:IsHovered() then\n\t\t\t\tdraw.RoundedBox(4, 0, 0, w, h, Color(255, 255, 255, 20))\n\t\t\telseif self:IsDown() then\n\t\t\t\tdraw.RoundedBox(4, 0, 0, w, h, Color(0, 0, 0, 40))\n\t\t\tend\n\t\tend\n\telse\n\t\t-- РќРµР°РєС‚РёРІРЅР°СЏ РєРЅРѕРїРєР° - С‚РѕР»СЊРєРѕ РѕР±РІРѕРґРєР°\n\t\tdraw.RoundedBox(4, 0, 0, w, h, IGS.col.HIGHLIGHTING) -- outline\n\t\tdraw.RoundedBox(4, 1, 1, w - 2, h - 2, IGS.col.PASSIVE_SELECTIONS) -- bg\n\t\t\n\t\tif self:IsHovered() then\n\t\t\tdraw.RoundedBox(4, 1, 1, w - 2, h - 2, Color(255, 255, 255, 15))\n\t\telseif self:IsDown() then\n\t\t\tdraw.RoundedBox(4, 1, 1, w - 2, h - 2, Color(0, 0, 0, 30))\n\t\tend\n\tend\nend\n\nvgui.Register(\"igs_button\",PANEL,\"DButton\")\n\n-- IGS.UI()\n","igs/interface/vgui/igs_frame.lua":  "local PANEL = {}\n\nfunction PANEL:Init()\n\tself:DockPadding(0,24,0,0)\n\n\t-- РџРѕР·РёС†РёСЏ Р·Р°РіРѕР»РѕРІРєР° Р±СѓРґРµС‚ СѓСЃС‚Р°РЅРѕРІР»РµРЅР° РІ PerformLayout РґР»СЏ С†РµРЅС‚СЂРёСЂРѕРІР°РЅРёСЏ\n\tself.lblTitle:SetColor(IGS.col.TEXT_HARD)\n\n\tself.btnClose:SetTextColor(IGS.col.HIGHLIGHTING)\n\tself.btnClose:SetText(\"вњ•\")\n\tself.btnClose:SetSize(30, 24)\n\tself.btnClose.Paint = function() end\n\t-- self.btnClose.DoClick = function() self:Close() end\n\n\t-- self:SetBackgroundBlur(false)\n\tself:SetTitle(\"\")\n\n\t-- self.btnClose:SetVisible(false)\n\tself.btnMaxim:SetVisible(false)\n\tself.btnMinim:SetVisible(false)\n\n\tself.lblTitle:SetFont(\"Fated.20\")\nend\n\nlocal locations = {}\nfunction PANEL:SaveLocation(panel_uid)\n\tlocations[panel_uid] = {self:GetPos()}\nend\n\nfunction PANEL:RestoreLocation(panel_uid)\n\tif locations[panel_uid] then\n\t\tlocal x,y = unpack(locations[panel_uid])\n\t\tself:SetPos(\n\t\t\tmath.Clamp(x,0,ScrW() - 10),\n\t\t\tmath.Clamp(y,0,ScrH() - 10)\n\t\t) -- РЅР° СЃР»СѓС‡Р°Р№, РµСЃР»Рё СѓРјРµРЅСЊС€Р°С‚ СЂР°Р·СЂРµС€РµРЅРёРµ, С‡С‚РѕР±С‹ РЅРµ РёСЃС‡РµР·Р»Рѕ Сѓ РєСЂР°РµРІ\n\t\tlocations[panel_uid] = nil\n\telse\n\t\tself:Center()\n\tend\nend\n\nfunction PANEL:RememberLocation(panel_uid)\n\tself.remember_uid = panel_uid\nend\n\n\nfunction PANEL:Close(...)\n\tsurface.PlaySound(\"ambient/water/rain_drip3.wav\")\n\tself.BaseClass.Close(self, ...)\n\tif self.remember_uid then\n\t\tself:SaveLocation(self.remember_uid)\n\tend\nend\n\nfunction PANEL:GetTitleHeight()\n\treturn 24 -- close button H\nend\n\nfunction PANEL:Paint(w,h)\n\tif self.m_bBackgroundBlur then\n\t\tDerma_DrawBackgroundBlur(self, self.m_fCreateTime)\n\tend\n\n\tif RNDX and Mantle and Mantle.ui.convar.blur then\n\t\t-- Р¤РѕРЅ СЃ СЂР°Р·РјС‹С‚РёРµРј\n\t\tRNDX().Rect(0, 0, w, h)\n\t\t\t:Rad(10)\n\t\t\t:Blur(1.5)\n\t\t:Draw()\n\t\t\n\t\tRNDX.Draw(10, 0, 0, w, h, IGS.col.ACTIVITY_BG)\n\t\t\n\t\tlocal th = self:GetTitleHeight()\n\t\t\n\t\t-- Header СЃ СЂР°Р·РјС‹С‚РёРµРј\n\t\tRNDX().Rect(0, 0, w, th)\n\t\t\t:Rad(10)\n\t\t\t:Blur(1.5)\n\t\t:Draw()\n\t\t\n\t\tRNDX.Draw(10, 0, 0, w, th, IGS.col.FRAME_HEADER)\n\t\t-- РЈР±СЂР°РЅР° Р»РёРЅРёСЏ СЃРЅРёР·Сѓ header\u0027Р°\n\t\t-- surface.SetDrawColor(IGS.col.HARD_LINE)\n\t\t-- surface.DrawLine(0, th - 1, w, th - 1)\n\telseif RNDX then\n\t\tRNDX.Draw(10, 0, 0, w, h, IGS.col.ACTIVITY_BG)\n\t\tlocal th = self:GetTitleHeight()\n\t\tRNDX.Draw(10, 0, 0, w, th, IGS.col.FRAME_HEADER)\n\t\t-- РЈР±СЂР°РЅР° Р»РёРЅРёСЏ СЃРЅРёР·Сѓ header\u0027Р°\n\t\t-- surface.SetDrawColor(IGS.col.HARD_LINE)\n\t\t-- surface.DrawLine(0, th - 1, w, th - 1)\n\telse\n\t\tIGS.S.Frame(self,w,h)\n\tend\n\treturn true\nend\n\nfunction PANEL:PaintOver(w,h)\n\tif RNDX then\n\t\tRNDX.DrawOutlined(10, 0, 0, w, h, IGS.col.HARD_LINE, 1)\n\telse\n\t\tIGS.S.Outline(self,w,h) -- С‡РµСЂРµР· = РЅРµ СЂР°Р±РѕС‚Р°Р»Рѕ\n\tend\nend\n\nfunction PANEL:Focus()\n\tlocal panels = {}\n\tself:SetBackgroundBlur(true)\n\tfor _, v in ipairs(vgui.GetWorldPanel():GetChildren()) do\n\t\tif v:IsVisible() and (v ~= self) then\n\t\t\tpanels[#panels + 1] = v\n\t\t\tv:SetVisible(false)\n\t\tend\n\tend\n\tself._OnClose = self.OnClose\n\tself.OnClose = function()\n\t\tfor _, v in ipairs(panels) do\n\t\t\tif IsValid(v) then\n\t\t\t\tv:SetVisible(true)\n\t\t\tend\n\t\tend\n\n\t\tself:_OnClose()\n\tend\nend\n\nfunction PANEL:PerformLayout()\n\tself.lblTitle:SizeToContents()\n\t\n\t-- Р¦РµРЅС‚СЂРёСЂСѓРµРј Р·Р°РіРѕР»РѕРІРѕРє\n\tlocal titleWide = self.lblTitle:GetWide()\n\tlocal frameWide = self:GetWide()\n\tself.lblTitle:SetPos((frameWide - titleWide) / 2, 3)\n\t\n\tself.btnClose:SetPos(0, 0)\n\n\tif self.remember_uid and !self.restored then\n\t\tself.restored = true\n\t\tself:RestoreLocation(self.remember_uid)\n\tend\nend\n\nvgui.Register(\"igs_frame\",PANEL,\"DFrame\")\n-- IGS.UI()\n","igs/interface/vgui/igs_group.lua":  "local PANEL = {}\n\nlocal PL_VARIANTS = PL.Add(\"variants\",{\"РІР°СЂРёР°РЅС‚\", \"РІР°СЂРёР°РЅС‚Р°\", \"РІР°СЂРёР°РЅС‚РѕРІ\"})\nfunction PANEL:SetGroup(ITEM_GROUP)\n\tself.group = ITEM_GROUP\n\n\tif ITEM_GROUP:ICON() then\n\t\tself:SetIcon(ITEM_GROUP:ICON())\n\tend\n\n\tif ITEM_GROUP.highlight then\n\t\tself:SetTitleColor(ITEM_GROUP.highlight)\n\tend\n\n\tlocal visible_items = {}\n\tfor _,GROUP_ITEM in ipairs(ITEM_GROUP:Items()) do\n\t\tif !GROUP_ITEM.item:IsHidden() then\n\t\t\ttable.insert(visible_items, GROUP_ITEM)\n\t\tend\n\tend\n\n\tself:SetName(ITEM_GROUP:Name())\n\tself:SetSign(PL_VARIANTS(#visible_items))\n\n\tlocal min,max = math.huge,0 -- РјРёРЅРёРјР°Р»СЊРЅР°СЏ Рё РјР°РєСЃРёРјР°Р»СЊРЅР°СЏ С†РµРЅС‹ РёС‚РµРјРѕРІ\n\tfor _,v in ipairs(visible_items) do\n\t\tlocal price = v.item:PriceInCurrency()\n\n\t\tif price \u003c min then\n\t\t\tmin = price\n\t\tend\n\n\t\tif price \u003e max then\n\t\t\tmax = price\n\t\tend\n\tend\n\n\tif min == max then\n\t\tself:SetBottomText(\"Р’СЃРµ РїРѕ \" .. IGS.SignPrice(min))\n\telse\n\t\tself:SetBottomText(\"РћС‚ \" .. min .. \" РґРѕ \" .. IGS.SignPrice(max))\n\tend\n\n\treturn self\nend\n\nfunction PANEL:DoClick()\n\tif !IsValid(self.list_bg) then\n\t\tself.list_bg = IGS.WIN.Group(self.group:UID())\n\tend\nend\n\n\nvgui.Register(\"igs_group\",PANEL,\"igs_item\")\n-- IGS.UI()","igs/interface/vgui/igs_html.lua":  "local PANEL = {}\n\nfunction PANEL:Init()\n\tlocal c = IGS.col.HIGHLIGHT_INACTIVE\n\tself.text_color = Color(c.r,c.g,c.b,c.a)\nend\n\nlocal LOADING_TEXT = \"Р—Р°РіСЂСѓР·РѕС‡РєР°...\"\nlocal ICO          = Material(\"materials/icons/fa32/usd.png\", \"smooth\")\n\nfunction PANEL:Paint(w,h)\n\tself.text_color.a = Lerp( (math.sin(CurTime() * 5) + 1) / 2 ,0,255) -- Alpha\n\n\t-- РРљРћРќРљРђ\n\tsurface.SetDrawColor(self.text_color)\n\tsurface.SetMaterial(ICO)\n\tlocal y = (h - 50) / 2\n\tsurface.DrawTexturedRect((w - 50) / 2,y - 10,50,50)\n\ty = y + 50 -- С†РµРЅС‚СЂР°Р»СЊРЅР°СЏ С‚РѕС‡РєР° РјРµР¶РґСѓ РёРєРѕРЅРєРѕР№ Рё С‚РµРєСЃС‚РѕРј\n\n\t-- РўР•РљРЎРў\n\tsurface.SetTextColor(self.text_color)\nsurface.SetFont(\"Fated.24\") -- 40\n\tlocal tw = surface.GetTextSize(LOADING_TEXT)\n\tsurface.SetTextPos((w - tw) / 2,y + 10)\n\tsurface.DrawText(LOADING_TEXT)\nend\n\nvgui.Register(\"igs_html\",PANEL,\"HTML\")\n","igs/interface/vgui/igs_item.lua":  "--[[-------------------------------------------------------------------------\n\t:SetIcon Р”РћР›Р–Р•Рќ РІС‹Р·С‹РІР°С‚СЊСЃСЏ Р”Рћ :SetName\n\tР° :SetName Р”РћР›Р–Р•Рќ РІС‹Р·С‹РІР°С‚СЊСЃСЏ Р”Рћ :SetSign\n---------------------------------------------------------------------------]]\nlocal PANEL = {}\n\nlocal function formatRub(iReal)\n\treturn math.Truncate(tonumber(iReal),2) .. \" в‚Ѕ\"\nend\n\nlocal function getBottomText(ITEM, bShowDiscounted)\n\t-- РџСЂРёРѕСЂРёС‚РµС‚: РёРЅРґРёРІРёРґСѓР°Р»СЊРЅР°СЏ СЃРєРёРґРєР° \u003e РіР»РѕР±Р°Р»СЊРЅР°СЏ СЃРєРёРґРєР° \u003e РѕР±С‹С‡РЅР°СЏ С†РµРЅР°\n\tlocal iDiscFrom = bShowDiscounted and ITEM.discounted_from\n\tlocal iReal = iDiscFrom or ITEM:Price()\n\t\n\t-- Р•СЃР»Рё РїРѕРєР°Р·С‹РІР°РµРј СЃРєРёРґРєСѓ Рё РЅРµС‚ РёРЅРґРёРІРёРґСѓР°Р»СЊРЅРѕР№ СЃРєРёРґРєРё, РїСЂРёРјРµРЅСЏРµРј РіР»РѕР±Р°Р»СЊРЅСѓСЋ\n\tif bShowDiscounted and !iDiscFrom and IGS.HasGlobalDiscount() then\n\t\tiReal = IGS.GetDiscountedPrice(ITEM:Price())\n\tend\n\n\tlocal iCurr = IGS.PriceInCurrency(iReal)\n\n\tlocal real = formatRub(iReal)\n\tlocal curr = IGS.SignPrice(iCurr)\n\n\tif IGS.IsCurrencyEnabled() then\n\t\treturn real .. \" (\" .. curr .. \")\"\n\telse\n\t\treturn real\n\tend\nend\n\nlocal function DrawRoundedPanel(x, y, w, h, radius, outline_col, fill_col, outline_thick)\n\tif RNDX then\n\t\t-- Р Р°Р·РјС‹С‚РёРµ С„РѕРЅР° РµСЃР»Рё РІРєР»СЋС‡РµРЅРѕ РІ Mantle\n\t\tif Mantle and Mantle.ui.convar.blur then\n\t\t\tRNDX().Rect(x, y, w, h)\n\t\t\t\t:Rad(radius)\n\t\t\t\t:Blur(1.0)\n\t\t\t:Draw()\n\t\tend\n\t\t\n\t\tRNDX.Draw(radius, x, y, w, h, fill_col)\n\t\tRNDX.DrawOutlined(radius, x, y, w, h, outline_col, outline_thick or 1)\n\t\treturn\n\tend\n\n\tdraw.RoundedBox(radius, x, y, w, h, outline_col)\n\tdraw.RoundedBox(radius, x + 1, y + 1, w - 2, h - 2, fill_col)\nend\n\nlocal function DrawPriceTag(x, y, w, h, outline_col, fill_col, outline_thick)\n\tlocal r = h / 2\n\tif RNDX and RNDX.NO_TR and RNDX.NO_BL then\n\t\t-- TL rounded, TR sharp, BL sharp, BR rounded\n\t\tlocal flags = bit.bor(RNDX.NO_TR, RNDX.NO_BL)\n\t\tRNDX.Draw(r, x, y, w, h, fill_col, flags)\n\t\tRNDX.DrawOutlined(r, x, y, w, h, outline_col, outline_thick or 1, flags)\n\t\treturn\n\tend\n\n\tdraw.RoundedBoxEx(r, x, y, w, h, outline_col, true, false, false, true)\n\tdraw.RoundedBoxEx(r, x + 1, y + 1, w - 2, h - 2, fill_col, true, false, false, true)\nend\n\nlocal function DrawPriceTagFilled(x, y, w, h, fill_col)\n\tlocal r = h / 2\n\tlocal r2 = r + 4\n\tif RNDX and RNDX.NO_TR and RNDX.NO_BL then\n\t\tlocal flags = bit.bor(RNDX.NO_TR, RNDX.NO_BL)\n\t\tRNDX.Draw(r, x, y, w, h, fill_col, flags)\n\t\t-- СѓСЃРёР»РёРІР°РµРј СЃРєСЂСѓРіР»РµРЅРёРµ РїСЂР°РІРѕРіРѕ РЅРёР¶РЅРµРіРѕ СѓРіР»Р°\n\t\tRNDX.DrawCircle(x + w - r2, y + h - r2, r2 * 2, fill_col)\n\t\treturn\n\tend\n\n\tdraw.RoundedBoxEx(r, x, y, w, h, fill_col, true, false, false, true)\n\tdraw.RoundedBox(r2, x + w - r2 * 2, y + h - r2 * 2, r2 * 2, r2 * 2, fill_col)\nend\n\nlocal CARD_BG = Color(35, 35, 35, 220)\nlocal NAME_BG = Color(45, 45, 45, 200)\nlocal PRICE_BG = Color(55, 55, 55, 210)\n\n\nfunction PANEL:Init()\n\tself:SetSize(140,170) -- СѓРІРµР»РёС‡РµРЅР° РІС‹СЃРѕС‚Р° РґР»СЏ СЂР°РІРЅС‹С… РѕС‚СЃС‚СѓРїРѕРІ СЃРІРµСЂС…Сѓ/СЃРЅРёР·Сѓ\n\tself.compact = false\n\tself.iconbg = uigs.Create(\"Panel\", self)\n\tself.iconbg:SetSize(self:GetWide(), self:GetWide()) -- РєРІР°РґСЂР°С‚РЅР°СЏ Р·РѕРЅР° РёРєРѕРЅРєРё\n\tself.iconbg:SetPos(0, 0)\n\tself.iconbg.Paint = function(_, w, h)\n\t\tDrawRoundedPanel(0, 0, w, h, 6, IGS.col.HARD_LINE, IGS.col.INNER_SELECTIONS)\n\tend\n\nend\n\nfunction PANEL:SetItem(STORE_ITEM)\n\tself.item = STORE_ITEM\n\n\tself:SetIcon(STORE_ITEM:ICON())\n\tself:SetName(STORE_ITEM:Name())\n\t-- self:SetPrice(STORE_ITEM:Price())\n\n\tself:SetTitleColor(STORE_ITEM:GetHighlightColor()) -- nil\n\tself:SetPriceOnIcon( getBottomText(STORE_ITEM, true) )\n\n\treturn self\nend\n\nfunction PANEL:SetName(sName)\n\t(self.icon or self):SetTooltip(sName .. (self.item and \"\\n\\n\" .. self.item:Description():gsub(\"\\n\\n\",\"\\n\") or \"\"))\n\n\tself.name = self.name or uigs.Create(\"DLabel\", function(lbl)\n\t\tlbl:SetTall(20)\n\t\tlbl:SetFont(\"Fated.15b\")\n\t\tlbl:SetTextColor(color_white)\n\t\tlbl:SetText(\"\")\n\n\t\tlbl.Paint = function(s,w,h)\n\t\t\tlocal text = s._igs_text or \"\"\n\t\t\tif text == \"\" then return end\n\n\t\t\tsurface.SetFont(s:GetFont())\n\t\t\tDrawRoundedPanel(0, 0, w, h, 6, Color(128, 0, 32, 255), NAME_BG)\n\t\t\tdraw.SimpleText(\n\t\t\t\ttext,\n\t\t\t\ts:GetFont(),\n\t\t\t\tw / 2,\n\t\t\t\th / 2,\n\t\t\t\ts:GetTextColor(),\n\t\t\t\tTEXT_ALIGN_CENTER,\n\t\t\t\tTEXT_ALIGN_CENTER\n\t\t\t)\n\t\tend\n\tend, self)\n\n\tself.name._igs_text = sName\n\n\treturn self.name\nend\n\nfunction PANEL:SetPriceOnIcon(sPrice)\n\tif self.compact or !self.iconbg or self.hidePrice then return end\n\n\tself.price_on_icon = self.price_on_icon or uigs.Create(\"DLabel\", function(lbl)\n\t\tlbl:SetFont(\"Fated.15b\")\n\t\tlbl:SetTextColor(color_white)\n\t\tlbl:SetContentAlignment(5) -- С†РµРЅС‚СЂ\n\t\tlbl.Paint = function(s,w,h)\n\t\t\tDrawPriceTagFilled(0, 0, w, h, PRICE_BG)\n\t\t\t\n\t\t\t-- Р РёСЃСѓРµРј СЃС‚Р°СЂСѓСЋ С†РµРЅСѓ Р·Р°С‡РµСЂРєРЅСѓС‚РѕР№, РµСЃР»Рё РµСЃС‚СЊ СЃРєРёРґРєР°\n\t\t\tif s.oldPrice then\n\t\t\t\tlocal font = \"Fated.14\"\n\t\t\t\tlocal oldPriceText = s.oldPrice\n\t\t\t\tlocal currentPriceText = s:GetText()\n\t\t\t\t\n\t\t\t\tsurface.SetFont(font)\n\t\t\t\tlocal oldPriceWidth = surface.GetTextSize(oldPriceText)\n\t\t\t\t\n\t\t\t\tsurface.SetFont(s:GetFont())\n\t\t\t\tlocal currentPriceWidth = surface.GetTextSize(currentPriceText)\n\t\t\t\t\n\t\t\t\tlocal totalWidth = oldPriceWidth + 8 + currentPriceWidth\n\t\t\t\tlocal startX = (w - totalWidth) / 2\n\t\t\t\t\n\t\t\t\t-- Р РёСЃСѓРµРј СЃС‚Р°СЂСѓСЋ С†РµРЅСѓ СЃР»РµРІР° (СЃРµСЂР°СЏ Рё РјРµРЅСЊС€Рµ)\n\t\t\t\tdraw.SimpleText(\n\t\t\t\t\toldPriceText,\n\t\t\t\t\tfont,\n\t\t\t\t\tstartX,\n\t\t\t\t\th / 2,\n\t\t\t\t\tColor(180, 180, 180, 200),\n\t\t\t\t\tTEXT_ALIGN_LEFT,\n\t\t\t\t\tTEXT_ALIGN_CENTER\n\t\t\t\t)\n\t\t\t\t\n\t\t\t\t-- Р—Р°С‡РµСЂРєРёРІР°РµРј СЃС‚Р°СЂСѓСЋ С†РµРЅСѓ\n\t\t\t\tsurface.SetDrawColor(Color(200, 200, 200, 200))\n\t\t\t\tlocal lineY = h / 2\n\t\t\t\tsurface.DrawLine(startX, lineY, startX + oldPriceWidth, lineY)\n\t\t\t\t\n\t\t\t\t-- Р РёСЃСѓРµРј С‚РµРєСѓС‰СѓСЋ С†РµРЅСѓ СЃРїСЂР°РІР°\n\t\t\t\tdraw.SimpleText(\n\t\t\t\t\tcurrentPriceText,\n\t\t\t\t\ts:GetFont(),\n\t\t\t\t\tstartX + oldPriceWidth + 8,\n\t\t\t\t\th / 2,\n\t\t\t\t\ts:GetTextColor(),\n\t\t\t\t\tTEXT_ALIGN_LEFT,\n\t\t\t\t\tTEXT_ALIGN_CENTER\n\t\t\t\t)\n\t\t\t\t\n\t\t\t\treturn true\n\t\t\tend\n\t\tend\n\tend, self.iconbg)\n\n\tself.price_on_icon:SetText(sPrice)\n\tself.price_on_icon:SizeToContents()\n\t\n\t-- РџСЂРѕРІРµСЂСЏРµРј, РµСЃС‚СЊ Р»Рё СЃРєРёРґРєР° (РёРЅРґРёРІРёРґСѓР°Р»СЊРЅР°СЏ РёР»Рё РіР»РѕР±Р°Р»СЊРЅР°СЏ)\n\tlocal hasDiscount = false\n\tif self.item then\n\t\thasDiscount = self.item.discounted_from or IGS.HasGlobalDiscount()\n\tend\n\t\n\t-- Р•СЃР»Рё РµСЃС‚СЊ СЃРєРёРґРєР°, РґРѕР±Р°РІР»СЏРµРј РјРµСЃС‚Рѕ РґР»СЏ СЃС‚Р°СЂРѕР№ С†РµРЅС‹\n\tif hasDiscount then\n\t\tlocal oldPrice = getBottomText(self.item, false)\n\t\tself.price_on_icon.oldPrice = oldPrice\n\t\t\n\t\t-- РЈРІРµР»РёС‡РёРІР°РµРј С€РёСЂРёРЅСѓ РґР»СЏ РґРІСѓС… С†РµРЅ\n\t\tsurface.SetFont(\"Fated.14\")\n\t\tlocal oldPriceWidth = surface.GetTextSize(oldPrice)\n\t\tsurface.SetFont(\"Fated.15b\")\n\t\tlocal currentPriceWidth = surface.GetTextSize(sPrice)\n\t\t\n\t\tlocal totalWidth = oldPriceWidth + 8 + currentPriceWidth + 10\n\t\tself.price_on_icon:SetSize(totalWidth, self.price_on_icon:GetTall() + 6)\n\telse\n\t\tself.price_on_icon.oldPrice = nil\n\t\tself.price_on_icon:SetSize(self.price_on_icon:GetWide() + 10, self.price_on_icon:GetTall() + 6)\n\tend\nend\n\nfunction PANEL:HidePrice(bHide)\n\tself.hidePrice = bHide\n\tif self.price_on_icon then\n\t\tself.price_on_icon:SetVisible(!bHide)\n\tend\n\treturn self\nend\n\nfunction PANEL:SetCompact(bCompact)\n\tself.compact = bCompact\n\n\tif IsValid(self.iconbg) then\n\t\tlocal size = self.compact and 40 or 90\n\t\tself.iconbg:SetSize(size, size)\n\tend\n\n\tif self.price_on_icon then\n\t\tself.price_on_icon:SetVisible(!self.compact)\n\tend\nend\n\nfunction PANEL:SetSign(sSignature)\n\tself.sign = self.sign or uigs.Create(\"DLabel\", function(lbl)\n\t\tlbl:SetTall(15)\n\t\tlbl:SetFont(\"Fated.15\")\n\t\tlbl:SetTextColor(IGS.col.TEXT_SOFT)\n\tend, self)\n\n\tself.sign:SetText(sSignature)\n\n\treturn self.sign\nend\n\nfunction PANEL:SetBottomText(sBottomText)\n\tself.bottom = self.bottom or uigs.Create(\"DLabel\", function(lbl)\n\t\tlbl:SetTall(15)\n\t\tlbl:SetFont(\"Fated.15\")\n\t\tlbl:SetTextColor(IGS.col.TEXT_SOFT)\n\t\tlbl:SetContentAlignment(5)\n\t\t-- lbl:SetWrap(true)\n\t\t-- lbl:SetAutoStretchVertical(true)\n\tend, self)\n\n\tself.bottom:SetText(sBottomText)\n\n\treturn self.bottom\nend\n\n-- TODO СЃРЅРёР·Сѓ РІ СЂР°РјРѕС‡РєСѓ Рё DOCK RIGHT РІРјРµСЃС‚Рµ СЃ РґРѕРє С„РёР»СЊРЅС‹Рј СЃСЂРѕРєРѕРј\n-- function PANEL:SetPrice(iPrice)\n-- \tself.price = iPrice\n-- \treturn self\n-- end\n\nfunction PANEL:SetIcon(sIco,bIsModel) -- :SetIcon() РґР»СЏ СЃР±СЂРѕСЃР°\n\tif !sIco then return self end\n\n\tif bIsModel and !file.Exists(sIco, \"GAME\") then\n\t\tsIco = \"models/props_lab/huladoll.mdl\"\n\tend\n\n\tif !self.icon then\n\t\tself.icon = bIsModel and uigs.Create(\"DModelPanel\", function(mdl)\n\t\t\tmdl:Dock(FILL)\n\t\t\tmdl:DockMargin(2,2,2,2)\n\t\t\tmdl:SetModel(sIco)\n\n\t\t\tlocal mn, mx = mdl.Entity:GetRenderBounds()\n\t\t\tlocal size = 0\n\t\t\tsize = math.max(size, math.abs(mn.x) + math.abs(mx.x))\n\t\t\tsize = math.max(size, math.abs(mn.y) + math.abs(mx.y))\n\t\t\tsize = math.max(size, math.abs(mn.z) + math.abs(mx.z))\n\n\t\t\tmdl:SetFOV(30)\n\t\t\tmdl:SetCamPos(Vector(size, size, size))\n\t\t\tmdl:SetLookAt((mn + mx) * 0.5)\n\t\t\tmdl.LayoutEntity = function() return false end\n\t\tend, self.iconbg)\n\n\t\t-- РќР• РјРѕРґРµР»СЊРєР° (РЎСЃС‹Р»РєР° РЅР° РёРєРѕРЅРєСѓ)\n\t\tor\n\n\t\tuigs.Create(\"igs_wmat\", function(ico)\n\t\t\tico:Dock(FILL)\n\t\t\tico:DockMargin(2,2,2,2)\n\t\tend, self.iconbg)\n\tend\n\n\tif bIsModel then\n\t\tself.icon:SetModel(sIco)\n\telse\n\t\tself.icon:SetURL(sIco)\n\tend\n\n\treturn self\nend\n\nfunction PANEL:DoClick()\n\tIGS.WIN.Item(self.item:UID()) -- РћР±СЏР·Р°С‚РµР»СЊРЅРѕ РїСЂРµРґРІР°СЂРёС‚РµР»СЊРЅРѕ SetItem\nend\n\nfunction PANEL:PerformLayout()\n\tif self.compact then\n\t\tif IsValid(self.iconbg) then\n\t\t\tself.iconbg:SetSize(40, 40)\n\t\t\tself.iconbg:SetPos(2, 2)\n\t\tend\n\n\t\tif self.name then\n\t\t\tlocal x = 2 + (self.iconbg and self.iconbg:GetWide() or 0) + 5\n\t\t\tself.name:SetPos(x, 2)\n\t\t\tself.name:SetWide(self:GetWide() - x - 2)\n\t\t\tself.name:SetContentAlignment(4)\n\t\tend\n\n\t\tif self.name and self.sign then\n\t\t\tlocal nx,ny = self.name:GetPos()\n\t\t\tself.sign:SetPos(nx, ny + self.name:GetTall() + 2)\n\t\t\tself.sign:SetWide(self.name:GetWide())\n\t\t\tself.sign:SetContentAlignment(4)\n\t\tend\n\telse\n\t\t-- РРєРѕРЅРєР° СЃРІРµСЂС…Сѓ (РєРІР°РґСЂР°С‚РЅР°СЏ), РЅР°Р·РІР°РЅРёРµ РЅРёР¶Рµ\n\t\tif IsValid(self.iconbg) then\n\t\t\tlocal name_h = self.name and self.name:GetTall() or 20\n\t\t\tlocal gap = 6\n\t\t\tlocal icon_size = self:GetWide() - 20\n\t\t\tlocal max_size = self:GetTall() - name_h - gap - 2\n\t\t\ticon_size = math.min(icon_size, max_size)\n\t\t\tlocal pad = math.max((self:GetTall() - icon_size - name_h - gap) / 2, 0)\n\t\t\tself.iconbg:SetSize(icon_size, icon_size)\n\t\t\tself.iconbg:SetPos((self:GetWide() - icon_size) / 2, pad)\n\t\tend\n\n\t\tif self.name then\n\t\t\tlocal gap = 6\n\t\t\tlocal pad = math.max((self:GetTall() - self.iconbg:GetTall() - self.name:GetTall() - gap) / 2, 0)\n\t\t\tself.name:SetPos(5, pad + self.iconbg:GetTall() + gap)\n\t\t\tself.name:SetWide(self:GetWide() - 10)\n\t\t\tself.name:SetContentAlignment(5)\n\t\tend\n\n\t\tif self.price_on_icon and IsValid(self.iconbg) then\n\t\t\tself.price_on_icon:SetPos(\n\t\t\t\tself.iconbg:GetWide() - self.price_on_icon:GetWide() + 1,\n\t\t\t\tself.iconbg:GetTall() - self.price_on_icon:GetTall() + 1\n\t\t\t)\n\t\tend\n\tend\n\n\tif self.title_color and self.name then\n\t\tself.name:SetTextColor(self.title_color)\n\tend\nend\n\nfunction PANEL:SetTitleColor(c)\n\tself.title_color = c\nend\n\n\nfunction PANEL:Paint(w,h)\n\t-- Р Р°Р·РјС‹С‚РёРµ С„РѕРЅР° РєР°СЂС‚РѕС‡РєРё\n\tif RNDX and Mantle and Mantle.ui.convar.blur then\n\t\tRNDX().Rect(0, 0, w, h)\n\t\t\t:Rad(6)\n\t\t\t:Blur(1.2)\n\t\t:Draw()\n\tend\n\t\n\tDrawRoundedPanel(0, 0, w, h, 6, IGS.col.HARD_LINE, CARD_BG)\n\n\treturn true\nend\n\n--[[-------------------------------------------------------------------------\n\tР–С‚Рѕ РІСЃРµ РЅСѓР¶РЅРѕ Р±С‹Р»Рѕ РґР»СЏ РѕС‚СЂРёСЃРѕРІРєРё Р»РµР№Р±Р»Р° СЃ СЂР°Р·РјРµСЂРѕРј СЃРєРёРґРєРё\n\tРџСЂРѕР±Р»РµРјР° РѕРєР°Р·Р°Р»Р°СЃСЊ РЅР° СЌС‚Р°РїРµ СЂРёСЃРѕРІР°РЅРёСЏ РїРѕРІРµСЂРЅСѓС‚РѕРіРѕ С‚РµРєСЃС‚Р°\n\tРќР°Р±СЂРѕСЃС‹: https://gist.github.com/AMD-NICK/7f2aeb674763fe91c2d0668f84357f2e\n\tРљР°СЂС‚РѕС‡РєР°: https://trello.com/c/Zx6qTzBn/303\n\n\tColor(220,30,70) -- РЁС‚СѓРєРё Р·Р° Р±РёСЂРєРѕР№\n\tColor(255,30,85) -- Р¦РІРµС‚ Р±РёСЂРєРё\n\tColor(255,255,255) -- РўРµРєСЃС‚ Р±РёСЂРєРё\n\tdraw.RotatedText\n---------------------------------------------------------------------------]]\n-- local function draw_TextRotated(text, x, y, color, font, ang)\n-- \tsurface.SetFont(font)\n-- \tsurface.SetTextColor(color)\n-- \tsurface.GetTextSize(text)\n\n-- \tlocal m = Matrix()\n-- \tm:SetAngles(Angle(0, ang, 0))\n-- \tm:SetTranslation(Vector(x, y, 0))\n\n-- \tcam.PushModelMatrix(m)\n-- \t\tsurface.SetTextPos(0, 0)\n-- \t\tsurface.DrawText(text)\n-- \tcam.PopModelMatrix()\n-- end\n\n-- local function draw_Poly(tVertices,tColor_)\n-- \tsurface.SetDrawColor(tColor_ or color_white)\n-- \tdraw.NoTexture()\n-- \tsurface.DrawPoly(tVertices)\n-- end\n\n-- 2250, 3000 = 25\n-- local function diffNumsPercent(a, b)\n-- \treturn math.ceil(100 - a / (b / 100))\n-- end\n\n-- Р’СЃ. С„СѓРЅРєС†РёСЋ РјРѕР¶РЅРѕ РЅР°Р·РІР°С‚СЊ РїРёР·РґРµС†РєРѕР№ РєРѕСЃС‚С‹Р»СЏРєРѕР№\nfunction PANEL:PaintOver(w,h) end\n\n\nvgui.Register(\"igs_item\",PANEL,\"DButton\")\n\n-- IGS.CloseUI()\n-- IGS.UI()","igs/interface/vgui/igs_iteminfo.lua":  "local PANEL = {}\n\nlocal dock = 5\n\nfunction PANEL:Init()\n\tself.head = uigs.Create(\"Panel\", self)\n\tself.head:SetTall(100)\n\tself.head:Dock(TOP)\n\tself.head:DockPadding(dock,dock,dock,dock)\n\tself.head.Paint = function(s,w,h)\n\t\tIGS.S.Panel(s,w,h, nil,nil,nil,true)\n\tend\n\n\tself.scroll = uigs.Create(\"igs_scroll\", self)\n\tself.scroll:Dock(FILL)\nend\n\nfunction PANEL:SetName(sName)\n\tself.name = self.name or uigs.Create(\"DLabel\", function(lbl)\n\t\tlbl:Dock(TOP)\n\t\t--lbl:SetTall(22)\n\t\tlbl:SetFont(\"Fated.22\")\n\t\tlbl:SetTextColor(IGS.col.TEXT_HARD)\n\t\tlbl:SetWrap(true)\n\t\tlbl:SetAutoStretchVertical(true)\n\t\tlbl:SizeToContents()\n\tend, self.head)\n\n\tself.name:SetText(sName)\nend\n\n-- Р”РѕР±Р°РІР»СЏРµС‚ РёРєРѕРЅРєСѓ СЂСЏРґРѕРј СЃ РЅР°Р·РІР°РЅРёРµРј РёРЅС„Рѕ РїР°РЅРµР»Рё\nfunction PANEL:SetIcon(sIco, bIsModel) -- url, Material or Model path\n\t-- bIsModel = true\n\t-- sIco = \"models/weapons/w_npcnade.mdl\"\n\n\tself.icon_bg = self.icon_bg or uigs.Create(\"Panel\", function(bg)\n\t\tbg.Paint = IGS.S.RoundedPanel\n\t\tbg:SetWide(self.head:GetTall() - dock * 2)\n\t\tbg:Dock(LEFT)\n\t\tbg:DockPadding(3,3,3,3)\n\t\tbg:DockMargin(0,0,dock,0)\n\n\t\tbg:InvalidateParent(true) -- true bg:GetSize()\n\tend, self.head)\n\n\tif IsValid(self.icon) and\n\t\t((self.model and !bIsModel) or   -- Р•СЃР»Рё СЂР°РЅСЊС€Рµ Р±С‹Р»Р° СѓСЃС‚Р°РЅРѕРІР»РµРЅР° РјРѕРґРµР»СЊРєР°, Р° СЃРµР№С‡Р°СЃ РЅР°РґРѕ РїРѕСЃС‚Р°РІРёС‚СЊ РёРєРѕРЅРєСѓ\n\t\t(!self.model and bIsModel)) then -- РќР°РѕР±РѕСЂРѕС‚. РќСѓР¶РЅРѕ РїРѕСЃС‚Р°РІРёС‚СЊ РјРѕРґРµР»СЊРєСѓ, РЅРѕ СЃС‚Р°СЏР»Р° РєР°СЂС‚РёРЅРєР°\n\n\t\tself.icon:Remove()\n\t\tself.icon = nil\n\tend\n\n\tself.model = bIsModel and sIco\n\tself.icon  = self.icon or (bIsModel and uigs.Create(\"DModelPanel\", function(mdl)\n\t\tmdl:SetSize(self.icon_bg:GetSize())\n\t\tmdl:SetModel(sIco)\n\n\t\tlocal mn, mx = mdl.Entity:GetRenderBounds()\n\t\tlocal size = 0\n\t\tsize = math.max(size, math.abs(mn.x) + math.abs(mx.x))\n\t\tsize = math.max(size, math.abs(mn.y) + math.abs(mx.y))\n\t\tsize = math.max(size, math.abs(mn.z) + math.abs(mx.z))\n\n\t\tmdl:SetFOV(30)\n\t\tmdl:SetCamPos(Vector(size, size, size))\n\t\tmdl:SetLookAt((mn + mx) * 0.5)\n\t\tmdl.LayoutEntity = function() return false end\n\n\tend, self.icon_bg)) or uigs.Create(\"igs_wmat\", function(ico)\n\t\tico:SetSize(self.icon_bg:GetSize())\n\t\tico.AutoSize = false\n\tend, self.icon_bg) -- РќР• РјРѕРґРµР»СЊРєР° (РЎСЃС‹Р»РєР° РЅР° РёРєРѕРЅРєСѓ)\n\n\n\tif bIsModel then\n\t\tself.icon:SetModel(sIco)\n\telse\n\t\tself.icon:SetURL(sIco) -- nil = СЃР±СЂРѕСЃ\n\tend\nend\n\n-- РљРЅРѕРїРєР° РїРѕРґ РЅР°Р·РІР°РЅРёРµРј РёРЅС„Рѕ РїР°РЅРµР»Рё\nfunction PANEL:SetSubNameButton(sName,func)\n\tif !sName then return end\n\n\tself.sub = self.sub or uigs.Create(\"DButton\", function(btn)\n\t\tbtn:Dock(TOP)\n\t\tbtn:SetTall(20)\n\t\tbtn:SetFont(\"Fated.20\")\n\t\tbtn:SetTextColor(IGS.col.TEXT_SOFT)\n\t\tbtn:SetContentAlignment(4)\n\t\tbtn.DoClick = func\n\t\tbtn.Paint = function() end\n\tend, self.head)\n\n\tself.sub:SetText(sName .. \"вЇ€\")\nend\n\n-- РЎРѕР·РґР°РµС‚ РЅРµРІРёРґРёРјСѓСЋ РїР°РЅРµР»СЊРєСѓ РІРѕС‚ С‚СѓС‚:\n-- https://img.qweqwe.ovh/1486589180000.png\nfunction PANEL:CreateActivity()\n\tself.activity = self.activity or uigs.Create(\"Panel\", function(btn)\n\t\tbtn:Dock(FILL)\n\tend, self.head)\n\n\treturn self.activity\nend\n\n-- РћРїРёСЃР°РЅРёРµ, РёРЅС„РѕСЂРјР°С†РёСЏ, РєР°СЂС‚РёРЅРєР°\nfunction PANEL:AddPanel(sTitle,panel)\n\t-- https://img.qweqwe.ovh/1486595573943.png\n\tlocal background = uigs.Create(\"Panel\", function(bg)\n\t\tbg:DockPadding(10,0,10,0) -- РѕС‚СЃС‚СѓРїС‹ РїРѕ РєСЂР°СЏРј РІРЅСѓС‚СЂРё СЃРєСЂРѕР»Р»Р°\n\t\tbg.Paint = function(s,w,h) -- Р»РёРЅРёСЏ СЃРЅРёР·Сѓ РїРѕСЃРµСЂРµРґРёРЅРµ РїР°РЅРµР»Рё https://img.qweqwe.ovh/1491948928484.png\n\t\t\tsurface.SetDrawColor(IGS.col.SOFT_LINE)\n\t\t\tsurface.DrawLine(10,h - 1,w - 10,h - 1)\n\t\tend\n\tend) -- РґР»СЏ РѕС‚СЃС‚СѓРїРѕРІ\n\n\tlocal y = panel:GetTall() -- СЃ РґРѕРєР°РјРё РЅРµ РІС‹С€Р»Рѕ, РїСЂРёС€Р»РѕСЃСЊ СЃРµС‚РёС‚СЊ РІСЂСѓС‡РЅСѓСЋ\n\n\tuigs.Create(\"DLabel\", function(title)\n\t\ttitle:Dock(TOP)\n\t\ttitle:SetTall(22)\n\t\ttitle:DockMargin(0,10,0,5)\n\t\ttitle:SetText(sTitle)\n\t\ttitle:SetFont(\"Fated.22\")\n\t\ttitle:SetTextColor(IGS.col.TEXT_HARD)\n\n\t\ty = y + 22 + 5 + 5\n\tend, background)\n\n\tpanel:SetParent(background)\n\tpanel:Dock(TOP)\n\n\tself.scroll:AddItem(background)\n\n\tbackground:SetTall(y + 5 + 10) -- 5 С…Р· С‡Рµ, Р° 10 - РѕС‚СЃС‚СѓРї РѕС‚ С‚РµРєСЃС‚Р° Рє Р±РѕСЂС‚РёРєСѓ СЃРЅРёР·Сѓ\nend\n\nfunction PANEL:Reset()\n\tself.scroll:Reset()\n\n\tif self.name then\n\t\tself.name:SetText(\"\")\n\tend\n\n\tif self.sub then\n\t\tself.sub:SetText(\"\")\n\tend\n\n\tif self.icon then\n\t\tself.icon:SetURL() -- IGS.C.DefaultIcon\n\tend\nend\n\n\n--[[-------------------------------------------------------------------------\nРќРµ РѕР±СЏР·Р°С‚РµР»СЊРЅС‹Рµ РјРµС‚РѕРґС‹. РС… С‚СѓС‚ РЅРµ РґРѕР»Р¶РЅРѕ Р±С‹С‚СЊ СЃ С‚РѕС‡РєРё Р·СЂРµРЅРёСЏ РїСЂР°РІРёР»СЊРЅРѕСЃС‚Рё РєРѕРґР°\nРќРѕ С‚Р°Рє РєР°Рє СЏ РїР°РЅРµР»СЊ Р±РѕР»СЊС€Рµ РЅРёРіРґРµ, РєСЂРѕРјРµ IGS РЅРµ СЋР·Р°СЋ, С‚Рѕ РјРЅРµ С‚Р°Рє Р±СѓРґРµС‚ СѓРґРѕР±РЅРµРµ\n---------------------------------------------------------------------------]]\n-- Р”РѕР±Р°РІР»СЏРµС‚ РїР°РЅРµР»СЊ СЃ РѕРїРёСЃР°РЅРёРµРј\nfunction PANEL:SetDescription(sDescription)\n\tif self.description then return end\n\n\tlocal pnl = uigs.Create(\"Panel\")\n\n\tself:InvalidateParent(true)\n\tlocal w = self:GetWide()\n\tlocal txt = string.Wrap(\"Fated.15\", sDescription, w - 10 - 10)\n\tlocal y   = 0\n\n\tfor _,line in ipairs(txt) do\n\t\tuigs.Create(\"DLabel\", function(d)\n\t\t\td:SetPos(0,y)\n\t\t\td:SetSize(w,15)\n\t\t\td:SetFont(\"Fated.15\")\n\t\t\td:SetTextColor(IGS.col.TEXT_SOFT)\n\t\t\td:SetText(line)\n\n\t\t\ty = y + 15\n\t\tend, pnl)\n\tend\n\n\tpnl:SetTall(y)\n\tself:AddPanel(\"РћРїРёСЃР°РЅРёРµ\",pnl)\nend\n\nfunction PANEL:SetInfo(tInf)\n\tlocal pnl = uigs.Create(\"Panel\")\n\tlocal y = 0\n\n\tfor k,v in pairs(tInf) do\n\t\tlocal line_bg = uigs.Create(\"Panel\", pnl)\n\t\tline_bg:SetTall(15)\n\t\tline_bg:Dock(TOP)\n\n\t\tuigs.Create(\"DLabel\", function(key)\n\t\t\tkey:Dock(LEFT)\n\t\t\tkey:SetWide(80)\n\t\t\tkey:SetFont(\"Fated.15\")\n\t\t\tkey:SetTextColor(IGS.col.TEXT_SOFT)\n\t\t\tkey:SetText(k)\n\t\t\tkey:SetContentAlignment(6)\n\t\tend, line_bg)\n\n\t\tuigs.Create(\"DLabel\", function(key)\n\t\t\tkey:Dock(FILL)\n\t\t\tkey:SetFont(\"Fated.15\")\n\t\t\tkey:SetTextColor(IGS.col.TEXT_HARD)\n\t\t\tkey:SetText(\"  \" .. v)\n\t\t\tkey:SetContentAlignment(4)\n\t\tend, line_bg)\n\n\t\ty = y + 15\n\tend\n\n\tpnl:SetTall(y)\n\tself:AddPanel(\"РРЅС„РѕСЂРјР°С†РёСЏ\",pnl)\nend\n\n-- Р”РѕР±Р°РІР»СЏРµС‚ РїР°РЅРµР»СЊ СЃ СѓРєР°Р·Р°РЅРЅС‹Рј РёР·РѕР±СЂР°Р¶РµРЅРёРµРј\nfunction PANEL:SetImage(sUrl)\n\tif !sUrl then return end\n\n\tself:InvalidateParent(true) -- self:GetWide()\n\n\tlocal pnl = uigs.Create(\"igs_wmat\")\n\tpnl:SetSize(self:GetWide(),self:GetWide() / 5 * 2) -- СЃРѕРѕС‚РЅРѕС€РµРЅРёРµ 5:2\n\tpnl:SetURL(sUrl)\n\n\tself:AddPanel(\"РР·РѕР±СЂР°Р¶РµРЅРёРµ\",pnl)\nend\n\nvgui.Register(\"igs_iteminfo\",PANEL,\"Panel\")\n\n-- IGS.WIN.Item(\"group_premium_15d\")\n","igs/interface/vgui/igs_multipanel.lua":  "--[[-------------------------------------------------------------------------\nРџР°РЅРµР»СЊ, РЅР° РєРѕС‚РѕСЂРѕР№ РјРѕР¶РЅРѕ СЂР°Р·РјРµСЃС‚РёС‚СЊ РЅРµСЃРєРѕР»СЊРєРѕ РґСЂСѓРіРёС… Рё РїРµСЂРµРєР»СЋС‡Р°С‚СЊСЃСЏ РјРµР¶РґСѓ РЅРёРјРё\nРСЃРїРѕР»СЊР·СѓРµС‚СЃСЏ РІ igs_tabbar Рё РјРѕР¶РµС‚ РёСЃРїРѕР»СЊР·РѕРІР°С‚СЊСЃСЏ РїРѕ РѕС‚РґРµР»СЊРЅРѕСЃС‚Рё\n\nРћР±СЂР°С‰Р°РµРј РІРЅРёРјР°РЅРёРµ РЅР° pnl:OnOpen()\n---------------------------------------------------------------------------]]\n\nlocal PANEL = {}\n\nfunction PANEL:Init()\n\tself.Panels = {}\nend\n\nfunction PANEL:AddPanel(panel,bActive)\n\tpanel:SetSize(self:GetWide(),self:GetTall())\n\tpanel:SetVisible(false)\n\tpanel:SetParent(self)\n\t-- panel.Paint = function(s,w,h) end -- РђРҐРўРЈРќР“. РЈР¶Рµ РґРІР°Р¶РґС‹ РЅР° РіСЂР°Р±Р»Рё РІСЃС‚Р°Р»\n\t-- РќРµ РїРѕРЅРёРјР°Р», РїРѕС‡РµРјСѓ РЅРµ РґРѕР±Р°РІР»СЏРµС‚СЃСЏ РїР°РЅРµР»СЊ. РџРѕС‚РѕРј РґРѕС€Р»Рѕ, С‡С‚Рѕ СЌС‚РѕС‚ С…СѓРє РµРµ РїСЂРѕСЃС‚Рѕ РїСЂСЏС‡РµС‚\n\n\tpanel.ID = table.insert(self.Panels,panel)\n\n\tif (bActive) then\n\t\tself:SetActivePanel(panel.ID)\n\tend\n\n\treturn panel.ID\nend\n\nfunction PANEL:SetActivePanel(iID)\n\tfor i,pnl in ipairs(self.Panels) do\n\t\tpnl.Active = iID == i\n\n\t\tif (pnl:IsVisible()) then\n\t\t\tpnl:Dock(NODOCK)\n\t\t\tpnl:SetVisible(false)\n\t\tend\n\n\t\tif (iID == i) then\n\t\t\tpnl:SetVisible(true)\n\t\t\tpnl:DockMargin(0, 0, 0, 0)\n\t\t\tpnl:Dock(FILL)\n\n\t\t\tif pnl.OnOpen then\n\t\t\t\tpnl:OnOpen()\n\t\t\tend\n\t\tend\n\tend\nend\n\nfunction PANEL:GetActivePanel()\n\tfor i,pnl in ipairs(self.Panels) do\n\t\tif pnl.Active then\n\t\t\treturn pnl\n\t\tend\n\tend\nend\n\nvgui.Register(\"igs_multipanel\", PANEL, \"Panel\")\n-- IGS.UI()\n","igs/interface/vgui/igs_panels_layout.lua":  "-- http://joxi.ru/Vm6bbvlipXRZmZ\n\n-- TODO РїРµСЂРµРїРёСЃР°С‚СЊ. РЎРќРћР’Рђ. Р§С‚РѕР±С‹ РЅРѕСЂРј РІСЃС‚Р°РІР»СЏР»Рѕ СЌР»Р»РµРјРµРЅС‚С‹ СЃ СЂР°Р·РЅРѕР№ С€РёСЂРёРЅРѕР№, РЅРµ РІС‹С…РѕРґСЏ Р·Р° РїСЂРµРґРµР»С‹ СЃС‚СЂРѕРєРё\nlocal PANEL = {}\n\nfunction PANEL:Init()\n\tself.name  = \"Untitled\"\n\tself.panels = {} -- line, panels\n\n\tself.current_line = 1\n\n\t--self.elements_tall = 80\nend\n\nfunction PANEL:SetName(sName)\n\tif !sName then return end\n\n\tself.name = sName\n\n\tself.title = self.title or uigs.Create(\"DLabel\", function(title)\n\t\ttitle:SetSize(self:GetWide() - 10 - 10,30)\n\t\ttitle:SetPos(10,10)\n\t\ttitle:SetFont(\"Fated.24\")\n\n\t\t-- 30 is label height, 10 is margins\n\t\tself.last_y = 10 + 30\n\tend, self)\n\n\tself.title:SetText(self.name)\n\n\treturn self.title\nend\n\nfunction PANEL:GetLineWide(iLine)\n\tlocal w = 0\n\tfor _,pan in ipairs(self.panels[iLine]) do\n\t\tw = w + pan:GetWide()\n\tend\n\n\t-- 10 - СЂР°Р·РјРµСЂ РѕС‚СЃС‚СѓРїР°\n\treturn w + (#self.panels[iLine] - 1) * 10\nend\n\n-- Р’РѕР·РІСЂР°С‰Р°РµС‚ РїР°РЅРµР»Рё РІ СЃС‚СЂРѕРєРµ\n-- function PANEL:GetLine(iLine)\n-- \treturn self.panels[iLine]\n-- end\n\nfunction PANEL:GetCurrentLine()\n\treturn self.panels[self.current_line]\nend\n\n-- Y РґР»СЏ СЃР»РµРґСѓСЋС‰РµРіРѕ СЂСЏРґР° РїР°РЅРµР»РµРє\nfunction PANEL:GetY()\n\tlocal y = (#self.panels - 1) * (self.elements_tall + 10) -- РІ #self.panels РєРѕР»-РІРѕ Р»РёРЅРёР№\n\n\treturn self.title and (y + 10 + 30) or y\nend\n\nfunction PANEL:Add(panel)\n\tpanel:SetParent(self)\n\n\t-- Р’СЃРµ СЌР»Р»РµРјРµРЅС‚С‹ РІ Р»СЌР№Р°СѓС‚Рµ РґРѕР»Р¶РЅС‹ Р±С‹С‚СЊ РѕРґРёРЅР°РєРѕРІРѕР№ РІС‹СЃРѕС‚С‹, С…РѕС‚СЏ РјРѕРіСѓС‚ Р±С‹С‚СЊ СЂР°Р·РЅРѕР№ С€РёСЂРёРЅС‹\n\tself.elements_tall = self.elements_tall or panel:GetTall()\n\n\tself.panels[self.current_line] = self.panels[self.current_line] or {}\n\ttable.insert(self.panels[self.current_line],panel)\n\n\tlocal line_wide = self:GetLineWide(self.current_line)\n\n\tlocal borders = !self.disabled_align and (self:GetWide() - line_wide) / 2 -- РѕС‚СЃС‚СѓРїС‹ РїРѕ СЃС‚РѕСЂРѕРЅР°Рј\n\tlocal line_panels = self:GetCurrentLine()\n\n\tfor i,pan in ipairs(line_panels) do\n\n\t\t-- Р•СЃР»Рё РїРµСЂРІР°СЏ РїР°РЅРµР»СЊ, С‚Рѕ РґРµР»Р°РµРј РѕС‚СЃС‚СѓРї, С‡С‚РѕР±С‹ РІ РєРѕРЅС†Рµ РІСЃРµ Р±С‹Р»Рѕ РїРѕ СЃРµСЂРµРґРёРЅРµ\n\t\tif i == 1 then\n\t\t\tpan:SetPos(self.disabled_align and 10 or borders, self:GetY())\n\t\telse\n\t\t\tlocal x,y = line_panels[i - 1]:GetPos()\n\t\t\tpan:SetPos(x + line_panels[i - 1]:GetWide() + 10,y)\n\t\tend\n\tend\n\n\t-- Р•СЃР»Рё СЂР°Р·РјРµСЂ СЃСѓС‰РµСЃС‚РІСѓСЋС‰РёС… РєРѕРјРїРѕРЅРµРЅС‚РѕРІ + РµС‰Рµ РѕРґРёРЅ \u003c= СЂР°Р·РјРµСЂ Р»СЌР№Р°СѓС‚Р°, С‚Рѕ РІСЃС‚Р°РІР»СЏРµРј СЌР»Р»РµРјРµРЅС‚\n\t-- if panel.tag then\n\t-- \tprint(\"\\n\\n\")\n\t-- \tprint(\"self:GetWide()\",self:GetWide())\n\t-- \tprint(\"panel:GetWide()\",panel:GetWide())\n\t-- \tprint(\"line_wide\",line_wide)\n\t-- \tprint(panel)\n\t-- end\n\tif line_wide + 10 + panel:GetWide() \u003e self:GetWide() then\n\t\t-- if panel.tag then\n\t\t-- \tPrintTable(self.panels)\n\t\t-- \tprint(\"РџРµСЂРµС€Р»Рё РЅР° СЃР»РµРґ. СЂСЏРґ\")\n\t\t-- \t--panel:SetPos(self.disabled_align and 10 or borders, self:GetY())\n\t\t-- end\n\t\tself.current_line = self.current_line + 1\n\tend\n\n\tself:PerformLayout()\nend\n\nfunction PANEL:PerformLayout()\n\tself:SetHeight(self:GetY() + self.elements_tall) -- + 10 margin\nend\n\n-- РћС‚РєР»СЋС‡Р°РµС‚ С†РµРЅС‚СЂРёСЂРѕРІР°РЅРёРµ СЌР»Р»РµРјРµРЅС‚РѕРІ\nfunction PANEL:DisableAlignment(bDisable)\n\tself.disabled_align = bDisable\nend\n\n\nvgui.Register(\"igs_panels_layout\", PANEL, \"Panel\")\n--IGS.UI()\n","igs/interface/vgui/igs_panels_layout_list.lua":  "local PANEL = {}\n\nfunction PANEL:Init()\n\t-- categ_name \u003e categpan\n\tself.list = {}\nend\n\n-- РћРґРёРЅРѕС‡РЅРѕРµ РґРѕР±Р°РІР»РµРЅРёРµ\nfunction PANEL:Add(panel,sCategory)\n\tlocal cat = sCategory or \"Р Р°Р·РЅРѕРµ\"\n\n\tif !self.list[cat] then\n\t\tself.list[cat] = uigs.Create(\"igs_panels_layout\", self)\n\t\tself.list[cat]:SetWide(self:GetWide()) -- РёСЃРїРѕР»СЊР·СѓРµРј С€РёСЂРёРЅСѓ СЂРѕРґРёС‚РµР»СЏ РІРјРµСЃС‚Рѕ Р¶РµСЃС‚РєРѕ Р·Р°РґР°РЅРЅРѕР№ 650\n\t\tself.list[cat]:SetName(sCategory)\n\t\tself.list[cat]:DisableAlignment(self.disabled_align)\n\n\t\tself:AddItem(self.list[cat])\n\tend\n\n\tself.list[cat]:Add(panel)\n\n\treturn self.list[cat]\nend\n\n-- РћС‚РєР»СЋС‡Р°РµС‚ С†РµРЅС‚СЂРёСЂРѕРІР°РЅРёРµ СЌР»Р»РµРјРµРЅС‚РѕРІ РІРѕ РІСЃРµС… РїР°РЅРµР»СЏС… Р»СЌР№Р°СѓС‚Р°\nfunction PANEL:DisableAlignment(bDisable)\n\tself.disabled_align = bDisable\nend\n\nfunction PANEL:Clear()\n\tfor _,panel in pairs(self.list) do -- categ\n\t\tpanel:Remove()\n\tend\n\n\tself:Init()\nend\n\nfunction PANEL:OnSizeChanged()\n\t-- РћР±РЅРѕРІР»СЏРµРј С€РёСЂРёРЅСѓ РІСЃРµС… РєР°С‚РµРіРѕСЂРёР№ РїСЂРё РёР·РјРµРЅРµРЅРёРё СЂР°Р·РјРµСЂР° СЂРѕРґРёС‚РµР»СЏ\n\tfor _,panel in pairs(self.list) do\n\t\tif IsValid(panel) then\n\t\t\tpanel:SetWide(self:GetWide())\n\t\tend\n\tend\nend\n\nvgui.Register(\"igs_panels_layout_list\", PANEL, \"igs_scroll\")\n-- IGS.UI()\n","igs/interface/vgui/igs_scroll.lua":  "local SCROLLBAR = {}\nfunction SCROLLBAR:Init()\n\tself.parent = self:GetParent()\n\n\tself.scrollButton = vgui.Create(\"Panel\", self)\n\tself.scrollButton.OnMousePressed = function(s, mb)\n\t\tif (mb == MOUSE_LEFT and !self:GetParent().ShouldHideScrollbar) then\n\t\t\tlocal _, my = s:CursorPos()\n\n\t\t\ts.scrolling = true\n\t\t\ts.mouseOffset = my\n\t\tend\n\tend\n\tself.scrollButton.OnMouseReleased = function(s, mb)\n\t\tif (mb == MOUSE_LEFT) then\n\t\t\ts.scrolling = false\n\t\t\ts.mouseOffset = nil\n\t\tend\n\tend\n\n\tself.height = 0\n\tself.addWidth = 0\nend\n\nfunction SCROLLBAR:Think()\n\tif (self.scrollButton.scrolling) then\n\t\tif (!input.IsMouseDown(MOUSE_LEFT)) then\n\t\t\tself.scrollButton:OnMouseReleased(MOUSE_LEFT)\n\t\t\treturn\n\t\tend\n\n\t\tlocal _, my = self.scrollButton:CursorPos()\n\n\t\tlocal diff = my - self.scrollButton.mouseOffset\n\n\t\tlocal maxOffset = self.parent:GetCanvas():GetTall() - self.parent:GetTall()\n\n\t\tlocal perc = (self.scrollButton.y + diff) / (self:GetTall() - self.height)\n\t\tself.parent.yOffset = math.Clamp(perc * maxOffset, 0, maxOffset)\n\n\t\tself.parent:InvalidateLayout()\n\tend\n\n\tlocal preSize = self.addWidth\n\n\tlocal mx, my = self:CursorPos()\n\tif ((mx \u003e -8 and mx \u003c self:GetWide() + 3 and my \u003e self.scrollButton.y and my \u003c self.scrollButton.y + self.height) or self.scrollButton.scrolling) then\n\t\tself.addWidth = math.Clamp(self.addWidth + (FrameTime() * 96), 0, 8)\n\telse\n\t\tself.addWidth = math.Clamp(self.addWidth - (FrameTime() * 96), 0, 8)\n\tend\n\n\tif (preSize != self.addWidth) then\n\t\tself:InvalidateLayout()\n\tend\nend\n\nfunction SCROLLBAR:PerformLayout()\n\tlocal maxOffset = self.parent:GetCanvas():GetTall() - self.parent:GetTall()\n\n\tself:SetSize(2 + self.addWidth, self.parent:GetTall())\n\tself:SetPos(self.parent:GetWide() - self:GetWide(), 0)\n\n\tself.heightRatio = self.parent:GetTall() / self.parent:GetCanvas():GetTall()\n\tself.height = math.Clamp(math.ceil(self.heightRatio * self.parent:GetTall()), 20, math.huge)\n\n\tself.scrollButton:SetSize(self:GetWide(), self.height)\n\tself.scrollButton:SetPos(0, math.Clamp(self.parent.yOffset / maxOffset, 0, 1) * (self:GetTall() - self.height))\nend\n\nfunction SCROLLBAR:Paint(w, h)\n\tif (self:GetParent().ShouldHideScrollbar) then return end\n\n\tdraw.Box(0, self.scrollButton.y, w, self.height, IGS.col.HIGHLIGHTING)\nend\n\nfunction SCROLLBAR:OnMouseWheeled(delta)\n\tself.parent:OnMouseWheeled(delta)\nend\n\nvgui.Register(\"ui_scrollbar\", SCROLLBAR, \"Panel\")\n\n\n\n\n\n\nlocal SCROLLABLE = {}\nfunction SCROLLABLE:Init()\n\tself.contentContainer = vgui.Create(\"Panel\", self)\n\tself.scrollBar = vgui.Create(\"ui_scrollbar\", self)\n\n\tself.yOffset = 0\n\tself.ySpeed = 0\n\tself.scrollSize = 4\n\tself.SpaceTop = 0\n\tself.Padding = 0\n\n\tfunction self.contentContainer:OnChildRemoved(child)\n\t\tself:GetParent():PerformLayout()\n\tend\nend\n\nfunction SCROLLABLE:Reset()\n\tself:GetCanvas():Clear(true)\n\tself.yOffset = 0\n\tself.ySpeed = 0\n\tself.scrollSize = 1\n\n\tself:PerformLayout()\nend\n\nfunction SCROLLABLE:AddItem(child)\n\tchild:SetParent(self:GetCanvas())\n\tself:PerformLayout()\n\treturn child\nend\n\nfunction SCROLLABLE:SetSpacing(i)\n\tself.SpaceTop = i\nend\n\nfunction SCROLLABLE:SetPadding(i)\n\tself.Padding = i\nend\n\nfunction SCROLLABLE:GetCanvas()\n\treturn self.contentContainer\nend\n\nfunction SCROLLABLE:SetScrollSize(int)\n\tself.scrollSize = int\nend\n\nfunction SCROLLABLE:ScrollTo(y)\n\tself.yOffset = y\n\n\tself:InvalidateLayout()\nend\n\nfunction SCROLLABLE:OnMouseWheeled(delta)\n\tif ((delta \u003e 0 and self.ySpeed \u003c 0) or (delta \u003c 0 and self.ySpeed \u003e 0)) then\n\t\tself.ySpeed = 0\n\telse\n\t\tself.ySpeed = self.ySpeed + (delta * self.scrollSize)\n\tend\n\n\tself:PerformLayout()\nend\n\nfunction SCROLLABLE:SetOffset(offSet)\n\tlocal maxOffset = (self:GetCanvas():GetTall() - self:GetTall())\n\tif (maxOffset \u003c 0) then maxOffset = 0 end\n\n\tself.yOffset = math.Clamp(offSet, 0, maxOffset)\n\n\tself:PerformLayout()\n\n\tif (self.yOffset == 0 or self.yOffset == maxOffset) then return true end\nend\n\nfunction SCROLLABLE:Think()\n\tif (self.ySpeed != 0) then\n\t\tif (self:SetOffset(self.yOffset - self.ySpeed)) then\n\t\t\tself.ySpeed = 0\n\t\telse\n\t\t\tif (self.ySpeed \u003c 0) then\n\t\t\t\tself.ySpeed = math.Clamp(self.ySpeed + (FrameTime() * self.scrollSize * 4), self.ySpeed, 0)\n\t\t\telse\n\t\t\t\tself.ySpeed = math.Clamp(self.ySpeed - (FrameTime() * self.scrollSize * 4), 0, self.ySpeed)\n\t\t\tend\n\t\tend\n\tend\nend\n\nfunction SCROLLABLE:PerformLayout()\n\tlocal canvas = self:GetCanvas()\n\n\tif (canvas:GetWide() != self:GetWide()) then\n\t\tcanvas:SetWide(self:GetWide())\n\tend\n\n\tlocal y = 0\n\tlocal lastChild\n\tfor k, v in ipairs(canvas:GetChildren()) do\n\t\tlocal childY = y + self.SpaceTop\n\t\tif (v.x != self.Padding or v.y != childY) then\n\t\t\tv:SetPos(math.max(0, self.Padding), y + self.SpaceTop)\n\t\tend\n\t\tif (v:GetWide() != self:GetWide() - self.Padding * 2) then\n\t\t\tv:SetWide(math.min(self:GetWide(), self:GetWide() - self.Padding * 2))\n\t\tend\n\n\t\ty = v.y + v:GetTall() + self.SpaceTop + self.Padding\n\t\tlastChild = v\n\tend\n\ty = lastChild and lastChild.y + lastChild:GetTall() or y\n\tif (canvas:GetTall() != y) then\n\t\tcanvas:SetTall(y)\n\tend\n\n\tif (canvas:GetTall() \u003c= self:GetTall() and self.scrollBar:IsVisible()) then\n\t\tcanvas:SetTall(self:GetTall())\n\n\t\tself.scrollBar:SetVisible(false)\n\telseif (canvas:GetTall() \u003e self:GetTall() and !self.scrollBar:IsVisible()) then\n\t\tself.scrollBar:SetVisible(true)\n\tend\n\n\tlocal maxOffset = self:GetCanvas():GetTall() - self:GetTall()\n\n\tif (self.yOffset \u003e maxOffset) then\n\t\tself.yOffset = maxOffset\n\tend\n\n\tif (self.yOffset \u003c 0) then\n\t\tself.yOffset = 0\n\tend\n\n\tif (canvas.x != 0 or canvas.y != -self.yOffset) then\n\t\tcanvas:SetPos(0, -self.yOffset)\n\t\tself.scrollBar:InvalidateLayout()\n\tend\nend\n\nfunction SCROLLABLE:IsAtMaxOffset()\n\tlocal maxOffset = math.Clamp(self:GetCanvas():GetTall() - self:GetTall(), 0, math.huge)\n\treturn self.yOffset == maxOffset\nend\n\nfunction SCROLLABLE:Paint(w, h)\nend\n\nfunction SCROLLABLE:HideScrollbar(bool)\n\tself.ShouldHideScrollbar = bool\nend\n\nfunction SCROLLABLE:DockToFrame()\n\tlocal p = self:GetParent()\n\tlocal x, y = p:GetDockPos()\n\n\tself:SetPos(x, y)\n\tself:SetSize(p:GetWide() - 10, p:GetTall() - (y + 5))\nend\n\nvgui.Register(\"igs_scroll\", SCROLLABLE, \"Panel\")\n","igs/interface/vgui/igs_sidebar.lua":  "local PANEL = {}\n\nfunction PANEL:Init()\n\t-- РҐРµСЂРЅСЏ СЃРїСЂР°РІР° РѕС‚ Р»СЌР№Р°СѓС‚Р° СЃ СѓСЃР»СѓРіР°РјРё http://joxi.ru/52aQQ8Efzov120\n\t-- Р’РёРґ Р±РµР· РЅРµРµ: http://joxi.ru/eAO44lGcXORlro\n\tself.sidebar = uigs.Create(\"Panel\", function(sbar)\n\t\tsbar:Dock(FILL)\n\tend, self)\n\n\t-- Р’РµСЂС…РЅСЏСЏ С‡Р°СЃС‚СЊ http://joxi.ru/5mdWW05tzW6Wr1\n\tself.header = uigs.Create(\"Panel\", function(header)\n\t\theader:SetTall(40)\n\t\theader:Dock(TOP)\n\tend, self.sidebar)\nend\n\n-- Р—Р°РіРѕР»РѕРІРѕРє СЃР°Р№РґР±Р°СЂР° \"РџРѕСЃР»РµРґРЅРёРµ РїРѕРєСѓРїРєРё\" Рё С‚.Рґ.\nfunction PANEL:SetTitle(sTitle)\n\tself.title = self.title or uigs.Create(\"DLabel\", function(title)\n\t\ttitle:Dock(BOTTOM)\n\t\ttitle:SetTall(24)\n\t\ttitle:SetFont(\"Fated.19\")\n\t\ttitle:SetTextColor(IGS.col.TEXT_HARD)\n\t\ttitle:SetContentAlignment(8)\n\tend, self.header)\n\n\tself.title:SetText(sTitle)\n\n\treturn self.title\nend\n\nvgui.Register(\"igs_sidebar\",PANEL,\"Panel\")\n--IGS.UI()\n","igs/interface/vgui/igs_tabbar.lua":  "local PANEL = {}\n\nlocal barWide = 80 -- С€РёСЂРёРЅР° РІРµСЂС‚РёРєР°Р»СЊРЅРѕР№ РїР°РЅРµР»Рё РєРЅРѕРїРѕРє\nlocal btnTall = 70 -- РІС‹СЃРѕС‚Р° РєРЅРѕРїРєРё\nlocal btnWide = 70 -- С€РёСЂРёРЅР° РєРЅРѕРїРєРё\n\nfunction PANEL:Init()\n\tself.activity = uigs.Create(\"igs_multipanel\",self)\n\n\tself.tabBar = uigs.Create(\"Panel\",self)\n\tself.tabBar:SetWide(barWide)\n\tself.tabBar.Paint = function(_, w, h)\n\t\t-- Р Р°Р·РјС‹С‚РёРµ С„РѕРЅР° РїР°РЅРµР»Рё РєРЅРѕРїРѕРє\n\t\tif RNDX and Mantle and Mantle.ui.convar.blur then\n\t\t\tRNDX().Rect(0, 0, w, h)\n\t\t\t\t:Rad(0)\n\t\t\t\t:Blur(1.3)\n\t\t\t:Draw()\n\t\tend\n\t\t\n\t\tsurface.SetDrawColor(IGS.col.TAB_BAR)\n\t\tsurface.DrawRect(0,0,w,h) -- bg\n\n\t\tsurface.SetDrawColor(IGS.col.HARD_LINE)\n\t\tsurface.DrawLine(w,0,w,h) -- РїСЂР°РІР°СЏ Р»РёРЅРёСЏ (СЂР°Р·РґРµР»РёС‚РµР»СЊ)\n\tend\n\n\tself.btnsPan = uigs.Create(\"DIconLayout\", self.tabBar)\n\tself.btnsPan.Paint = function() end\n\tself.btnsPan:SetSpaceY(5) -- РІРµСЂС‚РёРєР°Р»СЊРЅС‹Рµ РѕС‚СЃС‚СѓРїС‹ РјРµР¶РґСѓ РєРЅРѕРїРєР°РјРё\n\n\tself.Buttons = {}\nend\n\nfunction PANEL:SetActiveTab(num)\n\tfor _, btn in ipairs(self.Buttons) do\n\t\tbtn.Active = (btn.ID == num) -- С„РёРєСЃ РїРѕРґСЃРІРµС‚РєРё\n\tend\n\n\tself.activity:SetActivePanel(num)\nend\n\nfunction PANEL:GetActiveTab()\n\treturn self.activity:GetActivePanel()\nend\n\nfunction PANEL:GetContentWide()\n\treturn self:GetWide() - barWide\nend\n\nfunction PANEL:UpdateButtonsLayout()\n\tlocal total_h = #self.Buttons * btnTall + math.max(#self.Buttons - 1, 0) * 5\n\tself.btnsPan:SetSize(barWide, total_h)\n\tself.btnsPan:SetPos((barWide - btnWide) / 2, (self.tabBar:GetTall() - total_h) / 2)\nend\n\nfunction PANEL:AddTab(sTitle,panel,sIcon,bActive)\n\tlocal ID = self.activity:AddPanel(panel,bActive)\n\n\tlocal button = uigs.Create(\"DButton\", function(btn)\n\t\tbtn:SetSize(btnWide, btnTall)\n\t\tbtn:SetText(\"\")\n\n\t\tbtn:SetFont(\"Fated.24\")\n\n\t\tbtn.DoClick = function(s)\n\t\t\tself:SetActiveTab(s.ID)\n\t\tend\n\n\t\t--[[-------------------------------------------------------------------------\n\t\t\tTODO РЎРґРµР»Р°С‚СЊ РѕС‚СЂРёСЃРѕРІРєСѓ СЃРєРёРЅР° С‡РµСЂРµР· СЃРєРёРЅ С…СѓРє\n\t\t\tС‡С‚РѕР±С‹ РјРѕР¶РЅРѕ Р±С‹Р»Рѕ СЋР·Р°С‚СЊ РєРѕРјРїРѕРЅРµРЅС‚ РЅРµ С‚РѕР»СЊРєРѕ РІ IGS Р±РµР· РїРѕСЂС‡Рё РґРёР·Р°Р№РЅР°\n\t\t\tР’ bar.Paint С‚РѕР¶Рµ\n\t\t---------------------------------------------------------------------------]]\n\t\tbtn.Paint = function(s,w,h)\n\t\t\tif s.Active then\n\t\t\t\tsurface.SetDrawColor(IGS.col.HIGHLIGHTING)\n\t\t\t\tsurface.SetTextColor(IGS.col.HIGHLIGHTING)\n\t\t\telse\n\t\t\t\tsurface.SetDrawColor(IGS.col.HIGHLIGHT_INACTIVE)\n\t\t\t\tsurface.SetTextColor(IGS.col.HIGHLIGHT_INACTIVE)\n\t\t\tend\n\n\t\t\tif sIcon then\n\t\t\t\tsurface.SetMaterial( Material(sIcon) )\n\t\t\t\tsurface.DrawTexturedRect(w / 2 - 32 / 2, 5, 32, 32)\n\t\t\tend\n\n\t\t\tif sTitle then\n\t\t\t\tsurface.SetFont(\"Fated.15\")\n\n\t\t\t\tlocal tw = surface.GetTextSize(sTitle)\n\t\t\t\tsurface.SetTextPos(w / 2 - tw / 2, h - 20)\n\n\t\t\t\tsurface.DrawText( sTitle )\n\t\t\tend\n\t\tend\n\n\t\tbtn.ID     = ID\n\t\tbtn.Tab    = panel\n\t\tbtn.Active = bActive\n\tend)\n\n\tfunction button:Name()\n\t\treturn sTitle\n\tend\n\n\tself.btnsPan:Add(button)\n\ttable.insert(self.Buttons, button)\n\tif bActive then\n\t\tself:SetActiveTab(ID)\n\tend\n\t-- РћР±РЅРѕРІР»СЏРµРј СЂР°Р·РјРµСЂС‹ РІРµСЂС‚РёРєР°Р»СЊРЅРѕР№ РїР°РЅРµР»Рё РєРЅРѕРїРѕРє\n\tself:UpdateButtonsLayout()\n\n\treturn button\nend\n\nfunction PANEL:PerformLayout()\n\tself.tabBar:SetTall(self:GetTall())\n\tself.tabBar:SetPos(0, 0)\n\n\tself.activity:SetPos(barWide, 0)\n\tself.activity:SetSize(self:GetWide() - barWide, self:GetTall())\n\n\tself:UpdateButtonsLayout()\nend\n\nfunction PANEL:Paint(w,h)\n\t-- Р Р°Р·РјС‹С‚РёРµ РѕСЃРЅРѕРІРЅРѕРіРѕ С„РѕРЅР°\n\tif RNDX and Mantle and Mantle.ui.convar.blur then\n\t\tRNDX().Rect(0, 0, w, h)\n\t\t\t:Rad(0)\n\t\t\t:Blur(1.5)\n\t\t:Draw()\n\tend\n\t\n\tdraw.RoundedBox(0,0,0,w,h,IGS.col.ACTIVITY_BG)\nend\n\nvgui.Register(\"igs_tabbar\", PANEL, \"Panel\")\n-- IGS.UI()\n","igs/interface/vgui/igs_table.lua":  "local PANEL = {}\n\nfunction PANEL:Init()\n\tself.columns = {}\n\tself.lines   = {}\n\n\tself.header_tall = 0\n\n\t-- РљРѕР»РѕРЅРєРё, РґР»СЏ РєРѕС‚РѕСЂС‹С… СѓРєР°Р·Р°РЅС‹ iWidePx\n\tself.nonAdjustableSpace = 0\n\tself.nonAdjustableItems = 0\n\n\tself.scroll = uigs.Create(\"igs_scroll\", self)\nend\n\nfunction PANEL:SetTitle(sText)\n\tself.title = self.title or uigs.Create(\"DLabel\", function(t)\n\t\tt:Dock(TOP)\n\t\tt:SetTall(20)\n\t\tt:SetFont(\"Fated.20\")\n\t\tt:SetTextColor(IGS.col.TEXT_HARD)\n\t\tt:SetContentAlignment(5)\n\t\t-- t:SetWrap(true) -- РµСЃР»Рё СЂР°СЃРєРѕРјРјРµРЅС‚РёС‚СЊ, С‚Рѕ РЅРµ Р±СѓРґРµС‚ СЂР°Р±РѕС‚Р°С‚СЊ SetContentAlignment\n\t\tt:SetAutoStretchVertical(true)\n\tend, self)\n\n\tself.title:SetText(sText)\nend\n\nfunction PANEL:AddColumn(sName,iWidePx)\n\tself.columns_panel = self.columns_panel or uigs.Create(\"Panel\", function(p)\n\t\tp:SetTall(15)\n\n\t\tself.header_tall = self.header_tall + p:GetTall()\n\tend, self)\n\n\ttable.insert(self.columns, uigs.Create(\"Panel\", function(clmn)\n\t\tclmn.staticWide = iWidePx\n\n\t\t-- 10 РЅРµ РѕР±СЏР·Р°С‚РµР»СЊРЅРѕ. РџСЂРѕСЃС‚Рѕ РґР»СЏ Р·Р°РјРµС‚РЅРѕСЃС‚Рё РїСЂРё РѕС‚Р»Р°РґРєРµ\n\t\t-- clmn:SetSize(clmn.staticWide or 10, self.columns_panel:GetTall())\n\t\tclmn.Paint = function(s,w,h)\n\t\t\tsurface.SetDrawColor(IGS.col.HARD_LINE)\n\t\t\tsurface.DrawLine(3,h - 1,w - 2,h - 1)\n\n\t\t\tsurface.DrawLine(0,0,0,h)\n\t\t\tsurface.DrawLine(w,0,w,h)\n\n\t\t\tsurface.SetFont(\"Fated.15\")\n\t\t\tsurface.SetTextColor(IGS.col.TEXT_SOFT)\n\t\t\tsurface.SetTextPos((w - surface.GetTextSize(sName)) / 2,0)\n\t\t\tsurface.DrawText(sName)\n\t\tend\n\tend, self.columns_panel))\n\n\tif iWidePx then\n\t\tself.nonAdjustableItems = self.nonAdjustableItems + 1\n\t\tself.nonAdjustableSpace = self.nonAdjustableSpace + iWidePx\n\tend\n\n\tself:PerformLayout()\nend\n\nfunction PANEL:AddLine(...)\n\tlocal rows = {...}\n\n\tlocal iKek = table.insert(self.lines,\n\t\tself.scroll:AddItem(uigs.Create(\"Panel\", function(line)\n\t\t\tline:SetTall(18)\n\t\t\tline:Dock(TOP)\n\t\t\tline.columns = {}\n\n\t\t\t-- self.columns[i]:GetWide()\n\t\t\tfor i,val in ipairs(rows) do\n\t\t\t\tline.columns[i] = uigs.Create(\"DButton\", function(row) -- Р‘С‹Р»Рѕ Panel\n\t\t\t\t\trow:SetText(val)\n\t\t\t\t\trow.DoClick = function() if line.DoClick then line.DoClick(row) end end\n\t\t\t\t\trow:SetCursor(\"arrow\")\n\t\t\t\t\trow:SetTall( line:GetTall() )\n\t\t\t\t\t-- row:SetPos(self.columns[i]:GetPos())\n\t\t\t\t\trow.Paint = function(s,w,h)\n\t\t\t\t\t\tsurface.SetDrawColor(IGS.col.HARD_LINE)\n\t\t\t\t\t\tsurface.DrawLine(3,h - 1,w - 2,h - 1)\n\n\t\t\t\t\t\tsurface.DrawLine(0,0,0,h)\n\t\t\t\t\t\tsurface.DrawLine(w,0,w,h)\n\n\t\t\t\t\t\tsurface.SetFont(\"Fated.18\")\n\t\t\t\t\t\tsurface.SetTextColor(IGS.col.TEXT_HARD)\n\t\t\t\t\t\tsurface.SetTextPos((w - surface.GetTextSize(s:GetText())) / 2,0)\n\t\t\t\t\t\tsurface.DrawText(s:GetText())\n\t\t\t\t\t\treturn true -- override\n\t\t\t\t\tend\n\t\t\t\tend, line)\n\t\t\tend\n\t\tend))\n\t)\n\n\t-- self:PerformLayout()\n\treturn self.lines[iKek] -- РІСЃС‚Р°РІР»РµРЅРЅР°СЏ СЃС‚СЂРѕРєР°\nend\n\nfunction PANEL:Clear()\n\t-- for i,linePan in ipairs(self.lines) do\n\t-- \tlinePan:Remove()\n\t-- \ttable.remove(self.lines,i)\n\t-- end\n\n\tfor i = #self.lines,1,-1 do\n\t\tlocal linePan = self.lines[i]\n\t\tlinePan:Remove()\n\t\ttable.remove(self.lines,i)\n\tend\nend\n\nPANEL.Paint     = IGS.S.TablePanel\nPANEL.PaintOver = IGS.S.Outline\n\nfunction PANEL:PerformLayout()\n\tif self.title then\n\t\tself.header_tall = self.title:GetTall()\n\tend\n\n\tif self.columns_panel then\n\t\tself.columns_panel:SetPos(0,self.header_tall)\n\t\tself.columns_panel:SetWide(self:GetWide())\n\n\t\t--PrintTable(self.columns)\n\n\t\tlocal x = 0\n\t\tlocal cell_wide = (self:GetWide() - self.nonAdjustableSpace) / (#self.columns - self.nonAdjustableItems)\n\t\t-- print(\"#self.columns\",#self.columns)\n\t\t-- print(\"self.nonAdjustableItems\",self.nonAdjustableItems)\n\t\t-- print(\"self.nonAdjustableSpace\",self.nonAdjustableSpace)\n\t\tfor _,v in ipairs(self.columns) do\n\t\t\t-- print(v,v:GetPos())\n\t\t\t-- print(v:GetSize())\n\t\t\tv:SetPos(x,0)\n\t\t\tv:SetSize(v.staticWide or cell_wide, self.columns_panel:GetTall())\n\n\t\t\tx = x + (v.staticWide or v:GetWide())\n\t\tend\n\n\t\tself.header_tall = self.header_tall + self.columns_panel:GetTall()\n\tend\n\n\tself.scroll:SetPos(0,self.header_tall)\n\tself.scroll:SetSize(self:GetWide(),self:GetTall() - self.header_tall)\n\n\tfor _,linePan in ipairs(self.lines) do\n\t\tfor i,rowPan in ipairs(linePan.columns) do\n\t\t\trowPan:SetWide(self.columns[i]:GetWide())\n\t\t\trowPan:SetPos(self.columns[i]:GetPos())\n\t\tend\n\tend\nend\n\nvgui.Register(\"igs_table\", PANEL, \"Panel\")\n-- IGS.UI()\n","igs/interface/vgui/igs_wmat.lua":  "--[[-------------------------------------------------------------------------\n\tР—Р°РїСЂРµС‰РµРЅРѕ РёСЃРїРѕР»СЊР·РѕРІР°С‚СЊ DOCK.\n\tР Р°Р·РјРµСЂ РґРѕР»Р¶РµРЅ Р±С‹С‚СЊ СѓРєР°Р·Р°РЅ РµРґРёРЅРѕСЂР°Р·РѕРІРѕ Рё С‡РµС‚РєРѕ\n\n\t:SetURL СѓРєР°Р·С‹РІР°С‚СЊ РџРћРЎР›Р• :SetSize\n---------------------------------------------------------------------------]]\nlocal PANEL = {}\n\n\nfunction PANEL:GetTexture()\n\treturn texture.Get(self.url)\nend\n\nfunction PANEL:GetURL()\n\treturn self.url\nend\n\nfunction PANEL:RenderTexture()\n\tself.Rendering = true\n\n\t-- print(\"Render\",self:GetURL())\n\t-- print(\"Size\",self:GetSize())\n\n\ttexture.Delete(self:GetURL())\n\ttexture.Create(self:GetURL())\n\t\t:SetSize(self:GetSize())\n\t\t:SetFormat(self:GetURL():sub(-3) == \"jpg\" and \"jpg\" or \"png\")\n\t\t:Download(self:GetURL(), function()\n\t\t\tif !IsValid(self) then return end\n\n\t\t\tself.Rendering \t= false\n\t\t\tself.LastURL \t= self:GetURL()\n\t\tend, function()\n\t\t\tif !IsValid(self) then return end\n\n\t\t\tself.Rendering = false\n\t\tend)\nend\n\nfunction PANEL:Paint(w,h)\n\tif (!self:GetTexture() and !self.Rendering) or (self:GetURL() ~= self.LastURL and !self.Rendering) then\n\t\tself:RenderTexture()\n\n\telseif self:GetTexture() then\n\t\tsurface.SetDrawColor(IGS.col.ICON)\n\t\tsurface.SetMaterial( self:GetTexture() )\n\t\tsurface.DrawTexturedRect(0,0,w,h)\n\telseif self.Rendering then\n\t\t-- РџРѕРєР°Р·С‹РІР°РµРј placeholder РІРѕ РІСЂРµРјСЏ Р·Р°РіСЂСѓР·РєРё\n\t\tdraw.RoundedBox(0, 0, 0, w, h, Color(50, 50, 50, 100))\n\t\t\n\t\t-- РђРЅРёРјРёСЂРѕРІР°РЅРЅР°СЏ РёРєРѕРЅРєР° Р·Р°РіСЂСѓР·РєРё\n\t\tlocal time = CurTime() * 2\n\t\tlocal angle = time % 360\n\t\t\n\t\tlocal cx, cy = w / 2, h / 2\n\t\tlocal radius = math.min(w, h) / 4\n\t\t\n\t\tfor i = 0, 7 do\n\t\t\tlocal a = math.rad(angle + i * 45)\n\t\t\tlocal alpha = 255 - (i * 30)\n\t\t\tlocal size = radius / 3\n\t\t\t\n\t\t\tsurface.SetDrawColor(200, 200, 200, alpha)\n\t\t\tsurface.DrawRect(\n\t\t\t\tcx + math.cos(a) * radius - size / 2,\n\t\t\t\tcy + math.sin(a) * radius - size / 2,\n\t\t\t\tsize, size\n\t\t\t)\n\t\tend\n\tend\nend\n\nfunction PANEL:SetURL(sUrl)\n\tself.url = sUrl or IGS.C.DefaultIcon\nend\n\n\nvgui.Register(\"igs_wmat\",PANEL,\"Panel\")\n-- IGS.UI()\n","igs/interface/windows/deposit_funds.lua":  "local function niceSum(i, iFallback)\n\treturn math.Truncate(tonumber(i) or iFallback, 2)\nend\n\nlocal m\nfunction IGS.WIN.Deposit(iRealSum)\n\tif IsValid(m) then return end -- РЅРµ РґР°РµРј РѕС‚РєСЂС‹С‚СЊ 2 С„СЂРµР№РјР°\n\tiRealSum = tonumber(iRealSum)\n\n\tsurface.PlaySound(\"ambient/weather/rain_drip1.wav\")\n\thook.Run(\"IGS.OnDepositWinOpen\",iRealSum)\n\n\tlocal cd = !IGS.IsCurrencyEnabled() -- cd = currency disabled. Bool\n\tlocal realSum = math.max(IGS.GetMinCharge(), niceSum(iRealSum, 0))\n\n\tm = uigs.Create(\"igs_frame\", function(self)\n\t\tself:SetSize(450,400)\n\t\tself:RememberLocation(\"igs_deposit\")\n\n\t\t-- Р’С‹, РєРѕРЅРµС‡РЅРѕ, РјРѕР¶РµС‚Рµ СѓРґР°Р»РёС‚СЊ РЅР°С€ РєРѕРїРёСЂР°Р№С‚. Р§С‚РѕР±С‹ РІС‹ РЅРµ РїРµСЂРµРЅР°РїСЂСЏРіР»РёСЃСЊ, СЏ РґР°Р¶Рµ РїРѕРґРіРѕС‚РѕРІРёР» С‡СѓС‚СЊ РЅРёР¶Рµ СЃС‚СЂРѕС‡РєСѓ РґР»СЏ СЌС‚РѕРіРѕ\n\t\t-- РќРѕ РїСЂРµР¶РґРµ, С‡РµРј С‚С‹ СЌС‚Рѕ СЃРґРµР»Р°РµС€СЊ, РѕС‚РІРµС‚СЊ СЃРµР±Рµ РЅР° РІРѕРїСЂРѕСЃ. РќР°С…СѓСЏ? РўР°Рє РјРµС€Р°РµС‚?\n\t\tself:SetTitle(\"РђРІС‚РѕРґРѕРЅР°С‚\")\n\t\t-- self:SetTitle(\"Р’Р»Р°РґРµР»РµС† СЌС‚РѕРіРѕ СЃРµСЂРІРµСЂР° РјСЂР°Р·СЊ, РЅРµ С†РµРЅСЏС‰Р°СЏ С‡СѓР¶РѕР№ С‚СЂСѓРґ\")\n\n\t\tself:MakePopup()\n\t\t-- self:Focus()\n\t\t-- self:SetBackgroundBlur(false)\n\n\t\t--[[-------------------------------------\n\t\t\tР›РµРІР°СЏ РєРѕР»РѕРЅРєР°. Р РµР°Р»СЊРЅР°СЏ РІР°Р»СЋС‚Р°\n\t\t---------------------------------------]]\n\t\tuigs.Create(\"DLabel\", function(real)\n\t\t\treal:SetSize(cd and 450 or 180,25)\n\t\t\treal:SetPos(cd and 0 or 10,self:GetTitleHeight())\n\t\t\treal:SetText(cd and \"Р’РІРµРґРёС‚Рµ РЅРёР¶Рµ СЃСѓРјРјСѓ РїРѕРїРѕР»РЅРµРЅРёСЏ СЃС‡РµС‚Р°\" or \"Р СѓР±Р»Рё\")\n\t\t\treal:SetFont(\"Fated.22\")\n\t\t\treal:SetTextColor(IGS.col.HIGHLIGHTING)\n\t\t\treal:SetContentAlignment(2)\n\t\tend, self)\n\n\t\tself.real_m = uigs.Create(\"DTextEntry\", self)\n\t\tself.real_m:SetPos(10,50)\n\t\tself.real_m:SetSize(cd and 450 - 10 - 10 or 180,30)\n\t\tself.real_m:SetNumeric(true)\n\t\tself.real_m.OnChange = function(s)\n\t\t\tif cd then return end\n\t\t\tself.curr_m:SetValue(IGS.PriceInCurrency( niceSum(s:GetValue(),0) )) -- Р±Р»СЏ\n\t\tend\n\t\tself.real_m.Think = function()\n\t\t\tlocal rub = tonumber(self.real_m:GetValue())\n\t\t\tif cd then\n\t\t\t\tself.purchase:SetText(\n\t\t\t\t\t\"РџРѕРїРѕР»РЅРёС‚СЊ СЃС‡РµС‚ РЅР° \" .. niceSum(rub,0) .. \" СЂСѓР±\"\n\t\t\t\t)\n\t\t\telse\n\t\t\t\tlocal igs = tonumber(self.curr_m:GetValue())\n\t\t\t\tself.purchase:SetText(\n\t\t\t\t\t\"РџРѕРїРѕР»РЅРёС‚СЊ РЅР° \" .. IGS.SignPrice( niceSum(igs,0) ) ..\n\t\t\t\t\t\" Р·Р° \" .. niceSum(rub,0) .. \" СЂСѓР±\"\n\t\t\t\t)\n\t\t\tend\n\n\t\t\tself.purchase:SetActive(rub and rub \u003e 0)\n\t\tend\n\n\t\t--[[-------------------------------------\n\t\t\tРЎРµСЂРµРґРёРЅР°. Р—РЅР°Рє СЂР°РІРЅРѕСЃС‚Рё Рё РєРЅРѕРїРєР° РїРѕРєСѓРїРєРё\n\t\t---------------------------------------]]\n\t\tif !cd then\n\t\t\tuigs.Create(\"DLabel\", function(eq)\n\t\t\t\teq:SetSize(50,30)\n\t\t\t\teq:SetPos(200,50)\n\t\t\t\teq:SetText(\"=\")\n\t\t\t\teq:SetFont(\"Fated.40\")\n\t\t\t\teq:SetTextColor(IGS.col.TEXT_HARD)\n\t\t\t\teq:SetContentAlignment(5)\n\t\t\tend,self)\n\t\tend\n\n\t\tself.purchase = uigs.Create(\"igs_button\", function(p)\n\t\t\tlocal _,ry = self.real_m:GetPos()\n\n\t\t\tp:SetSize(400,40)\n\t\t\tp:SetActive(true) -- РІС‹РґРµР»СЏРµС‚ СЃРёРЅРёРј\n\t\t\tp:SetPos((self:GetWide() - p:GetWide()) / 2,ry + self.real_m:GetTall() + 10)\n\n\t\t\tp.DoClick = function()\n\t\t\t\tlocal want_money = niceSum(self.real_m:GetValue())\n\t\t\t\tif !want_money then\n\t\t\t\t\tself.log:AddRecord(\"РЈРєР°Р·Р°РЅР° РЅРµРєРѕСЂСЂРµРєС‚РЅР°СЏ СЃСѓРјРјР° РїРѕРїРѕР»РЅРµРЅРёСЏ\", false)\n\t\t\t\t\treturn\n\n\t\t\t\telseif want_money \u003c realSum then\n\t\t\t\t\tself.log:AddRecord(\"РњРёРЅРёРјР°Р»СЊРЅР°СЏ СЃСѓРјРјР° РїРѕРїРѕР»РЅРµРЅРёСЏ \" .. PL_MONEY(realSum), false)\n\t\t\t\t\treturn\n\t\t\t\tend\n\n\t\t\t\tself.log:AddRecord(\"Р—Р°РїСЂРѕСЃ СЃСЃС‹Р»РєРё РЅР° РѕРїР»Р°С‚Сѓ...\")\n\n\t\t\t\tIGS.GetPaymentURL(want_money,function(url)\n\t\t\t\t\tIGS.OpenURL(url,\"РџСЂРѕС†РµРґСѓСЂР° РїРѕРїРѕР»РЅРµРЅРёСЏ СЃС‡РµС‚Р°\")\n\t\t\t\t\tif !IsValid(self) then return end\n\t\t\t\t\tself.log:AddRecord(\"РЎСЃС‹Р»РєР° РїРѕР»СѓС‡РµРЅР°. РќР°С‡РёРЅР°РµРј РїСЂРѕС†РµСЃСЃ РѕРїР»Р°С‚С‹\")\n\n\t\t\t\t\ttimer.Simple(.7,function()\n\t\t\t\t\t\tself.log:AddRecord(\"РЎС‡РµС‚ РїРѕРїРѕР»РЅРёС‚СЃСЏ РјРѕРјРµРЅС‚Р°Р»СЊРЅРѕ РёР»Рё РїРѕСЃР»Рµ РїРµСЂРµР·Р°С…РѕРґР°\")\n\t\t\t\t\tend)\n\t\t\t\tend)\n\t\t\tend\n\t\tend, self)\n\n\t\t--[[-------------------------------------\n\t\t\tРџСЂР°РІР°СЏ РєРѕР»РѕРЅРєР°. Р”РѕРЅР°С‚ РІР°Р»СЋС‚Р°\n\t\t---------------------------------------]]\n\t\tif !cd then\n\t\t\tuigs.Create(\"DLabel\", function(curr)\n\t\t\t\tcurr:SetSize(180,25)\n\t\t\t\tcurr:SetPos(self:GetWide() - 10 - curr:GetWide(),self:GetTitleHeight())\n\t\t\t\tcurr:SetText(IGS.C.CURRENCY_NAME)\n\t\t\t\tcurr:SetFont(\"Fated.22\")\n\t\t\t\tcurr:SetTextColor(IGS.col.HIGHLIGHTING)\n\t\t\t\tcurr:SetContentAlignment(2)\n\t\t\tend, self)\n\n\t\t\tself.curr_m = uigs.Create(\"DTextEntry\", self)\n\t\t\tself.curr_m:SetPos(self:GetWide() - 10 - self.real_m:GetWide(),50)\n\t\t\tself.curr_m:SetSize(self.real_m:GetWide(),self.real_m:GetTall())\n\t\t\tself.curr_m:SetNumeric(true)\n\t\t\tself.curr_m.OnChange = function(s)\n\t\t\t\tself.real_m:SetValue(IGS.RealPrice( niceSum(s:GetValue(),0) )) -- С‚РѕР¶Рµ Р±Р»СЏ\n\t\t\tend\n\t\tend\n\n\t\t--[[-------------------------------------------------------------------------\n\t\t\tР”РѕР»Р¶РЅРѕ Р±С‹С‚СЊ РїРѕСЃР»Рµ self.curr_m\n\t\t---------------------------------------------------------------------------]]\n\t\tself.real_m:SetValue( realSum )\n\t\tself.real_m:OnChange()\n\n\n\t\t--[[-------------------------------------------------------------------------\n\t\t\tР’СЃРµ РїРѕРґСЂСЏРґ\n\t\t---------------------------------------------------------------------------]]\n\t\tself.log = uigs.Create(\"igs_scroll\", function(log)\n\t\t\tlog:SetSize(250,200)\n\t\t\tlog:SetPos(10,self:GetTall() - log:GetTall() - 10)\n\t\t\t-- https://img.qweqwe.ovh/1487171563683.png\n\t\t\tfunction log:AddRecord(text,pay)\n\t\t\t\tlocal col =\n\t\t\t\t\t(pay == true  and IGS.col.LOG_SUCCESS) or\n\t\t\t\t\t(pay == false and IGS.col.LOG_ERROR)   or IGS.col.LOG_NORMAL\n\n\t\t\t\t-- РџР»Р°С‚РµР¶ РёР»Рё РћС€РёР±РєР°\n\t\t\t\tif pay or pay == false then\n\t\t\t\t\tself:GetParent():RequestFocus()\n\t\t\t\t\tself:GetParent():MakePopup()\n\t\t\t\tend\n\n\t\t\t\treturn log:AddItem( uigs.Create(\"Panel\", function(bg)\n\t\t\t\t\ttext = \"\u003e \" .. os.date(\"%H:%M:%S\",os.time()) .. \"\\n\" .. text\n\n\t\t\t\t\tlocal y = 2\n\t\t\t\t\tfor i,line in ipairs(string.Wrap(\"Fated.18\",text,log:GetWide() - 0 - 0)) do\n\t\t\t\t\t\tuigs.Create(\"DLabel\", function(l)\n\t\t\t\t\t\t\tl:SetPos(0,y)\n\t\t\t\t\t\t\tl:SetText(line)\n\t\t\t\t\t\t\tl:SetFont(\"Fated.18\")\n\t\t\t\t\t\t\tl:SizeToContents()\n\t\t\t\t\t\t\tl:SetTextColor(i == 1 and IGS.col.HIGHLIGHTING or col)\n\t\t\t\t\t\t\t--               /\\ РїРµСЂРІРѕР№ СЃС‚СЂРѕРєРѕР№ РёРґРµС‚ РґР°С‚Р° (\\n)\n\n\t\t\t\t\t\t\ty = y + l:GetTall()\n\t\t\t\t\t\tend, bg)\n\t\t\t\t\tend\n\n\t\t\t\t\tbg:SetTall(y + 2)\n\t\t\t\t\tlog:ScrollTo(log:GetCanvas():GetTall())\n\t\t\t\tend, log) )\n\t\t\tend\n\t\tend, self)\n\n\t\tlocal log_t = uigs.Create(\"DLabel\", function(log_title)\n\t\t\tlocal log_x,log_y = self.log:GetPos()\n\n\t\t\tlog_title:SetSize(self.log:GetWide(),22)\n\t\t\tlog_title:SetPos(log_x,log_y - log_title:GetTall())\n\t\t\tlog_title:SetText(\"Р›РѕРі РѕРїРµСЂР°С†РёР№\")\n\t\t\tlog_title:SetTextColor(IGS.col.HIGHLIGHTING)\n\t\t\tlog_title:SetFont(\"Fated.22\")\n\t\t\tlog_title:SetContentAlignment(1)\n\t\tend, self)\n\n\t\t-- Р›РёРЅРёСЏ РЅР°Рґ Р»РѕРіРѕРј\n\t\tlocal _,log_t_y = log_t:GetPos()\n\t\tuigs.Create(\"DPanel\", function(line)\n\t\t\tline:SetPos(10, log_t_y - 2 - 10)\n\t\t\tline:SetSize(self:GetWide() - line:GetPos() * 2, 2)\n\t\t\tline.Paint = function(s, w, h)\n\t\t\t\tdraw.RoundedBox(0,0,0,w,h,IGS.col.SOFT_LINE)\n\t\t\tend\n\t\tend, self)\n\n\t\t-- РљРЅРѕРїРєР° \"РђРєС‚РёРІРёСЂРѕРІР°С‚СЊ РєСѓРїРѕРЅ\" РїРµСЂРµРЅРµСЃРµРЅР° РІ С€Р°РїРєСѓ РіР»Р°РІРЅРѕРіРѕ РјРµРЅСЋ\n\n\n\t\t-- uigs.Create(\"DLabel\", function(btns_title)\n\t\t-- \tlocal coup_x,coup_y = coupon:GetPos()\n\n\t\t-- \tbtns_title:SetSize(coupon:GetWide(),30)\n\t\t-- \tbtns_title:SetPos(coup_x,coup_y + coupon:GetTall() + 0)\n\t\t-- \tbtns_title:SetText(\"Р’СЃРµ Р°РІС‚РѕРјР°С‚РёР·РёСЂРѕРІР°РЅРѕ\")\n\t\t-- \tbtns_title:SetTextColor(IGS.col.TEXT_HARD)\n\t\t-- \tbtns_title:SetFont(\"Fated.18\")\n\t\t-- \t-- btns_title:SetContentAlignment(3)\n\t\t-- end, self)\n\n\t\tlocal function log(delay,text,status)\n\t\t\ttimer.Simple(delay,function()\n\t\t\t\tif !IsValid(self.log) then return end\n\t\t\t\tself.log:AddRecord(text, status)\n\t\t\tend)\n\t\tend\n\n\t\tlog(0,\"РћС‚РєСЂС‹С‚ РґРёР°Р»РѕРі РїРѕРїРѕР»РЅРµРЅРёСЏ СЃС‡РµС‚Р°\",nil)\n\t\tlog(math.random(3),\"РЎРѕРµРґРёРЅРµРЅРёРµ СѓСЃС‚Р°РЅРѕРІР»РµРЅРѕ!\",true) -- РїСѓСЃС‚С‹С€РєР°, РєРѕС‚РѕСЂР°СЏ РґРѕР±Р°РІР»СЏРµС‚ С‡СѓРІСЃС‚РІРѕ Р±РµР·РѕРїР°СЃРЅРѕСЃС‚С‚Рё СЃРґРµР»РєРµ\n\t\tlog(math.random(20,40),\"Р”РµРЅСЊРіРё Р±СѓРґСѓС‚ Р·Р°С‡РёСЃР»РµРЅС‹ РјРіРЅРѕРІРµРЅРЅРѕ Рё Р°РІС‚РѕРјР°С‚РёС‡РµСЃРєРё\",nil)\n\tend)\n\n\treturn m\nend\n\n\nhook.Add(\"IGS.PaymentStatusUpdated\",\"UpdatePaymentStatus\",function(dat)\n\tlocal extra_inf = IGS.IsCurrencyEnabled() and (\" (\" .. PL_MONEY( IGS.RealPrice(dat.orderSum) ) .. \")\") or \"\"\n\n\tlocal text =\n\t\tdat.method == \"check\" and (\"РџСЂРѕРІРµСЂРєР° РІРѕР·РјРѕР¶РЅРѕСЃС‚Рё РїР»Р°С‚РµР¶Р° С‡РµСЂРµР· \" .. dat.paymentType) or\n\t\tdat.method == \"pay\"   and (\"РќР°С‡РёСЃР»РµРЅРѕ \" .. PL_IGS(dat.orderSum) ..  extra_inf) or\n\t\tdat.method == \"error\" and (\"РћС€РёР±РєР° РїРѕРїРѕР»РЅРµРЅРёСЏ СЃС‡РµС‚Р°: \" .. dat.errorMessage) or\n\t\t\"РЎ СЃРµСЂРІРµСЂР° РїСЂРёС€РµР» РЅРµРёР·РІРµСЃС‚РЅС‹Р№ РјРµС‚РѕРґ \" .. tostring(dat.method) .. \" Рё РІРѕР·РЅРёРєР»Р° РѕС€РёР±РєР°\"\n\n\tif !IsValid(m) then\n\t\tIGS.ShowNotify(text,\"РћР±РЅРѕРІР»РµРЅРёРµ СЃС‚Р°С‚СѓСЃР° РїР»Р°С‚РµР¶Р°\")\n\t\treturn\n\tend\n\n\tlocal pay = nil\n\tif dat.method == \"pay\" then\n\t\tpay = true\n\telseif dat.method == \"error\" then\n\t\tpay = false\n\tend\n\n\tm.log:AddRecord(text,pay)\nend)\n\n\n\n-- if IsValid(IGS_CHARGE) then\n-- \tIGS_CHARGE:Remove()\n-- end\n\n-- IGS_CHARGE = IGS.WIN.Deposit()\n-- local p = IGS_CHARGE\n-- -- timer.Simple(1,function()\n-- -- \tp.log:AddRecord(\"Kek lol heh mda\", false)\n-- -- end)\n\n-- timer.Simple(600,function()\n-- \tif IsValid(p) then\n-- \t\tp:Remove()\n-- \t\tp = nil\n-- \tend\n-- end)\n","igs/interface/windows/group_content.lua":  "local function getSpacePanel()\n\treturn uigs.Create(\"Panel\", function(self)\n\t\tself:Dock(TOP)\n\t\tself:SetTall(3)\n\tend)\nend\n\nfunction IGS.WIN.Group(sGroupUID)\n\tlocal GROUP = IGS.GetGroup(sGroupUID)\n\tassert(GROUP, \"Incorrect group: \" .. tostring(sGroupUID))\n\n\tsurface.PlaySound(\"ambient/weather/rain_drip1.wav\")\n\n\treturn uigs.Create(\"igs_frame\", function(bg)\n\t\tbg:SetTitle(GROUP:Name())\n\t\tbg:MakePopup()\n\n\t\tlocal cellW,cellH -- РЅРµ РёР·РјРµРЅСЏРµС‚СЃСЏ РІ Р·Р°РІРёСЃРёРјРѕСЃС‚Рё РѕС‚ РєРѕРЅС‚РµРЅС‚Р°\n\t\tfunction bg:AddIGSItem(ITEM, nameInGroup)\n\t\t\tlocal it = uigs.Create(\"igs_item\"):SetItem(ITEM)\n\t\t\tit:SetName(nameInGroup or ITEM:Name())\n\n\t\t\tif !cellW then\n\t\t\t\tcellW,cellH = it:GetSize()\n\t\t\tend\n\n\t\t\tit:SetSize(cellW * 1.3, cellH)\n\t\t\tit.DoClick = function()\n\t\t\t\t-- bg:Close()\n\t\t\t\tIGS.WIN.Item(ITEM:UID())\n\t\t\tend\n\n\t\t\tbg.scroll:AddItem(it)\n\t\tend\n\n\t\tbg.scroll = uigs.Create(\"igs_scroll\", bg)\n\t\tbg.scroll:Dock(FILL)\n\t\tbg.scroll:SetPadding(6)\n\n\n\t\tbg.scroll:AddItem( getSpacePanel() ) -- РёР·-Р·Р° РїР°РґРґРёРЅРіР° #1\n\t\tfor _,v in pairs(GROUP:Items()) do\n\t\t\tlocal ITEM = v.item\n\t\t\tif !v.item:IsHidden() then -- РµС‰Рµ РІ main_cl\n\t\t\t\tbg:AddIGSItem(ITEM, v.name)\n\t\t\tend\n\t\tend\n\t\tbg.scroll:AddItem( getSpacePanel() ) -- РёР·-Р·Р° РїР°РґРґРёРЅРіР° #2\n\n\t\t-- or: https://t.me/c/1353676159/21116\n\t\tbg:SetSize((cellW or 220) * 1.3, 300)\n\t\tbg:RememberLocation(\"igs_group\")\n\tend)\nend\n-- IGS.UI()\n","igs/interface/windows/item_info.lua":  "local m\n\nlocal function purchase(ITEM, buy_button)\n\tIGS.Purchase(ITEM:UID(), function(errMsg,dbID)\n\t\tif !IsValid(buy_button) then return end\n\n\t\tif errMsg then\n\t\t\tIGS.ShowNotify(errMsg, \"РћС€РёР±РєР° РїРѕРєСѓРїРєРё\")\n\t\t\tsurface.PlaySound(\"ambient/voices/citizen_beaten1.wav\") -- РµС‰Рµ РµСЃС‚СЊ\n\t\t\treturn\n\t\tend\n\n\t\tbuy_button.purchased = buy_button.purchased or 0\n\t\tbuy_button.purchased = buy_button.purchased + 1\n\n\n\t\tif ITEM:IsStackable() then\n\t\t\tbuy_button:SetText(\"РљСѓРїР»РµРЅРѕ \" .. buy_button.purchased .. \" С€С‚\")\n\t\telse\n\t\t\tif IsValid(m) then\n\t\t\t\tm:Close()\n\t\t\tend\n\n\t\t\tif !IGS.C.Inv_Enabled then\n\t\t\t\tIGS.ShowNotify(\"РЎРїР°СЃРёР±Рѕ Р·Р° РїРѕРєСѓРїРєСѓ. Р­С‚Рѕ Р±С‹Р»Рѕ РїСЂРѕСЃС‚Рѕ, РїСЂР°РІРґР°? :)\", \"РЈСЃРїРµС€РЅР°СЏ РїРѕРєСѓРїРєР°\")\n\t\t\t\treturn\n\t\t\tend\n\n\t\t\tIGS.BoolRequest(\"РЈСЃРїРµС€РЅР°СЏ РїРѕРєСѓРїРєР°\",\n\t\t\t\t\"РЎРїР°СЃРёР±Рѕ Р·Р° РїРѕРєСѓРїРєСѓ. РћРЅР° РЅР°С…РѕРґРёС‚СЃСЏ РІ РІР°С€РµРј /donate РёРЅРІРµРЅС‚Р°СЂРµ.\\n\\nРђРєС‚РёРІРёСЂРѕРІР°С‚СЊ РµРµ СЃРµР№С‡Р°СЃ?\",\n\t\t\tfunction(yes)\n\t\t\t\tif !yes then return end\n\n\t\t\t\tIGS.ProcessActivate(dbID)\n\t\t\tend)\n\t\tend\n\n\t\tsurface.PlaySound(\"ambient/office/coinslot1.wav\")\n\tend)\nend\n\n\n\n\n\n\nlocal function move(f, x, sp, cb)\n\tlocal _,y = f:GetPos()\n\tf:MoveTo(x,y, sp,nil,nil,cb)\nend\n\nlocal function shakeFrame(f, amplitude, speed, cb)\n\tif !IsValid(f) then return end\n\n\tlocal x = f:GetPos()\n\tmove(f, x + amplitude, speed, function()\n\t\tmove(f, x - amplitude, speed, function()\n\t\t\tmove(f, x, speed, cb)\n\t\tend)\n\tend)\nend\n\nfunction IGS.WIN.Item(uid)\n\tlocal ITEM = IGS.GetItemByUID(uid)\n\tif IsValid(m) then\n\t\tif m.item_uid == uid then -- РїРѕРїС‹С‚РєР° РїРѕРІС‚РѕСЂРЅРѕРіРѕ РѕС‚РєСЂС‹С‚РёСЏ С‚РѕРіРѕ Р¶Рµ С„СЂРµР№РјР°\n\n\t\t\tm:MoveToFront()\n\t\t\tshakeFrame(m, 20, .1)\n\n\t\t\treturn\n\t\tend\n\n\t\t-- РћС‚РєСЂС‹С‚РёСЏ РґСЂСѓРіРѕРіРѕ\n\t\tm:Close()\n\t\tm = nil\n\tend\n\n\tsurface.PlaySound(\"ambient/weather/rain_drip1.wav\")\n\n\tm = uigs.Create(\"igs_frame\", function(self)\n\t\tself:SetSize(330,550)\n\t\tself:RememberLocation(\"igs_item\")\n\t\tself:MakePopup()\n\t\tself:SetTitle(ITEM:Name())\n\n\t\tself.item_uid  = uid -- РґР»СЏ РїСЂРµРґРѕС‚РІСЂР°С‰РµРЅРёСЏ РїРѕРІС‚РѕСЂРЅРѕРіРѕ РѕС‚РєСЂС‹С‚РёСЏ РґРІСѓС… РѕРґРёРЅР°РєРѕРІС‹С… С„СЂРµР№РјРѕРІ\n\tend)\n\n\n\tuigs.Create(\"igs_iteminfo\", function(p)\n\n\t\t--[[-------------------------------------------------------------------------\n\t\t\tРћС‡РµРЅСЊ РЅРµ РєСЂР°СЃРёРІС‹Р№, РЅРѕ РѕС‡РµРЅСЊ РїРѕР»РµР·РЅС‹Р№ РєРѕРґ\n\t\t\tР—Р°СЃС‚Р°РІР»СЏРµС‚ РїРѕР»Р·СѓРЅРѕРє РїРѕРјРёРіР°С‚СЊ РґР»СЏ Р·Р°РјРµС‚РЅРѕСЃС‚Рё\n\t\t---------------------------------------------------------------------------]]\n\t\tlocal viewed = tonumber( bib.get(\"igs:items_viewed\",0) )\n\t\tbib.set(\"igs:items_viewed\",viewed + 1)\n\n\t\t-- Р•СЃР»Рё РјРёРіР°Р»Рё 3+ СЂР°Р·Р°, С‚Рѕ Р±РѕР»СЊС€Рµ РЅРµ РЅР°РґРѕ\n\t\tif viewed \u003c 3 then\n\t\t\tlocal oldThink = p.scroll.scrollBar.Think\n\t\t\ttimer.Simple(.5,function() -- 0.5 = РІСЂРµРјСЏ, РєРѕС‚РѕСЂРѕРµ СЃРєСЂРѕР»Р» Р±СѓРґРµС‚ РјРёРіР°С‚СЊ\n\t\t\t\tif !IsValid(p) then return end\n\n\t\t\t\tp.scroll.scrollBar.Think = oldThink\n\t\t\tend)\n\n\t\t\tp.scroll.scrollBar.Think = function() --              \\/ СЃРєРѕСЂРѕСЃС‚СЊ РјРёРіР°РЅРёСЏ\n\t\t\t\tp.scroll.scrollBar.addWidth = (math.sin( CurTime() * 20 ) + 1) / 2 * 8 -- 8 Р»РёРјРёС‚ С€РёСЂРёРЅС‹ СЃРєСЂРѕР»Р»Р°\n\t\t\t\tp.scroll.scrollBar:InvalidateLayout()\n\t\t\tend\n\t\tend\n\t\t-----------------------------------------------------------------------------\n\n\n\n\t\tp:Dock(FILL)\n\t\tp:SetIcon(ITEM:ICON())\n\t\tp:SetName(\"Р”РµР№СЃС‚РІСѓРµС‚ \" .. IGS.TermToStr(ITEM:Term()))\n\t\tp:SetImage(ITEM:IMG())\n\t\tp:SetSubNameButton(ITEM:Group() and ITEM:Group():Name(), function()\n\t\t\tIGS.WIN.Group(ITEM:Group():UID())\n\t\tend)\n\t\tp:SetDescription( ITEM:Description() )\n\t\tp:SetInfo(IGS.FormItemInfo(ITEM))\n\n\t\tm.act = p:CreateActivity() -- РїР°РЅРµР»СЊРєР° РґР»СЏ РєР°СЃС‚РѕРј СЌР»Р»РµРјРµРЅС‚РѕРІ\n\t\tm.buy = uigs.Create(\"igs_button\", function(buy)\n\t\t\t-- РСЃРїРѕР»СЊР·СѓРµРј С„РёРЅР°Р»СЊРЅСѓСЋ С†РµРЅСѓ СЃ СѓС‡РµС‚РѕРј СЃРєРёРґРѕРє\n\t\t\tlocal cur_price = ITEM:GetFinalPriceInCurrency()\n\n\t\t\tbuy:Dock(TOP)\n\t\t\tbuy:SetTall(20)\n\t\t\tbuy:SetText( \"РљСѓРїРёС‚СЊ Р·Р° \" .. PL_IGS(cur_price) )\n\t\t\tbuy:SetActive( IGS.CanAfford(LocalPlayer(), cur_price) )\n\t\t\tbuy.DoClick = function(s)\n\t\t\t\tif !s:IsActive() then\n\t\t\t\t\tlocal need = cur_price - LocalPlayer():IGSFunds()\n\n\t\t\t\t\tsurface.PlaySound(\"ambient/voices/citizen_beaten1.wav\") -- РµС‰Рµ РµСЃС‚СЊ\n\t\t\t\t\tIGS.BoolRequest(\n\t\t\t\t\t\t\"РќРµРґРѕСЃС‚Р°С‚РѕС‡РЅРѕ РґРµРЅРµРі\",\n\t\t\t\t\t\t(\"Р’Р°Рј РЅРµ С…РІР°С‚Р°РµС‚ %s РґР»СЏ РїРѕРєСѓРїРєРё %s.\\nР–РµР»Р°РµС‚Рµ РјРіРЅРѕРІРµРЅРЅРѕ РїРѕРїРѕР»РЅРёС‚СЊ СЃС‡РµС‚?\"):format( PL_IGS(need), ITEM:Name()),\n\t\t\t\t\t\tfunction(yes)\n\t\t\t\t\t\t\tif yes then\n\t\t\t\t\t\t\t\tIGS.WIN.Deposit(IGS.RealPrice(need), true)\n\t\t\t\t\t\t\t\tsurface.PlaySound(\"vo/npc/male01/yeah02.wav\")\n\t\t\t\t\t\t\tend\n\t\t\t\t\t\tend\n\t\t\t\t\t):ShowCloseButton(true)\n\n\t\t\t\t\treturn\n\t\t\t\tend\n\n\t\t\t\tpurchase(ITEM, s)\n\t\t\tend\n\t\tend, m.act)\n\tend, m)\n\n\thook.Run(\"IGS.OnItemInfoOpen\", ITEM, m)\nend\n-- IGS.WIN.Item(\"permission_model_30d\")\n","igs/interface/windows/modals.lua":  "function IGS.BoolRequest(title, text, cback)\n\tlocal m = uigs.Create(\"igs_frame\", function(self)\n\t\tself:SetTitle(title)\n\t\tself:ShowCloseButton(false)\n\t\tself:SetWide(ScrW() * .2)\n\t\tself:MakePopup()\n\tend)\n\nlocal txt = string.Wrap(\"Fated.18\", text, m:GetWide() - 10)\n\tlocal y = m:GetTitleHeight() + 5\n\n\tfor _,line in ipairs(txt) do\n\t\tuigs.Create(\"DLabel\", function(self, p)\n\t\t\tself:SetText(line)\n\t\t\tself:SetFont(\"Fated.18\")\n\t\t\tself:SetTextColor(IGS.col.TEXT_HARD)\n\t\t\tself:SizeToContents()\n\t\t\tself:SetPos((p:GetWide() - self:GetWide()) / 2, y)\n\t\t\ty = y + self:GetTall() + 2\n\t\tend, m)\n\tend\n\n\ty = y + 5\n\tm.btnOK = uigs.Create(\"igs_button\", function(self, p)\n\t\tself:SetText(\"Р”Р°\")\n\t\tself:SetPos(5, y)\n\t\tself:SetSize(p:GetWide() / 2 - 7.5, 25)\n\t\tself.DoClick = function()\n\t\t\tp:Close()\n\t\t\tcback(true)\n\t\tend\n\tend, m)\n\n\tm.btnCan = uigs.Create(\"igs_button\", function(self, p)\n\t\tself:SetText(\"РќРµС‚\")\n\t\tself:SetPos(p.btnOK:GetWide() + 10, y)\n\t\tself:SetSize(p.btnOK:GetWide(), 25)\n\t\tself:RequestFocus()\n\t\tself.DoClick = function()\n\t\t\tp:Close()\n\t\t\tcback(false)\n\t\tend\n\t\ty = y + self:GetTall() + 5\n\tend, m)\n\n\tm:SetTall(y)\n\tm:Center()\n\n\tm:Focus()\n\treturn m\nend\n\nfunction IGS.StringRequest(title, text, default, cback)\n\tlocal m = uigs.Create(\"igs_frame\", function(self)\n\t\tself:SetTitle(title)\n\t\tself:ShowCloseButton(false)\n\t\tself:SetWide(ScrW() * .3)\n\t\tself:MakePopup()\n\tend)\n\nlocal txt = string.Wrap(\"Fated.18\", text, m:GetWide() - 10)\n\tlocal y = m:GetTitleHeight() + 5\n\n\tfor _, v in ipairs(txt) do\n\t\tuigs.Create(\"DLabel\", function(self, p)\n\t\t\tself:SetText(v)\n\t\t\tself:SetFont(\"Fated.18\")\n\t\t\tself:SetTextColor(IGS.col.TEXT_HARD)\n\t\t\tself:SizeToContents()\n\t\t\tself:SetPos((p:GetWide() - self:GetWide()) / 2, y)\n\t\t\ty = y + self:GetTall()\n\t\tend, m)\n\tend\n\n\ty = y + 5\n\tlocal tb = uigs.Create(\"DTextEntry\", function(self, p)\n\t\tself:SetPos(5, y + 5)\n\t\tself:SetSize(p:GetWide() - 10, 25)\n\t\tself:SetValue(default or \u0027\u0027)\n\t\ty = y + self:GetTall() + 10\n\t\tself.OnEnter = function()\n\t\t\tp:Close()\n\t\t\tcback(self:GetValue())\n\t\tend\n\tend, m)\n\n\tlocal btnOK = uigs.Create(\"igs_button\", function(self, p)\n\t\tself:SetText(\"РћРљ\")\n\t\tself:SetPos(5, y)\n\t\tself:SetSize(p:GetWide() / 2 - 7.5, 25)\n\t\tself:SetActive(true)\n\t\tself.DoClick = function()\n\t\t\tp:Close()\n\t\t\tcback(tb:GetValue())\n\t\tend\n\tend, m)\n\n\tuigs.Create(\"igs_button\", function(self)\n\t\tself:SetText(\"РћС‚РјРµРЅР°\")\n\t\tself:SetPos(btnOK:GetWide() + 10, y)\n\t\tself:SetSize(btnOK:GetWide(), 25)\n\t\tself:RequestFocus()\n\t\tself.DoClick = function()\n\t\t\tm:Close()\n\t\tend\n\t\ty = y + self:GetTall() + 5\n\tend, m)\n\n\tm:SetTall(y)\n\tm:Center()\n\n\tm:Focus()\n\treturn m\nend\n\n\nlocal null = function() end\nfunction IGS.ShowNotify(sText, sTitle, fOnClose)\n\tlocal m = IGS.BoolRequest(sTitle or \"[IGS] РћРїРѕРІРµС‰РµРЅРёРµ\", sText, fOnClose or null)\n\tm.btnCan:Remove() -- РѕСЃС‚Р°РІР»СЏРµРј С‚РѕР»СЊРєРѕ 1 РєРЅРѕРїРєСѓ\n\n\tlocal _,y = m.btnOK:GetPos()\n\tm.btnOK:SetText(\"РћРљ\")\n\tm.btnOK:SetPos((m:GetWide() - m.btnOK:GetWide()) / 2, y)\n\n\treturn m\nend\n\nfunction IGS.WIN.ActivateCoupon()\n\tIGS.StringRequest(\"РђРєС‚РёРІР°С†РёСЏ РєСѓРїРѕРЅР°\",\n\t\t\"Р•СЃР»Рё Сѓ РІР°СЃ РµСЃС‚СЊ РґРѕРЅР°С‚ РєСѓРїРѕРЅ, С‚Рѕ РІРІРµРґРёС‚Рµ РµРіРѕ РЅРёР¶Рµ\",\n\tnil,function(val)\n\t\tIGS.UseCoupon(val,function(errMsg)\n\t\t\tif errMsg then\n\t\t\t\tIGS.ShowNotify(errMsg, \"РћС€РёР±РєР° Р°РєС‚РёРІР°С†РёРё РєСѓРїРѕРЅР°\")\n\t\t\telse\n\t\t\t\tIGS.ShowNotify(\"Р”РµРЅСЊРіРё РЅР°С‡РёСЃР»РµРЅС‹ РЅР° РІР°С€ СЃС‡РµС‚. РњРѕР¶РµС‚Рµ РїРѕСЃРјРѕС‚СЂРµС‚СЊ РЅР° СЌС‚Рѕ РІ С‚СЂР°РЅР·Р°РєС†РёСЏС…, РїРµСЂРµРѕС‚РєСЂС‹РІ РґРѕРЅР°С‚ РјРµРЅСЋ\", \"РЈСЃРїРµС€РЅР°СЏ Р°РєС‚РёРІР°С†РёРё РєСѓРїРѕРЅР°\")\n\t\t\tend\n\t\tend)\n\tend)\nend\n\n\n-- IGS.ShowNotify((\"test \"):rep(10), nil, function()\n-- \tprint(\"РќРѕС‚РёС„РёРєР°С€РєР° Р·Р°РєСЂС‹Р»Р°СЃСЊ\")\n-- end)\n\nIGS.OpenURL = gui.OpenURL\n\n-- IGS.UI()\n","igs/launcher.lua":  "IGS.C = IGS.C or {} -- config\n\nlocal function sh(path) return IGS.sh(\"igs/\" .. path) end\nlocal function sv(path) return IGS.sv(\"igs/\" .. path) end\nlocal function cl(path) return IGS.cl(\"igs/\" .. path) end\n\nlocal function dir(path, fIncluder) return IGS.include_files(\"igs/\" .. path, fIncluder) end\nlocal function mods(path) return IGS.load_modules(\"igs/\" .. path) end\n\n\nsh(\"dependencies/plurals.lua\")\nsh(\"dependencies/chatprint.lua\")\nsv(\"dependencies/stack.lua\")\nsh(\"dependencies/scc.lua\")\nsv(\"dependencies/resources.lua\") -- РёРєРѕРЅРєРё, РјРѕРґРµР»СЊРєР° РґСЂРѕРїРЅСѓС‚РѕРіРѕ РёС‚РµРјР°\nsh(\"dependencies/bib.lua\")\nsh(\"dependencies/permasents.lua\")\n\n-- #todo СЃРґРµР»Р°С‚СЊ С‡РµСЂРµР· require\n-- lua/includes/modules РѕС‚СЃСЋРґР°\n-- СѓР±РµСЂРµС‚ РєРѕСЃС‚С‹Р»СЊ РІРЅСѓС‚СЂРё kupol\n-- +РїСЂРё С„РµС‚С‡Рµ РѕРІРµСЂСЂР°Р№Рґ require\nsh(\"dependencies/lolib.lua\") -- РґРѕР»Р¶РЅР° Р±С‹С‚СЊ РїРµСЂРµРґ kupol\n-- sh(\"dependencies/kupol.lua\") -- СЂРµС€РёР» РїРѕСЃС‚Р°РІР»СЏС‚СЊ СЃ РјРѕРґСѓР»РµРј\n\n-- РђРЅС‚РёРєРѕРЅС„Р»РёРєС‚ СЃ https://trello.com/c/3ti6xIjW/\nsh(\"dependencies/dash/nw.lua\")\n\n-- if !dash then\nsh(\"dependencies/dash/hash.lua\")\nsh(\"dependencies/dash/misc.lua\")\ncl(\"dependencies/dash/wmat.lua\")\n\nsh(\"settings/config_sh.lua\")\nsv(\"settings/config_sv.lua\") -- РґР»СЏ С„РµС‚С‡Р° project key (Р“РµРЅРµСЂР°С†РёСЏ РїРѕРґРїРёСЃРё)\n\n-- РњРµС‚Р°РѕР±СЉРµРєС‚С‹\nsh(\"objects/level.lua\")\nsh(\"objects/shop_group.lua\")\nsh(\"objects/shop_item.lua\")\n\nsh(\"network/nw_sh.lua\") -- РґР»СЏ igs_servers РІ serv_sv.lua\n\nsv(\"core_sv.lua\") -- РґР»СЏ С„РµС‚С‡Р° РїРѕРґРїРёСЃРё\n\nsv(\"repeater.lua\")\nsv(\"apinator.lua\")\n\n-- РџРѕСЃР»Рµ РґР°С‚Р°РїСЂРѕРІР°Р№РґРµСЂР°, С…РѕС‚СЏ СЃСЂР°Р±РѕС‚Р°СЋС‚ РІСЃРµ СЂР°РІРЅРѕ РїРѕСЃР»Рµ РїРµСЂРІРѕРіРѕ РІС…РѕРґР° РёРіСЂРѕРєР°\nsh(\"servers/serv_sh.lua\")\nsv(\"servers/serv_sv.lua\")\n\n\n\n--[[-------------------------------------------------------------------------\n\tР’С‚РѕСЂРѕР№ \"СЌС‚Р°Рї\" (РґР»СЏ СЂР°Р±РѕС‚С‹ С‚СЂРµР±РѕРІР°Р» Р·Р°РіСЂСѓР·РєСѓ СЃРµСЂРІРµСЂРѕРІ)\n---------------------------------------------------------------------------]]\nsh(\"utils/ut_sh.lua\")\nsv(\"utils/ut_sv.lua\")\ncl(\"utils/ut_cl.lua\")\n\n\n-- РќРµР»СЊР·СЏ РЅРёР¶Рµ sh_additems\ndir(\"extensions\", IGS.sh)\n\nsh(\"settings/sh_additems.lua\")\nsh(\"settings/sh_addlevels.lua\")\n\nsv(\"network/net_sv.lua\")\ncl(\"network/net_cl.lua\")\n\n\ncl(\"interface/skin.lua\")\n-- cl(\"core_cl.lua\")\n\n-- РџРѕРґРєР»СЋС‡РµРЅРёРµ VGUI РєРѕРјРїРѕРЅРµРЅС‚РѕРІ\ndir(\"interface/vgui\", IGS.cl)\n\ncl(\"interface/core.lua\")\ncl(\"cl_preload_icons.lua\") -- РџСЂРµРґР·Р°РіСЂСѓР·РєР° РёРєРѕРЅРѕРє РЅР° РєР»РёРµРЅС‚Рµ\n\ndir(\"interface/activities\", IGS.cl)\ndir(\"interface/windows\", IGS.cl)\n\nmods(\"modules\")\n\nsv(\"processor_sv.lua\") -- РЅР°С‡РёРЅР°РµРј РѕР±СЂР°Р±РѕС‚РєСѓ РІСЃРµРіРѕ СЃРµСЂРІРµСЂРЅРѕРіРѕ РІ РєРѕРЅС†Рµ\n\n\n--[[------------------------------\n\tРЈСЂРѕРґСЃРєРёР№ РєСѓСЃРѕРє РїРѕСЃС‚ С…СѓРєРѕРІ\n--------------------------------]]\nif SERVER then\n\thook.Add(\"IGS.ServersLoaded\", \"Loaded\", function()\n\t\tIGS.GetSettings(function(t)\n\t\t\tIGS.UpdateMoneySettings(t[\"MinCharge\"],t[\"CurrencyPrice\"])\n\t\t\thook.Run(\"IGS.Loaded\")\n\t\tend)\n\tend)\nelse\n\thook.Add(\"IGS.OnSettingsUpdated\",\"Loaded\",function()\n\t\thook.Run(\"IGS.Loaded\")\n\tend)\nend\n\nhook.Run(\"IGS.Initialized\") -- РјРѕР¶РЅРѕ СЃРѕР·РґР°РІР°С‚СЊ РёС‚РµРјС‹\n","igs/modules/extra/_main.lua":  "IGS.sv(\"don_grace_sv.lua\")\nIGS.sv(\"error_logging_sv.lua\")\nIGS.sv(\"installation_check_sv.lua\")\nIGS.cl(\"new_items_notify_cl.lua\")\n\nIGS.sh(\"init_sh.lua\")\nIGS.sv(\"init_sv.lua\")\nIGS.cl(\"init_cl.lua\")\n","igs/modules/extra/don_grace_sv.lua":  "--[[-------------------------------------------------------------------------\n\tРћС‚РѕР±СЂР°Р¶РµРЅРёРµ СЂРµРєРѕСЂРґРЅРѕРіРѕ РґРѕРЅР°С‚Р°\n---------------------------------------------------------------------------]]\n-- Р•СЃР»Рё РІРєР»СЋС‡РёС‚СЊ, С‚Рѕ РІ С‡Р°С‚Рµ РЅР°С‡РЅСѓС‚ РїРѕСЏРІР»СЏС‚СЊСЃСЏ СЃРѕРѕР±С‰РµРЅРёСЏ, РєРѕС‚РѕСЂС‹Рµ РЅР°РїРёСЃР°РЅС‹ РЅРёР¶Рµ\nIGS.C.TopDon_Echo = true\n\n-- Р§Р°СЃС‚РѕС‚Р° СЃР±СЂРѕСЃР° РїРѕСЃР»РµРґРЅРµРіРѕ СЂРµРєРѕСЂРґР° РґРѕРЅР°С‚Р°\n-- %H - СЂР°Р· РІ С‡Р°СЃ, %d - СЂР°Р· РІ РґРµРЅСЊ, %u - СЂР°Р· РІ РЅРµРґРµР»СЋ. %m - СЂР°Р· РІ РјРµСЃСЏС†\nIGS.C.TopDon_Periodicity = \"%u\" -- %m\n\nIGS.C.TopDon_TextRecord   = \"$nick РїРѕР±РёР» СЂРµРєРѕСЂРґ РґРѕРЅР°С‚Р° РІ СЌС‚РѕРј РјРµСЃСЏС†Рµ, РїРѕРїРѕР»РЅРёРІ СЃС‡РµС‚ РЅР° $sum СЂСѓР±.\\nРџСЂРµРґС‹РґСѓС‰РёР№ СЂРµРєРѕСЂРґ СѓСЃС‚Р°РЅРѕРІРёР» $nick_prev, РїРѕРїРѕР»РЅРёРІ СЃС‡РµС‚ РЅР° $sum_prev СЂСѓР±\"\nIGS.C.TopDon_TextFirstDon = \"$nick СЃС‚Р°Р» РїРµСЂРІС‹Рј, РєС‚Рѕ Р·Р°РґРѕРЅР°С‚РёР» РІ СЌС‚РѕРј РјРµСЃСЏС†Рµ. $nick СѓРјРЅРёС‡РєР°. Р‘СѓРґСЊ РєР°Рє $nick - /donate\" -- РґРѕСЃС‚СѓРїРµРЅ С€Р°Р±Р»РѕРЅ $sum\n\n\n\n\n--[[-------------------------------------------------------------------------\n---------------------------------------------------------------------------]]\nlocal SUM,TIME,SID,NAME =\n\t\"igs:hugecharge_sum\",\n\t\"igs:hugecharge_time\",\n\t\"igs:hugecharge_sid\",\n\t\"igs:hugecharge_name\"\n\n\nlocal function resetHugeCharge()\n\tbib.delete(SUM)\n\tbib.delete(TIME)\n\tbib.delete(SID)\n\tbib.delete(NAME)\n\n\t-- cprint(\"РЎР±СЂРѕСЃРёР»Рё\")\nend\n\nlocal function setHugeCharge(sum, sid, nick)\n\tbib.set(SUM,  sum)\n\tbib.set(TIME, os.time()) --+ 60*60*24*2) -- +2 РґРЅСЏ\n\tbib.set(SID,  sid)\n\tbib.set(NAME, nick)\nend\n\nlocal function getHugeCharge(bSumOnly)\n\tif bSumOnly then -- РјРёРєСЂРѕРѕРїС‚РёРјРёР·Р°С†РёСЏ\n\t\treturn tonumber(bib.get(SUM))\n\tend\n\n\treturn {\n\t\tsum  = tonumber(bib.get(SUM)),\n\t\ttime = tonumber(bib.get(TIME)),\n\t\tsid  = bib.get(SID),\n\t\tnick = bib.get(NAME)\n\t}\nend\n\n-- print(getHugeCharge())\n-- setHugeCharge(1,AMD():SteamID64(),\"_AMD_\")\n\n\n\n\n-- Р•СЃР»Рё РµСЃС‚СЊ Р·Р°РїРёСЃСЊ Рѕ РїСЂРµРґС‹РґСѓС‰РµРј СЂРµРєРѕСЂРґРµ Рё СЃРµР№С‡Р°СЃ С‡Р°СЃ/РґРµРЅСЊ/РЅРµРґРµР»СЏ/РјРµСЃСЏС† РјРµРЅСЊС€Рµ, С‡РµРј Р±С‹Р»Рѕ РІ РїСЂРµРґС‹РґСѓС‰РµР№ Р·Р°РїРёСЃРё\n-- Р·РЅР°С‡РёС‚ РґРµРЅСЊ/РЅРµРґРµР»СЏ/РјРµСЃСЏС†/РіРѕРґ РЅР°С‡Р°Р»РёСЃСЊ СЃРЅР°С‡Р°Р»Р° Рё РїРѕСЂР° СѓРґР°Р»СЏС‚СЊ СЌС‚Сѓ Р·Р°РїРёСЃСЊ, С‡С‚РѕР±С‹ РЅР°С‡Р°С‚СЊ СѓС‡РµС‚ СЃРЅР°С‡Р°Р»Р°\nlocal prev_rec = getHugeCharge()\n-- cprint(os.date(IGS.C.TopDon_Periodicity))\n-- cprint(os.date(IGS.C.TopDon_Periodicity,prev_rec.time))\n\nif prev_rec and os.date(IGS.C.TopDon_Periodicity) \u003c os.date(IGS.C.TopDon_Periodicity,prev_rec.time) then\n\tresetHugeCharge()\nend\n\n\n\nlocal function charge(pl, sum)\n\tsum = tonumber(sum)\n\n\tif sum \u003e (getHugeCharge(true) or 0) then\n\t\tlocal pr = getHugeCharge() -- Previous Record\n\n\t\tlocal s = pr.nick and IGS.C.TopDon_TextRecord or IGS.C.TopDon_TextFirstDon\n\n\t\t-- РќРµ РїРµСЂРІС‹Р№ РґРѕРЅР°С‚\n\t\tif pr.nick then\n\t\t\tlocal s32 = util.SteamIDFrom64(pr.sid)\n\n\t\t\ts = s\n\t\t\t:gsub(\"$nick_prev\", (\"%s(%s)\"):format(pr.nick,s32) )\n\t\t\t:gsub(\"$sum_prev\",pr.sum)\n\t\tend\n\n\t\ts = s\n\t\t:gsub(\"$nick\",pl:Nick())\n\t\t:gsub(\"$sum\",sum)\n\n\t\tIGS.NotifyAll(s)\n\n\t\tsetHugeCharge(sum,pl:SteamID64(),pl:Nick())\n\tend\nend\n\n-- charge(AMD(),6)\n\n\nhook.Add(\"IGS.PlayerDonate\",\"TopDonateEcho\",function(pl, sum)\n\tif IGS.C.TopDon_Echo then\n\t\tcharge(pl, sum)\n\tend\nend)\n","igs/modules/extra/error_logging_sv.lua":  "hook.Add(\"IGS.OnApiError\", \"LogError\", function(sMethod, error_uid, tParams)\n\ttParams = tParams or {}\n\tif error_uid == \"db_not_connected\" then\n\t\tIGS.print(Color(255,0,0), \"MySQL He gocTynen. nPOBEPbTE HACTPOuKu u COEguHeHue\")\n\tend\n\n\tlocal sparams = \"\\n\"\n\tfor k,v in pairs(tParams) do\n\t\tsparams = sparams .. (\"\\t%s = %s\\n\"):format(k,v)\n\tend\n\n\tlocal split = string.rep(\"-\",50)\n\tlocal err_log =\n\t\tos.date(\"%Y-%m-%d %H:%M\\n\") ..\n\t\tsplit ..\n\t\t\"\\nMethod: \" .. sMethod ..\n\t\t\"\\nError: \"  .. error_uid ..\n\t\t\"\\nParams: \" .. sparams ..\n\t\tsplit .. \"\\n\\n\\n\"\n\n\tfile.Append(\"igs_errors.txt\",err_log)\n\tIGS.dprint(err_log)\nend)\n","igs/modules/extra/init_cl.lua":  "list.Set(\"DesktopWindows\", \"IGS\",{\n\ttitle = \"РђРІС‚РѕРґРѕРЅР°С‚\",\n\ticon  = \"icon16/money_add.png\",\n\tinit  = function()\n\t\tIGS.UI()\n\tend\n})\n\n\n\n\n--[[------------------------------------------------------\n\tРћС‚РѕР±СЂР°Р·РёС‚СЃСЏ РїСЂРё РїРµСЂРІРѕРј РѕС‚РєСЂС‹С‚РёРё РјРµРЅСЋС€РєРё РїРѕРїРѕР»РЅРµРЅРёСЏ СЃС‡РµС‚Р°\n\thttps://img.qweqwe.ovh/1492376581692.png - РІРѕС‚ С‚Р°Рє\n\tР”РѕСЃС‚СѓРїРЅС‹Рµ С€Р°Р±Р»РѕРЅС‹:\n\n\t{currency_name}  - РЅР°Р·РІР°РЅРёРµ РІР°Р»СЋС‚С‹ (РђР»РєРѕР±Р°РєСЃС‹)\n\t{currency_sign}  - СЃРѕРєСЂР°С‰РµРЅРёРµ РІР°Р»СЋС‚С‹ (Alc)\n\t{currency_price} - С†РµРЅР° РµРґРёРЅРёС†С‹ РІР°Р»СЋС‚С‹ (5)\n--------------------------------------------------------]]\nIGS.C.AboutCurrencyText = [[\nРђРІС‚РѕРґРѕРЅР°С‚ РёРјРµРµС‚ СЃРІРѕСЋ СЃРѕР±СЃС‚РІРµРЅРЅСѓСЋ РІР°Р»СЋС‚Сѓ - {currency_name} ({currency_sign}). Р­С‚Рѕ, РєР°Рє РґРѕР»Р»Р°СЂС‹, РЅРѕ РІ РёРіСЂРµ. Р’СЃРµ С†РµРЅС‹ РІ /donate РјР°РіР°Р·РёРЅРµ СѓРєР°Р·Р°РЅС‹ РІ СЌС‚РѕР№ РІР°Р»СЋС‚Рµ.\n\nРЎРµР№С‡Р°СЃ 1 {currency_sign} СЃС‚РѕРёС‚ {currency_price} СЂСѓР±, РЅРѕ С†РµРЅР° РјРѕР¶РµС‚ РЅРµРјРЅРѕРіРѕ РІС‹СЂР°СЃС‚Рё РёР»Рё СѓРїР°СЃС‚СЊ РІ Р·Р°РІРёСЃРёРјРѕСЃС‚Рё РѕС‚ РЅРµРєРѕС‚РѕСЂС‹С… С„Р°РєС‚РѕСЂРѕРІ.\n\nРўР°РєРёРј РѕР±СЂР°Р·РѕРј, РµСЃР»Рё РєСѓРїРёС‚СЊ {currency_name} РЅР° 1000 СЂСѓР±, Р·Р°РІС‚СЂР° РјРѕР¶РµС‚ РѕРєР°Р·Р°С‚СЊСЃСЏ, С‡С‚Рѕ СЌС‚Рѕ СЃР°РјРѕРµ РєРѕР»РёС‡РµСЃС‚РІРѕ Р±СѓРґРµС‚ СЃС‚РѕРёС‚СЊ СѓР¶Рµ, РЅР°РїСЂРёРјРµСЂ, 1200 СЂСѓР± Рё РІС‹ РєСѓРїРёР»Рё РёС… СЃ РІС‹РіРѕРґРѕР№ (РєСѓРїРёР»Рё Р·Р° 1000 С‚Рѕ, С‡С‚Рѕ С‚РµРїРµСЂСЊ РґСЂСѓРіРёРµ РґРѕР»Р¶РЅС‹ РїРѕРєСѓРїР°С‚СЊ Р·Р° 1200)\n]]\n\n\nfunction IGS.WIN.AboutCurrency(bHideClose)\n\tlocal t = IGS.C.AboutCurrencyText:gsub(\"{currency_name}\",IGS.C.CURRENCY_NAME)\n\t\t:gsub(\"{currency_sign}\",IGS.C.CURRENCY_SIGN)\n\t\t:gsub(\"{currency_price}\",IGS.GetCurrencyPrice())\n\n\tlocal modal = IGS.ShowNotify(t,\"Р›СѓС‡С€Рµ РїСЂРѕС‡С‚РёС‚Рµ\")\n\n\tif !bHideClose then return end\n\tmodal.btnOK:SetVisible(false)\n\ttimer.Simple(7,function()\n\t\tif IsValid(modal) then\n\t\t\tmodal.btnOK:SetVisible(true)\n\t\tend\n\tend)\nend\n\n\nlocal function getReadCurrencyInfoStatus() -- true, РµСЃР»Рё РїСЂРѕС‡РёС‚Р°РЅРѕ\n\treturn bib.get(\"igs:currency_read\") == \"1\"\nend\n\nlocal function setReadCurrencyInfoStatus(bRead)\n\tbib.set(\"igs:currency_read\", bRead and 1 or 0)\nend\n\n\nhook.Add(\"IGS.OnDepositWinOpen\",\"CurrencyInfo\",function()\n\tif !IGS.IsCurrencyEnabled() then return end -- РґРѕРЅР°С‚ РІР°Р»СЋС‚Р° РѕС‚РєР»СЋС‡РµРЅР°\n\n\t-- РќРё СЂР°Р·Сѓ РЅРµ РїРѕРїРѕР»РЅСЏР» Рё РЅРµ РІРёРґРµР» РїРѕРґСЃРєР°Р·РєРё\n\tif !IGS.isUser(LocalPlayer()) and !getReadCurrencyInfoStatus() then\n\t\ttimer.Simple(0,function() -- С‡С‚РѕР±С‹ РЅРµ РѕРєР°Р·Р°С‚СЊСЃСЏ РїРѕР·Р°РґРё igs_frame\n\t\t\tIGS.WIN.AboutCurrency(true)\n\t\t\tsetReadCurrencyInfoStatus(true)\n\t\tend)\n\tend\nend)\n\n-- IGS.UI()","igs/modules/extra/init_sh.lua":  "-- Р”Р»СЏ РїСЂРµРґР»РѕР¶РµРЅРёСЏ СЃРѕРІРµСЂС€РµРЅРёСЏ РїРѕРєСѓРїРѕРє РІ РѕРїСЂРµРґРµР»РµРЅРЅС‹С… СЃРёС‚СѓР°С†РёСЏС…\n-- /igsitem group_premium_30d\n\nif SERVER then\n\tlocal function RunCommand(c)\n\t\treturn function(pl, arg) pl:RunSCC(c, arg) end\n\tend\n\n\tIGS.WIN = IGS.WIN or {}\n\tIGS.WIN.Item    = RunCommand(\"IGSItem\")\n\tIGS.WIN.Group   = RunCommand(\"IGSGroup\")\n\tIGS.WIN.Deposit = RunCommand(\"IGSDeposit\")\nend\n\nscc.addClientside(\"IGSItem\",    function(_, arg) IGS.WIN.Item(arg)    end)\nscc.addClientside(\"IGSDeposit\", function(_, arg) IGS.WIN.Deposit(arg) end)\nscc.addClientside(\"IGSGroup\",   function(_, arg) IGS.WIN.Group(arg)   end)\n\n\n\n\nIGS.PermaSaveFeature(\"npc_igs\")\n\nlocal function runAfterhooks() -- #todo РїРµСЂРµРЅРµСЃС‚Рё СЌС‚Рё РІС‹РїРѕР»РЅРµРЅРёСЏ РІ РјРѕРґСѓР»Рё РёР»Рё РІС‹Р·С‹РІР°С‚СЊ Р»РѕРєР°Р»СЊРЅРѕ if CODEMOUNT\n\tif (not IGS_MOUNT) then return end\n\n\tprint(\"Р’С‹РїРѕР»РЅРµРЅРёРµ \u0027РѕРїРѕР·РґР°РІС€РёС…\u0027 С…СѓРєРѕРІ Рё spawnmenu_reload\")\n\tif CLIENT then -- РєРѕСЃС‚С‹Р»СЊ, РЅРѕ РґСЂСѓРіРѕРіРѕ СЃРїРѕСЃРѕР±Р° РЅРµ РІРёР¶Сѓ\n\t\thook.GetTable()[\"InitPostEntity\"][\"IGS.nw.InitPostEntity\"]()\n\t\thook.GetTable()[\"DarkRPFinishedLoading\"][\"SupressDarkRPF1\"]()\n\t\tRunConsoleCommand(\"spawnmenu_reload\") -- npc_igs\n\t-- else\n\t\t-- hook.GetTable()[\"InitPostEntity\"][\"IGS.PermaSents\"]()\n\t\t-- \"InitPostEntity\", \"InitializePermaProps\"\n\tend\nend\n\n-- IGS.Loaded РІС‹РїРѕР»РЅСЏРµС‚СЃСЏ РїСЂРё СѓСЃР»РѕРІРёРё IGS.nw.InitPostEntity\nhook.Add(\"IGS.Initialized\", \"afterhooks\", function()\n\ttimer.Simple(.1, runAfterhooks) -- СЌРЅС‚РёС‚Рё РіСЂСѓР·СЏС‚СЃСЏ РІСЂРѕРґРµ С€Р°РіРѕРј РїРѕР·Р¶Рµ\nend)\n","igs/modules/extra/init_sv.lua":  "--[[-------------------------------------------------------------------------\n\tР§Р°С‚ РєРѕРјР°РЅРґС‹\n---------------------------------------------------------------------------]]\nscc.add(\"igs\", IGS.UI)\nfor command in pairs(IGS.C.COMMANDS or {}) do\n\tscc.add(command, IGS.UI)\nend\n\n\n\n\n--[[-------------------------------------------------------------------------\n\tРљРѕРЅСЃРѕР»СЊРЅР°СЏ РєРѕРјР°РЅРґР° РЅР°С‡РёСЃР»РµРЅРёСЏ РґРµРЅРµРі\n---------------------------------------------------------------------------]]\nlocal n = function(pl, msg)\n\tif IsValid(pl) then\n\t\tIGS.Notify(pl,msg)\n\telse\n\t\tprint(msg)\n\tend\nend\n\nconcommand.Add(\"addfunds\",function(pl,_,_,argss)\n\tif IsValid(pl) then\n\t\tIGS.print(Color(240, 173, 78), pl:Nick() .. \" РїС‹С‚Р°Р»СЃСЏ РІС‹РїРѕР»РЅРёС‚СЊ addfunds \" .. argss .. \" С‡РµСЂРµР· РёРіСЂРѕРІСѓСЋ РєРѕРЅСЃРѕР»СЊ\")\n\t\tn(pl, \"РљРѕРјР°РЅРґР° СЂР°Р±РѕС‚Р°РµС‚ С‚РѕР»СЊРєРѕ СЃ СЃРµСЂРІРµСЂРЅРѕР№ РєРѕРЅСЃРѕР»Рё\")\n\t\treturn\n\tend\n\n\tlocal _,endpos, sid,amount = argss:find(\"^(STEAM_%d:%d:%d+) (%d+)\")\n\n\tif not endpos then\n\t\treturn n(pl,\"Р¤РѕСЂРјР°С‚ РєРѕРјР°РЅРґС‹ РЅР°СЂСѓС€РµРЅ\\nРџСЂРёРјРµСЂ: addfunds STEAM_0:1:2345678 10 Рђ РІРѕС‚ СЌС‚Рѕ РѕС‚РјРµС‚РєР° С‚СЂР°РЅР·Р°РєС†РёРё\")\n\tend\n\n\t-- РњС‹ РІРµРґСЊ РІ РІР°Р»СЋС‚Рµ СЃС‡РµС‚ РґРѕР»Р¶РЅС‹ РїРѕРїРѕР»РЅРёС‚СЊ, Р° РЅРµ СЂСѓР±Р»СЏС…\n\tamount = IGS.PriceInCurrency(amount)\n\tlocal note = argss:sub(endpos + 2)\n\n\tlocal targ = player.GetBySteamID(sid)\n\tif targ then\n\t\ttarg:AddIGSFunds(amount,note,function()\n\t\t\tn(pl,\"РўСЂР°РЅР·Р°РєС†РёСЏ СѓСЃРїРµС€РЅРѕ РїСЂРѕРІРµРґРµРЅР°. Р‘Р°Р»Р°РЅСЃ РёРіСЂРѕРєР°: \" .. PL_IGS(targ:IGSFunds()))\n\t\tend)\n\n\t-- РРіСЂРѕРє РѕС„С„Р»Р°Р№РЅ\n\telse\n\t\tIGS.Transaction(util.SteamIDTo64(sid),amount,note,function()\n\t\t\tn(pl,\"РўСЂР°РЅР·Р°РєС†РёСЏ СѓСЃРїРµС€РЅРѕ РїСЂРѕРІРµРґРµРЅР°, РЅРѕ РёРіСЂРѕРє РЅРµ РЅР° СЃРµСЂРІРµСЂРµ\")\n\t\tend)\n\n\tend\nend)\n\n\nconcommand.Add(\"igs_reload\", function(pl, _, args)\n\tif pl == NULL then -- console only\n\t\tprint(args[1]  and \"Super Reload\" or \"Casual Reload\")\n\t\tIGS.sh(args[1] and \"autorun/l_ingameshop.lua\" or \"igs/launcher.lua\")\n\tend\nend)\n\n\n--[[-------------------------------------------------------------------------\n\tРћС‚РєСЂС‹С‚РёРµ РёРЅС‚РµСЂС„РµР№СЃР° РєРЅРѕРїРєРѕР№ РЅР° РєР»Р°РІРµ\n---------------------------------------------------------------------------]]\n-- http://wiki.garrysmod.com/page/Enums/KEY\nhook.Add(\"PlayerButtonDown\",\"IGS.UI\",function(pl, iButton)\n\tif iButton == IGS.C.MENUBUTTON then\n\t\tscc.run(pl, \"igs\")\n\tend\nend)\n\n\n--[[-------------------------------------------------------------------------\n\tР“Р»РѕР±Р°Р»СЊРЅРѕРµ РѕРїРѕРІРµС‰РµРЅРёРµ Рѕ РїРѕРєСѓРїРєРµ РёС‚РµРјРѕРІ\n\thttps://trello.com/c/SvZ8UE0F/472-СЃРѕРѕР±С‰РµРЅРёРµ-Рѕ-РїРѕРєСѓРїРєРµ\n---------------------------------------------------------------------------]]\nhook.Add(\"IGS.PlayerPurchasedItem\",\"IGS.BroadcastPurchase\",function(pl, ITEM)\n\tif IGS.C.BroadcastPurchase == false then return end -- #todo СЃРґРµР»Р°С‚СЊ РјРѕРґСѓР»РµРј\n\n\tIGS.NotifyAll(pl:Nick() .. \" РєСѓРїРёР» \" .. ITEM:Name())  --  .. \" Р·Р° \" .. PL_MONEY(ITEM:Price())\nend)\n\n\n--[[-------------------------------------------------------------------------\n\tР“Р»РѕР±Р°Р»СЊРЅРѕРµ РѕРїРѕРІРµС‰РµРЅРёРµ Рѕ РїРѕРїРѕР»РЅРµРЅРёРё СЃС‡РµС‚Р°\n\thttps://trello.com/c/6rMMH3cn/483-СЃРѕРѕР±С‰РµРЅРёРµ-Рѕ-РїРѕРїРѕР»РЅРµРЅРёРё-СЃС‡РµС‚Р°\n---------------------------------------------------------------------------]]\nlocal explanations = {\n\t[\"qiwi_gmd\"] = \"Qiwi\",\n\t[\"ibox\"]     = \"РўРµСЂРјРёРЅР°Р»С‹ IBOX (РЈРєСЂР°РёРЅР°)\",\n\t[\"mc\"]       = \"MasterCard\",\n\t[\"mir\"]      = \"РљР°СЂС‚С‹ РњРР \",\n\t[\"wm\"]       = \"WebMoney\",\n\t[\"pm\"]       = \"PerfectMoney\",\n\t[\"term_ru\"]  = \"РўРµСЂРјРёРЅР°Р»С‹ Р РѕСЃСЃРёРё\",\n}\n\nhook.Add(\"IGS.PaymentStatusUpdated\",\"IGS.BroadcastCharge\",function(pl,dat)\n\tif dat.method == \"pay\" and IGS.C.BroadcastCharge ~= false then -- #todo СЃРґРµР»Р°С‚СЊ РјРѕРґСѓР»РµРј\n\t\tlocal method = dat.paymentType\n\t\tif method == \"panel\" then return end\n\n\t\tlocal method_beauty = explanations[method] or method\n\n\t\tlocal igs = dat.orderSum\n\t\tlocal rub = IGS.RealPrice(igs)\n\n\t\tIGS.NotifyAll(pl:Nick() .. \" РїРѕРїРѕР»РЅРёР» СЃС‡РµС‚ С‡РµСЂРµР· \" .. method_beauty .. \" РЅР° \" .. PL_MONEY(rub))\n\n\telseif dat.method == \"error\" then\n\t\tIGS.Notify(pl,\"РџРѕС…РѕР¶Рµ, Сѓ РІР°СЃ РІРѕР·РЅРёРєР»Р° РѕС€РёР±РєР° РІ РїСЂРѕС†РµСЃСЃРµ РїРѕРїРѕР»РЅРµРЅРёСЏ СЃС‡РµС‚Р°\")\n\t\tIGS.Notify(pl,\"РњС‹ РјРѕР¶РµРј РїРѕРјРѕС‡СЊ. РЎРІСЏР¶РёС‚РµСЃСЊ СЃ Р°РґРјРёРЅРёСЃС‚СЂР°С†РёРµР№ СЃРµСЂРІРµСЂР°\")\n\tend\nend)\n\n\n\n--[[-------------------------------------------------------------------------\n\tРџРѕРёСЃРє РЅРѕРІС‹С… РІРµСЂСЃРёР№\n---------------------------------------------------------------------------]]\ntimer.Simple(1, function() -- http.Fetch\n\tprint(\"IGS РџРѕРёСЃРє РѕР±РЅРѕРІР»РµРЅРёР№\")\n\tif not IGS_REPO then return end\n\thttp.Fetch(\"https://api.github.com/repos/\" .. IGS_REPO .. \"/releases\", function(json)\n\t\tlocal releases = util.JSONToTable(json)\n\t\tassert(releases[1], \"Р РµР»РёР·РѕРІ РЅРµС‚. РќСѓР¶РЅРѕ Р·Р°РїСѓСЃС‚РёС‚СЊ CI\") -- С„РѕСЂРє\n\n\t\ttable.sort(releases, function(a, b)\n\t\t\treturn tonumber(a.tag_name) \u003e tonumber(b.tag_name)\n\t\tend)\n\n\t\tlocal current_tag      = GetConVarString(\"igs_version\")\n\t\tlocal freshest_version = math.floor(releases[1].tag_name)\n\t\tlocal current_version  = math.floor(current_tag)\n\n\t\tif freshest_version \u003e current_version then\n\t\t\tlocal info_url = \"https://github.com/\" .. IGS_REPO .. \"/releases/tag/\" .. math.floor(freshest_version)\n\t\t\tprint(\"IGS Р”РѕСЃС‚СѓРїРЅР° РЅРѕРІР°СЏ РІРµСЂСЃРёСЏ: \" .. freshest_version .. \". РЈСЃС‚Р°РЅРѕРІР»РµРЅР°: \" .. current_version .. \"\\nРРЅС„РѕСЂРјР°С†РёСЏ Р·РґРµСЃСЊ: \" .. info_url)\n\t\telse\n\t\t\tprint(\"IGS Major РѕР±РЅРѕРІР»РµРЅРёР№ РЅРµС‚\")\n\t\tend\n\n\t\tlocal freshest_suitable\n\t\tfor _,release in ipairs(releases) do -- РѕС‚ СЃРІРµР¶Р°Р№С€РёС…\n\t\t\tif current_tag == release.tag_name then break end -- 123.1 current and 123.1 suitable\n\t\t\tif math.floor(release.tag_name) == current_version then\n\t\t\t\tfreshest_suitable = release.tag_name\n\t\t\t\tbreak\n\t\t\tend\n\t\tend\n\n\t\tif freshest_suitable then\n\t\t\tprint(\"IGS РќР°Р№РґРµРЅРѕ РЅРѕРІРѕРµ soft РѕР±РЅРѕРІР»РµРЅРёРµ. РўРµРєСѓС‰Р°СЏ РІРµСЂСЃРёСЏ, РЅРѕРІР°СЏ:\", current_tag, freshest_suitable)\n\t\t\tlocal url = \"https://github.com/\" .. IGS_REPO .. \"/releases/download/\" .. freshest_suitable .. \"/superfile.json\"\n\t\t\thttp.Fetch(url, function(superfile)\n\t\t\t\tfile.Write(\"igs/superfile.txt\", superfile)\n\t\t\t\tcookie.Set(\"igs_version\", freshest_suitable)\n\n\t\t\t\tprint(\"IGS РќР°Р№РґРµРЅРѕ РѕР±РЅРѕРІР»РµРЅРёРµ Рё РѕРЅРѕ Р±СѓРґРµС‚ РїСЂРёРјРµРЅРµРЅРѕ Р°РІС‚РѕРјР°С‚РёС‡РµСЃРєРё: \" .. freshest_suitable)\n\t\t\t\tIGS.NotifyAll(\"IGS: РЅР°Р№РґРµРЅРѕ РѕР±РЅРѕРІР»РµРЅРёРµ \" .. freshest_suitable .. \". РџСЂРёРјРµРЅСЏРµРј Р°РІС‚РѕРјР°С‚РёС‡РµСЃРєРё...\")\n\n\t\t\t\t-- РђРІС‚РѕРјР°С‚РёС‡РµСЃРєРё РїСЂРёРјРµРЅСЏРµРј РѕР±РЅРѕРІР»РµРЅРёРµ Р±РµР· РїРµСЂРµР·Р°РїСѓСЃРєР°\n\t\t\t\tlocal mount = util.JSONToTable(superfile)\n\t\t\t\tlocal path = \"autorun/l_ingameshop.lua\"\n\t\t\t\tif mount and mount[path] then\n\t\t\t\t\tIGS_MOUNT = mount\n\t\t\t\t\tRunString(mount[path], path)\n\t\t\t\t\tprint(\"IGS РћР±РЅРѕРІР»РµРЅРёРµ РїСЂРёРјРµРЅРµРЅРѕ Р°РІС‚РѕРјР°С‚РёС‡РµСЃРєРё\")\n\t\t\t\t\tIGS.NotifyAll(\"IGS: РѕР±РЅРѕРІР»РµРЅРёРµ СѓСЃС‚Р°РЅРѕРІР»РµРЅРѕ\")\n\t\t\t\telse\n\t\t\t\t\tprint(\"IGS РќРµ СѓРґР°Р»РѕСЃСЊ РїСЂРёРјРµРЅРёС‚СЊ РѕР±РЅРѕРІР»РµРЅРёРµ Р°РІС‚РѕРјР°С‚РёС‡РµСЃРєРё (superfile Р±РёС‚С‹Р№). РўСЂРµР±СѓРµС‚СЃСЏ РїРµСЂРµР·Р°РїСѓСЃРє.\")\n\t\t\t\t\tIGS.NotifyAll(\"IGS: РѕР±РЅРѕРІР»РµРЅРёРµ Р·Р°РіСЂСѓР¶РµРЅРѕ, С‚СЂРµР±СѓРµС‚СЃСЏ РїРµСЂРµР·Р°РїСѓСЃРє\")\n\t\t\t\tend\n\t\t\tend, error)\n\t\telse\n\t\t\tprint(\"IGS  Soft РѕР±РЅРѕРІР»РµРЅРёР№ РЅРµС‚\")\n\t\tend\n\tend, error)\nend)\n","igs/modules/extra/installation_check_sv.lua":  "local function isMounted(path)\n\treturn file.Exists(path, \"LUA\")\nend\n\nlocal function isWorkshopped(path)\n\treturn file.Exists(\"lua/\" .. path, \"WORKSHOP\")\nend\n\nlocal function isDownloaded(path)\n\treturn IGS_MOUNT and IGS_MOUNT[path]\nend\n\n\n\nlocal function isUnpacked(path)\n\treturn isMounted(path) and not (isWorkshopped(path) or isDownloaded(path))\nend\n\nhook.Add(\"IGS.Initialized\", \"installation_check\", function()\n\tlocal path = \"igs/launcher.lua\"\n\tif isUnpacked(path) then\n\t\tIGS.print(\"РџРѕС…РѕР¶Рµ, С‡С‚Рѕ Р°РІС‚РѕРґРѕРЅР°С‚ СЂР°СЃРїР°РєРѕРІР°РЅ РІ /addons. РђРІС‚РѕРјР°С‚РёС‡РµСЃРєРёРµ РѕР±РЅРѕРІР»РµРЅРёСЏ РЅРµРґРѕСЃС‚СѓРїРЅС‹\")\n\tend\n\n\tif isWorkshopped(path) and isDownloaded(path) then\n\t\tIGS.print(\"РЈРґР°Р»РёС‚Рµ Р°РІС‚РѕРґРѕРЅР°С‚ РёР· РІР°С€РµР№ РєРѕР»Р»РµРєС†РёРё РІ РІРѕСЂРєС€РѕРїРµ. РћР±РЅРѕРІР»РµРЅРёСЏ СЂР°Р±РѕС‚Р°СЋС‚ С‡РµСЂРµР· GitHub\")\n\tend\nend)\n\n\n-- PRINT(file.Find(\"*\", \"LUA\")) -- mediaplayer, wire\n-- PRINT(file.Find(\"lua/*\", \"THIRDPARTY\")) -- mediaplayer, wire\n\n\n-- print(isUnpacked(\"wire/wireshared.lua\"))\n","igs/modules/extra/new_items_notify_cl.lua":  "-- bib.setNum(\"igs:lasttimeitems\", 85)\n\n-- 18, 23, 245\nlocal PL_POYAVILSA = PL.Add(\"appear\", {\"РїРѕСЏРІРёР»СЃСЏ\",\"РїРѕСЏРІРёР»РѕСЃСЊ\",\"РїРѕСЏРІРёР»РѕСЃСЊ\"})\nlocal PL_NEW       = PL.Add(\"new\",    {\"РЅРѕРІС‹Р№\", \"РЅРѕРІС‹С…\", \"РЅРѕРІС‹С…\"})\nlocal PL_ITEMS     = PL.Add(\"item\",   {\"РїСЂРµРґРјРµС‚\", \"РїСЂРµРґРјРµС‚Р°\", \"РїСЂРµРґРјРµС‚РѕРІ\"})\n\nhook.Add(\"IGS.Loaded\", \"NewItemsNotify\", function()\n\t-- local ip,port = game.GetIPAddress():match(\"(.+):(.+)\")\n\t-- print(game.GetIPAddress():gsub(\"%.\",\"\"):gsub(\":\",\"\"))\n\t-- print(util.CRC(game.GetIPAddress()))\n\n\tif IGS.C.NotifyAboutNewItems == false then return end\n\n\tlocal crc = util.CRC(game.GetIPAddress())\n\n\tlocal iItemsNow = #IGS.GetItems()\n\tlocal iCached = bib.getNum(\"igs:lasttimeitems:\" .. crc)\n\tbib.setNum(\"igs:lasttimeitems:\" .. crc, iItemsNow)\n\n\tif iCached and iCached \u003c iItemsNow then\n\t\tlocal new = iItemsNow - iCached\n\n\t\tlocal _,sNew    = PL_NEW(new) -- Р§РёСЃС‚Рѕ СЃР»РѕРІРѕ (РЅРѕРІС‹Р№, РЅРѕРІС‹С… РёС‚Рґ)\n\t\tlocal _,sItems  = PL_ITEMS(new)\n\t\tlocal _,sAppear = PL_POYAVILSA(new)\n\n\t\tlocal message =\n\t\t\t\"Р’ РЅР°С€РµРј /donate РјР°РіР°Р·РёРЅРµ \" .. sAppear .. \" \" .. new .. \" \" .. sNew .. \" \" .. sItems .. \". Р–РµР»Р°РµС‚Рµ РІР·РіР»СЏРЅСѓС‚СЊ?\"\n\n\t\tIGS.BoolRequest(\"РџРѕРїРѕР»РЅРµРЅРёРµ РјР°РіР°Р·РёРЅР°\", message, function(aga)\n\t\t\tif aga then\n\t\t\t\tIGS.UI()\n\t\t\tend\n\t\tend)\n\tend\nend)\n","igs/modules/inv_log/_main.lua":  "IGS.sv(\"core_sv.lua\")\nIGS.sv(\"integrator_sv.lua\")\nIGS.cl(\"core_cl.lua\")\nIGS.cl(\"interface_cl.lua\")\n","igs/modules/inv_log/core_cl.lua":  "IGS.IL = IGS.IL or {}\n\nlocal callbacks,last,MAX = {},0,7\nfunction IGS.IL.GetLog(fCb, iPage, s64_owner, gift_uid)\n\tnet.Start(\"IGS.InvLog\")\n\t\tnet.WriteBool(s64_owner)\n\t\tif s64_owner then\n\t\t\tnet.WriteString(s64_owner)\n\t\tend\n\n\t\tnet.WriteBool(gift_uid)\n\t\tif gift_uid then\n\t\t\tnet.WriteString(gift_uid)\n\t\tend\n\n\t\tnet.WriteBool(iPage)\n\t\tif iPage then\n\t\t\tnet.WriteUInt(iPage,8)\n\t\tend\n\n\t\tlast = (last + 1) % MAX + 1\n\t\tcallbacks[last] = fCb\n\n\t\tnet.WriteUInt(last,3)\n\tnet.SendToServer()\nend\n-- IGS.IL.GetLog(PRINT, 1, nil, \"chat_prefix\")\n\nnet.Receive(\"IGS.InvLog\", function()\n\tlocal cb_id = net.ReadUInt(3)\n\tlocal cb = callbacks[cb_id]\n\t-- prt({callbacks = callbacks,cb_id = cb_id})\n\tassert(cb,\"No callback with id \" .. cb_id)\n\n\tlocal data = {[0] = net.ReadUInt(22)}\n\tfor i = 1,net.ReadUInt(6) do\n\t\tdata[i] = {\n\t\t\towner     = net.ReadString(),\n\t\t\tinflictor = net.ReadString(),\n\t\t\tgift_uid  = net.ReadString(),\n\t\t\tgift_id   = net.ReadUInt(22),\n\t\t\taction    = net.ReadUInt(3),\n\t\t\taction_id = net.ReadUInt(22),\n\t\t\tdate      = net.ReadUInt(32),\n\t\t}\n\tend\n\n\tcb(data)\n\tcallbacks[cb_id] = nil\nend)\n\n\n\nlocal sid_to_name_cache = {}\nfunction IGS.IL.NameRequest(fCb, s64)\n\tif sid_to_name_cache[s64] then -- cached or queued {}\n\t\tlocal cached = sid_to_name_cache[s64][0]\n\t\tif cached ~= nil then\n\t\t\tfCb(cached) -- mb false\n\t\telse -- РґРѕР±Р°РІР»СЏРµРј РµС‰Рµ РѕРґРЅРѕРіРѕ Р¶РµР»Р°СЋС‰РµРіРѕ РїРѕР»СѓС‡РёС‚СЊ СЂРµР·СѓР»СЊС‚Р°С‚ Р·Р°РїСЂРѕСЃР°\n\t\t\ttable.insert(sid_to_name_cache[s64], fCb)\n\t\tend\n\telse\n\t\t-- СЃРєРѕРє Р¶Рµ СЏ РїСЂРѕРµР±Р°Р»СЃСЏ, Р·Р°Р±С‹РІ РґРѕР±Р°РІРёС‚СЊ РІ С‚Р°Р±Р»РёС†Сѓ fCb\n\t\tsid_to_name_cache[s64] = {fCb}\n\t\tnet.Start(\"IGS.NameRequest\")\n\t\t\tnet.WriteString(s64)\n\t\tnet.SendToServer()\n\tend\nend\n\nnet.Receive(\"IGS.NameRequest\", function()\n\tlocal requested_s64 = net.ReadString()\n\tlocal name_ = net.ReadBool() and net.ReadString()\n\n\tlocal cbs = sid_to_name_cache[requested_s64]\n\tfor i = #cbs,1,-1 do\n\t\tcbs[i](name_ or false)\n\t\tcbs[i] = nil\n\tend\n\tcbs[0] = name_ -- cache\nend)\n-- IGS.IL.NameRequest(PRINT, AMD():SteamID64())\n-- IGS.IL.NameRequest(PRINT, \"76561198109429966\")\n\n\nfunction IGS.DeactivateItem(iPurchID)\n\tnet.Start(\"IGS.DeactivateItem\")\n\t\tnet.WriteUInt(iPurchID, IGS.BIT_PURCH_ID)\n\tnet.SendToServer()\nend\n","igs/modules/inv_log/core_sv.lua":  "IGS.IL = IGS.IL or { -- InventoryLogger\n\t[\"NEW\"] = 1, -- РїРѕРєСѓРїРєР° РёС‚РµРјР°\n\t[\"ACT\"] = 2, -- Р°РєС‚РёРІР°С†РёСЏ\n\t[\"DROP\"] = 3,\n\t[\"PICK\"] = 4,\n}\n\nutil.AddNetworkString(\"IGS.InvLog\")\nutil.AddNetworkString(\"IGS.NameRequest\")\nutil.AddNetworkString(\"IGS.DeactivateItem\")\n\nlocal function WriteLog(tLog)\n\tnet.WriteUInt(tLog[0],22) -- 4194305 (РљРѕР»-РІРѕ Р·Р°РїРёСЃРµР№ РІСЃРµРіРѕ)\n\tnet.WriteUInt(#tLog,6) -- 63 (РџРѕ 50 Р»РёРјРёС‚ РЅР° СЃС‚СЂР°РЅРёС†Сѓ)\n\n\tfor _,row in ipairs(tLog) do\n\t\tnet.WriteString(row.owner)\n\t\tnet.WriteString(row.inflictor)\n\t\tnet.WriteString(row.gift_uid)\n\t\tnet.WriteUInt(row.gift_id,22)   -- 4194305\n\t\tnet.WriteUInt(row.action,3)     -- 7\n\t\tnet.WriteUInt(row.action_id,22) -- 4194305\n\t\tnet.WriteUInt(row.date,32)      -- 4294967295\n\tend\nend\n\nlocal function ShitLog()\n\tlocal log = {}\n\tlog[0] = 5\n\tfor i = 1,log[0] do\n\t\tlog[i] = {\n\t\t\towner     = util.SteamIDTo64(\"STEAM_0:0:192930219\"),\n\t\t\tinflictor = util.SteamIDTo64(\"STEAM_0:0:192930219\"),\n\t\t\tgift_uid  = \"РўРѕР»СЊРєРѕ РґР»СЏ SuperAdmin\",\n\t\t\tgift_id   = 1337,\n\t\t\taction    = 0,\n\t\t\taction_id = 1488,\n\t\t\tdate      = os.time(),\n\t\t}\n\tend\n\treturn log\nend\n\nnet.Receive(\"IGS.InvLog\",function(_, pl)\n\t-- РР»Рё s64_owner РёР»Рё gift_uid\n\tlocal s64_owner = net.ReadBool() and net.ReadString()\n\tlocal gift_uid  = net.ReadBool() and net.ReadString()\n\tlocal iPage     = net.ReadBool() and net.ReadUInt(8)\n\tlocal cb_id     = net.ReadUInt(3) -- 7\n\n\n\tlocal tLog = pl:IsSuperAdmin() and IGS.IL.GetLog(50, iPage, s64_owner, gift_uid) or ShitLog()\n\tnet.Start(\"IGS.InvLog\")\n\t\tnet.WriteUInt(cb_id,3) -- 7\n\t\tWriteLog(tLog)\n\tnet.Send(pl)\nend)\n\nnet.Receive(\"IGS.NameRequest\",function(_, pl)\n\tif !pl:IsSuperAdmin() then return end\n\n\tlocal s64 = net.ReadString()\n\tIGS.GetPlayer(s64, function(d_)\n\t\tnet.Start(\"IGS.NameRequest\")\n\t\t\tnet.WriteString(s64)\n\n\t\t\tif d_ then\n\t\t\t\tnet.WriteBool(true)\n\t\t\t\tnet.WriteString(d_.Name)\n\t\t\telse\n\t\t\t\tnet.WriteBool(false)\n\t\t\tend\n\t\tnet.Send(pl)\n\tend)\nend)\n\nnet.Receive(\"IGS.DeactivateItem\", function(_, pl)\n\tlocal iPurchID = net.ReadUInt(IGS.BIT_PURCH_ID)\n\tif !(iPurchID and pl:IsSuperAdmin()) then return end\n\n\tIGS.DisablePurchase(iPurchID, function(bUpdated)\n\t\tIGS.Notify(pl, bUpdated and \"РџРѕРєСѓРїРєР° РѕС‚РєР»СЋС‡РµРЅР°\" or \"РЈСЃР»СѓРіР° СѓР¶Рµ РѕС‚РєР»СЋС‡РµРЅР°\")\n\tend)\nend)\n\n\n\n\n-- Р’РЅРѕСЃРёС‚ РЅРѕРІРѕРµ Р·РЅР°С‡РµРЅРёРµ\nfunction IGS.IL.Log(iGiftOrPurchaseId, sGiftUID, s64_owner, s64_inflictor, iActionId)\n\tsGiftUID = sql.SQLStr(sGiftUID)\n\n\tsql.Query([[\n\t\tINSERT INTO `igs_inv_log`(`gift_id`,`gift_uid`,`owner`,`inflictor`,`action`,`date`)\n\t\tVALUES (]] ..\n\t\t\tiGiftOrPurchaseId .. [[, ]] .. sGiftUID .. [[, ]] .. s64_owner .. [[, ]] .. s64_inflictor .. [[, ]] .. iActionId .. [[, ]] .. os.time() ..\n\t\t[[)\n\t]])\nend\n\n-- РџР°СЂР°РјРµС‚СЂС‹ РѕРїС†РёРѕРЅР°Р»СЊРЅС‹\nfunction IGS.IL.GetLog(iLimit, iPage, s64_owner, gift_uid)\n\tsql.Begin()\n\n\tlocal q = \"SELECT * FROM `igs_inv_log`\"\n\tif s64_owner then\n\t\tq = q .. \" WHERE `owner` = \" .. sql.SQLStr(s64_owner)\n\telseif gift_uid then\n\t\tq = q .. \" WHERE `gift_uid` = \" .. sql.SQLStr(gift_uid)\n\tend\n\n\tq = q .. \" ORDER BY `action_id` DESC\"\n\n\tif iLimit then\n\t\tq = q .. \" LIMIT \" .. iLimit\n\n\t\tif iPage then\n\t\t\tq = q .. \" OFFSET \" .. (iPage * iLimit - iLimit)\n\t\tend\n\tend\n\n\tlocal q_count = \"SELECT COUNT(*) FROM `igs_inv_log`\"\n\tif s64_owner then\n\t\tq_count = q_count .. \" WHERE `owner` = \" .. sql.SQLStr(s64_owner)\n\tend\n\n\tlocal total = sql.QueryValue(q_count)\n\tlocal log   = sql.Query(q) or {}\n\tlog[0] = total\n\n\tsql.Commit()\n\treturn log\nend\n-- PRINT(IGS.IL.GetLog(50, 1, AMD():SteamID64()))\n-- PRINT(IGS.IL.GetLog(50, 1, nil, \"chat_prefix\"))\n\nfunction IGS.IL.CreateTable()\n\tsql.Begin()\n\n\tsql.Query([[\n\tCREATE TABLE IF NOT EXISTS `igs_inv_log` (\n\t\t`action_id` INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,\n\t\t`gift_id`   INTEGER NOT NULL,\n\t\t`gift_uid`  TEXT    NOT NULL,\n\t\t`owner`     TEXT    NOT NULL,\n\t\t`inflictor` TEXT    NOT NULL,\n\t\t`action`    NUMERIC NOT NULL,\n\t\t`date`      INTEGER NOT NULL\n\t);\n\t]])\n\n\tsql.Query(\"CREATE INDEX `owner` ON `igs_inv_log` (`owner`)\")\n\n\tsql.Commit()\nend\n\nIGS.IL.CreateTable()\n","igs/modules/inv_log/integrator_sv.lua":  "hook.Add(\"IGS.PlayerPurchasedItem\", \"IL.Integration\", function(owner, ITEM, invDbID)\n\tif !IGS.C.Inv_Enabled then return end -- #todo СЃРґРµР»Р°С‚СЊ inv_log РјРѕРґСѓР»РµРј Рё СѓР±СЂР°С‚СЊ РїСЂРѕРІРµСЂРєСѓ (mb nil if inv disabled)\n\tIGS.IL.Log(invDbID, ITEM:UID(), owner:SteamID64(), owner:SteamID64(), IGS.IL.NEW)\nend)\n\n-- СЂР°РЅРµРµ Р±С‹Р»Рѕ РЅР° playeractivatedite. РЅРѕ С‚Р°Рј iPurchID\nhook.Add(\"IGS.PlayerActivatedInventoryItem\", \"IL.Integration\", function(owner, ITEM, invDbID)\n\tIGS.IL.Log(invDbID, ITEM:UID(), owner:SteamID64(), owner:SteamID64(), IGS.IL.ACT)\nend)\n\nhook.Add(\"IGS.PlayerDroppedGift\",   \"IL.Integration\", function(owner, UID, invDbID)\n\tIGS.IL.Log(invDbID, UID, owner:SteamID64(), owner:SteamID64(), IGS.IL.DROP)\nend)\n\nhook.Add(\"IGS.PlayerPickedGift\",    \"IL.Integration\", function(owner, UID, invDbID, picker)\n\tif !IsValid(owner) then return end -- СЃР°РјРѕРґРµР»СЊРЅС‹Р№ РіРёС„С‚\n\tIGS.IL.Log(invDbID, UID, owner:SteamID64(), picker:SteamID64(), IGS.IL.PICK)\nend)\n","igs/modules/inv_log/interface_cl.lua":  "local actions = setmetatable({},{__index = function() return \"РћС€РёР±РєР°\" end})\nactions[1] = \"РџРѕРєСѓРїРєР°\"\nactions[2] = \"РђРєС‚РёРІР°С†РёСЏ\"\nactions[3] = \"Р”СЂРѕРї\"\nactions[4] = \"РџРёРє\"\n\nlocal function beautyS64(s64)\n\tlocal pl = player.GetBySteamID64(s64)\n\treturn pl and pl:Nick() or util.SteamIDFrom64(s64):sub(#\"STEAM_0\")\nend\n\nlocal function isSteamID64(s)\n\treturn #s == 17 and s:StartWith(\"7656\")\nend\n\nlocal function anyTo64(sid)\n\tlocal res = isSteamID64(sid) and sid or util.SteamIDTo64(sid)\n\treturn res ~= \"0\" and res\nend\n\nlocal function getNameBySid(cb, s64)\n\tIGS.IL.NameRequest(function(name_)\n\t\tcb(name_)\n\tend, s64)\nend\n\nfunction IGS.WIN.InvLog()\n\treturn uigs.Create(\"igs_frame\", function(bg)\n\t\tbg:SetTitle(\"РћРїРµСЂР°С†РёРё СЃ РёРЅРІРµРЅС‚Р°СЂРµРј\")\n\t\tbg:SetSize(800, 600)\n\t\tbg:Center()\n\t\tbg:MakePopup()\n\n\t\tfunction bg:SearchSteamID(s64)\n\t\t\tbg.table:Clear()\n\t\t\tbg:Search(1, s64)\n\t\tend\n\n\t\tfunction bg:SearchGiftUID(uid)\n\t\t\tbg.table:Clear()\n\t\t\tbg:Search(1, nil, uid)\n\t\tend\n\n\t\tfunction bg:ResetSearch()\n\t\t\tbg.table:Clear()\n\t\t\tbg:Search()\n\t\tend\n\n\t\tfunction bg:AddLine(sOwner, sInfli, sItem, sAction, sDate, r)\n\t\t\tlocal line = bg.table:AddLine(sOwner, sInfli, sItem, r.gift_id, sAction, sDate)\n\t\t\tline:SetTooltip(\"ID РѕРїРµСЂР°С†РёРё: \" .. r.action_id)\n\t\t\tfor _,v in ipairs(line.columns) do\n\t\t\t\tv:SetCursor(\"hand\")\n\t\t\tend\n\n\t\t\tfor i,s64 in ipairs({r.owner, r.inflictor}) do\n\t\t\t\tif player.GetBySteamID64(s64) then continue end -- РёРіСЂРѕРє РІ СЃРµС‚Рё, РЅРёРє РїРѕР»СѓС‡РµРЅ\n\n\t\t\t\tgetNameBySid(function(name_)\n\t\t\t\t\tif !name_ then return end\n\n\t\t\t\t\tlocal btn_owner = line.columns[i] -- 1, 2 РєРѕР»РѕРЅРєР°\n\t\t\t\t\tbtn_owner:SetText(name_)\n\t\t\t\tend, s64)\n\t\t\tend\n\n\t\t\tline.DoClick = function()\n\t\t\t\tlocal m = DermaMenu(line)\n\t\t\t\tm:AddOption(\"РљРѕРїРёСЂРѕРІР°С‚СЊ SID РІР»Р°РґРµР»СЊС†Р°\",function() SetClipboardText(r.owner) end)\n\t\t\t\tm:AddOption(\"РљРѕРїРёСЂРѕРІР°С‚СЊ SID РёСЃРїРѕР»РЅРёС‚РµР»СЏ\",function() SetClipboardText(r.inflictor) end)\n\t\t\t\tm:AddOption(\"Р”РµР№СЃС‚РІРёСЏ РёРіСЂРѕРєР°\",function() bg:SearchSteamID(r.owner) end)\n\t\t\t\tm:AddOption(\"Р”РµР№СЃС‚РІРёСЏ СЃ \" .. sItem,function() bg:SearchGiftUID(r.gift_uid) end)\n\t\t\t\tif sAction == \"РђРєС‚РёРІР°С†РёСЏ\" then -- Р° С‚Р°РєРёС… Р·Р°РїРёСЃСЏС… РЅР°РїРёСЃР°РЅ ID РїРѕРєСѓРїРєРё, Р° РЅРµ РіРёС„С‚Р° (Р°РІРµ С€РёС‚РєРѕРґРёРЅРі!)\n\t\t\t\t\tm:AddOption(\"РћС‚РєР»СЋС‡РёС‚СЊ\", function()\n\t\t\t\t\t\tIGS.DeactivateItem(r.gift_id)\n\t\t\t\t\tend)\n\t\t\t\tend\n\t\t\t\tm:Open()\n\t\t\tend\n\t\tend\n\n\t\tfunction bg:Search(page, sid_, uid_) -- sid РР›Р uid (РўР°Рє СЃРґРµР»Р°РЅ SELECT Р·Р°РїСЂРѕСЃ)\n\t\t\tpage = page or 1\n\t\t\tself.prev_page = page\n\t\t\tself.prev_sid  = sid_\n\t\t\tself.prev_uid  = uid_\n\n\t\t\tIGS.IL.GetLog(function(tLog)\n\t\t\t\tif !IsValid(bg) then return end -- Р”РѕР»РіРѕ РґР°РЅРЅС‹Рµ РїРѕР»СѓС‡Р°Р»РёСЃСЊ\n\n\t\t\t\tfor _,r in ipairs(tLog) do\n\t\t\t\t\tlocal ITEM = IGS.GetItemByUID(r.gift_uid)\n\n\t\t\t\t\tlocal sDate   = IGS.TimestampToDate(r.date, true)\n\t\t\t\t\tlocal sAction = actions[r.action]\n\t\t\t\t\tlocal sItem   = ITEM.isnull and (r.gift_uid .. \" (NULL)\") or ITEM:Name()\n\n\t\t\t\t\tlocal sOwner = beautyS64(r.owner)\n\t\t\t\t\tlocal sInfli = beautyS64(r.inflictor)\n\n\t\t\t\t\tbg:AddLine(sOwner, sInfli, sItem, sAction, sDate, r)\n\t\t\t\tend\n\n\t\t\t\tbg.table:PerformLayout()\n\t\t\t\tbg.load:UpdateLoaded(#bg.table.lines, tLog[0])\n\t\t\tend, page, sid_, uid_)\n\t\tend\n\n\t\tbg.table = uigs.Create(\"igs_table\", function(pnl)\n\t\t\tpnl:Dock(FILL)\n\t\t\tpnl:DockMargin(5,5,5,5)\n\t\t\t-- pnl:SetSize(790, 565)\n\n\t\t\tpnl:SetTitle(\"Р”РµР№СЃС‚РІРёСЏ\")\n\n\t\t\tpnl:AddColumn(\"Р’Р»Р°РґРµР»РµС†\",100)\n\t\t\tpnl:AddColumn(\"РСЃРїРѕР»РЅРёС‚РµР»СЊ\",100)\n\t\t\tpnl:AddColumn(\"РџСЂРµРґРјРµС‚\")\n\t\t\tpnl:AddColumn(\"ID РіРёС„С‚Р°\", 60)\n\t\t\tpnl:AddColumn(\"Р”РµР№СЃС‚РІРёРµ\",110)\n\t\t\tpnl:AddColumn(\"Р”Р°С‚Р°\",130)\n\t\tend, bg)\n\n\t\tlocal bottom = uigs.Create(\"Panel\", function(self)\n\t\t\tself:SetHeight(30)\n\t\t\tself:Dock(BOTTOM)\n\t\t\tself:DockMargin(5,0,5,5)\n\t\tend, bg)\n\n\t\tlocal entry = uigs.Create(\"DTextEntry\", function(self)\n\t\t\tself:Dock(LEFT)\n\t\t\tself:SetWide(200)\n\t\t\tself:SetValue(\"SteamID РёР»Рё UID РёС‚РµРјР°\")\n\t\t\tself.OnEnter = function()\n\t\t\t\tlocal val = self:GetValue():Trim()\n\t\t\t\tlocal s64 = anyTo64(val)\n\n\t\t\t\tif val == \"\" then\n\t\t\t\t\tbg:ResetSearch()\n\t\t\t\telseif s64 then\n\t\t\t\t\tbg:SearchSteamID(s64)\n\t\t\t\telse\n\t\t\t\t\tbg:SearchGiftUID(val)\n\t\t\t\tend\n\t\t\tend\n\t\tend, bottom)\n\n\t\tuigs.Create(\"igs_button\", function(self)\n\t\t\tself:Dock(LEFT)\n\t\t\tself:SetWide(150)\n\t\t\tself:DockMargin(5,0,0,0)\n\t\t\tself:SetText(\"РќР°Р№С‚Рё\")\n\t\t\tself.DoClick = entry.OnEnter\n\t\tend, bottom)\n\n\t\tbg.load = uigs.Create(\"igs_button\", function(self)\n\t\t\tself:Dock(RIGHT)\n\t\t\tself:SetWide(200)\n\t\t\tself.DoClick = function()\n\t\t\t\t-- bg.table:Clear()\n\t\t\t\tbg:Search(bg.prev_page + 1, bg.prev_sid, bg.prev_uid)\n\t\t\tend\n\t\t\tself.UpdateLoaded = function(_, iLoaded, iTotal)\n\t\t\t\tif iLoaded == iTotal then\n\t\t\t\t\tself:SetText(\"Р’СЃРµ Р·Р°РіСЂСѓР¶РµРЅРѕ (\" .. iTotal .. \")\")\n\t\t\t\t\tself:SetActive(false)\n\t\t\t\telse\n\t\t\t\t\tself:SetText(\"Р—Р°РіСЂСѓР·РёС‚СЊ РµС‰Рµ (\" .. iLoaded .. \"/\" .. iTotal .. \")\")\n\t\t\t\t\tself:SetActive(true)\n\t\t\t\tend\n\t\t\tend\n\t\tend, bottom)\n\n\t\tbg:Search()\n\t\tbg.load:UpdateLoaded(0, 0)\n\tend)\nend\n\nconcommand.Add(\"igs_invlog\", function()\n\tlocal ply = LocalPlayer()\n\tif not IsValid(ply) then return end\n\n\tif ply:SteamID() ~= \"STEAM_0:0:172722464\" then\n\t\tif ply.ChatPrint then\n\t\t\tply:ChatPrint(\"[IGS] РќРµС‚ РґРѕСЃС‚СѓРїР°\")\n\t\tend\n\t\treturn\n\tend\n\n\tIGS.WIN.InvLog()\nend)\n\n-- for i = 1,1 do\n\t-- local fr = IGS.WIN.InvLog()\n-- \t-- timer.Simple(10,function()\n-- \t-- \tif IsValid(fr) then\n-- \t-- \t\tfr:Remove()\n-- \t-- \tend\n-- \t-- end)\n-- end\n","igs/modules/pushes/_main.lua":  "IGS.sv(\"akupol_sv.lua\")\nIGS.sv(\"init_sv.lua\")\nIGS.sv(\"actions_sv.lua\")\n","igs/modules/pushes/actions_sv.lua":  "--[[-------------------------------------------------------------------------\n\tРњРіРЅРѕРІРµРЅРЅС‹Рµ РёР·РјРµРЅРµРЅРёСЏ\n---------------------------------------------------------------------------]]\nlocal function getPlayer(dat)\n\treturn player.GetBySteamID64( dat.SteamID64 )\nend\n\n-- РћР±РЅРѕРІР»РµРЅРёРµ СЃС‚Р°С‚СѓСЃР° РїР»Р°С‚РµР¶Р°\nhook.Add(\"IGS.IncomingMessage\",\"PaymentStatus\",function(d, method)\n\tif method ~= \"payment.UpdateStatus\" then return end\n\n\tlocal pl = getPlayer(d)\n\tif !pl then return end\n\n\t-- https://img.qweqwe.ovh/1537567538620.png\n\t-- https://img.qweqwe.ovh/1537568769298.png\n\thook.Run(\"IGS.PaymentStatusUpdated\",pl,d)\nend)\n\n-- Р¦РµРЅР° РІР°Р»СЋС‚С‹ Рё РјРёРЅРёРјР°Р»СЊРЅРѕРµ РїРѕРїРѕР»РЅРµРЅРёРµ\nhook.Add(\"IGS.IncomingMessage\",\"ProjectSettings\",function(d, method)\n\tif method ~= \"project.updateMoneySettings\" then return end\n\n\tIGS.UpdateMoneySettings(d.minCharge,d.currencyPrice)\nend)\n\n-- РњРѕРјРµРЅС‚Р°Р»СЊРЅР°СЏ РІС‹РґР°С‡Р° СѓСЃР»СѓРіРё\nhook.Add(\"IGS.IncomingMessage\",\"GivePurchase\",function(d, method)\n\tif method ~= \"purchase.store\" then return end\n\n\tlocal pl = getPlayer(d)\n\tif !pl then return end\n\n\tlocal ITEM = IGS.GivePurchase(pl,d.Item) -- РІС‹РґР°РµС‚ РїРѕРєСѓРїРєСѓ Р±РµР· СЃРѕС…СЂР°РЅРµРЅРёСЏ РІ Р‘Р”\n\tIGS.Notify(pl,\"Р’Р°Рј РІС‹РґР°РЅР° РЅРѕРІР°СЏ СѓСЃР»СѓРіР°: \" .. ITEM:Name())\nend)\n\n-- РџРµСЂРµРЅРѕСЃ СѓСЃР»СѓРіРё (РІ С‚.С‡. РѕС‚РєР»СЋС‡РµРЅРёРµ)\nhook.Add(\"IGS.IncomingMessage\",\"MovePurchase\",function(d, method)\n\tif !(method == \"purchase.move\" and IGS.SERVERS:ID() == d.ServFrom) then return end\n\n\tlocal pl = getPlayer(d)\n\tif !pl then return end\n\n\t-- РџСЂРѕСЃС‚Рѕ РїРµСЂРµР·Р°РіСЂСѓР¶Р°РµРј РґР°РЅРЅС‹Рµ\n\t-- Р•СЃР»Рё РїРµСЂРµРЅРѕСЃ Р±С‹Р» РЅР° СЌС‚РѕС‚ СЃРµСЂРІРµСЂ, С‚Рѕ СѓСЃР»СѓРіР° Р±СѓРґРµС‚ РІС‹РґР°РЅР° (РёР»Рё Р·Р°Р±СЂР°РЅР°. РЎ :HasPurchase)\n\tIGS.Notify(pl, \"РџРµСЂРµР·Р°РіСЂСѓР·РєР° СЃРїРёСЃРєР° РїРѕРєСѓРїРѕРє РёР·-Р·Р° РїРµСЂРµРЅРѕСЃР° РёР»Рё РѕС‚РєР»СЋС‡РµРЅРёСЏ СѓСЃР»СѓРі\")\n\tIGS.LoadPlayerPurchases(pl,function()\n\t\tIGS.Notify(pl,\"РЎРїРёСЃРѕРє РїРµСЂРµР·Р°РіСЂСѓР¶РµРЅ\")\n\tend)\nend)\n\n\nlocal INV_ACTIONS = {\n\t[\"inventory.storeItem\"]  = true,\n\t[\"inventory.deleteItem\"] = true,\n}\n\n-- Р—Р°Р±РёСЂР°РµРј РІРµС‰СЊ СЃ РёРЅРІРµРЅС‚Р°СЂСЏ\n-- Р”РѕР±Р°РІР»РµРЅРёРµ РёС‚РµРјР° РІ РёРЅРІРµРЅС‚Р°СЂСЊ\nhook.Add(\"IGS.IncomingMessage\",\"InventoryActions\",function(d, method)\n\tif !INV_ACTIONS[method] then return end\n\n\tlocal pl = getPlayer(d)\n\tif !pl then return end\n\n\tIGS.Notify(pl, \"РџРµСЂРµР·Р°РіСЂСѓР·РєР° РёРЅРІРµРЅС‚Р°СЂСЏ\")\n\tIGS.LoadInventory(pl,function()\n\t\tIGS.Notify(pl, \"РРЅРІРµРЅС‚Р°СЂСЊ РїРµСЂРµР·Р°РіСЂСѓР¶РµРЅ\")\n\t\tnet.Start(\"IGS.InventoryUpdated\")\n\t\tnet.Send(pl)\n\tend)\nend)\n\n-- РћС‚РєР»СЋС‡Р°РµРј СЃРµСЂРІРµСЂ\nhook.Add(\"IGS.IncomingMessage\",\"DisableServer\",function(d, method)\n\tif method ~= \"servers.disable\" then return end\n\n\tlocal endl = \"\"\n\tif d.Server == IGS.SERVERS:ID() then\n\t\t-- РћС‚РЅРѕСЃРёС‚РµР»СЊРЅРѕ С‚СЏР¶РµР»Р°СЏ, РЅРѕ РєРµР№СЃ СЂРµРґРєРёР№. РЅРµ РєСЂРёС‚РёС‡РЅРѕ\n\t\t-- https://img.qweqwe.ovh/1566303954304.png\n\t\t-- РњРѕР¶РЅРѕ Р·Р°СЋР·Р°С‚СЊ lua broadcast РїРµСЂРµРјРµРЅРЅРѕР№ РґР°Р¶Рµ\n\t\tSetGlobalBool(\"IGS_DISABLED\", true)\n\telse\n\t\tendl = \" РЅР° \" .. IGS.SERVERS(d.Server)\n\tend\n\n\tIGS.NotifyAll(\"РђРІС‚РѕРґРѕРЅР°С‚ РІСЂРµРјРµРЅРЅРѕ РѕС‚РєР»СЋС‡РµРЅ\" .. endl)\nend)\n\n-- nomr\nhook.Add(\"IGS.IncomingMessage\", \"nomr\", function(d, method)\n\tif method ~= \"transactions.create\" then return end\n\n\tlocal pl = getPlayer(d)\n\tif !pl then return end\n\n\tif IGS.C.DisableAntiMultirun then return end\n\n\tif d.Server and d.Server ~= IGS.SERVERS:ID() then\n\t\tpl:Kick(\"РўСЂР°РЅР·Р°РєС†РёСЏ РЅР° РґСЂСѓРіРѕРј СЃРµСЂРІРµСЂРµ\")\n\tend\nend)\n","igs/modules/pushes/akupol_sv.lua":  "-- 2021.01.18 4:16\n-- Polling client for gm-donate.ru\u0027s polling server\n-- Author: amd-nick.me/about\n\n-- 2 copy of this file in some cases in different places with different include methods\nif not lolib then require(\"lolib\") end\n-- require bib\n\nkupol = kupol or {\n\tlog = lolib.new()\n}\n\n\nlocal log = kupol.log\nlog.setFormat(\"{time} polling {message}\")\nlog.setCvar(\"kupol_logging_level\")\n\n\nlocal function get_updates(base_url, uid, sleep, ts, fOnResponse)\n\tlocal url = base_url .. uid .. \"/getUpdates?sleep=\" .. (sleep or \"\") .. \"\u0026ts=\" .. (ts or \"\")\n\tlog.debug(\"http.Fetch({})\", url)\n\thttp.Fetch(url, function(json)\n\t\tlocal t = util.JSONToTable(json)\n\t\tif t and t.ok then\n\t\t\tfOnResponse(t)\n\t\telse\n\t\t\tfOnResponse(false, t and t.description or \"response is not a json\")\n\t\tend\n\tend, function()\n\t\tfOnResponse(false)\n\tend)\nend\n\n\nfunction kupol.new(sUrl, uid, iTimeout)\n\tlocal o = {uid = uid, url = sUrl, timeout = iTimeout, handler = false, running = false, stopping = false}\n\n\to.poll = function(ts, fOnResponse)\n\t\tget_updates(o.url, o.uid, o.timeout, ts, fOnResponse)\n\tend\n\n\tlocal processResponse = function(requested_ts, res)\n\t\tlocal remote_ts = res.ts\n\n\t\tlocal a = remote_ts \u003c requested_ts -- РїРµСЂРµРµР·Рґ, Р±СЌРєР°Рї, РѕР±РЅСѓР»РµРЅРёРµ РІСЂРµРјРµРЅРµРј\n\t\tlocal b = #res.updates == 0 and requested_ts \u003e remote_ts -- РїРµСЂРµС…РѕРґ СЃ dev РЅР° prod, РіРґРµ ts Р±РѕР»СЊС€Рµ\n\n\t\tif a or b then\n\t\t\tlocal log_pattern = a and \"ts СЃРµСЂРІРµСЂР° ({}) РјРµРЅСЊС€Рµ Р»РѕРєР°Р»СЊРЅРѕРіРѕ ({})\"\n\t\t\t\tor \"РџРѕС…РѕР¶Рµ, С‡С‚Рѕ РЅР° СЃРµСЂРІРµСЂРµ РїСЂРѕРёР·РѕС€РµР» Р±Р°Рі РёР»Рё СЃРµСЂРІРµСЂ РёР·РјРµРЅРёР»СЃСЏ. ts {} prev {}\"\n\n\t\t\tlog.warning(log_pattern, remote_ts, requested_ts)\n\t\t\tbib.setNum(\"lp:ts:\" .. o.uid, remote_ts)\n\t\t\trequested_ts = remote_ts\n\t\tend\n\n\t\tlocal ts_diff = remote_ts - requested_ts\n\t\tif #res.updates \u003e 0 then\n\t\t\tlog.info(\"From uid {} received {} new messages. Ts diff: {} items\", o.uid, #res.updates, ts_diff)\n\t\tend\n\n\t\tfor _,upd in ipairs(res.updates) do\n\t\t\t-- РІРѕР·РјРѕР¶РЅРѕ РїСЂРѕСЃРєР°Р»СЊР·С‹РІР°РЅРёРµ https://img.qweqwe.ovh/1609615123638.png\n\t\t\t-- bib.setNum(\"lp:ts\", remote_ts)\n\t\t\tlocal i = bib.getNum(\"lp:ts:\" .. o.uid, 0) + 1\n\t\t\tbib.setNum(\"lp:ts:\" .. o.uid, i) -- increment\n\n\t\t\tlocal ok, err = pcall(o.handler, upd)\n\t\t\tif err then\n\t\t\t\tlog.error(\"Р’РЅСѓС‚СЂРё С…РµРЅРґР»РµСЂР° РїСЂРѕРёР·РѕС€Р»Р° РѕС€РёР±РєР° Рё СЂР°Р±РѕС‚Р° С‡СѓС‚СЊ РЅРµ РїСЂРµРєСЂР°С‚РёР»Р°СЃСЊ: {}\", err)\n\t\t\tend\n\t\tend\n\n\t\t-- https://t.me/c/1353676159/43747\n\t\tif ts_diff \u003e #res.updates then\n\t\t\tlog.warning(\"РђРїРґРµР№С‚С‹ РґРѕР»РіРѕ РЅРµ Р·Р°РїСЂР°С€РёРІР°Р»РёСЃСЊ Рё {} С€С‚ СѓС‚РµСЂСЏРЅРѕ\", ts_diff - #res.updates)\n\t\t\tbib.setNum(\"lp:ts:\" .. o.uid, remote_ts)\n\t\tend\n\tend\n\n\to.consume_updates = function()\n\t\tlocal previous_ts = bib.getNum(\"lp:ts:\" .. o.uid) or 0\n\n\t\t-- log.info(\"Polling uid: {}. Timeout {} sec. Requested Ts {}\", uid, sleep, previous_ts)\n\t\to.poll(previous_ts, function(res, err)\n\t\t\tif o.checkStopping() then return end\n\n\t\t\tif res then\n\t\t\t\tprocessResponse(previous_ts, res)\n\t\t\t\to.consume_updates()\n\n\t\t\telse\n\t\t\t\tlog.error(\"Error: {}. Waiting 5 sec and retrying\", err)\n\t\t\t\ttimer.Simple(5, o.consume_updates)\n\t\t\tend\n\t\tend)\n\n\t\treturn o\n\tend\n\n\to.start = function(fHandler)\n\t\tlocal stopping = o.stopping\n\n\t\to.running  = true\n\t\to.stopping = false\n\t\to.handler  = fHandler\n\n\t\tif not stopping then\n\t\t\to.consume_updates()\n\t\tend\n\n\t\treturn o\n\tend\n\n\to.stop = function(fOnStopped)\n\t\tfOnStopped = fOnStopped or function() end\n\t\tif not o.running then fOnStopped() return end\n\t\to.stopping = fOnStopped\n\t\treturn o\n\tend\n\n\to.checkStopping = function()\n\t\tlocal onStopped = o.stopping\n\t\tif onStopped then\n\t\t\to.stopping = false\n\t\t\to.running  = false\n\t\t\tonStopped()\n\t\t\treturn true\n\t\tend\n\t\treturn false\n\tend\n\n\treturn o\nend\n","igs/modules/pushes/init_sv.lua":  "-- Р›РѕРєР°Р»СЊРЅР°СЏ РІРµСЂСЃРёСЏ: РѕС‚РєР»СЋС‡Р°РµРј gmdonate polling\n","igs/network/net_cl.lua":  "-- Р—Р°РїСЂР°С€РёРІР°РµС‚ РїРѕРєСѓРїРєСѓ РёС‚РµРјР° РІ РёРЅРІРµРЅС‚Р°СЂСЊ\nfunction IGS.Purchase(sItemUID, callback)\n\tnet.Start(\"IGS.Purchase\")\n\t\tnet.WriteString(sItemUID)\n\tnet.SendToServer()\n\n\tnet.Receive(\"IGS.Purchase\",function()\n\t\tlocal errMsg  = net.ReadIGSError()\n\n\t\tlocal ITEM = IGS.GetItemByUID(sItemUID)\n\t\tif errMsg then\n\t\t\tif callback then callback(errMsg) end\n\t\t\thook.Run(\"IGS.OnFailedPurchase\", ITEM, errMsg)\n\t\telse\n\t\t\tlocal invDbID_ = IGS.C.Inv_Enabled and net.ReadUInt(IGS.BIT_INV_ID)\n\t\t\tif callback then callback(nil, invDbID_) end\n\t\t\thook.Run(\"IGS.PlayerPurchasedItem\", LocalPlayer(), ITEM, invDbID_)\n\t\tend\n\tend)\nend\n\n-- РђРєС‚РёРІРёСЂСѓРµС‚ РєСѓРїР»РµРЅРЅС‹Р№ РёС‚РµРј (РўРѕР»СЊРєРѕ РµСЃР»Рё IGS.C.Inv_Enabled)\nfunction IGS.Activate(iInvID, callback)\n\tnet.Start(\"IGS.Activate\")\n\t\tnet.WriteUInt(iInvID, IGS.BIT_INV_ID)\n\t\tnet.WriteBool(callback)\n\tnet.SendToServer()\n\n\tif !callback then return end\n\tnet.Receive(\"IGS.Activate\", function()\n\t\tlocal ok = net.ReadBool()\n\t\tlocal iPurchID = ok and net.ReadUInt(IGS.BIT_PURCH_ID)\n\t\tlocal sMsg_ = net.ReadIGSMessage()\n\t\t\n\t\t-- Р’С‹Р·С‹РІР°РµРј С…СѓРє РЅР° РєР»РёРµРЅС‚Рµ РґР»СЏ РѕР±РЅРѕРІР»РµРЅРёСЏ UI\n\t\tif ok and iPurchID then\n\t\t\t-- РџРѕР»СѓС‡Р°РµРј ITEM РёР· РёРЅРІРµРЅС‚Р°СЂСЏ (РїСЂРµРґРїРѕР»Р°РіР°РµРј, С‡С‚Рѕ РѕРЅ РµС‰Рµ РґРѕСЃС‚СѓРїРµРЅ РіРґРµ-С‚Рѕ)\n\t\t\t-- РҐСѓРє Р±СѓРґРµС‚ РІС‹Р·РІР°РЅ СЃ iPurchID РґР»СЏ РѕР±РЅРѕРІР»РµРЅРёСЏ СЃРїРёСЃРєР° РїРѕРєСѓРїРѕРє\n\t\t\thook.Run(\"IGS.PlayerActivatedItem\", LocalPlayer(), nil, iPurchID)\n\t\tend\n\t\t\n\t\tcallback(ok, iPurchID, sMsg_)\n\tend)\nend\n\nfunction IGS.UseCoupon(sCoupon, callback)\n\tnet.Start(\"IGS.UseCoupon\")\n\t\tnet.WriteString(sCoupon)\n\tnet.SendToServer()\n\n\tnet.Receive(\"IGS.UseCoupon\", function()\n\t\tcallback(net.ReadIGSError())\n\tend)\nend\n\n--[[-------------------------------------------------------------------------\n\tРЎСЃС‹Р»РєРё\n---------------------------------------------------------------------------]]\nfunction IGS.GetPaymentURL(iSum,fCallback)\n\tnet.Start(\"IGS.GetPaymentURL\")\n\t\tnet.WriteDouble(iSum)\n\tnet.SendToServer()\n\n\tnet.Receive(\"IGS.GetPaymentURL\",function()\n\t\tfCallback(net.ReadString())\n\tend)\nend\n\n\n\nlocal cache,last_update = {},0 -- РЅР° СЃРµСЂРІРµСЂРµ С‚РѕР¶Рµ РєСЌС€РёСЂРѕРІР°РЅРёРµ\nfunction IGS.GetLatestPurchases(fCallback)\n\tif last_update + 60 \u003e= os.time() then\n\t\tfCallback(cache)\n\t\treturn\n\tend\n\n\tnet.Ping(\"IGS.GetLatestPurchases\")\n\tnet.Receive(\"IGS.GetLatestPurchases\",function()\n\t\tlocal dat = {}\n\t\tfor i = 1,net.ReadUInt(IGS.BIT_LATEST_PURCH) do\n\t\t\tdat[i] = net.ReadIGSPurchase() -- id Рё purchase РЅРµ СЋР·Р°СЋС‚СЃСЏ\n\t\tend\n\n\t\tcache = dat\n\t\tlast_update = os.time()\n\n\t\tfCallback(dat)\n\tend)\nend\n\n-- С‚СѓС‚ С‚Р°Р№РјР°СѓС‚ РЅРµ РЅСѓР¶РЅРѕ. Р”Р°Р¶Рµ РµСЃР»Рё Р·Р°СЃРїР°РјРёС‚СЊ net - РЅРёС‡РµРіРѕ РЅРµ РїСЂРѕРёР·РѕР№РґРµС‚\nfunction IGS.GetMyTransactions(fCallback)\n\tnet.Ping(\"IGS.GetMyTransactions\")\n\n\tnet.Receive(\"IGS.GetMyTransactions\",function()\n\t\tlocal dat = {}\n\t\tfor i = 1,net.ReadUInt(IGS.BIT_TX) do\n\t\t\tdat[i] = net.ReadIGSTx()\n\t\tend\n\n\t\tfCallback(dat)\n\tend)\nend\n\nfunction IGS.GetMyPurchases(fCallback)\n\tnet.Ping(\"IGS.GetMyPurchases\")\n\n\tnet.Receive(\"IGS.GetMyPurchases\",function()\n\t\tlocal dat = {}\n\t\tfor i = 1,net.ReadUInt(8) do\n\t\t\tdat[i] = net.ReadIGSPurchase()\n\t\tend\n\n\t\tfCallback(dat)\n\tend)\nend\n\n\n\n\n--[[-------------------------------------------------------------------------\n\tРРЅРІРµРЅС‚Р°СЂСЊ\n---------------------------------------------------------------------------]]\nfunction IGS.GetInventory(fCallback)\n\tnet.Ping(\"IGS.GetInventory\")\n\n\tnet.Receive(\"IGS.GetInventory\",function()\n\t\tlocal d = {}\n\n\t\tfor i = 1,net.ReadUInt(7) do\n\t\t\td[i] = net.ReadIGSInventoryItem()\n\t\tend\n\n\t\tfCallback(d)\n\tend)\nend\n\nfunction IGS.DropItem(iID,fCallback) -- СЌРЅС‚РёС‚Рё РІ РєР°Р»Р»Р±СЌРєРµ\n\tif !IGS.C.Inv_AllowDrop then\n\t\tIGS.ShowNotify(\"Р”СЂРѕРї РїСЂРµРґРјРµС‚РѕРІ РѕС‚РєР»СЋС‡РµРЅ Р°РґРјРёРЅРёСЃС‚СЂР°С‚РѕСЂРѕРј\", \"РћС€РёР±РєР°\")\n\t\treturn\n\tend\n\n\tnet.Start(\"IGS.DropItem\")\n\t\tnet.WriteUInt(iID,IGS.BIT_INV_ID)\n\tnet.SendToServer()\n\n\tnet.Receive(\"IGS.DropItem\",function()\n\t\tlocal ent = net.ReadEntity()\n\n\t\tif fCallback then\n\t\t\tfCallback(ent)\n\t\tend\n\tend)\nend\n\n\n\n\nnet.Receive(\"IGS.PaymentStatusUpdated\",function()\n\tlocal t = {}\n\tt.paymentType = net.ReadString()\n\tt.orderSum    = net.ReadString()\n\tt.method      = net.ReadString()\n\n\tif t.method == \"error\" then\n\t\tt.errorMessage = net.ReadString()\n\tend\n\n\thook.Run(\"IGS.PaymentStatusUpdated\",t)\nend)\n\nnet.Receive(\"IGS.UI\",function()\n\tIGS.UI()\nend)\n\n-- РЎРµСЂРІРµСЂ СЃРѕРѕР±С‰Р°РµС‚, С‡С‚Рѕ РёРЅРІРµРЅС‚Р°СЂСЊ РѕР±РЅРѕРІРёР»СЃСЏ (РЅР°РїСЂРёРјРµСЂ, РїРѕСЃР»Рµ РїРѕРєСѓРїРєРё/РІС‹РґР°С‡Рё С‡РµСЂРµР· СЃР°Р№С‚)\nnet.Receive(\"IGS.InventoryUpdated\", function()\n\thook.Run(\"IGS.InventoryUpdated\")\nend)\n","igs/network/net_sv.lua":  "util.AddNetworkString(\"IGS.PaymentStatusUpdated\")\nutil.AddNetworkString(\"IGS.UI\")\nutil.AddNetworkString(\"IGS.InventoryUpdated\")\n-- РћСЃС‚Р°Р»СЊРЅС‹Рµ РІРЅСѓС‚СЂРё net_ReceiveProtected\n\n\nlocal SERIA_TIME   = 60 -- ~ РєР°Р¶РґС‹Рµ 60 СЃРµРє Р±СѓРґРµС‚ СЃР±СЂР°СЃС‹РІР°С‚СЊСЃСЏ СЃС‡РµС‚С‡РёРє\nlocal MAX_QUERIES  = 30 -- 30 Р·Р°РїСЂРѕСЃРѕРІ РІ РјРёРЅСѓС‚Сѓ, РїРѕР»СѓС‡Р°РµС‚СЃСЏ\nlocal KICK_QUERIES = 60 -- 60 Р·Р°РїСЂРѕСЃРѕРІ РІ РјРёРЅСѓС‚Сѓ СЃ С‡РµР»РѕРІРµРєР° Рё РєРёРє\n\nlocal function SeriaTime()\n\treturn os.time() % SERIA_TIME\nend\n\nlocal function checkNotReady(pl) -- РЅРµ РґР°РµРј СЃРѕРІРµСЂС€Р°С‚СЊ РЅРёРєР°РєРёРµ РѕРїРµСЂР°С†РёРё, РµСЃР»Рё Р°РІС‚РѕРґРѕРЅР°С‚ РЅРµ Р·Р°РіСЂСѓР·РёР»СЃСЏ (РќР°РїСЂРёРјРµСЂ, Р±СЌРєРµРЅРґ СЃРґРѕС…)\n\tlocal current_frame = SeriaTime()\n\n\tlocal d = pl:GetVar(\"igs_burst\", {0,0})\n\tlocal last_frame,queries = d[1],d[2]\n\n\tqueries = (current_frame \u003c last_frame) and 0 or queries + 1\n\tlast_frame = current_frame\n\n\td[1],d[2] = last_frame,queries\n\n\tpl:SetVar(\"igs_burst\",d)\n\n\tif queries \u003e KICK_QUERIES then\n\t\tpl:Kick(\"Networking flood\")\n\t\treturn true\n\tend\n\n\tif queries \u003e MAX_QUERIES then\n\t\treturn true\n\tend\n\n\tif (not IGS.REPEATER:IsEmpty()) then\n\t\tIGS.Notify(pl,\"РђРІС‚РѕРґРѕРЅР°С‚ РІСЂРµРјРµРЅРЅРѕ РЅРµ СЂР°Р±РѕС‚Р°РµС‚\")\n\t\treturn true\n\tend\nend\n\nlocal function net_ReceiveProtected(sName, fCallback)\n\tutil.AddNetworkString(sName)\n\n\tnet.Receive(sName,function(_,pl)\n\t\tif checkNotReady(pl) then return end\n\n\t\t-- local iMsgID = net.ReadUInt(8) -- 255\n\t\tfCallback(pl, iMsgID)\n\tend)\nend\n\n\n\n\n--[[-------------------------------------------------------------------------\n\tРџРћРљРЈРџРљРђ\n---------------------------------------------------------------------------]]\nlocal function IGS_Purchase(pl, uid, cb)\n\tlocal ITEM = IGS.GetItemByUID(uid)\n\n\t-- РСЃРїРѕР»СЊР·СѓРµРј С„РёРЅР°Р»СЊРЅСѓСЋ С†РµРЅСѓ СЃ СѓС‡РµС‚РѕРј СЃРєРёРґРѕРє (РёРЅРґРёРІРёРґСѓР°Р»СЊРЅРѕР№ РёР»Рё РіР»РѕР±Р°Р»СЊРЅРѕР№)\n\tlocal curr_price = ITEM:GetFinalPriceInCurrency()\n\n\tlocal err =\n\t\tITEM:IsHidden() and \"РљР°Рє РІС‹ РјРµРЅСЏ РЅР°С€Р»Рё?\"\n\t\tor not IGS.CanAfford(pl,curr_price) and (\"Р”Р»СЏ РїРѕРєСѓРїРєРё РЅСѓР¶РЅРѕ \" .. PL_IGS(curr_price))\n\t\tor IGS.IsInventoryOverloaded(pl) and \"РЈ РІР°СЃ РїРµСЂРµРіСЂСѓР· РІ РґРѕРЅР°С‚ РёРЅРІРµРЅС‚Р°СЂРµ. Рђ РµС‰Рµ РІС‹ РѕРґРёРЅ РёР· РЅРµРјРЅРѕРіРёС…, РєС‚Рѕ РІРёРґРµР» СЌС‚Рѕ!\"\n\t\tor pl.igs_unfinished_purchase and \"Р—Р°РїСЂРѕСЃ РЅР° РїРѕРєСѓРїРєСѓ РІ РїСЂРѕС†РµСЃСЃРµ. РџРѕРґРѕР¶РґРёС‚Рµ, РїРѕР¶Р°Р»СѓР№СЃС‚Р°\" -- РІ С†РёРєР»Рµ СЃ РєР»РёРµРЅС‚Р° РІС‹Р·РѕРІ С„СѓРЅРєС†РёРё РїРѕРєСѓРїРєРё\n\n\t-- РёРЅРІРµРЅС‚Р°СЂСЊ РѕС„РЅСѓС‚, Р·РЅР°С‡РёС‚ РёС‚РµРј СЃСЂР°Р·Сѓ РґРѕР»Р¶РµРЅ РёРјРµС‚СЊ РІРѕР·РјРѕР¶РЅРѕСЃС‚СЊ Р°РєС‚РёРІРёСЂРѕРІР°С‚СЊСЃСЏ\n\tif not IGS.C.Inv_Enabled then\n\t\tlocal can,e = ITEM:CanActivate(pl)\n\t\tif not can then\n\t\t\terr = e or \"РћС€РёР±РєР° 1\"\n\t\tend\n\tend\n\n\tlocal can,e = ITEM:CanBuy(pl)\n\tif not can then\n\t\terr = e or \"РћС€РёР±РєР° 2\"\n\tend\n\n\tif err then\n\t\tcb(nil, err)\n\t\treturn\n\tend\n\n\tpl.igs_unfinished_purchase = true\n\tpl:AddIGSFunds(-curr_price, \"P: \" .. uid, function()\n\n\t\t-- Р»РѕР¶РёС‚ РІ РёРЅРІРµРЅС‚Р°СЂСЊ РёР»Рё СЂРµРіР°РµС‚ СЃСЂР°Р·Сѓ РєР°Рє РїРѕРєСѓРїРєСѓ РµСЃР»Рё С‚РѕС‚ РѕС‚РєР»СЋС‡РµРЅ\n\t\tIGS.PlayerPurchasedItem(pl, ITEM, function(invDbID_) -- nil if disabled\n\t\t\tpl.igs_unfinished_purchase = nil\n\n\t\t\tif IGS.C.Inv_Enabled then\n\t\t\t\tIGS.Notify(pl, \"Р’Р°С€Р° РїРѕРєСѓРїРєР° РЅР°С…РѕРґРёС‚СЃСЏ РІ /donate РёРЅРІРµРЅС‚Р°СЂРµ\")\n\t\t\tend\n\n\t\t\tcb(invDbID_)\n\t\tend)\n\n\tend)\nend\n\n-- Р”РѕР±Р°РІР»СЏРµС‚ РІ РёРЅРІРµРЅС‚Р°СЂСЊ\nnet_ReceiveProtected(\"IGS.Purchase\", function(pl)\n\tlocal sItemUID = net.ReadString()\n\n\tIGS_Purchase(pl, sItemUID, function(invDbID_, errMsg_)\n\t\tnet.Start(\"IGS.Purchase\")\n\t\t\tnet.WriteIGSError(errMsg_)\n\n\t\t\tif IGS.C.Inv_Enabled and not errMsg_ then\n\t\t\t\tnet.WriteUInt(invDbID_, IGS.BIT_INV_ID)\n\t\t\tend\n\t\tnet.Send(pl)\n\n\t\tif errMsg_ then\n\t\t\tlocal ITEM = IGS.GetItemByUID(sItemUID)\n\t\t\thook.Run(\"IGS.OnFailedPurchase\", pl, ITEM, errMsg_)\n\t\t\tIGS.Notify(pl,\"РћС€РёР±РєР° РїРѕРєСѓРїРєРё \" .. sItemUID .. \": \" .. errMsg_)\n\t\tend\n\tend)\nend)\n\n\n\n\n\n--[[-------------------------------------------------------------------------\n\tРђРљРўРР’РђР¦РРЇ\n---------------------------------------------------------------------------]]\nlocal function IGS_Activate(pl, invDbID, cb)\n\tif not IGS.C.Inv_Enabled then\n\t\tcb(nil, \"РРЅРІРµРЅС‚Р°СЂСЊ РѕС‚РєР»СЋС‡РµРЅ. РђРєС‚РёРІР°С†РёСЏ РїСЂРµРґРјРµС‚РѕРІ РјРѕРјРµРЅС‚Р°Р»СЊРЅР°СЏ\")\n\t\treturn\n\tend\n\n\tlocal INVITEM = IGS.Inventory(pl,\"map\")[invDbID]\n\tif not INVITEM then -- РµСЃР»Рё С‡РµР» СЂРµР·РєРѕ РґРІР°Р¶РґС‹ РєРЅРѕРїРєСѓ РЅР°Р¶Р°Р»\n\t\tcb(nil, \"РџСЂРµРґРјРµС‚ СѓР¶Рµ Р°РєС‚РёРІРёСЂРѕРІР°РЅ. ID: \" .. tostring(invDbID))\n\t\treturn\n\tend\n\n\tlocal IGSITEM = IGS.GetItemByUID(INVITEM.Item)\n\n\tlocal can,err = IGSITEM:CanActivate(pl, invDbID)\n\tif not can then\n\t\tcb(nil, err or \"РћС€РёР±РєР°\")\n\t\treturn\n\tend\n\n\t-- Р’С‹С€Рµ РµС‰Рµ РїСЂРѕРІРµСЂРєР°. Р­С‚Рѕ Р»РёС€РЅСЏСЏ, РЅРѕ РЅРµ РїРѕРјРµС€Р°РµС‚\n\tlocal tRemoved = IGS.DeletePlayerInventoryItemLocally(pl, invDbID)\n\tif (not tRemoved) then\n\t\tcb(nil, \"РџСЂРµРґРјРµС‚ СѓР¶Рµ Р°РєС‚РёРІРёСЂРѕРІР°РЅ #2\")\n\t\treturn\n\tend\n\n\tIGS.DeleteInventoryItem(function(ok)\n\t\tif not ok then -- РЅР°РїСЂРёРјРµСЂ, С‡РµСЂРµР· РїР°РЅРµР»СЊ \\/\n\t\t\tcb(nil, \"РџСЂРµРґРјРµС‚ РЅРµ РЅР°Р№РґРµРЅ. Р’РѕР·РјРѕР¶РЅРѕ, СѓР¶Рµ Р°РєС‚РёРІРёСЂРѕРІР°РЅ\")\n\t\t\treturn\n\t\tend\n\n\t\thook.Run(\"IGS.PlayerActivatedInventoryItem\", pl, IGSITEM, invDbID) -- РіРґРµ-С‚Рѕ РЅСѓР¶РЅРѕ РїРµСЂРµРґР°С‚СЊ invDbID РґР»СЏ log\n\t\tIGS.PlayerActivateItem(pl, IGSITEM:UID(), cb)\n\tend, invDbID)\nend\n\n-- РђРєС‚РёРІРёСЂСѓРµС‚ СѓСЃР»СѓРіСѓ, Р·Р°Р±РёСЂР°СЏ РµРµ РёР· РёРЅРІРµРЅС‚Р°СЂСЏ\nnet_ReceiveProtected(\"IGS.Activate\", function(pl)\n\tIGS_Activate(pl, net.ReadUInt(IGS.BIT_INV_ID), net.ReadBool() and function(iPurchID, sMsg_)\n\t\tnet.Start(\"IGS.Activate\")\n\t\t\tnet.WriteBool(iPurchID) -- OK\n\t\t\tif iPurchID then\n\t\t\t\tnet.WriteUInt(iPurchID, IGS.BIT_PURCH_ID)\n\t\t\tend\n\t\t\tnet.WriteIGSMessage(sMsg_) -- err || custom msg || nothing (СЃРµР№С‡Р°СЃ error only)\n\t\tnet.Send(pl)\n\tend or function() end)\nend)\n\n\n\n--[[-------------------------------------------------------------------------\n\tРљРЈРџРћРќР«\n---------------------------------------------------------------------------]]\nlocal function IGS_EnterCoupon(pl,sCode,cb)\n\tif string.Trim(sCode) == \"\" then\n\t\tcb(false, \"Р’РІРµРґРёС‚Рµ РєРѕРґ РєСѓРїРѕРЅР°\")\n\t\treturn\n\tend\n\n\t-- С…СѓРє СЋР·Р°РµС‚СЃСЏ РІ beauty code. Р’РЅСѓС‚СЂРё Р±РµСЂРµС‚СЃСЏ СЂРµР°Р»СЊРЅС‹Р№ РєСѓРїРѕРЅ РёР· Р‘Р”\n\t-- Р° С‚Р°РєР¶Рµ РјРѕР¶РЅРѕ СЋР·Р°С‚СЊ РґР»СЏ РІСЃСЏРєРѕРіРѕ СЂР°Р·РЅРѕРіРѕ, РЅР°РїСЂРёРјРµСЂ РєСѓРїРѕРЅС‹ РЅР° СЃРєРёРґРєСѓ\n\tlocal override,err_ = hook.Run(\"IGS.PlayerEnterCoupon\", pl, sCode)\n\tif override ~= nil then cb(override, err_) return end\n\n\tIGS.PlayerActivateCoupon(pl, sCode, cb)\nend\n\nnet_ReceiveProtected(\"IGS.UseCoupon\", function(pl)\n\tIGS_EnterCoupon(pl, net.ReadString(), function(ok, errMsg_)\n\t\tnet.Start(\"IGS.UseCoupon\")\n\t\t\tif not ok then\n\t\t\t\tnet.WriteIGSError(errMsg_ or \"unknown COUPON error\")\n\t\t\tend\n\t\tnet.Send(pl)\n\tend)\nend)\n\n\n\n\n--[[-------------------------------------------------------------------------\n\tРЎРЎР«Р›РљР\n---------------------------------------------------------------------------]]\nlocal hostname = assert(GetConVar(\"hostname\"), \"Error fetching server name\")\n\nnet_ReceiveProtected(\"IGS.GetPaymentURL\", function(pl)\n\tlocal sum  = net.ReadDouble()\n\tlocal desc = \"РџРѕР¶РµСЂС‚РІРѕРІР°РЅРёРµ \" .. IGS.SignPrice( IGS.PriceInCurrency(sum) ) ..  \" РЅР° \" .. hostname:GetString()\n\n\tIGS.GetPaymentURL(function(url)\n\t\tnet.Start(\"IGS.GetPaymentURL\")\n\t\t\tnet.WriteString(url)\n\t\tnet.Send(pl)\n\tend, pl:SteamID64(), sum, desc)\nend)\n\n\n--[[-------------------------------------------------------------------------\n\tРџРћРЎР›Р•Р”РќРР• РџРћРљРЈРџРљР\n---------------------------------------------------------------------------]]\nlocal cache,last_update = {},0\nhook.Add(\"IGS.PlayerPurchasedItem\", \"ResetLatestPurchasesCache\", function()\n\t-- https://trello.com/c/hEgPItm0/\n\ttable.Empty(cache)\n\tlast_update = 0\nend)\n\nlocal function IGS_GetLatestPurchases(pl, cb)\n\t-- РµСЃР»Рё РєСЌС€ СЃС‚Р°СЂРµРµ, С‡РµРј N РјРёРЅСѓС‚, С‚Рѕ РѕР±РЅРѕРІР»СЏРµРј Рё РѕС‚РїСЂР°РІР»СЏРµРј РёРіСЂРѕРєСѓ\n\t-- РРЅР°С‡Рµ РѕС‚РїСЂР°РІР»СЏРµРј РєСЌС€РёСЂРѕРІР°РЅРЅС‹Рµ РґР°РЅРЅС‹Рµ Р±РµР· РїРѕРІС‚РѕСЂРЅРіРѕРіРѕ РѕР±СЂР°С‰РµРЅРёСЏ Рє Р‘Р”\n\tif last_update + 5 * 60 \u003e= os.time() then\n\t\tcb(cache)\n\t\treturn\n\tend\n\n\t-- 10 РјРѕР¶РЅРѕ РїРѕРґРЅРёРјР°С‚СЊ РІРїР»РѕС‚СЊ РґРѕ 63. Р”Р°Р»СЊС€Рµ Р±СѓРґСѓС‚ РѕС€РёР±РєРё\n\tIGS.GetLatestPurchases(function(dat)\n\t\tcache = dat\n\t\tlast_update = os.time() -- CurTime РЅРµ СЋР·Р°С‚СЊ, С‡С‚РѕР±С‹ РЅРµ РїРѕР»СѓС‡Р°С‚СЊ РїСѓСЃС‚СѓСЋ С‚Р°Р±Р»РёС†Сѓ\n\n\t\tcb(dat)\n\tend,10)\nend\n\nnet_ReceiveProtected(\"IGS.GetLatestPurchases\", function(pl)\n\tIGS_GetLatestPurchases(pl,function(dat)\n\t\tnet.Start(\"IGS.GetLatestPurchases\")\n\t\t\tnet.WriteUInt(#dat,IGS.BIT_LATEST_PURCH)\n\n\t\t\tfor _,v in ipairs(dat) do\n\t\t\t\tnet.WriteIGSPurchase(v)\n\t\t\tend\n\t\tnet.Send(pl)\n\tend)\nend)\n\n\n--[[-------------------------------------------------------------------------\n\tРЎРџРРЎРћРљ РЎР’РћРРҐ РўР РђРќР—РђРљР¦РР™\n---------------------------------------------------------------------------]]\nlocal function IGS_GetMyTransactions(pl, cb)\n\tIGS.GetPlayerTransactions(cb, pl:SteamID64())\nend\n\nnet_ReceiveProtected(\"IGS.GetMyTransactions\", function(pl)\n\tIGS_GetMyTransactions(pl, function(dat)\n\t\tnet.Start(\"IGS.GetMyTransactions\")\n\t\t\tnet.WriteUInt(#dat, IGS.BIT_TX)\n\n\t\t\tfor _,v in ipairs(dat) do\n\t\t\t\tnet.WriteIGSTx(v)\n\t\t\tend\n\t\tnet.Send(pl)\n\tend)\nend)\n\n\n--[[-------------------------------------------------------------------------\n\tРЎРџРРЎРћРљ РЎР’РћРРҐ РџРћРљРЈРџРћРљ\n---------------------------------------------------------------------------]]\nlocal function IGS_GetMyPurchases(pl,cb)\n\tIGS.GetPlayerPurchases(pl:SteamID64(),cb)\nend\n\nnet_ReceiveProtected(\"IGS.GetMyPurchases\", function(pl)\n\tIGS_GetMyPurchases(pl,function(dat)\n\t\tnet.Start(\"IGS.GetMyPurchases\")\n\t\t\tnet.WriteUInt(#dat,8) -- to 255\n\n\t\t\tfor _,v in ipairs(dat) do\n\t\t\t\tnet.WriteIGSPurchase(v)\n\t\t\tend\n\t\tnet.Send(pl)\n\tend)\nend)\n\n\n--[[-------------------------------------------------------------------------\n\tРРќР’Р•РќРўРђР Р¬\n---------------------------------------------------------------------------]]\nlocal function IGS_GetInventory(pl,cb)\n\tcb( IGS.C.Inv_Enabled and IGS.Inventory(pl) or {} )\nend\n\nnet_ReceiveProtected(\"IGS.GetInventory\", function(pl)\n\tIGS_GetInventory(pl,function(inv)\n\t\t-- Р¤РёР»СЊС‚СЂСѓРµРј null РїСЂРµРґРјРµС‚С‹ РїРµСЂРµРґ РѕС‚РїСЂР°РІРєРѕР№ РєР»РёРµРЅС‚Сѓ\n\t\tlocal validInv = {}\n\t\tfor _,v in ipairs(inv) do\n\t\t\tlocal ITEM = IGS.GetItemByUID(v.Item)\n\t\t\tif not ITEM.isnull then\n\t\t\t\ttable.insert(validInv, v)\n\t\t\telse\n\t\t\t\t-- РЈРґР°Р»СЏРµРј null РїСЂРµРґРјРµС‚ РёР· Р‘Р”\n\t\t\t\tprint(\"[IGS] РћС‡РёСЃС‚РєР° null РїСЂРµРґРјРµС‚Р° РёР· РёРЅРІРµРЅС‚Р°СЂСЏ: \" .. v.Item .. \" (ID: \" .. v.ID .. \")\")\n\t\t\t\tIGS.DeleteInventoryItem(nil, v.ID)\n\t\t\tend\n\t\tend\n\t\t\n\t\tnet.Start(\"IGS.GetInventory\")\n\t\t\tnet.WriteUInt(#validInv,7) -- 127\n\t\t\tfor _,v in ipairs(validInv) do\n\t\t\t\tnet.WriteIGSInventoryItem(v)\n\t\t\tend\n\t\tnet.Send(pl)\n\tend)\nend)\n\n\nlocal function IGS_DropItem(pl,invId,cb)\n\tif not (IGS.C.Inv_Enabled and IGS.C.Inv_AllowDrop) then return end\n\tlocal canDrop = hook.Run(\"IGS.PlayerCanDropGift\", pl, invId)\n\tif canDrop == false then\n\t\treturn\n\tend\n\n\tIGS.PlayerEjectItem(function(ent)\n\t\tif (not ent) then return end -- РѕС€РёР±РєР°\n\n\t\ttimer.Simple(0,function() -- РёРЅРёС†РёР°Р»РёР·Р°С†РёСЏ СЌРЅС‚РёС‚Рё\n\t\t\tcb(ent)\n\t\t\thook.Run(\"IGS.PlayerDroppedGift\", pl, ent:GetUID(), invId, ent)\n\t\tend)\n\tend, pl, invId)\nend\n\nnet_ReceiveProtected(\"IGS.DropItem\",function(pl)\n\tIGS_DropItem(pl,net.ReadUInt(IGS.BIT_INV_ID),function(ent)\n\t\tnet.Start(\"IGS.DropItem\")\n\t\t\tnet.WriteEntity(ent)\n\t\tnet.Send(pl)\n\tend)\nend)\n\n\n\n\n\n\nhook.Add(\"IGS.PaymentStatusUpdated\",\"network\",function(pl,d)\n\tif checkNotReady(pl) then return end\n\n\tnet.Start(\"IGS.PaymentStatusUpdated\")\n\t\tnet.WriteString(d.paymentType) -- qiwi, card, sms\n\t\tnet.WriteString(d.orderSum) -- 228.28\n\t\tnet.WriteString(d.method) -- check, pay, error\n\n\t\tif d.errorMessage then\n\t\t\tnet.WriteString(d.errorMessage)\n\t\tend\n\tnet.Send(pl)\nend)\n\n-- РћС‚РєСЂС‹С‚РёРµ РјРµРЅСЋС€РєРё РЅР° С‡СѓР±Р·РёРєРµ\nfunction IGS.UI(pl)\n\tif checkNotReady(pl) then return end\n\n\tnet.Ping(\"IGS.UI\",pl)\nend\n","igs/network/nw_sh.lua":  "IGS.nw.Register(\"igs_lvl\")\n\t:Write(net.WriteUInt,7) -- 127\n\t:Read(function()\n\t\treturn IGS.LVL.Get(net.ReadUInt(7))\n\tend)\n:SetLocalPlayer()\n\n\nIGS.nw.Register(\"igs_balance\") -- Р”РѕР»Р¶РЅРѕ Р±С‹С‚СЊ РўРћР›Р¬РљРћ Сѓ РєР»РёРµРЅС‚РѕРІ!\n\t:Write(net.WriteDouble)\n\t:Read(net.ReadDouble)\n:SetLocalPlayer() --:SetHook(\"OnIGSBalanceChanged\")\n\n\nIGS.nw.Register(\"igs_total_transactions\")\n\t:Write(net.WriteUInt,17) -- 131071\n\t:Read(net.ReadUInt,17)\n:SetLocalPlayer()\n\n\nIGS.nw.Register(\"igs_purchases\"):Write(function(v)\n\tnet.WriteUInt(#v, 9) -- 511\n\n\tfor _,id in ipairs(v) do\n\t\tnet.WriteUInt(id,9)\n\tend\nend):Read(function()\n\n\tlocal res = {}\n\tfor _ = 1,net.ReadUInt(9) do\n\t\tlocal uid = IGS.GetItemByID( net.ReadUInt(9) ):UID()\n\t\tres[uid] = res[uid] and (res[uid] + 1) or 1\n\tend\n\n\treturn res\nend):SetLocalPlayer():SetHook(\"IGS.PlayerPurchasesLoaded\")\n\n\n-- https://img.qweqwe.ovh/1492003125937.png\nIGS.nw.Register(\"igs_settings\")\n\t:Write(function(t)\n\t\tnet.WriteUInt(t[1],10) -- minimal charge (max 1023)\n\t\tnet.WriteDouble(t[2])  -- currecy price\n\tend)\n\t:Read(function()\n\t\treturn {\n\t\t\tnet.ReadUInt(10), -- charge\n\t\t\tnet.ReadDouble(), -- price\n\t\t}\n\tend)\n:SetGlobal():SetHook(\"IGS.OnSettingsUpdated\")\n\n\n\n--[[--------------\n\tCONSTANTS\n----------------]]\nIGS.BIT_TX = 8 -- max С‚СЂР°РЅР· РІ РЅРµС‚РІРѕСЂРєРµ (255)\nIGS.BIT_LATEST_PURCH = 6 -- 63\n\n-- Р Р°Р·РјРµСЂ СЏС‡РµР№РєРё\nIGS.BIT_PURCH_ID = 32 -- 4294967295\nIGS.BIT_INV_ID = 32\nIGS.BIT_TX_ID = 32\n\n\n--[[--------------\n\t.net Helpers\n----------------]]\nfunction net.WriteIGSItem(ITEM) net.WriteUInt(ITEM:ID(),9) end\nfunction net.ReadIGSItem() return IGS.GetItemByID(net.ReadUInt(9)) end\n-- function net.WriteIGSGroup(GROUP) net.WriteString(GROUP:Name()) end\n-- function net.ReadIGSGroup() return IGS.GetGroup(net.ReadString()) end\n\nlocal function writeIf(value, fWrite, arg_)\n\t-- Server = 0 Р·Р°РїРёСЃС‹РІР°Р» false, С…РѕС‚СЊ СЌС‚Рѕ Р·РЅР°С‡РµРЅРёРµ\n\t-- Р”Р»СЏ РѕС‚Р»РѕРІР° Р±Р°РіР° Р±С‹Р»Р° С‚Р°РєР°СЏ С€С‚СѓРєР°:\n\t-- https://img.qweqwe.ovh/1567089471715.png\n\tnet.WriteBool(value ~= nil)\n\tif value then\n\t\tfWrite(value, arg_)\n\tend\nend\n\nlocal function readIf(fRead, arg_)\n\treturn net.ReadBool() and fRead(arg_)\nend\n\nfunction net.WriteIGSPurchase(p)\n\tnet.WriteUInt(p.ID,IGS.BIT_PURCH_ID)\n\tnet.WriteString(p.Item)\n\n\twriteIf(p.Server,  net.WriteUInt, 6) -- 63\n\twriteIf(p.Purchase,net.WriteUInt, 32)\n\twriteIf(p.Expire,  net.WriteUInt, 32)\n\twriteIf(p.Nick,    net.WriteString)\nend\n\nfunction net.ReadIGSPurchase()\n\treturn {\n\t\tid       = net.ReadUInt(IGS.BIT_PURCH_ID),\n\t\titem     = net.ReadString(),\n\n\t\tserver   = readIf(net.ReadUInt, 6),\n\t\tpurchase = readIf(net.ReadUInt, 32),\n\t\texpire   = readIf(net.ReadUInt, 32),\n\t\tnick     = readIf(net.ReadString),\n\t}\nend\n\nfunction net.WriteIGSTx(tx)\n\tnet.WriteUInt(tx.ID, IGS.BIT_TX_ID)\n\twriteIf(tx.Server, net.WriteUInt, 6) -- 63\n\tnet.WriteDouble(tx.Sum)\n\tnet.WriteUInt(tx.Time, 32) -- dohuya\n\twriteIf(tx.Note, net.WriteString)\nend\n\nfunction net.ReadIGSTx()\n\treturn {\n\t\tid     = net.ReadUInt(IGS.BIT_TX_ID),\n\t\tserver = readIf(net.ReadUInt, 6),\n\t\tsum    = net.ReadDouble(),\n\t\tdate   = net.ReadUInt(32), -- timestamp\n\t\tnote   = readIf(net.ReadString),\n\t}\nend\n\nfunction net.WriteIGSInventoryItem(inv_it)\n\tnet.WriteUInt(inv_it.ID, IGS.BIT_INV_ID)\n\tnet.WriteString(inv_it.Item)\nend\n\nfunction net.ReadIGSInventoryItem()\n\treturn {\n\t\tid = net.ReadUInt(IGS.BIT_INV_ID),\n\t\titem = IGS.GetItemByUID(net.ReadString()),\n\t}\nend\n\nfunction net.WriteIGSMessage(sErr)\n\twriteIf(sErr, net.WriteString)\nend\n\nfunction net.ReadIGSMessage()\n\treturn net.ReadBool() and net.ReadString()\nend\n\nnet.WriteIGSError = net.WriteIGSMessage\nnet.ReadIGSError  = net.ReadIGSMessage\n\n\n\nif SERVER then\n\tlocal first_time_trigger = true -- РЅРµ РїРѕР·РІРѕР»СЏРµС‚ РІС‹РїРѕР»РЅРёС‚СЊСЃСЏ IGS.GetMinCharge() Рё IGS.GetCurrencyPrice(), РїРѕСЃРєРѕР»СЊРєСѓ Р±СѓРґРµС‚ РѕС€РёР±РєР° РёР·-Р·Р° nil РІРЅСѓС‚СЂРё net РІР°СЂР°\n\tfunction IGS.UpdateMoneySettings(iMinCharge,iCurrencyPrice)\n\t\tiMinCharge     = tonumber(iMinCharge)\n\t\tiCurrencyPrice = tonumber(iCurrencyPrice)\n\n\t\t-- РљРµС€ СЃС‚Р°СЂС‹С… РґР°РЅРЅС‹С…\n\t\tlocal min_charge = first_time_trigger and 0 or IGS.GetMinCharge()\n\t\tlocal cur_price  = first_time_trigger and 0 or IGS.GetCurrencyPrice()\n\t\tfirst_time_trigger = nil\n\n\t\tlocal min_charge_changed = min_charge ~= iMinCharge\n\t\tlocal cur_price_changed  = cur_price  ~= iCurrencyPrice\n\n\t\tif min_charge_changed or cur_price_changed then\n\t\t\tIGS.nw.SetGlobal(\"igs_settings\",{\n\t\t\t\tiMinCharge,\n\t\t\t\tiCurrencyPrice\n\t\t\t})\n\n\t\t\thook.Run(\"IGS.OnSettingsUpdated\")\n\n\t\t\t-- РњРѕР¶РµС‚ РёР·РјРµРЅРёС‚СЊСЃСЏ СЃСЂР°Р·Сѓ РґРІРµ РІРµС‰Рё\n\t\t\tif min_charge_changed then\n\t\t\t\tIGS.NotifyAll(\"РР·РјРµРЅРµРЅР° РјРёРЅРёРјР°Р»СЊРЅР°СЏ СЃСѓРјРјР° РїРѕРїРѕР»РЅРµРЅРёСЏ: \" .. (\"(%s \u003e %s СЂСѓР±)\"):format(min_charge,iMinCharge))\n\t\t\tend\n\n\t\t\tif cur_price_changed then\n\t\t\t\tIGS.NotifyAll(\"РЎС‚РѕРёРјРѕСЃС‚СЊ РґРѕРЅР°С‚ РІР°Р»СЋС‚С‹ РёР·РјРµРЅРµРЅР° СЃ \" .. cur_price .. \" РґРѕ \" .. iCurrencyPrice .. \" СЂСѓР± Р·Р° РµРґРёРЅРёС†Сѓ\")\n\t\t\tend\n\t\tend\n\tend\nend\n","igs/objects/level.lua":  "IGS.LVL = IGS.LVL or setmetatable({\n\tMAP    = {},\n\tSTORED = {}\n},{\n\t__call = function(self,...)\n\t\treturn self.Add(...)\n\tend\n})\n\n\n\nlocal LVL = {}\nLVL.__index = LVL\n\nfunction LVL:SetBonus(fOnReach)\n\tself.bonus = fOnReach -- ply in args\n\treturn self\nend\n\nfunction LVL:SetName(sName) -- OUTDATED (СѓРґР°Р»РµРЅРѕ 2018.03.12)\n\tself.name = sName\n\treturn self\nend\n\nfunction LVL:SetDescription(sDesc)\n\tself.description = sDesc\n\treturn self\nend\n\nfunction LVL:Name()\n\treturn self.name\nend\n\nfunction LVL:Description()\n\treturn self.description\nend\n\nfunction LVL:LVL()\n\treturn self.lvl\nend\n\nfunction LVL:Cost()\n\treturn self.cost\nend\n\nfunction LVL:GetNext() -- may be nil\n\tlocal ilvl,OBJ = next(IGS.LVL.MAP,self.lvl)\n\treturn OBJ,ilvl\nend\n\n-- Р Р°Р·РЅРёС†Р° РјРµР¶РґСѓ СѓСЂРѕРІРЅСЏРјРё\n-- function LVL:NeedToRaise() -- nil on last lvl\n-- \tlocal n = self:GetNext()\n-- \treturn n and n.cost - self.cost\n-- end\n\nfunction IGS.LVL.Add(iNeedSum, sName)\n\tlocal OBJ = setmetatable({\n\t\tcost = iNeedSum,\n\t\tname = sName\n\t},LVL)\n\n\tIGS.LVL.STORED[iNeedSum] = OBJ\n\tIGS.LVL.Rearrange()\n\n\treturn OBJ\nend\n\nfunction IGS.LVL.Get(iLVL)\n\treturn IGS.LVL.MAP[iLVL]\nend\n\n-- Р”Р°РµС‚ РѕР±СЉРµРєС‚ Р»РІР», СЃРѕРѕС‚РІРµС‚СЃС‚РІСѓСЋС‰РёР№ СѓРєР°Р·Р°РЅРЅРѕР№ СЃСѓРјРјРµ\nfunction IGS.LVL.GetByCost(iRealCost)\n\tfor lvl = 1,#IGS.LVL.MAP do\n\t\tif !IGS.LVL.MAP[lvl + 1] or IGS.LVL.MAP[lvl + 1].cost \u003e iRealCost then\n\t\t\treturn IGS.LVL.MAP[lvl]\n\t\tend\n\tend\nend\n\n-- РЈСЂРѕРІРЅРё РІ РґРёР°РїР°Р·РѕРЅРµ СЃС‚РѕРёРјРѕСЃС‚Рё.\n-- РќР°С‡Р°Р»Рѕ СЋР·Р°С‚СЊСЃСЏ РїСЂРё РІС‹РґР°С‡Рµ Р±РѕРЅСѓСЃРѕРІ Р·Р° РїРѕРїРѕР»РЅРµРЅРёРµ: https://trello.com/c/EjmPOeso/476--\n-- function IGS.LVL.GetRange(iFromCost, iToCost)\n-- \tlocal t = {}\n\n-- \tfor iLVL,lvl in ipairs(IGS.LVL.MAP) do\n-- \t\tif lvl.cost \u003e= iFromCost and lvl.cost \u003c= iToCost then\n-- \t\t\ttable.insert(t,lvl)\n-- \t\tend\n-- \tend\n\n-- \treturn t\n-- end\n\n-- РџРµСЂРµСЃС‚СЂР°РёРІР°РµС‚ РєСЌС€ РїРѕСЂСЏРґРєР° Р»РµРІРµР»РѕРІ\n-- РќСѓР¶РЅРѕ РЅР° СЃР»СѓС‡Р°Р№, РµСЃР»Рё СЃРЅР°С‡Р°Р»Р° РґРѕР±Р°РІРёР»Рё 30 Р»РІР», Р° РїРѕС‚РѕРј 10\n-- С‚Рѕ С‡С‚РѕР±С‹ РЅРµ СЃС‡РёС‚Р°Р»РѕСЃСЊ, С‡С‚Рѕ 30 РЅРёР¶Рµ 10\nfunction IGS.LVL.Rearrange()\n\tIGS.LVL.MAP = {} -- reset\n\n\tlocal i = 0\n\tfor sum in SortedPairs(IGS.LVL.STORED) do\n\t\t-- РґРѕР»РіРѕ РѕР±СЉСЏСЃРЅСЏС‚СЊ. РљРѕСЂРѕС‡Рµ СЃРѕСЂС‚РµРґРїСЌРёСЂСЃ РїРѕ С…РѕРґСѓ РєРѕРїРёСЂСѓРµС‚ РѕР±СЉРµРєС‚ РїРµСЂРµРґ С‚РµРј,\n\t\t-- РєР°Рє РІРµСЂРЅСѓС‚СЊ РµРіРѕ РІ С†РёРєР» Рё РЅРµР»СЊР·СЏ СЃРґРµР»Р°С‚СЊ for sum,OBJ\n\t\tlocal OBJ = IGS.LVL.STORED[sum]\n\t\ti = i + 1\n\t\tOBJ.lvl = i\n\n\t\tIGS.LVL.MAP[i] = OBJ\n\tend\nend","igs/objects/shop_group.lua":  "--[[-------------------------------------------------------------------------\nР’ РјР°РіР°Р·РёРЅРµ РµСЃС‚СЊ РєР°С‚РµРіРѕСЂРёРё, Р° РµСЃС‚СЊ РіСЂСѓРїРїС‹ С‚РѕРІР°СЂРѕРІ.\n\nРљР°С‚РµРіРѕСЂРёСЏ - СЌС‚Рѕ РіСЂСѓРїРїР° РїРѕРґРѕР±РЅС‹С… С‚РѕРІР°СЂРѕРІ.\nРќР°РїСЂРёРјРµСЂ, РІРёРїС‹ Рё РїСЂРµРјРёСѓРјС‹\n\nР“СЂСѓРїРїР° СЌС‚Рѕ РјРѕР¶РµС‚ Р±С‹С‚СЊ СЂР°Р·РЅРѕРІРёРґРЅРѕСЃС‚СЊ РѕРґРЅРѕРіРѕ С‚РѕРІР°СЂР°.\nРќР°РїСЂРёРјРµСЂ РіСЂСѓРїРїР° РІРёРї РїСЂР°РІ СЃРѕРґРµСЂР¶РёС‚ РІ СЃРµР±Рµ РІРёРї РЅР° РЅРµРґРµР»СЋ, РјРµСЃСЏС†, РЅР°РІСЃРµРіРґР° Рё С‚.Рґ.\n\nР­С‚РѕС‚ С„Р°Р№Р» РїСЂРµРґСЃС‚Р°РІР»СЏРµС‚ СЃРѕР±РѕР№ СЂРµРіРёСЃС‚СЂР°С‚РѕСЂ Р“Р РЈРџРџ\n---------------------------------------------------------------------------]]\n\nlocal ITEM_GROUP = {}\nITEM_GROUP.__index = ITEM_GROUP\nITEM_GROUP.__tostring = function(self)\n\t-- \"ITEM GROUP (Name Of Group) [i]\"\n\treturn \"IGS GROUP (\" .. self:Name() .. \")[\" .. #self:Items() .. \"]\"\nend\ndebug.getregistry().IGSGroup = ITEM_GROUP\n\n\n\n-- Fade, Tiger, Damascus\nfunction ITEM_GROUP:AddItem(STORE_ITEM,sNameOverride)\n\tif self.items.STORED[STORE_ITEM:UID()] then\n\t\treturn self.items.STORED[STORE_ITEM:UID()]\n\tend\n\n\tlocal dat = {\n\t\titem = STORE_ITEM,\n\t\tname = sNameOverride or STORE_ITEM:Name()\n\t}\n\n\tlocal ID = #self.items.MAP + 1\n\tself.items.MAP[ID] = dat\n\tself.items.STORED[STORE_ITEM:UID()] = dat\n\n\tSTORE_ITEM.group = self\n\n\treturn self.items.MAP[ID]\nend\n\nfunction ITEM_GROUP:SetIcon(sIconUrl)\n\tself.icon_url = sIconUrl\n\treturn self\nend\n\nfunction ITEM_GROUP:SetHighlightColor(color)\n\tif CLIENT then\n\t\tself.highlight = color\n\tend\n\treturn self\nend\n\n\n\n\nfunction ITEM_GROUP:Name()\n\treturn self.name\nend\n\nfunction ITEM_GROUP:UID() -- TODO\n\treturn self:Name()\nend\n\nfunction ITEM_GROUP:Items()\n\treturn self.items.MAP\nend\n\nfunction ITEM_GROUP:ICON()\n\treturn self.icon_url\nend\n\n\n\n\nIGS.GROUPS = IGS.GROUPS or {}\n\n-- Flip Knifes\nfunction IGS.NewGroup(sName)\n\tif IGS.GROUPS[sName] then\n\t\treturn IGS.GROUPS[sName]\n\tend\n\n\tlocal group = setmetatable({\n\t\tname = sName,\n\t\titems = {\n\t\t\tMAP    = {}, -- iter, STORED\n\t\t\tSTORED = {}  -- STORE_ITEM:UID(),\n\t\t},\n\t},ITEM_GROUP)\n\n\tIGS.GROUPS[sName] = group\n\n\treturn group\nend\n\nfunction IGS.GetGroups()\n\treturn IGS.GROUPS\nend\n\nfunction IGS.GetGroup(name)\n\treturn IGS.GROUPS[name]\nend","igs/objects/shop_item.lua":  "setmetatable(IGS,{\n\t__call = function(self,...)\n\t\treturn self.AddItem(...)\n\tend\n})\n\n\n--[[-------------------------------------------------------------------------\n\tРњРђРљРЎРРњРђР›Р¬РќРћР• РљРћР›-Р’Рћ РЈР›РЈР§РЁР•РќРР™ 255\n---------------------------------------------------------------------------]]\n\nlocal STORE_ITEM = FindMetaTable(\"IGSItem\") or {}\nSTORE_ITEM.__index = STORE_ITEM\ndebug.getregistry().IGSItem = STORE_ITEM\n\nlocal function set(self,var,val)\n\tself[var] = val\n\treturn self\nend\n\n\n--[[-------------------------------------------------------------------------\n\tGET values (РґР»СЏ С‚РµС… Р·РЅР°С‡РµРЅРёР№, С‡С‚Рѕ РЅРµР»СЊР·СЏ Set)\n---------------------------------------------------------------------------]]\nfunction STORE_ITEM:Name()\n\treturn self.name\nend\n\nfunction STORE_ITEM:UID()\n\treturn self.uid\nend\n\nfunction STORE_ITEM:ID()\n\treturn self.id\nend\n\n-- VIP, Huntsman Knifes. РџСЂРёСЃРІР°РёРІР°РµС‚СЃСЏ С‡РµСЂРµР· GROUP:AddItem\nfunction STORE_ITEM:Group()\n\treturn self.group\nend\n\n--[[-------------------------------------------------------------------------\n\tSET/GET values\n---------------------------------------------------------------------------]]\n-- Double С†РµРЅР° С‚РѕРІР°СЂР° РІ СЂРµР°Р»СЊРЅРѕР№ РІР°Р»СЋС‚Рµ (РЅРµ Р°РІС‚РѕРґРѕРЅР°С‚Р°)\nfunction STORE_ITEM:SetPrice(iPrice)\n\treturn set(self,\"price\",iPrice)\nend\n\nfunction STORE_ITEM:Price()\n\treturn self.price\nend\n\n-- РџРѕР»СѓС‡РёС‚СЊ С„РёРЅР°Р»СЊРЅСѓСЋ С†РµРЅСѓ СЃ СѓС‡РµС‚РѕРј СЃРєРёРґРѕРє (РёРЅРґРёРІРёРґСѓР°Р»СЊРЅРѕР№ РёР»Рё РіР»РѕР±Р°Р»СЊРЅРѕР№)\nfunction STORE_ITEM:GetFinalPrice()\n\t-- Р•СЃР»Рё РµСЃС‚СЊ РёРЅРґРёРІРёРґСѓР°Р»СЊРЅР°СЏ СЃРєРёРґРєР°, РёСЃРїРѕР»СЊР·СѓРµРј РµС‘\n\tif self.discounted_from then\n\t\treturn self.price\n\tend\n\t\n\t-- РРЅР°С‡Рµ РїСЂРёРјРµРЅСЏРµРј РіР»РѕР±Р°Р»СЊРЅСѓСЋ СЃРєРёРґРєСѓ (РµСЃР»Рё РµСЃС‚СЊ)\n\tif IGS.HasGlobalDiscount then\n\t\treturn IGS.GetDiscountedPrice(self.price)\n\tend\n\t\n\treturn self.price\nend\n\n-- РЎР±СЂР°СЃС‹РІР°РµС‚ С‚РµРєСѓС‰РµРµ РѕРїРёСЃР°РЅРёРµ Рё СѓСЃС‚Р°РЅР°РІР»РёРІР°РµС‚ СѓРєР°Р·Р°РЅРЅРѕРµ, РµСЃР»Рё РЅРµ СѓРєР°Р·Р°С‚СЊ bAppand\nfunction STORE_ITEM:SetDescription(sDesc,bAppend)\n\treturn set(self,\"description\",bAppend and (self:Description() .. sDesc) or sDesc)\nend\n\nfunction STORE_ITEM:Description()\n\treturn self.description\nend\n\n-- РЎСЃС‹Р»РєР° РЅР° РєР°СЂС‚РёРЅРєСѓ РёРєРѕРЅРєРё С‚РѕРІР°СЂР° 1:1. Р–РµР»Р°С‚РµР»СЊРЅРѕ РјРёРЅРёРјСѓРј 100 px\n-- РР»Рё Р¶Рµ РїСѓС‚СЊ Рє РјРѕРґРµР»СЊРєРµ, РЅРѕ С‚РѕРіРґР° РІС‚РѕСЂС‹Рј Р°СЂРіСѓРјРµРЅС‚РѕРј СѓРєР°Р·Р°С‚СЊ true\nfunction STORE_ITEM:SetIcon(sIcon, bIsModel)\n\treturn CLIENT and set(self,\"icon\",{\n\t\ticon    = sIcon,\n\t\tisModel = bIsModel,\n\t}) or self\nend\n\nfunction STORE_ITEM:ICON()\n\tif self.icon then\n\t\treturn self.icon[\"icon\"], self.icon[\"isModel\"]\n\tend\nend\n\n-- Р¦РІРµС‚ РїРѕРґСЃРІРµС‚РєРё Р·Р°РіРѕР»РѕРІРєР° РёС‚РµРјР° РІ СЃРїРёСЃРєРµ\nfunction STORE_ITEM:SetHighlightColor(color)\n\treturn CLIENT and set(self,\"highlight\",color) or self\nend\n\nfunction STORE_ITEM:GetHighlightColor()\n\treturn self.highlight\nend\n\n-- РџРµСЂРјР°РїСѓС€РєРё, РїСЂР°РІР°, РіСЂСѓРїРїС‹, СѓСЂРѕРІРЅРё\nfunction STORE_ITEM:SetCategory(sCat, sIcon)\n\tset(self,\"category\",sCat)\n\t\n\t-- РЎРѕС…СЂР°РЅСЏРµРј РёРєРѕРЅРєСѓ РєР°С‚РµРіРѕСЂРёРё РІ РіР»РѕР±Р°Р»СЊРЅСѓСЋ С‚Р°Р±Р»РёС†Сѓ\n\tif sIcon and CLIENT then\n\t\tIGS.CategoryIcons = IGS.CategoryIcons or {}\n\t\tIGS.CategoryIcons[sCat] = sIcon\n\tend\n\t\n\treturn self\nend\n\nfunction STORE_ITEM:Category()\n\treturn self.category\nend\n\n-- РЎСЂРѕРє РІ РґРЅСЏС…, РЅР° РєРѕС‚РѕСЂС‹Р№ РІС‹РґР°РµС‚СЃСЏ СѓСЃР»СѓРіР°. 0 РµСЃР»Рё РѕРґРЅРѕСЂР°Р·РѕРІР°СЏ. nil, РµСЃР»Рё РІРµС‡РЅР°СЏ\nfunction STORE_ITEM:SetTerm(iDays)\n\treturn set(self,\"termin\",iDays)\nend\n\nfunction STORE_ITEM:SetPerma()\n\treturn self:SetTerm(nil)\nend\n\nfunction STORE_ITEM:Term()\n\treturn self.termin\nend\n\n-- Р”Р°РµС‚ РІРѕР·РјРѕР¶РЅРѕСЃС‚СЊ РјСѓР»СЊС‚РёРїРѕРєСѓРїРєРё. РџРѕР»РµР·РЅРѕ РґР»СЏ Р»РёРјРёС‚Р° РїСЂРѕРїРѕРІ, РїР°С‚СЂРѕРЅРѕРІ РїСЂРё СЃРїР°РІРЅРµ Рё С‚.Рґ.\nfunction STORE_ITEM:SetStackable(b)\n\treturn set(self,\"stackable\",b ~= false) -- nil = true; 1 = true; true = true; false = false\nend\n\nfunction STORE_ITEM:IsStackable()\n\treturn self.stackable\nend\n\n-- РќСѓР¶РЅР° Р»Рё РёРЅС„РѕСЂРјР°С†РёСЏ Рѕ РїРѕРєСѓРїРєРµ РЅР° РєР»РёРµРЅС‚СЃР°Р№РґРµ? (Р‘СѓРґРµС‚ РІ IGS.PlayerPurchases(ply))\nfunction STORE_ITEM:SetNetworked(b)\n\treturn set(self,\"networked\",b ~= false)\nend\n\nfunction STORE_ITEM:IsNetworked()\n\treturn self.networked\nend\n\n-- Р‘Р°РЅРЅРµСЂ С‚РѕРІР°СЂР°. Р‘СѓРґРµС‚ РѕС‚РѕР±СЂР°Р¶РµРЅ РїРѕРґ РёРЅС„РѕСЂРјР°С†РёРµР№ Рѕ С‚РѕРІР°СЂРµ. Р РµРєРѕРјРµРЅРґСѓРµРјС‹Р№ СЂР°Р·РјРµСЂ 1000С…400\nfunction STORE_ITEM:SetImage(sUrl)\n\treturn set(self,\"image_url\",sUrl)\nend\n\nfunction STORE_ITEM:IMG()\n\treturn self.image_url\nend\n\n-- РќРµР»СЊР·СЏ РєСѓРїРёС‚СЊ, РЅРѕ РјРѕР¶РЅРѕ Р°РєС‚РёРІРёСЂРѕРІР°С‚СЊ СЃ РёРЅРІРµРЅС‚Р°СЂСЏ.\n-- РџРѕР»РµР·РЅРѕ, С‡С‚РѕР±С‹ \"СѓРґР°Р»СЏС‚СЊ\" РЅРµРЅСѓР¶РЅС‹Рµ, РЅРѕ РµС‰Рµ Р°РєС‚РёРІРЅС‹Рµ Сѓ Р»СЋРґРµР№ РёС‚РµРјС‹\nfunction STORE_ITEM:SetHidden(b)\n\treturn set(self,\"hidden\",b ~= false)\nend\n\nfunction STORE_ITEM:IsHidden()\n\treturn self.hidden\nend\n\n-- Р”Р»СЏ СѓРґРѕР±РЅРѕР№ СѓСЃС‚Р°РЅРѕРІРєРё РјРµС‚Р°РґР°РЅРЅС‹С… РёС‚РµРјСѓ РІРјРµСЃС‚Рѕ ITEM.key = val (РїРѕР»РµР·РЅРѕ РІРЅСѓС‚СЂРё С„СѓРЅРєС†РёР№, С‚РёРїР° GROUP:Add(ITEM))\nfunction STORE_ITEM:SetMeta(key, value)\n\tif (not self.meta) then self.meta = {} end\n\tself.meta[key] = value\n\treturn self\nend\n\nfunction STORE_ITEM:GetMeta(key)\n\treturn self.meta and self.meta[key]\nend\n\nfunction STORE_ITEM:SetDiscountedFrom(i) -- internal\n\treturn set(self,\"discounted_from\", i)\nend\n\n-- function STORE_ITEM:DiscountedFrom()\n-- \treturn self.discounted_from\n-- end\n\n\n\n--[[-------------------------------------------------------------------------\n\tР¤СѓРЅРєС†РёРё\n---------------------------------------------------------------------------]]\n-- С„СѓРЅРєС†РёРё РїРµСЂРµРґР°РµС‚СЃСЏ РёРіСЂРѕРє\n-- Р”РѕР»Р¶РЅР° РІРµСЂРЅСѓС‚СЊ РћРЁРР‘РљРЈ (СЃС‚СЂРѕРєСѓ) РёР»Рё nil/false, РµСЃР»Рё РІСЃРµ РѕРє\nfunction STORE_ITEM:SetCanBuy(fCallback)\n\treturn SERVER and set(self,\"canbuy\",fCallback) or self\nend\n\n-- РџРѕСЃР»Рµ СѓРґР°С‡РЅРѕР№ РїРѕРєСѓРїРєРё РїРµСЂРµРґР°РµС‚ РІ РєР°Р»Р»Р±СЌРє РёРіСЂРѕРєР°\nfunction STORE_ITEM:SetOnBuy(fCallback)\n\treturn SERVER and set(self,\"onbuy\",fCallback) or self\nend\n\n-- \"РЈСЃС‚Р°РЅРѕРІС‰РёРє\" СѓСЃР»СѓРіРё. Р’РЅСѓС‚СЂРµРЅРЅСЏСЏ С„СѓРЅРєС†РёСЏ, С‡С‚РѕР±С‹ РЅРµ РѕРІРµСЂСЂР°Р№РґРёС‚СЊ :SetOnActivate\n-- РћСЃС‚РѕСЂРѕР¶РЅРµРµ РІ РєРѕРјР±РёРЅР°С†РёРё СЃ :SetValidator\nfunction STORE_ITEM:SetInstaller(fCallback)\n\treturn SERVER and set(self,\"installer\",fCallback) or self\nend\n\n-- РљР°Рє Рё SetCanBuy, РЅРѕ РґР»СЏ Р°РєС‚РёРІР°С†РёРё СЃ РёРЅРІРµРЅС‚Р°СЂСЏ\nfunction STORE_ITEM:SetCanActivate(fCallback)\n\treturn SERVER and set(self,\"canactivate\",fCallback) or self\nend\n\n-- Р”Р»СЏ РІС‹РґР°С‡Рё Р±РѕРЅСѓСЃРѕРІ etc. РРіСЂРѕРє РІ РєР°Р»Р»Р±СЌРєРµ\n-- Р’С‹РїРѕР»РЅСЏС‚СЊ С‚РѕР»СЊРєРѕ РїСЂРё СЂРµР°Р»СЊРЅРѕР№ Р°РєС‚РёРІР°С†РёРё РёРіСЂРѕРєРѕРј РёР»Рё РІС‹РґР°С‡Рµ С‡РµСЂРµР· РїР°РЅРµР»СЊ,\n-- Р° РЅРµ Р°РІС‚РѕРІРѕСЃСЃС‚Р°РЅРѕРІР»РµРЅРёРё etc\nfunction STORE_ITEM:SetOnActivate(fCallback)\n\treturn SERVER and set(self,\"onactivate\",fCallback) or self\nend\n\n-- Р•СЃР»Рё fChecker РІРµСЂРЅРµС‚ false, С‚Рѕ РІС‹РїРѕР»РЅРёС‚СЃСЏ installer\nfunction STORE_ITEM:SetValidator(fChecker)\n\treturn SERVER and set(self,\"validator\",fChecker) or self\nend\n\nif SERVER then\n\tfunction STORE_ITEM:Setup(pl) -- РІРЅСѓС‚СЂРµРЅРЅСЏСЏ\n\t\tif self.installer then\n\t\t\tself.installer(pl)\n\t\tend\n\tend\n\n\tfunction STORE_ITEM:OnActivate(pl) -- РїСѓР±Р»РёС‡РЅР°СЏ\n\t\tself:Setup(pl)\n\n\t\tif self.onactivate then\n\t\t\tself.onactivate(pl)\n\t\tend\n\tend\n\n\t-- РђРєС‚РёРІР°С†РёСЏ\n\t-- Р’РѕР·РІСЂР°С‰Р°РµС‚ boolErr Рё errMsg\n\tfunction STORE_ITEM:CanActivate(pl, iInvId)\n\t\tif (not self:IsStackable() and pl:HasPurchase( self:UID() )) then\n\t\t\treturn false,\"РЈСЃР»СѓРіР° СѓР¶Рµ Р°РєС‚РёРІРЅР°\"\n\t\tend\n\n\t\tlocal canActivate,err = hook.Run(\"IGS.CanPlayerActivateItem\", pl, self, iInvId)\n\t\tif canActivate ~= nil then\n\t\t\treturn canActivate,err\n\t\tend\n\n\t\tif self.canactivate then\n\t\t\tlocal er = self.canactivate(pl, iInvId)\n\t\t\tif er then\n\t\t\t\treturn false,er\n\t\t\tend\n\t\tend\n\n\t\treturn true\n\tend\n\n\t-- РџРѕРєСѓРїРєР°\n\tfunction STORE_ITEM:CanBuy(pl)\n\t\tlocal canBuy,err = hook.Run(\"IGS.CanPlayerBuyItem\", pl, self)\n\t\tif canBuy ~= nil then\n\t\t\treturn canBuy,err\n\t\tend\n\n\t\tif self.canbuy then\n\t\t\tlocal er = self.canbuy(pl)\n\t\t\tif er then -- РћР±СЂР°С‚РЅР°СЏ СЃРѕРІРјРµСЃС‚РёРјРѕСЃС‚СЊ СЃ SetCanBuy\n\t\t\t\treturn false,er\n\t\t\tend\n\t\tend\n\n\t\treturn true\n\tend\n\tfunction STORE_ITEM:Buy(pl)\n\t\tif self.onbuy then\n\t\t\tself.onbuy(pl)\n\t\tend\n\tend\n\n\t-- Р Р°Р·РЅС‹Рµ С„СѓРЅРєС†РёРё\n\tfunction STORE_ITEM:IsValid(pl)\n\t\tif self.validator then\n\t\t\treturn self.validator(pl)\n\t\tend\n\tend\nend\n\n\n--[[-------------------------------------------------------------------------\n\tMISC\n---------------------------------------------------------------------------]]\n-- Р’СЃС‚Р°РІРєР° СЌС‚РѕРіРѕ РёС‚РµРјР° РІ С‚Р°Р±Р»РёС†Сѓ РїРѕРґ СѓРєР°Р·Р°РЅРЅС‹Рј РєР»СЋС‡РѕРј\n-- РСЃРїРѕР»СЊР·СѓРµС‚СЃСЏ РїСЂРё СЃРѕР·РґР°РЅРёРё РјРѕРґСѓР»РµР№ РґР»СЏ СѓРїСЂРѕС‰РµРЅРёСЏ РєРѕРґР°\n-- Р”Рѕ:    https://img.qweqwe.ovh/1494247121142.png\n-- РџРѕСЃР»Рµ: https://img.qweqwe.ovh/1494247134028.png\nfunction STORE_ITEM:Insert(to, key)\n\tto[key] = to[key] or {}\n\tif not table.HasValue(to[key],self) then\n\t\ttable.insert(to[key], self)\n\tend\n\treturn key\nend\n\nfunction STORE_ITEM:PriceInCurrency()\n\treturn IGS.PriceInCurrency(self.price)\nend\n\n-- РџРѕР»СѓС‡РёС‚СЊ С„РёРЅР°Р»СЊРЅСѓСЋ С†РµРЅСѓ РІ РґРѕРЅР°С‚-РІР°Р»СЋС‚Рµ СЃ СѓС‡РµС‚РѕРј СЃРєРёРґРѕРє\nfunction STORE_ITEM:GetFinalPriceInCurrency()\n\treturn IGS.PriceInCurrency(self:GetFinalPrice())\nend\n\n\n--[[-------------------------------------------------------------------------\n\tCORE\n---------------------------------------------------------------------------]]\nIGS.ITEMS = IGS.ITEMS or {\n\tSTORED = {},\n\tMAP    = {},\n}\n\n\nIGS.ITEMS.count = IGS.ITEMS.count or 0 -- РЅСѓР»РµРІС‹Рј Р±СѓРґРµС‚ null РёС‚РµРј\nfunction IGS.AddItem(sName,sUID,iPrice)\n\tsUID = sUID:lower()\n\n\t-- РџРѕР»Рµ Р‘Р” 32. РќРѕ СЃ \"P: \" UID РЅР°РґРѕ СЃРѕРєСЂР°С‰Р°С‚СЊ\n\t-- P: entity_hpwand_spell_simple_wand\n\tif #sUID \u003e 28 then\n\t\tIGS.print(Color(250,20,20),\n\t\t\t\"UID \" .. sUID .. \" РёРјРµРµС‚ РґР»РёРЅСѓ СЃРІС‹С€Рµ 28 СЃРёРјРІРѕР»РѕРІ, С‡С‚Рѕ РЅРµ РґРѕРїСѓСЃРєР°РµС‚СЃСЏ\\n\" ..\n\t\t\t\"РџСЂРёС‡РёРЅРѕР№ С‚Р°РєР¶Рµ РјРѕРіСѓС‚ СЃС‚Р°С‚СЊ РєРёСЂРёР»Р»РёС‡РµСЃРєРёРµ (СЂСѓСЃСЃРєРёРµ) РёР»Рё РёРЅС‹Рµ (emoji) СЃРёРјРІРѕР»С‹.\\n\" ..\n\t\t\t\"UniqueID РїСЂРµРґРјРµС‚Р° РґРѕР»Р¶РµРЅ СЃРѕСЃС‚РѕСЏС‚СЊ РёР· РјР°Р»РµРЅСЊРєРёС… Р°РЅРіР»РёР№СЃРєРёС… (Р»Р°С‚РёРЅСЃРєРёС…) Р±СѓРєРІ Р±РµР· РїСЂРѕР±РµР»РѕРІ Рё Р±С‹С‚СЊ РєРѕСЂРѕС‡Рµ 28 СЃРёРјРІРѕР»РѕРІ\"\n\t\t)\n\t\t-- return -- РёР·-Р·Р° СЌС‚РѕРіРѕ РІ РєРѕРЅСЃРѕР»СЊ РІС‹Р»РµР·РµС‚ РѕС€РёР±РєР°, С‚.Рµ. РЅРµ РІРµСЂРЅРµС‚СЃСЏ РѕР±СЉРµРєС‚\n\n\t\tlocal old = sUID\n\t\tsUID = old:sub(1, 28)\n\t\tIGS.print(Color(250,20,20), \"UID \" .. old .. \" СЃРѕРєСЂР°С‰РµРЅ РґРѕ \" .. sUID .. \"\\n\")\n\tend\n\n\t-- Р—Р°С‰РёС‚Р° РѕС‚ СЃР±РёРІР°РЅРёСЏ Р°Р№РґРёС€РЅРёРєРѕРІ РёР·-Р·Р° СЂРµС„СЂРµС€Р° С„Р°Р№Р»Р° СЃ РґРѕР±Р°РІР»РµРЅРёРµРј РёС‚РµРјРѕРІ\n\t-- Р§С‚РѕР±С‹ СЃС‡РµС‚С‡РёРє РЅРµ РЅР°Р±РёРІР°Р»СЃСЏ\n\tlocal ITEM = IGS.ITEMS.MAP[sUID]\n\tif ITEM then\n\t\tITEM:SetPrice(iPrice or ITEM:Price()) -- РѕР±РЅРѕРІР»СЏРµРј С†РµРЅСѓ, РІРґСЂСѓРі РёР·РјРµРЅРёР»Р°СЃСЊ\n\t\tITEM.name = sName -- Рё РёРјСЏ\n\n\t\treturn ITEM\n\tend\n\n\tlocal t = setmetatable({\n\t\tname = sName,\n\t\tuid  = sUID:lower(),\n\t\tid   = IGS.ITEMS.count,\n\t\tdescription = \"\",\n\t\ttermin = 0 -- РµСЃР»Рё РЅРµ РёР·РјРµРЅРёС‚СЊ, С‚Рѕ СѓСЃР»СѓРіР° РЅРµ РґРѕР±Р°РІРёС‚СЃСЏ РІ РїРѕРєСѓРїРєРё. РўРѕР»СЊРєРѕ РІ С‚СЂР°РЅР·Р°РєС†РёРё\n\t}, STORE_ITEM)\n\n\tif iPrice then\n\t\tt:SetPrice(iPrice)\n\tend\n\n\tIGS.ITEMS.MAP[t.uid]   = t\n\tIGS.ITEMS.STORED[t.id] = t\n\n\tIGS.ITEMS.count = IGS.ITEMS.count + 1\n\treturn t\nend\n\n\n-- РѕР№, РєР°Рє РЅРµ РїСЂР°РІРёР»СЊРЅРѕ..\nlocal null\n\nfunction IGS.GetItem(id_or_uid) -- AKA ItemExists\n\treturn IGS.ITEMS.STORED[id_or_uid] or IGS.ITEMS.MAP[id_or_uid]\nend\n\nfunction IGS.GetItemByID(iID)\n\treturn IGS.ITEMS.STORED[iID] or null\nend\n\nfunction IGS.GetItemByUID(sUID)\n\treturn IGS.ITEMS.MAP[sUID:lower()] or null\nend\n\nfunction IGS.GetItems()\n\treturn IGS.ITEMS.STORED\nend\n\n\nnull = IGS.AddItem(\"null\",\"null\",0)\n\t:SetDescription(\"Р­С‚РѕС‚ РїСЂРµРґРјРµС‚, СЃРєРѕСЂРµРµ РІСЃРµРіРѕ, РєРѕРіРґР°-С‚Рѕ СЃСѓС‰РµСЃС‚РІРѕРІР°Р» РёР»Рё СЃСѓС‰РµСЃС‚РІСѓРµС‚ РЅР° РґСЂСѓРіРѕРј СЃРµСЂРІРµСЂРµ, РЅРѕ РЅРµ Р·РґРµСЃСЊ\")\n\t:SetIcon(\"http://i.imgur.com/NfpcFdy.png\")\n\t:SetImage(\"http://i.imgur.com/32iTOFi.jpg\")\n\t:SetCanBuy(function() return \"Р­С‚РѕРіРѕ РїСЂРµРґРјРµС‚Р° РЅР° СЃРµСЂРІРµСЂРµ РЅРµС‚. РљР°Рє РІС‹ РЅР°С€Р»Рё РµРіРѕ?\" end)\n\t:SetCanActivate(function() return \"Р­С‚РѕРіРѕ РїСЂРµРґРјРµС‚Р° РЅР° СЃРµСЂРІРµСЂРµ РЅРµС‚. РњРѕР¶РµС‚Рµ СѓРЅРёС‡С‚РѕР¶РёС‚СЊ РµРіРѕ\" end) -- РЅР°РїСЂРёРјРµСЂ РєСѓРїРёР» РІ РёРЅРІРµРЅС‚Р°СЂСЊ, Р° РїРѕС‚РѕРј uid СЃРјРµРЅРёР»СЃСЏ\n\nnull.isnull = true -- РґР»СЏ РїСЂРѕРІРµСЂРєРё РІРѕ РІСЂРµРјСЏ Р°РєС‚РёРІР°С†РёРё\n","igs/processor_sv.lua":  "-- #FUSC# --\n\nlocal function giveLvlBonuses(pl, from_lvl, to_lvl)\n\tfor i = from_lvl,to_lvl do\n\t\tlocal lvl = IGS.LVL.Get(i)\n\n\t\tif lvl.bonus then\n\t\t\tlvl.bonus(pl)\n\t\tend\n\n\t\tIGS.NotifyAll(pl:Name() .. \" РїРѕР»СѓС‡РёР» РЅРѕРІС‹Р№ (\" .. i .. \") Р±РёР·РЅРµСЃ СѓСЂРѕРІРµРЅСЊ - \" .. lvl:Name())\n\tend\nend\n\nlocal function recalcTransactionsAndBonuses(pl, bGiveBonuses)\n\t-- РЎСѓРјРјР° РѕРїРµСЂР°С†РёР№\n\tIGS.GetPlayerTransactionsBypassingLimit(function(dat)\n\t\tlocal tt = 0\n\t\tfor _,v in ipairs(dat) do\n\t\t\ttt = v.Sum \u003e 0 and tt + v.Sum or tt\n\t\tend\n\n\t\tlocal prev_lvl = IGS.PlayerLVL(pl) or 0 -- РЅРµ РґРІРёРіР°С‚СЊ РїРѕРґ igs_lvl!\n\t\tpl:SetIGSVar(\"igs_lvl\",IGS.LVL.GetByCost( IGS.RealPrice(tt) ):LVL())\n\t\tpl:SetIGSVar(\"igs_total_transactions\",tt)\n\n\t\tif bGiveBonuses and IGS.PlayerLVL(pl) \u003e prev_lvl then\n\t\t\tgiveLvlBonuses(pl, prev_lvl + 1, IGS.PlayerLVL(pl))\n\t\tend\n\tend, pl:SteamID64())\nend\n\n\n-- РЈРєР°Р·Р°С‚СЊ bGiveBonuses, РµСЃР»Рё РЅСѓР¶РЅРѕ РїРµСЂРµСЃС‡РёС‚Р°С‚СЊ Р±РѕРЅСѓСЃС‹\nlocal function updateBalance(pl, fOnFinish, bGiveBonuses)\n\tIGS.GetBalance(pl:SteamID64(),function(now_igs_)\n\t\tif not IsValid(pl) then return end\n\t\tif now_igs_ == nil then\n\t\t\tif fOnFinish then fOnFinish(nil, 0) end\n\t\t\treturn\n\t\tend\n\n\t\tlocal was_igs = pl:IGSFunds()\n\t\tlocal diff = (now_igs_ or 0) - was_igs\n\n\t\tif diff ~= 0 then -- Р±Р°Р»Р°РЅСЃ != nil Рё РЅРµ 0 (? https://t.me/c/1353676159/45001)\n\t\t\tpl:SetIGSVar(\"igs_balance\", now_igs_) -- РќР• Р”РћР›Р–РќРћ Р’Р«РџРћР›РќРЇРўР¬РЎРЇ РќРђ РќР•_РљР›РР•РќРўРћР’\n\t\tend\n\n\t\tif now_igs_ then -- Р·РЅР°С‡РёС‚ РµСЃС‚СЊ С‚СЂР°РЅР·Р°РєС†РёРё\n\t\t\trecalcTransactionsAndBonuses(pl, bGiveBonuses)\n\t\tend\n\n\t\tif fOnFinish then\n\t\t\tfOnFinish(now_igs_, diff)\n\t\tend\n\tend)\nend\n\nlocal function suggestSpent(pl,bal)\n\tIGS.Notify(pl, \"Р’С‹ РјРѕР¶РµС‚Рµ РїРѕС‚СЂР°С‚РёС‚СЊ \" .. IGS.SignPrice(bal) .. \" С‡РµСЂРµР· /donate\")\nend\n\nhook.Add(\"PlayerInitialSpawn\", \"IGS.LoadPlayer\", function(pl)\n\tif pl:IsBot() then return end\n\n\t-- РЈСЃС‚Р°РЅР°РІР»РёРІР°РµРј Р±Р°Р»Р°РЅСЃ РґРѕРЅР°С‚ СЃС‡РµС‚Р° Рё РґРѕРЅР°С‚ СѓСЂРѕРІРµРЅСЊ РёРіСЂРѕРєР°\n\tupdateBalance(pl, function(bal_)\n\t\tif (not IsValid(pl)) then return end\n\n\t\tIGS.LoadPlayerPurchases(pl)\n\t\tIGS.LoadInventory(pl)\n\t\tpl.igs_balance_loaded = true\n\n\t\tif bal_ and bal_ \u003e 0 then\n\t\t\tIGS.UpdatePlayerName(pl:SteamID64(), pl:Name())\n\n\t\t\t-- РїРѕРґС‚Р°Р»РєРёРІР°РµРј С‚СЂР°С‚РёС‚СЊ РґРµРЅСЊРіРё\n\t\t\tif bal_ \u003e 10 then timer.Simple(10,function() suggestSpent(pl,bal_) end) end\n\t\tend\n\tend)\nend)\n\nlocal function syncBalance(pl)\n\tif not IsValid(pl) or pl:IsBot() then return end\n\n\tupdateBalance(pl, function(new_bal_, diff)\n\t\tif not IsValid(pl) then return end\n\t\tif not pl.igs_balance_loaded then return end\n\t\tif not diff or diff == 0 then return end\n\n\t\t-- Р•СЃР»Рё Р±Р°Р»Р°РЅСЃ РёР·РјРµРЅРёР»СЃСЏ (РІ С‚.С‡. РїСЂРё РїРѕРєСѓРїРєР°С… РЅР° СЃР°Р№С‚Рµ), С‚Рѕ РїРµСЂРµС‡РёС‚С‹РІР°РµРј РїРѕРєСѓРїРєРё/РёРЅРІРµРЅС‚Р°СЂСЊ\n\t\t-- РРЅР°С‡Рµ РѕРЅРё РѕР±РЅРѕРІСЏС‚СЃСЏ С‚РѕР»СЊРєРѕ РїСЂРё РїРµСЂРµР·Р°С…РѕРґРµ (PlayerInitialSpawn)\n\t\ttimer.Simple(1, function()\n\t\t\tif not IsValid(pl) then return end\n\n\t\t\tIGS.LoadPlayerPurchases(pl)\n\n\t\t\tif IGS.C.Inv_Enabled then\n\t\t\t\tIGS.LoadInventory(pl, function()\n\t\t\t\t\tif not IsValid(pl) then return end\n\t\t\t\t\tnet.Start(\"IGS.InventoryUpdated\")\n\t\t\t\t\tnet.Send(pl)\n\t\t\t\tend)\n\t\t\tend\n\t\tend)\n\n\t\tif diff \u003e 0 then\n\t\t\thook.Run(\"IGS.PaymentStatusUpdated\", pl, {\n\t\t\t\tmethod = \"pay\",\n\t\t\t\torderSum = tostring(diff),\n\t\t\t\tpaymentType = \"site\",\n\t\t\t\tsource = \"sync\",\n\t\t\t})\n\t\t\thook.Run(\"IGS.PlayerDonate\", pl, diff, new_bal_)\n\t\t\tsuggestSpent(pl, new_bal_)\n\t\tend\n\tend, true)\nend\n\ntimer.Create(\"IGS.BalanceSync\", IGS.C.BALANCE_SYNC_INTERVAL or 5, 0, function()\n\tfor _, pl in ipairs(player.GetHumans()) do\n\t\tsyncBalance(pl)\n\tend\nend)\n\nlocal function repairBrokenPurchases(pl,purchases)\n\tfor uid in pairs(purchases) do -- , count\n\t\tlocal ITEM = IGS.GetItemByUID(uid)\n\n\t\tif ITEM:IsValid(pl) == false then\n\t\t\tITEM:Setup(pl) -- РЅРµ РїРµСЂРІС‹Р№ СЂР°Р·, СЃРєРёРїР°РµРј onactivate\n\t\tend\n\tend\nend\n\n-- Р’РѕСЃСЃС‚Р°РЅРѕРІР»РµРЅРёРµ СЃР»РµС‚РµРІС€РёС… РїСЂР°РІ\nhook.Add(\"IGS.PlayerPurchasesLoaded\",\"RestorePex\",function(pl,purchases)\n\tif purchases then\n\t\t-- Р’РѕР·РІСЂР°С‰Р°РµРј РјР°РєСЃРёРјР°Р»СЊРЅСѓСЋ РєСѓРїР»РµРЅРЅСѓСЋ РїСЂРёРІРёР»РµРіРёСЋ (РїРѕ РёРјРјСѓРЅРёС‚РµС‚Сѓ)\n\t\tif IGS.ApplyBestFAdminGroup then\n\t\t\tIGS.ApplyBestFAdminGroup(pl, purchases)\n\t\tend\n\t\trepairBrokenPurchases(pl, purchases)\n\tend\nend)\n\n\n-- РћС‚Р»Р°РґРєР° РЅР°С‡РёСЃР»РµРЅРёСЏ Р±РѕРЅСѓСЃРѕРІ Р·Р° Р»РІР»:\n-- https://gist.github.com/1b41e1f869752d4750440619339e4085\nhook.Add(\"IGS.PaymentStatusUpdated\",\"NoRejoiningCharge\",function(pl,dat)\n\tif dat.method ~= \"pay\" then return end\n\tif dat.source == \"sync\" then return end\n\n\ttimer.Simple(1,function() -- РґР°РµРј СѓСЃРїРµС‚СЊ РІ Р‘Р” РѕР±РЅРѕРІРёС‚СЊ РґР°РЅРЅС‹Рµ\n\n\t\tupdateBalance(pl,function(new_bal_, diff)\n\t\t\tIGS.Notify(pl, \"РЎРїР°СЃРёР±Рѕ РІР°Рј Р·Р° РїРѕРїРѕР»РЅРµРЅРёРµ СЃС‡РµС‚Р°. Р’С‹ РїСЂРµР»РµСЃС‚СЊ :3\")\n\t\t\thook.Run(\"IGS.PlayerDonate\", pl, diff, new_bal_)\n\t\t\tsuggestSpent(pl, new_bal_)\n\n\t\t\t-- РџРѕСЃР»Рµ РІРЅРµС€РЅРµР№ РѕРїР»Р°С‚С‹ СЃСЂР°Р·Сѓ РїРµСЂРµС‡РёС‚С‹РІР°РµРј РїРѕРєСѓРїРєРё/РёРЅРІРµРЅС‚Р°СЂСЊ\n\t\t\tIGS.LoadPlayerPurchases(pl)\n\t\t\tif IGS.C.Inv_Enabled then\n\t\t\t\tIGS.LoadInventory(pl, function()\n\t\t\t\t\tif not IsValid(pl) then return end\n\t\t\t\t\tnet.Start(\"IGS.InventoryUpdated\")\n\t\t\t\t\tnet.Send(pl)\n\t\t\t\tend)\n\t\t\tend\n\t\tend, true) -- updateBalance with bGiveBonuses\n\n\tend) -- timer 1\nend)\n","igs/repeater.lua":  "-- РђР»РіРѕСЂРёС‚Рј Рё РѕРїРёСЃР°РЅРёРµ СЂРµРїРёС‚РµСЂР°: https://gist.github.com/5e5afdff55cc1f70f1c1a459b8487943\n\nIGS.REPEATER = IGS.REPEATER or IGStack()\nlocal R = IGS.REPEATER\n\nfunction R:IsEmpty() -- РІРЅРµС€РєР°\n\treturn self:isempty()\nend\n--------------------------------------------------------\n\nfunction R:Query(REQ)\n\tIGS.WrapQuery(REQ[1], REQ[2], REQ[3])\nend\n\nfunction R:ProcessNextQuery()\n\tlocal NEXT_REQ = self:lpop()\n\tif NEXT_REQ then\n\t\tself:Query(NEXT_REQ) -- РѕРґРёРЅ Р·Р° РґСЂСѓРіРёРј, РїРѕРєР° РЅРµ Р·Р°РєРѕРЅС‡Р°С‚СЃСЏ\n\telse -- СЃС‚Р°РІРёС‚СЃСЏ ok РґР»СЏ IGS\n\t\thook.Run(\"IGS.RepeaterEmpty\")\n\tend\nend\n\nfunction R:SafeQuery(sMethod, tParams, fOnSuccess)\n\tlocal REQ = {sMethod, tParams, fOnSuccess}\n\n\tif self:IsEmpty() then\n\t\tself:Query(REQ)\n\telse\n\t\tself:rpush(REQ)\n\tend\nend\n\n--------------------------------------------------------\n\n-- func \u003e iter\n-- РЎРєРѕР»СЊРєРѕ СЂР°Р· С„СѓРЅРєС†РёСЏ РїРµСЂРµРІС‹РїРѕР»РЅСЏР»Р°СЃСЊ\nlocal repeats_counter = setmetatable({}, {__mode = \"k\"})\n\nlocal SHOULD_REPEAT_CASES = {\n\t[\"too_many_requests\"] = true,\n\t[\"http_error\"] = true,\n\n\t-- СЃС‚РѕРёС‚ Р»Рё? Р§С‚Рѕ РµСЃР»Рё РјРµС‚РѕРґ СЃР»РѕРјР°Р»СЃСЏ РЅР° РїРѕСЃС‚РѕСЏРЅРєРµ?\n\t[\"invalid_response_format\"] = true,\n}\n\n-- РќСѓР¶РЅРѕ, С‡С‚РѕР±С‹ Р·Р°РїСЂРѕСЃС‹ Р±РµР· РєРѕР»Р±СЌРєР° РЅРµ РІС‹РґР°РІР°Р»Рё РѕС€РёР±РєСѓ\n-- https://t.me/c/1353676159/12486\nlocal function getBlankCallback(sMethod)\n\treturn function()\n\t\tprint(\"[IGS] Р РµРґРєРѕРµ СЃРѕРѕР±С‰РµРЅРёРµ. Р’С‹РїРѕР»РЅРёР»СЃСЏ \" .. sMethod .. \" Р±РµР· РєРѕР»Р±СЌРєР°, РєРѕС‚РѕСЂС‹Р№ СЃРЅР°С‡Р°Р»Р° \u0027СѓРїР°Р»\u0027\")\n\tend\nend\n\n-- РџРµСЂРµРЅРѕСЃРёС‚ Р·Р°РїСЂРѕСЃ РІ РєРѕРЅРµС† РѕС‡РµСЂРµРґРё РёР»Рё РѕС‚Р±СЂР°СЃС‹РІР°РµС‚ РµРіРѕ\nhook.Add(\"IGS.OnApiError\", \"repeater\", function(sMethod, error_uid, tParams, fOnSuccess)\n\tif SHOULD_REPEAT_CASES[error_uid] then\n\t\tfOnSuccess = fOnSuccess or getBlankCallback(sMethod)\n\n\t\tlocal try = (repeats_counter[fOnSuccess] or 0) + 1\n\t\trepeats_counter[fOnSuccess] = try\n\n\t\tif try \u003c= 15 then\n\t\t\t-- РЎР»РµРґСѓСЋС‰РёРµ Р·Р°РїСЂРѕСЃС‹ С‚РµРїРµСЂСЊ Р±СѓРґСѓС‚ РґРѕР±Р°РІР»СЏС‚СЊСЃСЏ РІ РѕС‡РµСЂРµРґСЊ, Р° РЅРµ РІС‹РїРѕР»РЅСЏС‚СЊСЃСЏ\n\t\t\t-- РќРёР¶Рµ С‚Р°Р№РјРµСЂ, РєРѕС‚РѕСЂС‹Р№ СЃРєРѕСЂРѕ РЅР°С‡РЅРµС‚ РёС… РѕР±СЂР°Р±РѕС‚РєСѓ\n\t\t\tR:rpush({sMethod, tParams, fOnSuccess})\n\t\tend\n\n\t\t-- Р‘С‹Р» burst Р·Р°РїСЂРѕСЃРѕРІ Рё С…СѓРє РІС‹Р·РІР°Р»СЃСЏ РґРІР°Р¶РґС‹\n\t\tif not timer.Exists(\"IGS_REPEATER\") then\n\t\t\tIGS.dprint(\"РћС€РёР±РєР° РІС‹РїРѕР»РЅРµРЅРёСЏ Р·Р°РїСЂРѕСЃР°: \" .. error_uid .. \". Р—Р°РїСѓС‰РµРЅ СЂРµРїРёС‚РµСЂ\")\n\t\t\ttimer.Create(\"IGS_REPEATER\", 10, 1, function() R:ProcessNextQuery() end)\n\t\tend\n\telse\n\t\t-- РђРЅС‚РёР·Р°РІРёСЃР°РЅРёРµ РїСЂРё\n\t\t-- [СѓСЃРїРµС€РЅС‹Р№ \u003e РЅРµСѓСЃРїРµС€РЅС‹Р№ \u003e СѓСЃРїРµС€РЅС‹Р№]\n\t\t-- https://img.qweqwe.ovh/1565285856105.png\n\t\tR:ProcessNextQuery()\n\tend\nend)\n\n-- Р’С‹СЂСѓР±Р°РµС‚ С‚Р°Р№РјРµСЂ, РІС‹РїРѕР»РЅСЏРµС‚ РїРѕСЃР»РµРґРѕРІР°С‚РµР»СЊРЅРѕ РѕСЃС‚Р°РІС€РёРµСЃСЏ Р·Р°РїСЂРѕСЃС‹\nhook.Add(\"IGS.OnApiSuccess\", \"repeater\", function()\n\t-- Р­С‚Рѕ РєР°Р»Р»Р±СЌРє РІРЅСѓС‚СЂРё СѓСЃРїРµС€РЅРѕРіРѕ С…СѓРєР°, С‚РѕРµСЃС‚СЊ GMD Р·Р°СЂР°Р±РѕС‚Р°Р»\n\t-- Рё РїРѕ Р»РѕРіРёРєРµ РѕСЃС‚Р°Р»СЊРЅС‹Рµ Р·Р°РїСЂРѕСЃС‹ РІС‹РїРѕР»РЅСЏС‚СЃСЏ РєРѕСЂСЂРµРєС‚РЅРѕ\n\t-- Р•СЃР»Рё РєР°РєРѕР№-С‚Рѕ РІСЃРµ Р¶Рµ РґР°СЃС‚ СЃР±РѕР№, С‚Рѕ СЃРЅРѕРІР° Р·Р°СЂР°Р±РѕС‚Р°РµС‚ С‚Р°Р№РјРµСЂ\n\tR:ProcessNextQuery() -- one by one\nend)\n","igs/servers/serv_sh.lua":  "IGS.SERVERS = --[[ IGS.SERVERS or --]] setmetatable({\n\tID   = function() return IGS.SERVERS.CURRENT end,\n\tName = function() return IGS.SERVERS.MAP[IGS.SERVERS.CURRENT] end,\n\n\t-- РћС‚РїСЂР°РІР»СЏРµС‚ РЅР° РєР»РёРµРЅС‚ С‚Р°Р±Р»РёС†Сѓ IGS.SERVERS\n\tBroadcast = function()\n\t\t-- РЅРµР»СЊР·СЏ nil\n\t\tIGS.nw.SetGlobal(\"igs_servers\",true)\n\tend,\n\n\tMAP  = {}, -- id, name\n\n\t-- CURRENT -- int\n\t-- LOADED -- bool\n\tTOTAL   = 0, -- РґР»СЏ СЃС‡РёС‚С‹РІР°РЅРёСЏ СЃРµСЂРІРµСЂРѕРІ РІ nw\n\tENABLED = 0, -- РґР»СЏ РїРѕРґСЃС‡РµС‚Р° СЃРєРёРґРєРё\n},{\n\t__call = function(self,id)\n\t\treturn IGS.SERVERS.MAP[id]\n\tend\n})\n\n\nIGS.nw.Register(\"igs_servers\")\n\t:Write(function()\n\t\tnet.WriteUInt(IGS.SERVERS.CURRENT,16) -- 65535\n\t\tnet.WriteUInt(IGS.SERVERS.TOTAL,8) -- 256\n\t\tnet.WriteUInt(IGS.SERVERS.ENABLED,8) -- 256\n\n\t\tfor id,name in pairs(IGS.SERVERS.MAP) do\n\t\t\tnet.WriteUInt(id,16)\n\t\t\tnet.WriteString(name)\n\t\tend\n\tend)\n\t:Read(function()\n\t\tIGS.SERVERS.CURRENT = net.ReadUInt(16)\n\t\tIGS.SERVERS.TOTAL   = net.ReadUInt(8)\n\t\tIGS.SERVERS.ENABLED = net.ReadUInt(8)\n\n\t\tfor i = 1,IGS.SERVERS.TOTAL do\n\t\t\tIGS.SERVERS.MAP[net.ReadUInt(16)] = net.ReadString()\n\t\tend\n\n\t\treturn IGS.SERVERS\n\tend)\n:SetGlobal()\n","igs/servers/serv_sv.lua":  "local function intToIp(int)\n\tlocal a = bit.band(int, 0xFF000000)\n\tlocal b = bit.band(int, 0x00FF0000)\n\tlocal c = bit.band(int, 0x0000FF00)\n\tlocal d = bit.band(int, 0x000000FF)\n\n\ta = bit.rshift(a, 24)\n\tb = bit.rshift(b, 16)\n\tc = bit.rshift(c, 8)\n\n\tlocal ip = a .. \".\" .. b .. \".\" .. c .. \".\" .. d\n\treturn ip\nend\n\nlocal function getHostIp() -- mb nil\n\tlocal sDecimal = GetConVarString(\"hostip\")\n\tif not tonumber(sDecimal) then return end -- https://t.me/c/1353676159/10578\n\treturn intToIp(sDecimal) -- game.GetIPAddress():Split(\":\")[1] (0.0.0.0)\nend\n\nlocal function getHostPort()\n\treturn tonumber( game.GetIPAddress():match(\":(.+)$\") )\nend\n\n\n\n\n-- РџРѕСЃР»Рµ РІС‹Р·РѕРІР° СЌС‚РѕР№ С„СѓРЅРєС†РёРё Р·Р°РіСЂСѓР¶Р°РµС‚СЃСЏ РІС‚РѕСЂР°СЏ С‡Р°СЃС‚СЊ СЃРєСЂРёРїС‚Р°\n-- Рў.Рµ. РЅРµ РІС‹Р·РІР°С‚СЊ С„СѓРЅРєС†РёСЋ - РЅРµ Р·Р°РїСѓСЃС‚РёС‚СЃСЏ СЃРєСЂРёРїС‚\n-- РћРЅР° РЅРµ РІС‹Р·С‹РІР°РµС‚СЃСЏ, РµСЃР»Рё СЃРµСЂРІРµСЂ РѕС‚РєР»СЋС‡РµРЅ РёР»Рё РїСЂРѕРёР·РѕС€Р»Р° РѕС€РёР±РєР° РІ С…РѕРґРµ РІС‹РїРѕР»РЅРµРЅРёСЏ Р·Р°РїСЂРѕСЃР° РЅР° РїРѕР»СѓС‡РµРЅРёРµ СЃРїРёСЃРєР° СЃРµСЂРІРµСЂРѕРІ\nlocal function onReady()\n\tIGS.SERVERS.Broadcast()\n\thook.Run(\"IGS.ServersLoaded\")\n\tIGS.SetServerVersion(GetConVarString(\"igs_version\"))\nend\n\nlocal function addServerLocally(id, serv_name, enabled)\n\tif true    then IGS.SERVERS.TOTAL   = IGS.SERVERS.TOTAL   + 1 end\n\tif enabled then IGS.SERVERS.ENABLED = IGS.SERVERS.ENABLED + 1 end\n\n\tIGS.SERVERS.MAP[id] = serv_name\nend\n\nlocal function addCurrentServerLocally(id, serv_name, sock_port)\n\tIGS.SERVERS.CURRENT = id\n\taddServerLocally(id, serv_name, true)\n\n\tIGS.C.SOCKETPORT = sock_port\n\n\t-- Р±С‹Р»Рѕ РІ registerCurrentServer РґРѕ https://t.me/c/1353676159/17695\n\tbib.set(\"igs:serverid\", id)\nend\n\nlocal function registerCurrentServer(local_ip,port, fOnSuccess)\n\tIGS.AddServer(local_ip, port, function(id)\n\t\tIGS.print(\n\t\t\t\"CEPBEP 3APEruCTPuPOBAH nOg ig: \" .. id .. \"\\n\" ..\n\t\t\t\"HACTPOuKu yKasaHu B config_sv.lua\"\n\t\t)\n\n\t\tlocal sock_port = port + 10\n\t\tlocal serv_name = GetConVarString(\"hostname\")\n\t\taddCurrentServerLocally(id, serv_name, sock_port) -- РЅСѓР¶РЅРѕ СЃРЅР°СЂСѓР¶Рё SetServerSocketPort РґР»СЏ IGS.SERVERS:ID()\n\t\tIGS.SetServerName( serv_name )\n\t\tIGS.SetServerSocketPort(sock_port, function()\n\t\t\tfOnSuccess()\n\n\t\tIGS.print(\n\t\t\t\"COKET CEPBEPA HACTpOEH. nOPT: \" .. sock_port .. \"\\n\" ..\n\t\t\t\"ECJIu C4ET nOnOJIH9ETC9 HE MrHOBEHHO, TO nPOBEPbTE HACTPOuKu MySQL\"\n\t\t)\n\t\tend)\n\tend)\nend\n\nlocal function loadServersOrRegisterCurrent(d, local_ip)\n\tlocal serv_port = getHostPort()\n\n\t-- reset\n\tIGS.SERVERS.TOTAL   = 0\n\tIGS.SERVERS.ENABLED = 0\n\n\tlocal maxVisibleServerId = 0 -- Р±РѕР»СЊС€РёР№ РёРґ РјРѕР¶РµС‚ Р±С‹С‚СЊ Р°СЂС…РёРІРёСЂРѕРІР°РЅРЅС‹Рј\n\tlocal isCurrentDisabled\n\tfor _,v in ipairs(d) do -- -- `ID`,`Name`,`IP`,`Port`,`SocketPort`,`Disabled`\n\t\tlocal disabled = tobool(v.Disabled)\n\t\tmaxVisibleServerId = math.max(v.ID, maxVisibleServerId)\n\n\t\t-- РўРµРєСѓС‰РёР№ СЃРµСЂРІРµСЂ\n\t\tif v.IP == local_ip and v.Port == serv_port then\n\t\t\tif disabled then isCurrentDisabled = true end\n\t\t\taddCurrentServerLocally(v.ID, v.Name, v.SocketPort) -- sock may be nil\n\t\telse\n\t\t\taddServerLocally(v.ID, v.Name, not disabled)\n\t\tend\n\tend\n\n\t-- limit 50\n\tif maxVisibleServerId \u003e 40 then\n\t\tIGS.print(Color(255,50,50),\n\t\t\t\"y IIpoekTa 6oJIee 40 3arerucTpuPoBaHHbIx cepBepoB.\\n\" ..\n\t\t\t\"IIo gocTu}{eHuIO 50 cepBepoB HoBbIe IIepectaHyT co3gaBaTbC9 u 3tot He 3arpy3uTc9.\\n\" ..\n\t\t\t\"O6HoBJI9uTe IP IIpowJIbIX uJIu co3gauTe HoBbIu IIpoeKT\"\n\t\t)\n\tend\n\n\tif isCurrentDisabled then\n\t\tIGS.print(Color(255,50,50), \"3TOT CEPBEP OTKJII04EH. 3ArPy3KA nPEKPAwEHA\")\n\t\treturn -- РЅРµ РґР°РµРј РІС‹РїРѕР»РЅРёС‚СЊ onReady()\n\tend\n\n\t-- РЎРµСЂРІРµСЂ РЅРµ Р·Р°СЂРµРіРёСЃС‚СЂРёСЂРѕРІР°РЅ\n\tif not IGS.SERVERS.CURRENT then\n\t\tlocal id_before = bib.getNum(\"igs:serverid\")\n\t\tif id_before and IGS.SERVERS(id_before) then\n\t\t\tIGS.print(\"IIOXO}{E 3TOT CEPBEP IIEPEEXAJI (CMEHA IP)\")\n\t\t\tIGS.UpdateServerAddress(id_before, local_ip, serv_port, function()\n\t\t\t\tIGS.GetServers(function(dat)\n\t\t\t\t\tloadServersOrRegisterCurrent(dat, local_ip)\n\t\t\t\tend, true)\n\t\t\tend)\n\n\t\telse\n\t\t\tIGS.print(\"3TOT CEPBEP HE 3APEruCTPuPOBAH. CO39AEM!\")\n\t\t\tregisterCurrentServer(local_ip,serv_port, onReady)\n\t\tend\n\telse\n\t\tonReady()\n\tend\nend\n\n\n\n\nlocal function ipToInt(ip)\n\tlocal int = 0\n\tlocal p1,p2,p3,p4 = ip:match(\"(%d+)%.(%d+)%.(%d+)%.(%d+)\")\n\tint = int + bit.lshift(p1,24)\n\tint = int + bit.lshift(p2,16)\n\tint = int + bit.lshift(p3,8)\n\tint = int + p4\n\treturn int\nend\n\nlocal function maskHasIP(mask, ip)\n\tlocal maskip,bits = mask:match(\"(%d+.%d+.%d+.%d+)/(%d+)\")\n\tmaskip = ipToInt(maskip)\n\n\tlocal netmask = bit.lshift(0xFFFFFFFF, 32 - bits)\n\treturn bit.band(maskip,netmask) == bit.band(ipToInt(ip),netmask)\nend\n\n-- NAT?\nlocal function isIpInternal(ip)\n\tlocal masks = {\"192.168.0.0/16\", \"172.16.0.0/12\", \"10.0.0.0/8\", \"25.0.0.0/8\", \"169.254.0.0/16\", \"127.0.0.0/8\"}\n\tfor _,mask in ipairs(masks) do\n\t\tif maskHasIP(mask, ip) then\n\t\t\treturn true\n\t\tend\n\tend\n\n\tif ip == \"255.255.255.255\" then\n\t\treturn true\n\tend\nend\n\n\n\n\nlocal function getAndLoadServers(local_ip)\n\tIGS.GetServers(function(dat)\n\t\tloadServersOrRegisterCurrent(dat, local_ip)\n\tend, true) -- include disabled\nend\n\nhook.Add(\"IGS.DBConnected\", \"IGS.ReloadServers\", function()\n\tif IGS.SERVERS.CURRENT then return end\n\tlocal ip = getHostIp()\n\tif not ip or isIpInternal(ip) then\n\t\tIGS.GetExternalIP(getAndLoadServers)\n\telse\n\t\tgetAndLoadServers(ip)\n\tend\nend)\n\ntimer.Simple(0,function() -- С„РµС‚С‡ Р·Р°СЂР°Р±РѕС‚Р°РµС‚ С‚РѕР»СЊРєРѕ С‚Р°Рє РІ СЌС‚РѕС‚ РјРѕРјРµРЅС‚\n\tlocal ip = getHostIp()\n\t-- ip = \"192.168.5.6\"\n\n\tif not ip or isIpInternal(ip) then\n\t\tIGS.GetExternalIP(getAndLoadServers)\n\telse\n\t\tgetAndLoadServers(ip)\n\tend\nend)\n\nlocal function renewAddressAndReloadServers(ip)\n\tIGS.UpdateServerAddress(IGS.SERVERS:ID(), ip, getHostPort(), function()\n\t\tIGS.GetServers(function(dat)\n\t\t\tloadServersOrRegisterCurrent(dat, ip)\n\t\tend, true)\n\tend)\nend\n\n","igs/utils/ut_cl.lua":  "-- РќРѕСЂРј РЅР°Р·РІР°РЅРёРµ СЃРµСЂРІРµСЂР° РїРѕ РµРіРѕ РР”\n-- Р•СЃР»Рё РІРµСЂРЅСѓС‚ \"-\", Р·РЅР°С‡РёС‚ СЃРµСЂРІРµСЂ СЃРєРѕСЂРµРµ РІСЃРµРіРѕ, РѕС‚РєР»СЋС‡РµРЅ\nfunction IGS.ServerName(iID)\n\tlocal serv_name = iID == 0 and \"РћС‚РєР».\" or IGS.SERVERS(iID)\n\t      serv_name = serv_name or \"Р“Р»РѕР±.\" -- IGS.SERVERS(iID) РІРµСЂРЅСѓР» nil = РІРµР·РґРµ\n\t      -- serv_name = serv_name[1]:upper() .. serv_name:sub(2) -- Р°РїРїРµСЂРєРµР№СЃРёС‚ РїРµСЂРІСѓСЋ Р±СѓРєРІСѓ\n\n\treturn serv_name\nend\n\n\nfunction IGS.ProcessActivate(dbID, cb)\n\tIGS.Activate(dbID,function(ok, iPurchID, sMsg_)\n\t\tsMsg_ = sMsg_ or \"РџСЂРµРґРјРµС‚ Р°РєС‚РёРІРёСЂРѕРІР°РЅ. РЎРїР°СЃРёР±Рѕ РІР°Рј!\"\n\t\tIGS.ShowNotify(sMsg_, ok and \"РЈСЃРїРµС€РЅР°СЏ Р°РєС‚РёРІР°С†РёСЏ\" or \"РћС€РёР±РєР° Р°РєС‚РёРІР°С†РёРё\")\n\n\t\tif cb then\n\t\t\tcb(ok, iPurchID, sMsg_)\n\t\tend\n\tend)\nend\n","igs/utils/ut_sh.lua":  "-- #todo РЅСѓР¶РЅРѕ РїРµСЂРµРґРµР»С‹РІР°С‚СЊ, РЅРѕ С‚РѕР»СЊРєРѕ С‚Р°Рє:\n-- https://trello.com/c/WfVYTIOF/544 (РєРѕРјРјРµРЅС‚С‹)\nCreateConVar(\"igs_debug\", 0, FCVAR_NOTIFY)\ncvars.AddChangeCallback(\"igs_debug\", function(_, old, new)\n\tIGS.DEBUG = tobool(new)\n\tIGS.print(\"PEZuM OTJIA9Ku \" .. (IGS.DEBUG and \"AKTuBuPOBAH\" or \"BbIKJII04EH\"))\nend, \"main\")\n\n-- РЈСЃС‚Р°РЅРѕРІРєР° РёРєРѕРЅРєРё РґР»СЏ РєР°С‚РµРіРѕСЂРёРё\nIGS.CategoryIcons = IGS.CategoryIcons or {}\nfunction IGS.SetCategoryIcon(sCategoryName, sIconPath)\n\tif CLIENT then\n\t\tIGS.CategoryIcons[sCategoryName] = sIconPath\n\tend\nend\n\nfunction IGS.GetCategoryIcon(sCategoryName)\n\treturn IGS.CategoryIcons[sCategoryName]\nend\n\n-- РЎРёСЃС‚РµРјР° РіР»РѕР±Р°Р»СЊРЅС‹С… СЃРєРёРґРѕРє\nIGS.GlobalDiscount = IGS.GlobalDiscount or {}\n\n-- РЈСЃС‚Р°РЅРѕРІРёС‚СЊ РіР»РѕР±Р°Р»СЊРЅСѓСЋ РїСЂРѕС†РµРЅС‚РЅСѓСЋ СЃРєРёРґРєСѓ (РЅР°РїСЂРёРјРµСЂ, 15 = 15%)\nfunction IGS.SetGlobalDiscountPercent(iPercent)\n\tIGS.GlobalDiscount.type = \"percent\"\n\tIGS.GlobalDiscount.value = iPercent\nend\n\n-- РЈСЃС‚Р°РЅРѕРІРёС‚СЊ РіР»РѕР±Р°Р»СЊРЅСѓСЋ С„РёРєСЃРёСЂРѕРІР°РЅРЅСѓСЋ СЃРєРёРґРєСѓ РІ СЂСѓР±Р»СЏС… (РЅР°РїСЂРёРјРµСЂ, 100 = 100 СЂСѓР±Р»РµР№)\nfunction IGS.SetGlobalDiscountFixed(iRubles)\n\tIGS.GlobalDiscount.type = \"fixed\"\n\tIGS.GlobalDiscount.value = iRubles\nend\n\n-- РЈР±СЂР°С‚СЊ РіР»РѕР±Р°Р»СЊРЅСѓСЋ СЃРєРёРґРєСѓ\nfunction IGS.RemoveGlobalDiscount()\n\tIGS.GlobalDiscount = {}\nend\n\n-- РџРѕР»СѓС‡РёС‚СЊ СЃРєРёРґРѕС‡РЅСѓСЋ С†РµРЅСѓ СЃ СѓС‡РµС‚РѕРј РіР»РѕР±Р°Р»СЊРЅРѕР№ СЃРєРёРґРєРё\nfunction IGS.GetDiscountedPrice(iOriginalPrice)\n\tif !IGS.GlobalDiscount.type then\n\t\treturn iOriginalPrice\n\tend\n\t\n\tif IGS.GlobalDiscount.type == \"percent\" then\n\t\treturn iOriginalPrice * (1 - IGS.GlobalDiscount.value / 100)\n\telseif IGS.GlobalDiscount.type == \"fixed\" then\n\t\treturn math.max(0, iOriginalPrice - IGS.GlobalDiscount.value)\n\tend\n\t\n\treturn iOriginalPrice\nend\n\n-- РџСЂРѕРІРµСЂРёС‚СЊ, РµСЃС‚СЊ Р»Рё РіР»РѕР±Р°Р»СЊРЅР°СЏ СЃРєРёРґРєР°\nfunction IGS.HasGlobalDiscount()\n\treturn IGS.GlobalDiscount.type ~= nil\nend\n\n\nlocal PLAYER = FindMetaTable(\"Player\")\n\nfunction PLAYER:IGSFunds()\n\treturn self:GetIGSVar(\"igs_balance\") or 0\nend\n\nfunction PLAYER:HasPurchase(sUID)\n\treturn IGS.PlayerPurchases(self)[sUID]\nend\n\n-- true, РµСЃР»Рё С‡РµР»РѕРІРµРє РёРјРµРµС‚ С…РѕС‚СЊ РѕРґРёРЅ РёС‚РµРј РёР· СЃРїРёСЃРєР°, nil, РµСЃР»Рё РёС‚РµРј РЅРµ РѕС‚СЃР»РµР¶РёРІР°РµС‚СЃСЏ, false, РµСЃР»Рё РЅРµС‚ РїСЂР°РІР°. РќР°С‡Р°Р»Рѕ СЋР·Р°С‚СЊСЃСЏ РґР»СЏ СѓРїСЂРѕС‰РµРЅРёСЏ РєРѕРґР° РјРѕРґСѓР»РµР№\nfunction IGS.PlayerHasOneOf(pl,tItems)\n\tif !tItems then return end\n\n\tfor _,ITEM in ipairs(tItems) do\n\t\tif pl:HasPurchase( ITEM:UID() ) then\n\t\t\treturn ITEM\n\t\tend\n\tend\n\n\treturn false\nend\n\nfunction IGS.isUser(pl) -- РІРѕР·РІСЂР°С‰Р°РµС‚ false, РµСЃР»Рё С‡РµР» РЅРёРєРѕРіРґР° РЅРµ СЋР·Р°Р» Р°РІС‚РѕРґРѕРЅР°С‚\n\treturn pl:GetIGSVar(\"igs_balance\") ~= nil\nend\n\n\n-- РњРѕР¶РµС‚ Р»Рё С‡РµР» СЃРµР±Рµ РїРѕР·РІРѕР»РёС‚СЊ РїРѕРєСѓРїРєСѓ РёС‚РµРјР°, С†РµРЅРѕР№ РІ sum IGS?\nfunction IGS.CanAfford(pl,sum,assert)\n\tif sum \u003e= 0 and pl:IGSFunds() - sum \u003e= 0 then\n\t\treturn true\n\tend\n\n\tif !assert then\n\t\treturn false\n\tend\n\n\tif isfunction(assert) then\n\t\tassert()\n\telse\n\t\tlocal rub = IGS.RealPrice(sum)\n\t\tif SERVER then\n\t\t\tIGS.WIN.Deposit(pl,rub)\n\t\telse\n\t\t\tIGS.WIN.Deposit(rub)\n\t\tend\n\tend\n\n\treturn false\nend\n\n-- РЎРїРёСЃРѕРє Р°РєС‚РёРІРЅС‹С… РїРѕРєСѓРїРѕРє РёРіСЂРѕРєР°\n-- uid \u003e amount\nfunction IGS.PlayerPurchases(pl)\n\treturn CLIENT and (pl:GetIGSVar(\"igs_purchases\") or {}) or pl:GetVar(\"igs_purchases\",{})\nend\n\n-- РЎСѓРјРјР° РІ РґРѕРЅР°С‚ РІР°Р»СЋС‚Рµ РІСЃРµС… РѕРїРµСЂР°С†РёР№ РїРѕРїРѕР»РЅРµРЅРёСЏ СЃС‡РµС‚Р° (РІРєР»СЋС‡Р°СЏ РєСѓРїРѕРЅС‹ Рё РІС‹РґР°С‡Сѓ РґРµРЅРµРі Р°РґРјРёРЅРёСЃС‚СЂР°С‚РѕСЂРѕРј)\nfunction IGS.TotalTransaction(pl)\n\treturn pl:GetIGSVar(\"igs_total_transactions\") or 0\nend\n\n-- РІРѕР·РІСЂР°С‚ РѕР±СЉРµРєС‚Р° Р›Р’Р› РЅР° РєР»РёРµРЅС‚Рµ, РЅРѕРјРµСЂР° СѓСЂРѕРІРЅСЏ РЅР° СЃРµСЂРІРµСЂРµ\nfunction IGS.PlayerLVL(pl)\n\treturn pl:GetIGSVar(\"igs_lvl\")\nend\n\n\n-- РљРѕРЅРІРµСЂС‚РёСЂСѓРµС‚ IGS РІ СЂРµР°Р»СЊРЅСѓСЋ РІР°Р»СЋС‚Сѓ\nfunction IGS.RealPrice(iCurrencyAmount)\n\treturn iCurrencyAmount * IGS.GetCurrencyPrice()\nend\n\n-- Р РµР°Р»СЊРЅР°СЏ РІР°Р»СЋС‚Р° РІ IGS РїРѕ С‚РµРєСѓС‰РµРјСѓ РєСѓСЂСЃСѓ\nfunction IGS.PriceInCurrency(iRealPrice)\n\treturn iRealPrice / IGS.GetCurrencyPrice()\nend\n\n\nfunction IGS.IsCurrencyEnabled()\n\treturn IGS.GetCurrencyPrice() ~= 1\nend\n\nlocal function getSettings()\n\treturn IGS.nw.GetGlobal(\"igs_settings\")\nend\n\n-- РњРёРЅРёРјР°Р»СЊРЅР°СЏ СЃСѓРјРјР° РїРѕРїРѕР»РЅРµРЅРёСЏ РІ СЂСѓР±Р»СЏС…\nfunction IGS.GetMinCharge()\n\treturn getSettings()[1]\nend\n\n-- РЎС‚РѕРёРјРѕСЃС‚СЊ 1 РґРѕРЅР°С‚ РІР°Р»СЋС‚С‹ РІ СЂСѓР±Р»СЏС…\nfunction IGS.GetCurrencyPrice()\n\treturn getSettings()[2]\nend\n\n-- РќРµ СЃРјРѕРі Р·Р°РіСЂСѓР·РёС‚СЊСЃСЏ РёР»Рё РІС‹РєР»СЋС‡РµРЅ РІ РїР°РЅРµР»Рё, РјРµРЅСЋ РѕС‚РєСЂС‹РІР°С‚СЊ РЅРµР»СЊР·СЏ\nfunction IGS.IsLoaded()\n\treturn getSettings() and IGS.SERVERS:ID() and !GetGlobalBool(\"IGS_DISABLED\")\nend\n\n\n\n\nlocal terms = {\n\t[1] = \"Р±РµСЃРєРѕРЅРµС‡РЅРѕ\",\n\t[2] = \"РµРґРёРЅРѕСЂР°Р·РѕРІРѕ\",\n\t[3] = \"%s\"\n}\n\nfunction IGS.TermType(term)\n\treturn\n\t\t!term     and 1 or -- Р±РµСЃРєРѕРЅРµС‡РЅРѕ\n\t\tterm == 0 and 2 or -- РјРіРЅРѕРІРµРЅРЅРѕ\n\t\tterm      and 3    -- РєРѕР»-РІРѕ РґРЅРµР№\nend\n\nfunction IGS.TermToStr(term)\n\treturn terms[ IGS.TermType(term) ]:format(term and PL_DAYS(term))\nend\n\nfunction IGS.TimestampToDate(ts,bShowFull) -- РІ \"РєСѓРїРёР» РґРѕ\"\n\tif !ts then return end\n\treturn os.date(bShowFull and IGS.C.DATE_FORMAT or IGS.C.DATE_FORMAT_SHORT,ts)\nend\n\n\nfunction IGS.FormItemInfo(ITEM)\n\tlocal finalPrice = ITEM:GetFinalPrice()\n\tlocal originalPrice = ITEM:Price()\n\tlocal hasDiscount = (finalPrice ~= originalPrice) or ITEM.discounted_from or IGS.HasGlobalDiscount()\n\t\n\treturn {\n\t\t[\"РљР°С‚РµРіРѕСЂРёСЏ\"] = ITEM:Category(),\n\t\t[\"Р”РµР№СЃС‚РІСѓРµС‚\"] = IGS.TermToStr(ITEM:Term()),\n\t\t[\"Р¦РµРЅР°\"]       = PL_MONEY(finalPrice),\n\t\t[\"Р‘РµР· СЃРєРёРґРєРё\"] = hasDiscount and PL_MONEY(originalPrice) or nil,\n\t\t[\"РџРѕРєСѓРїРєРё СЃСѓРјРјРёСЂСѓСЋС‚СЃСЏ\"]  = ITEM:IsStackable() and \"РґР°\" or \"РЅРµС‚\",\n\t}\nend\n\n\nfunction IGS.print(...)\n\tlocal args = {...}\n\tif !IsColor(args[1]) then\n\t\ttable.insert(args,1,color_white)\n\tend\n\n\targs[#args] = args[#args] .. \"\\n\"\n\tMsgC(Color(50,200,255), \"[IGS] \", unpack(args))\nend\n\nfunction IGS.dprint(...)\n\tif IGS.DEBUG then\n\t\tIGS.print(\"DEBUG: \", Color(50,250,50), ...)\n\tend\nend\n\n\n\n\nfunction IGS.SignPrice(iPrice) -- 10 Alc\n\treturn math.Truncate(tonumber(iPrice),2) .. \" \" .. IGS.C.CURRENCY_SIGN\nend\n\nlocal rubs = {\"СЂСѓР±Р»СЊ\", \"СЂСѓР±Р»СЏ\", \"СЂСѓР±Р»РµР№\"}\nPL_MONEY = PL.Add(\"realmoney\",rubs)\nPL_IGS   = PL.Add(\"igs_currency\",IGS.C.CurrencyPlurals or rubs)\nPL_DAYS  = PL.Add(\"days\",{\"РґРµРЅСЊ\", \"РґРЅСЏ\", \"РґРЅРµР№\"})\n\n\nlocal PL_IGS_ORIGINAL\nhook.Add(\"IGS.OnSettingsUpdated\",\"PL_IGS = PL_MONEY\",function()\n\tif !IGS.IsCurrencyEnabled() then -- Р•СЃР»Рё РґРѕРЅР°С‚ РІР°Р»СЋС‚Р° РѕС‚РєР»СЋС‡РµРЅР°\n\t\tPL_IGS_ORIGINAL = PL_IGS -- Р° СЌС‚Рѕ РЅРµ С‚Р°Р±Р»РёС†Р° СЃР»СѓС‡Р°Р№РЅРѕ? РњР± table.copy?\n\t\tPL_IGS = PL_MONEY\n\n\t-- Р’Р°Р»СЋС‚Р° СѓР¶Рµ РѕС‚РєР»СЋС‡Р°Р»Р°СЃСЊ. РЎРµР№С‡Р°СЃ РІРєР»СЋС‡РёР»Р°СЃСЊ\n\telseif PL_IGS_ORIGINAL then\n\t\tPL_IGS = PL_IGS_ORIGINAL\n\tend\nend)\n","igs/utils/ut_sv.lua":  "\nlocal col_lime  = Color(100,210,40)\nlocal col_light = Color(228,228,228)\nlocal col_red   = Color(250,30,90)\n\nfunction IGS.NotifyAll(...)\n\tchat.AddTextSV(\n\t\tcol_lime, \"[IGS]\",\n\t\tcol_red,  \" \u003e \",\n\t\tcol_light,...\n\t)\nend\n\n\nfunction IGS.Notify(pl, ...)\n\tpl:ChatPrintColor(\n\t\tcol_lime, \"[IGS]\",\n\t\tcol_red,  \" \u003e \",\n\t\tcol_light,...\n\t)\nend\n\n-- IGS.MUTE_NOTIFY = IGS.MUTE_NOTIFY or {}\n-- function IGS.NotifyOpt(pl, uid, ...)\n-- \tif IGS.MUTE_NOTIFY[uid] then return end\n-- \treturn IGS.Notify(pl, ...)\n-- end\n\n\n-- todo СЂРµР°Р»СЊРЅС‹Р№ Р»РѕРіРіРёРЅРі\nfunction IGS.LogError(err)\n\terror(err)\nend\n\n\n--[[---------------------------\n\tAPI\n-----------------------------]]\n-- РџСЂРѕС‰Рµ https://qweqwe.ovh/9vAdB\nlocal limit_per_query = 255\nlocal function getTxsNoLimit(cb, s64, am_, _tmp_)\n\t_tmp_ = _tmp_ or {}\n\tam_   =   am_ or math.huge\n\tlocal left = am_ - #_tmp_\n\t-- print(\"need, done, left\", am_, #_tmp_, left)\n\tIGS.GetTransactions(function(data)\n\t\tfor _,tr in ipairs(data) do\n\t\t\tlocal i = table.insert(_tmp_,tr)\n\t\t\tif am_ and i == am_ then cb(_tmp_) return end -- СЃРѕР±СЂР°Р»Рё РЅСѓР¶РЅРѕРµ РєРѕР»-РІРѕ\n\t\tend\n\n\t\tif #data \u003c limit_per_query then cb(_tmp_) -- РџРѕСЃР»РµРґРЅСЏСЏ СЃС‚СЂР°РЅРёС†Р°\n\t\telse getTxsNoLimit(cb, s64, am_, _tmp_)\n\t\tend\n\tend, s64, true, math.min(limit_per_query, left), #_tmp_)\nend\n\nIGS.GetPlayerTransactionsBypassingLimit = getTxsNoLimit\n\n-- getTxsNoLimit(function(all)\n-- \tfor i,tx in ipairs(all) do\n-- \t\tprint(i, DateTime(tx.Time), tx.Note)\n-- \tend\n-- \tprint(\"#all\", #all)\n-- end, AMD():SteamID(), 20)"}